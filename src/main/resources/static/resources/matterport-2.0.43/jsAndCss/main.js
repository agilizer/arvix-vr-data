if ("undefined" == typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");
+function (t) {
    "use strict";
    function e(e) {
        return this.each(function () {
            var i = t(this), s = i.data("bs.tooltip"), n = "object" == typeof e && e;
            (s || "destroy" != e) && (s || i.data("bs.tooltip", s = new o(this, n)), "string" == typeof e && s[e]())
        })
    }

    var o = function (t, e) {
        this.type = this.options = this.enabled = this.timeout = this.hoverState = this.$element = null, this.init("tooltip", t, e)
    };
    o.VERSION = "3.2.0", o.DEFAULTS = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover focus",
        title: "",
        delay: 0,
        html: !1,
        container: !1,
        viewport: {selector: "body", padding: 0}
    }, o.prototype.init = function (e, o, i) {
        this.enabled = !0, this.type = e, this.$element = t(o), this.options = this.getOptions(i), this.$viewport = this.options.viewport && t(this.options.viewport.selector || this.options.viewport);
        for (var s = this.options.trigger.split(" "), n = s.length; n--;) {
            var r = s[n];
            if ("click" == r)this.$element.on("click." + this.type, this.options.selector, t.proxy(this.toggle, this)); else if ("manual" != r) {
                var a = "hover" == r ? "mouseenter" : "focusin", l = "hover" == r ? "mouseleave" : "focusout";
                this.$element.on(a + "." + this.type, this.options.selector, t.proxy(this.enter, this)), this.$element.on(l + "." + this.type, this.options.selector, t.proxy(this.leave, this))
            }
        }
        this.options.selector ? this._options = t.extend({}, this.options, {
            trigger: "manual",
            selector: ""
        }) : this.fixTitle()
    }, o.prototype.getDefaults = function () {
        return o.DEFAULTS
    }, o.prototype.getOptions = function (e) {
        return e = t.extend({}, this.getDefaults(), this.$element.data(), e), e.delay && "number" == typeof e.delay && (e.delay = {
            show: e.delay,
            hide: e.delay
        }), e
    }, o.prototype.getDelegateOptions = function () {
        var e = {}, o = this.getDefaults();
        return this._options && t.each(this._options, function (t, i) {
            o[t] != i && (e[t] = i)
        }), e
    }, o.prototype.enter = function (e) {
        var o = e instanceof this.constructor ? e : t(e.currentTarget).data("bs." + this.type);
        return o || (o = new this.constructor(e.currentTarget, this.getDelegateOptions()), t(e.currentTarget).data("bs." + this.type, o)), clearTimeout(o.timeout), o.hoverState = "in", o.options.delay && o.options.delay.show ? void(o.timeout = setTimeout(function () {
            "in" == o.hoverState && o.show()
        }, o.options.delay.show)) : o.show()
    }, o.prototype.leave = function (e) {
        var o = e instanceof this.constructor ? e : t(e.currentTarget).data("bs." + this.type);
        return o || (o = new this.constructor(e.currentTarget, this.getDelegateOptions()), t(e.currentTarget).data("bs." + this.type, o)), clearTimeout(o.timeout), o.hoverState = "out", o.options.delay && o.options.delay.hide ? void(o.timeout = setTimeout(function () {
            "out" == o.hoverState && o.hide()
        }, o.options.delay.hide)) : o.hide()
    }, o.prototype.show = function () {
        var e = t.Event("show.bs." + this.type);
        if (this.hasContent() && this.enabled) {
            this.$element.trigger(e);
            var o = t.contains(document.documentElement, this.$element[0]);
            if (e.isDefaultPrevented() || !o)return;
            var i = this, s = this.tip(), n = this.getUID(this.type);
            this.setContent(), s.attr("id", n), this.$element.attr("aria-describedby", n), this.options.animation && s.addClass("fade");
            var r = "function" == typeof this.options.placement ? this.options.placement.call(this, s[0], this.$element[0]) : this.options.placement, a = /\s?auto?\s?/i, l = a.test(r);
            l && (r = r.replace(a, "") || "top"), s.detach().css({
                top: 0,
                left: 0,
                display: "block"
            }).addClass(r).data("bs." + this.type, this), this.options.container ? s.appendTo(this.options.container) : s.insertAfter(this.$element);
            var p = this.getPosition(), h = s[0].offsetWidth, f = s[0].offsetHeight;
            if (l) {
                var u = r, d = this.$element.parent(), c = this.getPosition(d);
                r = "bottom" == r && p.top + p.height + f - c.scroll > c.height ? "top" : "top" == r && p.top - c.scroll - f < 0 ? "bottom" : "right" == r && p.right + h > c.width ? "left" : "left" == r && p.left - h < c.left ? "right" : r, s.removeClass(u).addClass(r)
            }
            var g = this.getCalculatedOffset(r, p, h, f);
            this.applyPlacement(g, r);
            var y = function () {
                i.$element.trigger("shown.bs." + i.type), i.hoverState = null
            };
            t.support.transition && this.$tip.hasClass("fade") ? s.one("bsTransitionEnd", y).emulateTransitionEnd(150) : y()
        }
    }, o.prototype.applyPlacement = function (e, o) {
        var i = this.tip(), s = i[0].offsetWidth, n = i[0].offsetHeight, r = parseInt(i.css("margin-top"), 10), a = parseInt(i.css("margin-left"), 10);
        isNaN(r) && (r = 0), isNaN(a) && (a = 0), e.top = e.top + r, e.left = e.left + a, t.offset.setOffset(i[0], t.extend({
            using: function (t) {
                i.css({top: Math.round(t.top), left: Math.round(t.left)})
            }
        }, e), 0), i.addClass("in");
        var l = i[0].offsetWidth, p = i[0].offsetHeight;
        "top" == o && p != n && (e.top = e.top + n - p);
        var h = this.getViewportAdjustedDelta(o, e, l, p);
        h.left ? e.left += h.left : e.top += h.top;
        var f = h.left ? 2 * h.left - s + l : 2 * h.top - n + p, u = h.left ? "left" : "top", d = h.left ? "offsetWidth" : "offsetHeight";
        i.offset(e), this.replaceArrow(f, i[0][d], u)
    }, o.prototype.replaceArrow = function (t, e, o) {
        this.arrow().css(o, t ? 50 * (1 - t / e) + "%" : "")
    }, o.prototype.setContent = function () {
        var t = this.tip(), e = this.getTitle();
        t.find(".tooltip-inner")[this.options.html ? "html" : "text"](e), t.removeClass("fade in top bottom left right")
    }, o.prototype.hide = function () {
        function e() {
            "in" != o.hoverState && i.detach(), o.$element.trigger("hidden.bs." + o.type)
        }

        var o = this, i = this.tip(), s = t.Event("hide.bs." + this.type);
        return this.$element.removeAttr("aria-describedby"), this.$element.trigger(s), s.isDefaultPrevented() ? void 0 : (i.removeClass("in"), t.support.transition && this.$tip.hasClass("fade") ? i.one("bsTransitionEnd", e).emulateTransitionEnd(150) : e(), this.hoverState = null, this)
    }, o.prototype.fixTitle = function () {
        var t = this.$element;
        (t.attr("title") || "string" != typeof t.attr("data-original-title")) && t.attr("data-original-title", t.attr("title") || "").attr("title", "")
    }, o.prototype.hasContent = function () {
        return this.getTitle()
    }, o.prototype.getPosition = function (e) {
        e = e || this.$element;
        var o = e[0], i = "BODY" == o.tagName;
        return t.extend({}, "function" == typeof o.getBoundingClientRect ? o.getBoundingClientRect() : null, {
            scroll: i ? document.documentElement.scrollTop || document.body.scrollTop : e.scrollTop(),
            width: i ? t(window).width() : e.outerWidth(),
            height: i ? t(window).height() : e.outerHeight()
        }, i ? {top: 0, left: 0} : e.offset())
    }, o.prototype.getCalculatedOffset = function (t, e, o, i) {
        return "bottom" == t ? {
            top: e.top + e.height,
            left: e.left + e.width / 2 - o / 2
        } : "top" == t ? {
            top: e.top - i,
            left: e.left + e.width / 2 - o / 2
        } : "left" == t ? {top: e.top + e.height / 2 - i / 2, left: e.left - o} : {
            top: e.top + e.height / 2 - i / 2,
            left: e.left + e.width
        }
    }, o.prototype.getViewportAdjustedDelta = function (t, e, o, i) {
        var s = {top: 0, left: 0};
        if (!this.$viewport)return s;
        var n = this.options.viewport && this.options.viewport.padding || 0, r = this.getPosition(this.$viewport);
        if (/right|left/.test(t)) {
            var a = e.top - n - r.scroll, l = e.top + n - r.scroll + i;
            a < r.top ? s.top = r.top - a : l > r.top + r.height && (s.top = r.top + r.height - l)
        } else {
            var p = e.left - n, h = e.left + n + o;
            p < r.left ? s.left = r.left - p : h > r.width && (s.left = r.left + r.width - h)
        }
        return s
    }, o.prototype.getTitle = function () {
        var t, e = this.$element, o = this.options;
        return t = e.attr("data-original-title") || ("function" == typeof o.title ? o.title.call(e[0]) : o.title)
    }, o.prototype.getUID = function (t) {
        do t += ~~(1e6 * Math.random()); while (document.getElementById(t));
        return t
    }, o.prototype.tip = function () {
        return this.$tip = this.$tip || t(this.options.template)
    }, o.prototype.arrow = function () {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    }, o.prototype.validate = function () {
        this.$element[0].parentNode || (this.hide(), this.$element = null, this.options = null)
    }, o.prototype.enable = function () {
        this.enabled = !0
    }, o.prototype.disable = function () {
        this.enabled = !1
    }, o.prototype.toggleEnabled = function () {
        this.enabled = !this.enabled
    }, o.prototype.toggle = function (e) {
        var o = this;
        e && (o = t(e.currentTarget).data("bs." + this.type), o || (o = new this.constructor(e.currentTarget, this.getDelegateOptions()), t(e.currentTarget).data("bs." + this.type, o))), o.tip().hasClass("in") ? o.leave(o) : o.enter(o)
    }, o.prototype.destroy = function () {
        clearTimeout(this.timeout), this.hide().$element.off("." + this.type).removeData("bs." + this.type)
    };
    var i = t.fn.tooltip;
    t.fn.tooltip = e, t.fn.tooltip.Constructor = o, t.fn.tooltip.noConflict = function () {
        return t.fn.tooltip = i, this
    }
}(jQuery);
!function (e, t, n) {
    "undefined" != typeof module && module.exports ? module.exports = n() : "function" == typeof define && define.amd ? define(n) : t[e] = n()
}("Keen", this, function () {
    "use strict";
    function Keen() {
        return _init.apply(this, arguments)
    }

    function _init(e) {
        if (_isUndefined(e))throw new Error("Check out our JavaScript SDK Usage Guide: https://keen.io/docs/clients/javascript/usage-guide/");
        if (_isUndefined(e.projectId) || "String" !== _type(e.projectId) || e.projectId.length < 1)throw new Error("Please provide a projectId");
        this.configure(e)
    }

    function _extend(e) {
        for (var t = 1; t < arguments.length; t++)for (var n in arguments[t])e[n] = arguments[t][n];
        return e
    }

    function _isUndefined(e) {
        return void 0 === e
    }

    function _type(e) {
        var t = e && e.constructor ? e.constructor.toString() : void 0;
        return t ? t.match(/function (.*)\(/)[1] : "Null"
    }

    function _each(e, t, n) {
        var r;
        if (!e)return 0;
        if (n = n ? n : e, "array" === _type(e)) {
            for (r = 0; r < e.length; r++)if (t.call(n, e[r], r, e) === !1)return 0
        } else for (r in e)if (e.hasOwnProperty(r) && t.call(n, e[r], r, e) === !1)return 0;
        return 1
    }

    function _parse_params(e) {
        for (var t, n = {}, r = /\+/g, i = /([^&=]+)=?([^&]*)/g, o = function (e) {
            return decodeURIComponent(e.replace(r, " "))
        }, a = e.split("?")[1]; t = i.exec(a);)n[o(t[1])] = o(t[2]);
        return n
    }

    function _set_protocol(e) {
        switch (e) {
            case"http":
                return "http";
            case"auto":
                return location.protocol.replace(/:/g, "");
            case"https":
            case void 0:
            default:
                return "https"
        }
    }

    function _set_request_type(e) {
        var t = e || "jsonp", n = !1;
        return ("Object" === _type(XMLHttpRequest) || "Function" === _type(XMLHttpRequest)) && "withCredentials" in new XMLHttpRequest && (n = !0), null == t || "xhr" == t ? n ? "xhr" : "jsonp" : t
    }

    function _build_url(e) {
        return this.client.endpoint + "/projects/" + this.client.projectId + e
    }

    function _uploadEvent(e, t, n, r, i) {
        var o = _build_url.apply(this, ["/events/" + e]), a = {};
        n = n === !1 ? !1 : !0, this.client.globalProperties && (a = this.client.globalProperties(e));
        for (var c in t)t.hasOwnProperty(c) && (a[c] = t[c]);
        switch (this.client.requestType) {
            case"xhr":
                _request.xhr.apply(this, ["POST", o, null, a, this.client.writeKey, n, r, i]);
                break;
            case"jsonp":
                var s = JSON.stringify(a), l = Keen.Base64.encode(s);
                o = o + "?api_key=" + this.client.writeKey, o = o + "&data=" + l, o = o + "&modified=" + (new Date).getTime(), _request.jsonp.apply(this, [o, this.client.writeKey, r, i]);
                break;
            case"beacon":
                var s = JSON.stringify(a), l = Keen.Base64.encode(s);
                o = o + "?api_key=" + encodeURIComponent(this.client.writeKey), o = o + "&data=" + encodeURIComponent(l), o = o + "&modified=" + encodeURIComponent((new Date).getTime()), o += "&c=clv1", _request.beacon.apply(this, [o, null, r, i])
        }
    }

    Keen.prototype.configure = function (e) {
        return e.host = _isUndefined(e.host) ? "api.keen.io/3.0" : e.host.replace(/.*?:\/\//g, ""), e.protocol = _set_protocol(e.protocol), e.requestType = _set_request_type(e.requestType), this.client = {
            projectId: e.projectId,
            writeKey: e.writeKey,
            readKey: e.readKey,
            globalProperties: null,
            endpoint: e.protocol + "://" + e.host,
            requestType: e.requestType
        }, Keen.trigger("client", this, e), this.trigger("ready"), this
    };
    var _request = {
        xhr: function (e, t, n, r, i, o, a, c) {
            if (!i)return Keen.log("Please provide a writeKey for https://keen.io/project/" + this.client.projectId);
            var s = new XMLHttpRequest;
            if (s.onreadystatechange = function () {
                    if (4 == s.readyState)if (s.status >= 200 && s.status < 300) {
                        var e;
                        try {
                            e = JSON.parse(s.responseText)
                        } catch (t) {
                            Keen.log("Could not JSON parse HTTP response: " + s.responseText), c && c(s, t)
                        }
                        a && e && a(e)
                    } else Keen.log("HTTP request failed."), c && c(s, null)
                }, s.open(e, t, o), i && s.setRequestHeader("Authorization", i), r && s.setRequestHeader("Content-Type", "application/json"), n)for (var l in n)n.hasOwnProperty(l) && s.setRequestHeader(l, n[l]);
            var u = r ? JSON.stringify(r) : null;
            s.send(u)
        }, jsonp: function (e, t, n, r) {
            if (!t)return Keen.log("Please provide a writeKey for https://keen.io/project/" + this.client.projectId);
            if (t && e.indexOf("api_key") < 0) {
                var i = e.indexOf("?") > 0 ? "&" : "?";
                e = e + i + "api_key=" + t
            }
            for (var o = "keenJSONPCallback" + (new Date).getTime(); o in window;)o += "a";
            var a = !1;
            window[o] = function (e) {
                a = !0, n && e && n(e), window[o] = void 0
            }, e = e + "&jsonp=" + o;
            var c = document.createElement("script");
            c.id = "keen-jsonp", c.src = e, document.getElementsByTagName("head")[0].appendChild(c), c.onreadystatechange = function () {
                a === !1 && "loaded" === this.readyState && (a = !0, r && r())
            }, c.onerror = function () {
                a === !1 && (a = !0, r && r())
            }
        }, beacon: function (e, t, n, r) {
            if (t && e.indexOf("api_key") < 0) {
                var i = e.indexOf("?") > 0 ? "&" : "?";
                e = e + i + "api_key=" + t
            }
            var o = !1, a = document.createElement("img");
            a.onload = function () {
                if (o = !0, "naturalHeight" in this) {
                    if (this.naturalHeight + this.naturalWidth === 0)return void this.onerror()
                } else if (this.width + this.height === 0)return void this.onerror();
                n && n({created: !0})
            }, a.onerror = function () {
                o = !0, r && r()
            }, a.src = e
        }
    }, Events = Keen.Events = {
        on: function (e, t) {
            this.listeners || (this.listeners = {});
            var n = this.listeners[e] || (this.listeners[e] = []);
            return n.push({callback: t}), this
        }, off: function (e, t) {
            if (!e && !t)return this.listeners = void 0, delete this.listeners, this;
            for (var n = this.listeners[e] || [], r = n.length; r--;)t && t == n[r].callback && this.listeners[e].splice(r, 1), t && 0 != n.length || (this.listeners[e] = void 0, delete this.listeners[e]);
            return this
        }, trigger: function (e) {
            if (!this.listeners)return this;
            for (var t = Array.prototype.slice.call(arguments, 1), n = this.listeners[e] || [], r = 0; r < n.length; r++)n[r].callback.apply(this, t);
            return this
        }
    };
    _extend(Keen.prototype, Events), _extend(Keen, Events), Keen.loaded = !0, Keen.utils = {
        each: _each,
        extend: _extend,
        parseParams: _parse_params
    }, Keen.ready = function (e) {
        Keen.loaded ? e() : Keen.on("ready", e)
    }, Keen.log = function (e) {
        "object" == typeof console && console.log("[Keen IO]", e)
    };
    var Plugins = Keen.Plugins = {};
    Keen.prototype.addEvent = function () {
        _uploadEvent.apply(this, arguments)
    }, Keen.prototype.addEventSync = function (e, t, n, r) {
        _uploadEvent.apply(this, [e, t, !1, n, r])
    }, Keen.prototype.trackExternalLink = function (e, t, n, r, i) {
        var o = e, a = o.metaKey, c = o.target, s = !1, l = function () {
        };
        return void 0 === r && (r = 500), "A" === c.nodeName ? l = function () {
            a || s || (s = !0, window.location = c.href)
        } : "FORM" === c.nodeName && (l = function () {
            s || (s = !0, c.submit())
        }), i && (l = function () {
            s || (s = !0, i())
        }), _uploadEvent.call(this, t, n, l, l), setTimeout(function () {
            l()
        }, r), a ? void 0 : !1
    }, Keen.prototype.setGlobalProperties = function (e) {
        if (!this.client)return Keen.log("Check out our JavaScript SDK Usage Guide: https://keen.io/docs/clients/javascript/usage-guide/");
        if (!e || "function" != typeof e)throw new Error("Invalid value for global properties: " + e);
        this.client.globalProperties = e
    }, Keen.Base64 = {
        map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (e) {
            var t, n, r, i, o, a, c, s = "", l = 0, u = this.map;
            for (e = this.utf8.encode(e); l < e.length;)t = e.charCodeAt(l++), n = e.charCodeAt(l++), r = e.charCodeAt(l++), i = t >> 2, o = (3 & t) << 4 | n >> 4, a = isNaN(n) ? 64 : (15 & n) << 2 | r >> 6, c = isNaN(n) || isNaN(r) ? 64 : 63 & r, s = s + u.charAt(i) + u.charAt(o) + u.charAt(a) + u.charAt(c);
            return s
        }, decode: function (e) {
            var t, n, r, i, o, a, c, s = "", l = 0, u = this.map, f = String.fromCharCode;
            for (e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); l < e.length;)t = u.indexOf(e.charAt(l++)), n = u.indexOf(e.charAt(l++)), r = u.indexOf(e.charAt(l++)), i = u.indexOf(e.charAt(l++)), o = t << 2 | n >> 4, a = (15 & n) << 4 | r >> 2, c = (3 & r) << 6 | i, s = s + (f(o) + (64 != r ? f(a) : "")) + (64 != i ? f(c) : "");
            return this.utf8.decode(s)
        }, utf8: {
            encode: function (e) {
                for (var t, n = "", r = 0, i = String.fromCharCode; r < e.length;)t = e.charCodeAt(r++), n += 128 > t ? i(t) : t > 127 && 2048 > t ? i(t >> 6 | 192) + i(63 & t | 128) : i(t >> 12 | 224) + i(t >> 6 & 63 | 128) + i(63 & t | 128);
                return n
            }, decode: function (e) {
                for (var t, n, r = "", i = 0, o = String.fromCharCode; i < e.length;)n = e.charCodeAt(i), r += 128 > n ? [o(n), i++][0] : n > 191 && 224 > n ? [o((31 & n) << 6 | 63 & (t = e.charCodeAt(i + 1))), i += 2][0] : [o((15 & n) << 12 | (63 & (t = e.charCodeAt(i + 1))) << 6 | 63 & (c3 = e.charCodeAt(i + 2))), i += 3][0];
                return r
            }
        }
    }, "object" != typeof JSON && (JSON = {}), function () {
        function f(e) {
            return 10 > e ? "0" + e : e
        }

        function quote(e) {
            return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) {
                var t = meta[e];
                return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
            }) + '"' : '"' + e + '"'
        }

        function str(e, t) {
            var n, r, i, o, a, c = gap, s = t[e];
            switch (s && "object" == typeof s && "function" == typeof s.toJSON && (s = s.toJSON(e)), "function" == typeof rep && (s = rep.call(t, e, s)), typeof s) {
                case"string":
                    return quote(s);
                case"number":
                    return isFinite(s) ? String(s) : "null";
                case"boolean":
                case"null":
                    return String(s);
                case"object":
                    if (!s)return "null";
                    if (gap += indent, a = [], "[object Array]" === Object.prototype.toString.apply(s)) {
                        for (o = s.length, n = 0; o > n; n += 1)a[n] = str(n, s) || "null";
                        return i = 0 === a.length ? "[]" : gap ? "[\n" + gap + a.join(",\n" + gap) + "\n" + c + "]" : "[" + a.join(",") + "]", gap = c, i
                    }
                    if (rep && "object" == typeof rep)for (o = rep.length, n = 0; o > n; n += 1)"string" == typeof rep[n] && (r = rep[n], i = str(r, s), i && a.push(quote(r) + (gap ? ": " : ":") + i)); else for (r in s)Object.prototype.hasOwnProperty.call(s, r) && (i = str(r, s), i && a.push(quote(r) + (gap ? ": " : ":") + i));
                    return i = 0 === a.length ? "{}" : gap ? "{\n" + gap + a.join(",\n" + gap) + "\n" + c + "}" : "{" + a.join(",") + "}", gap = c, i
            }
        }

        "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function () {
            return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null
        }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () {
            return this.valueOf()
        });
        var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = {
            "\b": "\\b",
            "	": "\\t",
            "\n": "\\n",
            "\f": "\\f",
            "\r": "\\r",
            '"': '\\"',
            "\\": "\\\\"
        }, rep;
        "function" != typeof JSON.stringify && (JSON.stringify = function (e, t, n) {
            var r;
            if (gap = "", indent = "", "number" == typeof n)for (r = 0; n > r; r += 1)indent += " "; else"string" == typeof n && (indent = n);
            if (rep = t, t && "function" != typeof t && ("object" != typeof t || "number" != typeof t.length))throw new Error("JSON.stringify");
            return str("", {"": e})
        }), "function" != typeof JSON.parse && (JSON.parse = function (text, reviver) {
            function walk(e, t) {
                var n, r, i = e[t];
                if (i && "object" == typeof i)for (n in i)Object.prototype.hasOwnProperty.call(i, n) && (r = walk(i, n), void 0 !== r ? i[n] = r : delete i[n]);
                return reviver.call(e, t, i)
            }

            var j;
            if (text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) {
                    return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4)
                })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, "")))return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({"": j}, "") : j;
            throw new SyntaxError("JSON.parse")
        })
    }(), !function (e, t, n) {
        "undefined" != typeof module && module.exports ? module.exports = n() : "function" == typeof define && define.amd ? define(n) : t[e] = n()
    }("domready", Keen.utils, function (e) {
        function t(e) {
            for (d = 1; e = r.shift();)e()
        }

        var n, r = [], i = !1, o = document, a = o.documentElement, c = a.doScroll, s = "DOMContentLoaded", l = "addEventListener", u = "onreadystatechange", f = "readyState", p = c ? /^loaded|^c/ : /^loaded|c/, d = p.test(o[f]);
        return o[l] && o[l](s, n = function () {
            o.removeEventListener(s, n, i), t()
        }, i), c && o.attachEvent(u, n = function () {
            /^c/.test(o[f]) && (o.detachEvent(u, n), t())
        }), e = c ? function (t) {
            self != top ? d ? t() : r.push(t) : function () {
                try {
                    a.doScroll("left")
                } catch (n) {
                    return setTimeout(function () {
                        e(t)
                    }, 50)
                }
                t()
            }()
        } : function (e) {
            d ? e() : r.push(e)
        }
    });
    var loaded = window.Keen, cached = window._Keen || {}, clients, ready;
    if (loaded && cached) {
        clients = cached.clients || {}, ready = cached.ready || [];
        for (var instance in clients)if (clients.hasOwnProperty(instance)) {
            var client = clients[instance];
            for (var method in Keen.prototype)Keen.prototype.hasOwnProperty(method) && (loaded.prototype[method] = Keen.prototype[method]);
            if (loaded.Query = Keen.Query ? Keen.Query : function () {
                }, loaded.Visualization = Keen.Visualization ? Keen.Visualization : function () {
                }, client._config && (client.configure.call(client, client._config), delete client._config), client._setGlobalProperties) {
                for (var globals = client._setGlobalProperties, i = 0; i < globals.length; i++)client.setGlobalProperties.apply(client, globals[i]);
                delete client._setGlobalProperties
            }
            if (client._addEvent) {
                for (var queue = client._addEvent || [], i = 0; i < queue.length; i++)client.addEvent.apply(client, queue[i]);
                delete client._addEvent
            }
            var callback = client._on || [];
            if (client._on) {
                for (var i = 0; i < callback.length; i++)client.on.apply(client, callback[i]);
                client.trigger("ready"), delete client._on
            }
        }
        for (var i = 0; i < ready.length; i++) {
            var callback = ready[i];
            Keen.on("ready", function () {
                callback()
            })
        }
    }
    return Keen.loaded && setTimeout(function () {
        Keen.utils.domready(function () {
            Keen.trigger("ready")
        })
    }, 0), Keen
});
!function (e, t) {
    if (!t.__SV) {
        var n, p, i, r;
        window.mixpanel = t, t._i = [], t.init = function (e, n, p) {
            function a(e, t) {
                var n = t.split(".");
                2 == n.length && (e = e[n[0]], t = n[1]), e[t] = function () {
                    e.push([t].concat(Array.prototype.slice.call(arguments, 0)))
                }
            }

            var o = t;
            for ("undefined" != typeof p ? o = t[p] = [] : p = "mixpanel", o.people = o.people || [], o.toString = function (e) {
                var t = "mixpanel";
                return "mixpanel" !== p && (t += "." + p), e || (t += " (stub)"), t
            }, o.people.toString = function () {
                return o.toString(1) + ".people (stub)"
            }, i = "disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "), r = 0; r < i.length; r++)a(o, i[r]);
            t._i.push([e, n, p])
        }, t.__SV = 1.2, n = e.createElement("script"), n.type = "text/javascript", n.async = !0, n.src = "//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js", p = e.getElementsByTagName("script")[0], p.parentNode.insertBefore(n, p)
    }
}(document, window.mixpanel || []);
!function (i, e) {
    "use strict";
    var s = "", r = "?", o = "function", a = "undefined", n = "object", t = "major", d = "model", w = "name", l = "type", p = "vendor", m = "version", c = "architecture", u = "console", g = "mobile", f = "tablet", h = "smarttv", b = {
        has: function (i, e) {
            return -1 !== e.toLowerCase().indexOf(i.toLowerCase())
        }, lowerize: function (i) {
            return i.toLowerCase()
        }
    }, y = {
        rgx: function () {
            for (var i, s, r, t, d, w, l, p = 0, m = arguments; p < m.length; p += 2) {
                var c = m[p], u = m[p + 1];
                if (typeof i === a) {
                    i = {};
                    for (t in u)d = u[t], typeof d === n ? i[d[0]] = e : i[d] = e
                }
                for (s = r = 0; s < c.length; s++)if (w = c[s].exec(this.getUA())) {
                    for (t = 0; t < u.length; t++)l = w[++r], d = u[t], typeof d === n && d.length > 0 ? 2 == d.length ? typeof d[1] == o ? i[d[0]] = d[1].call(this, l) : i[d[0]] = d[1] : 3 == d.length ? typeof d[1] !== o || d[1].exec && d[1].test ? i[d[0]] = l ? l.replace(d[1], d[2]) : e : i[d[0]] = l ? d[1].call(this, l, d[2]) : e : 4 == d.length && (i[d[0]] = l ? d[3].call(this, l.replace(d[1], d[2])) : e) : i[d] = l ? l : e;
                    break
                }
                if (w)break
            }
            return i
        }, str: function (i, s) {
            for (var o in s)if (typeof s[o] === n && s[o].length > 0) {
                for (var a = 0; a < s[o].length; a++)if (b.has(s[o][a], i))return o === r ? e : o
            } else if (b.has(s[o], i))return o === r ? e : o;
            return i
        }
    }, v = {
        browser: {
            oldsafari: {
                major: {1: ["/8", "/1", "/3"], 2: "/4", "?": "/"},
                version: {
                    "1.0": "/8",
                    1.2: "/1",
                    1.3: "/3",
                    "2.0": "/412",
                    "2.0.2": "/416",
                    "2.0.3": "/417",
                    "2.0.4": "/419",
                    "?": "/"
                }
            }
        },
        device: {sprint: {model: {"Evo Shift 4G": "7373KT"}, vendor: {HTC: "APA", Sprint: "Sprint"}}},
        os: {
            windows: {
                version: {
                    ME: "4.90",
                    "NT 3.11": "NT3.51",
                    "NT 4.0": "NT4.0",
                    2e3: "NT 5.0",
                    XP: ["NT 5.1", "NT 5.2"],
                    Vista: "NT 6.0",
                    7: "NT 6.1",
                    8: "NT 6.2",
                    8.1: "NT 6.3",
                    RT: "ARM"
                }
            }
        }
    }, k = {
        browser: [[/(opera\smini)\/((\d+)?[\w\.-]+)/i, /(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i, /(opera).+version\/((\d+)?[\w\.]+)/i, /(opera)[\/\s]+((\d+)?[\w\.]+)/i], [w, m, t], [/\s(opr)\/((\d+)?[\w\.]+)/i], [[w, "Opera"], m, t], [/(kindle)\/((\d+)?[\w\.]+)/i, /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i, /(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i, /(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i, /(rekonq)((?:\/)[\w\.]+)*/i, /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i], [w, m, t], [/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i], [[w, "IE"], m, t], [/(yabrowser)\/((\d+)?[\w\.]+)/i], [[w, "Yandex"], m, t], [/(comodo_dragon)\/((\d+)?[\w\.]+)/i], [[w, /_/g, " "], m, t], [/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i], [w, m, t], [/(dolfin)\/((\d+)?[\w\.]+)/i], [[w, "Dolphin"], m, t], [/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i], [[w, "Chrome"], m, t], [/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i], [m, t, [w, "Mobile Safari"]], [/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i], [m, t, w], [/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i], [w, [t, y.str, v.browser.oldsafari.major], [m, y.str, v.browser.oldsafari.version]], [/(konqueror)\/((\d+)?[\w\.]+)/i, /(webkit|khtml)\/((\d+)?[\w\.]+)/i], [w, m, t], [/(navigator|netscape)\/((\d+)?[\w\.-]+)/i], [[w, "Netscape"], m, t], [/(swiftfox)/i, /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i, /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i, /(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i, /(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i, /(links)\s\(((\d+)?[\w\.]+)/i, /(gobrowser)\/?((\d+)?[\w\.]+)*/i, /(ice\s?browser)\/v?((\d+)?[\w\._]+)/i, /(mosaic)[\/\s]((\d+)?[\w\.]+)/i], [w, m, t], [/(apple(?:coremedia|))\/((\d+)[\w\._]+)/i, /(coremedia) v((\d+)[\w\._]+)/i], [w, m, t], [/(aqualung|lyssna|bsplayer)\/([\w\.-]+)/i], [w, m], [/(ares|ossproxy)\s((\d+)[\w\.-]+)/i], [w, m, t], [/(audacious|audimusicstream|amarok|bass|core|dalvik|gnomemplayer|music on console|nsplayer|psp-internetradioplayer|videos)\/((\d+)[\w\.-]+)/i, /(clementine|music player daemon)\s((\d+)[\w\.-]+)/i, /(lg player|nexplayer)\s((\d+)[\d\.]+)/i, /player\/(nexplayer|lg player)\s((\d+)[\w\.-]+)/i], [w, m, t], [/(nexplayer)\s((\d+)[\w\.-]+)/i], [w, m, t], [/(flrp)\/((\d+)[\w\.-]+)/i], [[w, "Flip Player"], m, t], [/(fstream|nativehost|queryseekspider|ia-archiver|facebookexternalhit)/i], [w], [/(gstreamer) souphttpsrc (?:\([^\)]+\)){0,1} libsoup\/((\d+)[\w\.-]+)/i], [w, m, t], [/(htc streaming player)\s[\w_]+\s\/\s((\d+)[\d\.]+)/i, /(java|python-urllib|python-requests|wget|libcurl)\/((\d+)[\w\.-_]+)/i, /(lavf)((\d+)[\d\.]+)/i], [w, m, t], [/(htc_one_s)\/((\d+)[\d\.]+)/i], [[w, /_/g, " "], m, t], [/(mplayer)(?:\s|\/)(?:(?:sherpya-){0,1}svn)(?:-|\s)(r\d+(?:-\d+[\w\.-]+){0,1})/i], [w, m], [/(mplayer)(?:\s|\/)((\d+)[\w\.-]+)/i, /(mplayer) unknown-((\d+)[\w\.\-]+)/i], [w, m, t], [/(mplayer)/i, /(yourmuze)/i, /(media player classic|nero showtime)/i], [w], [/(nero (?:home|scout))\/((\d+)[\w\.-]+)/i], [w, m, t], [/(nokia\d+)\/((\d+)[\w\.-]+)/i], [w, m, t], [/\s(songbird)\/((\d+)[\w\.-]+)/i], [w, m, t], [/(winamp)3 version ((\d+)[\w\.-]+)/i, /(winamp)\s((\d+)[\w\.-]+)/i, /(winamp)mpeg\/((\d+)[\w\.-]+)/i], [w, m, t], [/(ocms-bot|tapinradio|tunein radio|unknown|winamp|inlight radio)/i], [w], [/(quicktime|rma|radioapp|radioclientapplication|soundtap|totem|stagefright|streamium)\/((\d+)[\w\.-]+)/i], [w, m, t], [/(smp)((\d+)[\d\.]+)/i], [w, m, t], [/(vlc) media player - version ((\d+)[\w\.]+)/i, /(vlc)\/((\d+)[\w\.-]+)/i, /(xbmc|gvfs|xine|xmms|irapp)\/((\d+)[\w\.-]+)/i, /(foobar2000)\/((\d+)[\d\.]+)/i, /(itunes)\/((\d+)[\d\.]+)/i], [w, m, t], [/(wmplayer)\/((\d+)[\w\.-]+)/i, /(windows-media-player)\/((\d+)[\w\.-]+)/i], [[w, /-/g, " "], m, t], [/windows\/((\d+)[\w\.-]+) upnp\/[\d\.]+ dlnadoc\/[\d\.]+ (home media server)/i], [m, t, [w, "Windows"]], [/(com\.riseupradioalarm)\/((\d+)[\d\.]*)/i], [w, m, t], [/(rad.io)\s((\d+)[\d\.]+)/i, /(radio.(?:de|at|fr))\s((\d+)[\d\.]+)/i], [[w, "rad.io"], m, t]],
        cpu: [[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i], [[c, "amd64"]], [/(ia32(?=;))/i], [[c, b.lowerize]], [/((?:i[346]|x)86)[;\)]/i], [[c, "ia32"]], [/windows\s(ce|mobile);\sppc;/i], [[c, "arm"]], [/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i], [[c, /ower/, "", b.lowerize]], [/(sun4\w)[;\)]/i], [[c, "sparc"]], [/(ia64(?=;)|68k(?=\))|arm(?=v\d+;)|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i], [c, b.lowerize]],
        device: [[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i], [d, p, [l, f]], [/applecoremedia\/[\w\.]+ \((ipad)/], [d, [p, "Apple"], [l, f]], [/(apple\s{0,1}tv)/i], [[d, "Apple TV"], [p, "Apple"]], [/(hp).+(touchpad)/i, /(kindle)\/([\w\.]+)/i, /\s(nook)[\w\s]+build\/(\w+)/i, /(dell)\s(strea[kpr\s\d]*[\dko])/i], [p, d, [l, f]], [/\((ip[honed|\s\w*]+);.+(apple)/i], [d, p, [l, g]], [/\((ip[honed|\s\w*]+);/i], [d, [p, "Apple"], [l, g]], [/(blackberry)[\s-]?(\w+)/i, /(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i, /(hp)\s([\w\s]+\w)/i, /(asus)-?(\w+)/i], [p, d, [l, g]], [/\((bb10);\s(\w+)/i], [[p, "BlackBerry"], d, [l, g]], [/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i], [[p, "Asus"], d, [l, f]], [/(sony)\s(tablet\s[ps])/i], [p, d, [l, f]], [/(nintendo)\s([wids3u]+)/i], [p, d, [l, u]], [/((playstation)\s[3portablevi]+)/i], [[p, "Sony"], d, [l, u]], [/(sprint\s(\w+))/i], [[p, y.str, v.device.sprint.vendor], [d, y.str, v.device.sprint.model], [l, g]], [/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i, /(zte)-(\w+)*/i, /(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i], [p, [d, /_/g, " "], [l, g]], [/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i, /(mot)[\s-]?(\w+)*/i], [[p, "Motorola"], d, [l, g]], [/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i], [[p, "Motorola"], d, [l, f]], [/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i], [[p, "Samsung"], d, [l, f]], [/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i, /(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i, /sec-((sgh\w+))/i], [[p, "Samsung"], d, [l, g]], [/(sie)-(\w+)*/i], [[p, "Siemens"], d, [l, g]], [/(maemo|nokia).*(n900|lumia\s\d+)/i, /(nokia)[\s_-]?([\w-]+)*/i], [[p, "Nokia"], d, [l, g]], [/android\s3\.[\s\w-;]{10}((a\d{3}))/i], [[p, "Acer"], d, [l, f]], [/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i], [[p, "LG"], d, [l, f]], [/((nexus\s[45]))/i, /(lg)[e;\s-\/]+(\w+)*/i], [[p, "LG"], d, [l, g]], [/android.+((ideatab[a-z0-9\-\s]+))/i], [[p, "Lenovo"], d, [l, f]], [/(lg) netcast\.tv/i], [p, [l, h]], [/(mobile|tablet);.+rv\:.+gecko\//i], [l, p, d]],
        engine: [[/(presto)\/([\w\.]+)/i, /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i, /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i, /(icab)[\/\s]([23]\.[\d\.]+)/i], [w, m], [/rv\:([\w\.]+).*(gecko)/i], [m, w]],
        os: [[/microsoft\s(windows)\s(vista|xp)/i], [w, m], [/(windows)\snt\s6\.2;\s(arm)/i, /(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i], [w, [m, y.str, v.os.windows.version]], [/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i], [[w, "Windows"], [m, y.str, v.os.windows.version]], [/\((bb)(10);/i], [[w, "BlackBerry"], m], [/(blackberry)\w*\/?([\w\.]+)*/i, /(tizen)\/([\w\.]+)/i, /(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i], [w, m], [/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i], [[w, "Symbian"], m], [/mozilla.+\(mobile;.+gecko.+firefox/i], [[w, "Firefox OS"], m], [/(nintendo|playstation)\s([wids3portablevu]+)/i, /(mint)[\/\s\(]?(\w+)*/i, /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i, /(hurd|linux)\s?([\w\.]+)*/i, /(gnu)\s?([\w\.]+)*/i], [w, m], [/(cros)\s[\w]+\s([\w\.]+\w)/i], [[w, "Chromium OS"], m], [/(sunos)\s?([\w\.]+\d)*/i], [[w, "Solaris"], m], [/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i], [w, m], [/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i], [[w, "iOS"], [m, /_/g, "."]], [/(mac\sos\sx)\s?([\w\s\.]+\w)*/i], [w, [m, /_/g, "."]], [/(haiku)\s(\w+)/i, /(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i, /(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i, /(unix)\s?([\w\.]+)*/i], [w, m]]
    }, x = function (e) {
        var r = e || (i && i.navigator && i.navigator.userAgent ? i.navigator.userAgent : s);
        return this instanceof x ? (this.getBrowser = function () {
            return y.rgx.apply(this, k.browser)
        }, this.getCPU = function () {
            return y.rgx.apply(this, k.cpu)
        }, this.getDevice = function () {
            return y.rgx.apply(this, k.device)
        }, this.getEngine = function () {
            return y.rgx.apply(this, k.engine)
        }, this.getOS = function () {
            return y.rgx.apply(this, k.os)
        }, this.getResult = function () {
            return {
                ua: this.getUA(),
                browser: this.getBrowser(),
                engine: this.getEngine(),
                os: this.getOS(),
                device: this.getDevice(),
                cpu: this.getCPU()
            }
        }, this.getUA = function () {
            return r
        }, this.setUA = function (i) {
            return r = i, this
        }, void this.setUA(r)) : new x(e).getResult()
    };
    if (typeof exports !== a)typeof module !== a && module.exports && (exports = module.exports = x), exports.UAParser = x; else if (i.UAParser = x, typeof define === o && define.amd && define(function () {
            return x
        }), typeof i.jQuery !== a) {
        var A = i.jQuery, _ = new x;
        A.ua = _.getResult(), A.ua.get = function () {
            return _.getUA()
        }, A.ua.set = function (i) {
            _.setUA(i);
            var e = _.getResult();
            for (var s in e)A.ua[s] = e[s]
        }
    }
}(this);
window.Modernizr = function (n, e, t) {
    function r(n) {
        d.cssText = n
    }

    function o(n, e) {
        return typeof n === e
    }

    var i, u, c, a = "2.8.2", s = {}, f = e.documentElement, l = "modernizr", p = e.createElement(l), d = p.style, y = ({}.toString, {}), m = [], w = m.slice, b = {}.hasOwnProperty;
    c = o(b, "undefined") || o(b.call, "undefined") ? function (n, e) {
        return e in n && o(n.constructor.prototype[e], "undefined")
    } : function (n, e) {
        return b.call(n, e)
    }, Function.prototype.bind || (Function.prototype.bind = function (n) {
        var e = this;
        if ("function" != typeof e)throw new TypeError;
        var t = w.call(arguments, 1), r = function () {
            if (this instanceof r) {
                var o = function () {
                };
                o.prototype = e.prototype;
                var i = new o, u = e.apply(i, t.concat(w.call(arguments)));
                return Object(u) === u ? u : i
            }
            return e.apply(n, t.concat(w.call(arguments)))
        };
        return r
    }), y.webgl = function () {
        return !!n.WebGLRenderingContext
    };
    for (var v in y)c(y, v) && (u = v.toLowerCase(), s[u] = y[v](), m.push((s[u] ? "" : "no-") + u));
    return s.addTest = function (n, e) {
        if ("object" == typeof n)for (var r in n)c(n, r) && s.addTest(r, n[r]); else {
            if (n = n.toLowerCase(), s[n] !== t)return s;
            e = "function" == typeof e ? e() : e, "undefined" != typeof enableClasses && enableClasses && (f.className += " " + (e ? "" : "no-") + n), s[n] = e
        }
        return s
    }, r(""), p = i = null, s._version = a, s
}(this, this.document);
!function (e, t, a) {
    "use strict";
    function n(t, h, m) {
        function H(a) {
            var n = 0, i = Ee.length;
            if (Ce.old = e.extend({}, Ce), Ie = we ? 0 : be[ge.horizontal ? "width" : "height"](), ke = Be[ge.horizontal ? "width" : "height"](), ze = we ? t : Pe[ge.horizontal ? "outerWidth" : "outerHeight"](), Ee.length = 0, Ce.start = 0, Ce.end = q(ze - Ie, 0), Re) {
                n = Ne.length, qe = Pe.children(ge.itemSelector), Ne.length = 0;
                var r, s = c(Pe, ge.horizontal ? "paddingLeft" : "paddingTop"), o = c(Pe, ge.horizontal ? "paddingRight" : "paddingBottom"), l = "border-box" === e(qe).css("boxSizing"), u = "none" !== qe.css("float"), f = 0, v = qe.length - 1;
                ze = 0, qe.each(function (t, a) {
                    var n = e(a), i = a.getBoundingClientRect(), l = E(ge.horizontal ? i.width || i.right - i.left : i.height || i.bottom - i.top), d = c(n, ge.horizontal ? "marginLeft" : "marginTop"), p = c(n, ge.horizontal ? "marginRight" : "marginBottom"), h = l + d + p, m = !d || !p, g = {};
                    g.el = a, g.size = m ? l : h, g.half = g.size / 2, g.start = ze + (m ? d : 0), g.center = g.start - E(Ie / 2 - g.size / 2), g.end = g.start - Ie + g.size, t || (ze += s), ze += h, ge.horizontal || u || p && d && t > 0 && (ze -= N(d, p)), t === v && (g.end += o, ze += o, f = m ? p : 0), Ne.push(g), r = g
                }), Pe[0].style[ge.horizontal ? "width" : "height"] = (l ? ze : ze - s - o) + "px", ze -= f, Ne.length ? (Ce.start = Ne[0][Me ? "center" : "start"], Ce.end = Me ? r.center : ze > Ie ? r.end : Ce.start) : Ce.start = Ce.end = 0
            }
            if (Ce.center = E(Ce.end / 2 + Ce.start / 2), Q(), Se.length && ke > 0 && (ge.dynamicHandle ? (Te = Ce.start === Ce.end ? ke : E(ke * Ie / ze), Te = d(Te, ge.minHandleSize, ke), Se[0].style[ge.horizontal ? "width" : "height"] = Te + "px") : Te = Se[ge.horizontal ? "outerWidth" : "outerHeight"](), xe.end = ke - Te, it || j()), !we && Ie > 0) {
                var p = Ce.start, h = "";
                if (Re)e.each(Ne, function (e, t) {
                    Me ? Ee.push(t.center) : t.start + t.size > p && p <= Ce.end && (p = t.start, Ee.push(p), p += Ie, p > Ce.end && p < Ce.end + Ie && Ee.push(Ce.end))
                }); else for (; p - Ie < Ce.end;)Ee.push(p), p += Ie;
                if (De[0] && i !== Ee.length) {
                    for (var m = 0; m < Ee.length; m++)h += ge.pageBuilder.call(ye, m);
                    Ae = De.html(h).children(), Ae.eq(Oe.activePage).addClass(ge.activeClass)
                }
            }
            if (Oe.slideeSize = ze, Oe.frameSize = Ie, Oe.sbSize = ke, Oe.handleSize = Te, Re) {
                a && null != ge.startAt && (W(ge.startAt), ye[Le ? "toCenter" : "toStart"](ge.startAt));
                var g = Ne[Oe.activeItem];
                X(Le && g ? g.center : d(Ce.dest, Ce.start, Ce.end))
            } else a ? null != ge.startAt && X(ge.startAt, 1) : X(d(Ce.dest, Ce.start, Ce.end));
            pe("load")
        }

        function X(e, t, a) {
            if (Re && at.released && !a) {
                var n = $(e), i = e > Ce.start && e < Ce.end;
                Le ? (i && (e = Ne[n.centerItem].center), Me && ge.activateMiddle && W(n.centerItem)) : i && (e = Ne[n.firstItem].start)
            }
            at.init && at.slidee && ge.elasticBounds ? e > Ce.end ? e = Ce.end + (e - Ce.end) / 6 : e < Ce.start && (e = Ce.start + (e - Ce.start) / 6) : e = d(e, Ce.start, Ce.end), et.start = +new Date, et.time = 0, et.from = Ce.cur, et.to = e, et.delta = e - Ce.cur, et.tweesing = at.tweese || at.init && !at.slidee, et.immediate = !et.tweesing && (t || at.init && at.slidee || !ge.speed), at.tweese = 0, e !== Ce.dest && (Ce.dest = e, pe("change"), it || Y()), K(), Q(), Z(), F()
        }

        function Y() {
            if (ye.initialized) {
                if (!it)return it = w(Y), void(at.released && pe("moveStart"));
                et.immediate ? Ce.cur = et.to : et.tweesing ? (et.tweeseDelta = et.to - Ce.cur, x(et.tweeseDelta) < .1 ? Ce.cur = et.to : Ce.cur += et.tweeseDelta * (at.released ? ge.swingSpeed : ge.syncSpeed)) : (et.time = N(+new Date - et.start, ge.speed), Ce.cur = et.from + et.delta * e.easing[ge.easing](et.time / ge.speed, et.time, 0, 1, ge.speed)), et.to === Ce.cur ? (Ce.cur = et.to, at.tweese = it = 0) : it = w(Y), pe("move"), we || (f ? Pe[0].style[f] = v + (ge.horizontal ? "translateX" : "translateY") + "(" + -Ce.cur + "px)" : Pe[0].style[ge.horizontal ? "left" : "top"] = -E(Ce.cur) + "px"), !it && at.released && pe("moveEnd"), j()
            }
        }

        function j() {
            Se.length && (xe.cur = Ce.start === Ce.end ? 0 : ((at.init && !at.slidee ? Ce.dest : Ce.cur) - Ce.start) / (Ce.end - Ce.start) * xe.end, xe.cur = d(E(xe.cur), xe.start, xe.end), _e.hPos !== xe.cur && (_e.hPos = xe.cur, f ? Se[0].style[f] = v + (ge.horizontal ? "translateX" : "translateY") + "(" + xe.cur + "px)" : Se[0].style[ge.horizontal ? "left" : "top"] = xe.cur + "px"))
        }

        function F() {
            Ae[0] && _e.page !== Oe.activePage && (_e.page = Oe.activePage, Ae.removeClass(ge.activeClass).eq(Oe.activePage).addClass(ge.activeClass), pe("activePage", _e.page))
        }

        function M() {
            tt.speed && Ce.cur !== (tt.speed > 0 ? Ce.end : Ce.start) || ye.stop(), ot = at.init ? w(M) : 0, tt.now = +new Date, tt.pos = Ce.cur + (tt.now - tt.lastTime) / 1e3 * tt.speed, X(at.init ? tt.pos : E(tt.pos)), at.init || Ce.cur !== Ce.dest || pe("moveEnd"), tt.lastTime = tt.now
        }

        function L(e, t, n) {
            if ("boolean" === i(t) && (n = t, t = a), t === a)X(Ce[e], n); else {
                if (Le && "center" !== e)return;
                var r = ye.getPos(t);
                r && X(r[e], n, !Le)
            }
        }

        function R(e) {
            return null != e ? l(e) ? e >= 0 && e < Ne.length ? e : -1 : qe.index(e) : -1
        }

        function U(e) {
            return R(l(e) && 0 > e ? e + Ne.length : e)
        }

        function W(e, t) {
            var a = R(e);
            return !Re || 0 > a ? !1 : ((_e.active !== a || t) && (qe.eq(Oe.activeItem).removeClass(ge.activeClass), qe.eq(a).addClass(ge.activeClass), _e.active = Oe.activeItem = a, Z(), pe("active", a)), a)
        }

        function $(e) {
            e = d(l(e) ? e : Ce.dest, Ce.start, Ce.end);
            var t = {}, a = Me ? 0 : Ie / 2;
            if (!we)for (var n = 0, i = Ee.length; i > n; n++) {
                if (e >= Ce.end || n === Ee.length - 1) {
                    t.activePage = Ee.length - 1;
                    break
                }
                if (e <= Ee[n] + a) {
                    t.activePage = n;
                    break
                }
            }
            if (Re) {
                for (var r = !1, s = !1, o = !1, c = 0, u = Ne.length; u > c; c++)if (r === !1 && e <= Ne[c].start + Ne[c].half && (r = c), o === !1 && e <= Ne[c].center + Ne[c].half && (o = c), c === u - 1 || e <= Ne[c].end + Ne[c].half) {
                    s = c;
                    break
                }
                t.firstItem = l(r) ? r : 0, t.centerItem = l(o) ? o : t.firstItem, t.lastItem = l(s) ? s : t.centerItem
            }
            return t
        }

        function Q(t) {
            e.extend(Oe, $(t))
        }

        function Z() {
            var e = Ce.dest <= Ce.start, t = Ce.dest >= Ce.end, a = (e ? 1 : 0) | (t ? 2 : 0);
            if (_e.slideePosState !== a && (_e.slideePosState = a, Je.is("button,input") && Je.prop("disabled", e), Ke.is("button,input") && Ke.prop("disabled", t), Je.add(Qe)[e ? "addClass" : "removeClass"](ge.disabledClass), Ke.add($e)[t ? "addClass" : "removeClass"](ge.disabledClass)), _e.fwdbwdState !== a && at.released && (_e.fwdbwdState = a, Qe.is("button,input") && Qe.prop("disabled", e), $e.is("button,input") && $e.prop("disabled", t)), Re && null != Oe.activeItem) {
                var n = 0 === Oe.activeItem, i = Oe.activeItem >= Ne.length - 1, r = (n ? 1 : 0) | (i ? 2 : 0);
                _e.itemsButtonState !== r && (_e.itemsButtonState = r, Ze.is("button,input") && Ze.prop("disabled", n), Ge.is("button,input") && Ge.prop("disabled", i), Ze[n ? "addClass" : "removeClass"](ge.disabledClass), Ge[i ? "addClass" : "removeClass"](ge.disabledClass))
            }
        }

        function G(e, t, a) {
            if (e = U(e), t = U(t), e > -1 && t > -1 && e !== t && (!a || t !== e - 1) && (a || t !== e + 1)) {
                qe.eq(e)[a ? "insertAfter" : "insertBefore"](Ne[t].el);
                var n = t > e ? e : a ? t : t - 1, i = e > t ? e : a ? t + 1 : t, r = e > t;
                null != Oe.activeItem && (e === Oe.activeItem ? _e.active = Oe.activeItem = a ? r ? t + 1 : t : r ? t : t - 1 : Oe.activeItem > n && Oe.activeItem < i && (_e.active = Oe.activeItem += r ? 1 : -1)), H()
            }
        }

        function J(e, t) {
            for (var a = 0, n = Ve[e].length; n > a; a++)if (Ve[e][a] === t)return a;
            return -1
        }

        function K() {
            at.released && !ye.isPaused && ye.resume()
        }

        function V(e) {
            return E(d(e, xe.start, xe.end) / xe.end * (Ce.end - Ce.start)) + Ce.start
        }

        function _() {
            at.history[0] = at.history[1], at.history[1] = at.history[2], at.history[2] = at.history[3], at.history[3] = at.delta
        }

        function ee(e) {
            at.released = 0, at.source = e, at.slidee = "slidee" === e
        }

        function te(t) {
            var a = "touchstart" === t.type, n = t.data.source, i = "slidee" === n;
            at.init || !a && ie(t.target) || ("handle" !== n || ge.dragHandle && xe.start !== xe.end) && (!i || (a ? ge.touchDragging : ge.mouseDragging && t.which < 2)) && (a || r(t), ee(n), at.init = 0, at.$source = e(t.target), at.touch = a, at.pointer = a ? t.originalEvent.touches[0] : t, at.initX = at.pointer.pageX, at.initY = at.pointer.pageY, at.initPos = i ? Ce.cur : xe.cur, at.start = +new Date, at.time = 0, at.path = 0, at.delta = 0, at.locked = 0, at.history = [0, 0, 0, 0], at.pathToLock = i ? a ? 30 : 10 : 0, b.on(a ? z : I, ae), ye.pause(1), (i ? Pe : Se).addClass(ge.draggedClass), pe("moveStart"), i && (rt = setInterval(_, 10)))
        }

        function ae(e) {
            if (at.released = "mouseup" === e.type || "touchend" === e.type, at.pointer = at.touch ? e.originalEvent[at.released ? "changedTouches" : "touches"][0] : e, at.pathX = at.pointer.pageX - at.initX, at.pathY = at.pointer.pageY - at.initY, at.path = D(A(at.pathX, 2) + A(at.pathY, 2)), at.delta = ge.horizontal ? at.pathX : at.pathY, at.released || !(at.path < 1)) {
                if (!at.init) {
                    if (!(ge.horizontal ? x(at.pathX) > x(at.pathY) : x(at.pathX) < x(at.pathY)))return ne();
                    at.init = 1
                }
                r(e), !at.locked && at.path > at.pathToLock && at.slidee && (at.locked = 1, at.$source.on(B, s)), at.released && (ne(), ge.releaseSwing && at.slidee && (at.swing = (at.delta - at.history[0]) / 40 * 300, at.delta += at.swing, at.tweese = x(at.swing) > 10)), X(at.slidee ? E(at.initPos - at.delta) : V(at.initPos + at.delta))
            }
        }

        function ne() {
            clearInterval(rt), at.released = !0, b.off(at.touch ? z : I, ae), (at.slidee ? Pe : Se).removeClass(ge.draggedClass), setTimeout(function () {
                at.$source.off(B, s)
            }), Ce.cur === Ce.dest && at.init && pe("moveEnd"), ye.resume(1), at.init = 0
        }

        function ie(t) {
            return ~e.inArray(t.nodeName, k) || e(t).is(ge.interactive)
        }

        function re() {
            ye.stop(), b.off("mouseup", re)
        }

        function se(e) {
            switch (r(e), this) {
                case $e[0]:
                case Qe[0]:
                    ye.moveBy($e.is(this) ? ge.moveBy : -ge.moveBy), b.on("mouseup", re);
                    break;
                case Ze[0]:
                    ye.prev();
                    break;
                case Ge[0]:
                    ye.next();
                    break;
                case Je[0]:
                    ye.prevPage();
                    break;
                case Ke[0]:
                    ye.nextPage()
            }
        }

        function oe(e) {
            return nt.curDelta = (ge.horizontal ? e.deltaY || e.deltaX : e.deltaY) || -e.wheelDelta, nt.curDelta /= 1 === e.deltaMode ? 3 : 100, Re ? (p = +new Date, nt.last < p - nt.resetTime && (nt.delta = 0), nt.last = p, nt.delta += nt.curDelta, x(nt.delta) < 1 ? nt.finalDelta = 0 : (nt.finalDelta = E(nt.delta / 1), nt.delta %= 1), nt.finalDelta) : nt.curDelta
        }

        function le(e) {
            e.originalEvent[g] = ye;
            var t = +new Date;
            if (O + ge.scrollHijack > t && Ue[0] !== document && Ue[0] !== window)return void(O = t);
            if (ge.scrollBy && Ce.start !== Ce.end) {
                var a = oe(e.originalEvent);
                (ge.scrollTrap || a > 0 && Ce.dest < Ce.end || 0 > a && Ce.dest > Ce.start) && r(e, 1), ye.slideBy(ge.scrollBy * a)
            }
        }

        function ce(e) {
            ge.clickBar && e.target === Be[0] && (r(e), X(V((ge.horizontal ? e.pageX - Be.offset().left : e.pageY - Be.offset().top) - Te / 2)))
        }

        function de(e) {
            if (ge.keyboardNavBy)switch (e.which) {
                case ge.horizontal ? 37 : 38:
                    r(e), ye["pages" === ge.keyboardNavBy ? "prevPage" : "prev"]();
                    break;
                case ge.horizontal ? 39 : 40:
                    r(e), ye["pages" === ge.keyboardNavBy ? "nextPage" : "next"]()
            }
        }

        function ue(e) {
            return ie(this) ? void(e.originalEvent[g + "ignore"] = !0) : void(this.parentNode !== Pe[0] || e.originalEvent[g + "ignore"] || ye.activate(this))
        }

        function fe() {
            this.parentNode === De[0] && ye.activatePage(Ae.index(this))
        }

        function ve(e) {
            ge.pauseOnHover && ye["mouseenter" === e.type ? "pause" : "resume"](2)
        }

        function pe(e, t) {
            if (Ve[e]) {
                for (me = Ve[e].length, T.length = 0, he = 0; me > he; he++)T.push(Ve[e][he]);
                for (he = 0; me > he; he++)T[he].call(ye, e, t)
            }
        }

        var he, me, ge = e.extend({}, n.defaults, h), ye = this, we = l(t), be = e(t), Pe = ge.slidee ? e(ge.slidee).eq(0) : be.children().eq(0), Ie = 0, ze = 0, Ce = {
            start: 0,
            center: 0,
            end: 0,
            cur: 0,
            dest: 0
        }, Be = e(ge.scrollBar).eq(0), Se = Be.children().eq(0), ke = 0, Te = 0, xe = {
            start: 0,
            end: 0,
            cur: 0
        }, De = e(ge.pagesBar), Ae = 0, Ee = [], qe = 0, Ne = [], Oe = {
            firstItem: 0,
            lastItem: 0,
            centerItem: 0,
            activeItem: null,
            activePage: 0
        }, He = new u(be[0]), Xe = new u(Pe[0]), Ye = new u(Be[0]), je = new u(Se[0]), Fe = "basic" === ge.itemNav, Me = "forceCentered" === ge.itemNav, Le = "centered" === ge.itemNav || Me, Re = !we && (Fe || Le || Me), Ue = ge.scrollSource ? e(ge.scrollSource) : be, We = ge.dragSource ? e(ge.dragSource) : be, $e = e(ge.forward), Qe = e(ge.backward), Ze = e(ge.prev), Ge = e(ge.next), Je = e(ge.prevPage), Ke = e(ge.nextPage), Ve = {}, _e = {}, et = {}, tt = {}, at = {released: 1}, nt = {
            last: 0,
            delta: 0,
            resetTime: 200
        }, it = 0, rt = 0, st = 0, ot = 0;
        we || (t = be[0]), ye.initialized = 0, ye.frame = t, ye.slidee = Pe[0], ye.pos = Ce, ye.rel = Oe, ye.items = Ne, ye.pages = Ee, ye.isPaused = 0, ye.options = ge, ye.dragging = at, ye.reload = function () {
            H()
        }, ye.getPos = function (e) {
            if (Re) {
                var t = R(e);
                return -1 !== t ? Ne[t] : !1
            }
            var a = Pe.find(e).eq(0);
            if (a[0]) {
                var n = ge.horizontal ? a.offset().left - Pe.offset().left : a.offset().top - Pe.offset().top, i = a[ge.horizontal ? "outerWidth" : "outerHeight"]();
                return {start: n, center: n - Ie / 2 + i / 2, end: n - Ie + i, size: i}
            }
            return !1
        }, ye.moveBy = function (e) {
            tt.speed = e, !at.init && tt.speed && Ce.cur !== (tt.speed > 0 ? Ce.end : Ce.start) && (tt.lastTime = +new Date, tt.startPos = Ce.cur, ee("button"), at.init = 1, pe("moveStart"), y(ot), M())
        }, ye.stop = function () {
            "button" === at.source && (at.init = 0, at.released = 1)
        }, ye.prev = function () {
            ye.activate(null == Oe.activeItem ? 0 : Oe.activeItem - 1)
        }, ye.next = function () {
            ye.activate(null == Oe.activeItem ? 0 : Oe.activeItem + 1)
        }, ye.prevPage = function () {
            ye.activatePage(Oe.activePage - 1)
        }, ye.nextPage = function () {
            ye.activatePage(Oe.activePage + 1)
        }, ye.slideBy = function (e, t) {
            e && (Re ? ye[Le ? "toCenter" : "toStart"](d((Le ? Oe.centerItem : Oe.firstItem) + ge.scrollBy * e, 0, Ne.length)) : X(Ce.dest + e, t))
        }, ye.slideTo = function (e, t) {
            X(e, t)
        }, ye.toStart = function (e, t) {
            L("start", e, t)
        }, ye.toEnd = function (e, t) {
            L("end", e, t)
        }, ye.toCenter = function (e, t) {
            L("center", e, t)
        }, ye.getIndex = R, ye.activate = function (e, t) {
            var a = W(e);
            ge.smart && a !== !1 && (Le ? ye.toCenter(a, t) : a >= Oe.lastItem ? ye.toStart(a, t) : a <= Oe.firstItem ? ye.toEnd(a, t) : K())
        }, ye.activatePage = function (e, t) {
            l(e) && X(Ee[d(e, 0, Ee.length - 1)], t)
        }, ye.resume = function (e) {
            ge.cycleBy && ge.cycleInterval && ("items" !== ge.cycleBy || Ne[0] && null != Oe.activeItem) && !(e < ye.isPaused) && (ye.isPaused = 0, st ? st = clearTimeout(st) : pe("resume"), st = setTimeout(function () {
                switch (pe("cycle"), ge.cycleBy) {
                    case"items":
                        ye.activate(Oe.activeItem >= Ne.length - 1 ? 0 : Oe.activeItem + 1);
                        break;
                    case"pages":
                        ye.activatePage(Oe.activePage >= Ee.length - 1 ? 0 : Oe.activePage + 1)
                }
            }, ge.cycleInterval))
        }, ye.pause = function (e) {
            e < ye.isPaused || (ye.isPaused = e || 100, st && (st = clearTimeout(st), pe("pause")))
        }, ye.toggle = function () {
            ye[st ? "pause" : "resume"]()
        }, ye.set = function (t, a) {
            e.isPlainObject(t) ? e.extend(ge, t) : ge.hasOwnProperty(t) && (ge[t] = a)
        }, ye.add = function (t, a) {
            var n = e(t);
            Re ? (null == a || !Ne[0] || a >= Ne.length ? n.appendTo(Pe) : Ne.length && n.insertBefore(Ne[a].el), null != Oe.activeItem && a <= Oe.activeItem && (_e.active = Oe.activeItem += n.length)) : Pe.append(n), H()
        }, ye.remove = function (t) {
            if (Re) {
                var a = U(t);
                if (a > -1) {
                    qe.eq(a).remove();
                    var n = a === Oe.activeItem;
                    null != Oe.activeItem && a < Oe.activeItem && (_e.active = --Oe.activeItem), H(), n && (_e.active = null, ye.activate(Oe.activeItem))
                }
            } else e(t).remove(), H()
        }, ye.moveAfter = function (e, t) {
            G(e, t, 1)
        }, ye.moveBefore = function (e, t) {
            G(e, t)
        }, ye.on = function (e, t) {
            if ("object" === i(e))for (var a in e)e.hasOwnProperty(a) && ye.on(a, e[a]); else if ("function" === i(t))for (var n = e.split(" "), r = 0, s = n.length; s > r; r++)Ve[n[r]] = Ve[n[r]] || [], -1 === J(n[r], t) && Ve[n[r]].push(t); else if ("array" === i(t))for (var o = 0, l = t.length; l > o; o++)ye.on(e, t[o])
        }, ye.one = function (e, t) {
            function a() {
                t.apply(ye, arguments), ye.off(e, a)
            }

            ye.on(e, a)
        }, ye.off = function (e, t) {
            if (t instanceof Array)for (var a = 0, n = t.length; n > a; a++)ye.off(e, t[a]); else for (var i = e.split(" "), r = 0, s = i.length; s > r; r++)if (Ve[i[r]] = Ve[i[r]] || [], null == t)Ve[i[r]].length = 0; else {
                var o = J(i[r], t);
                -1 !== o && Ve[i[r]].splice(o, 1)
            }
        }, ye.destroy = function () {
            return Ue.add(Se).add(Be).add(De).add($e).add(Qe).add(Ze).add(Ge).add(Je).add(Ke).off("." + g), b.off("keydown", de), Ze.add(Ge).add(Je).add(Ke).removeClass(ge.disabledClass), qe && null != Oe.activeItem && qe.eq(Oe.activeItem).removeClass(ge.activeClass), De.empty(), we || (be.off("." + g), He.restore(), Xe.restore(), Ye.restore(), je.restore(), e.removeData(t, g)), Ne.length = Ee.length = 0, _e = {}, ye.initialized = 0, ye
        }, ye.init = function () {
            if (!ye.initialized) {
                ye.on(m);
                var e = ["overflow", "position"], t = ["position", "webkitTransform", "msTransform", "transform", "left", "top", "width", "height"];
                He.save.apply(He, e), Ye.save.apply(Ye, e), Xe.save.apply(Xe, t), je.save.apply(je, t);
                var a = Se;
                return we || (a = a.add(Pe), be.css("overflow", "hidden"), f || "static" !== be.css("position") || be.css("position", "relative")), f ? v && a.css(f, v) : ("static" === Be.css("position") && Be.css("position", "relative"), a.css({position: "absolute"})), ge.forward && $e.on(S, se), ge.backward && Qe.on(S, se), ge.prev && Ze.on(B, se), ge.next && Ge.on(B, se), ge.prevPage && Je.on(B, se), ge.nextPage && Ke.on(B, se), Ue.on(C, le), Be[0] && Be.on(B, ce), Re && ge.activateOn && be.on(ge.activateOn + "." + g, "*", ue), De[0] && ge.activatePageOn && De.on(ge.activatePageOn + "." + g, "*", fe), We.on(P, {source: "slidee"}, te), Se && Se.on(P, {source: "handle"}, te), b.on("keydown", de), we || (be.on("mouseenter." + g + " mouseleave." + g, ve), be.on("scroll." + g, o)), ye.initialized = 1, H(!0), ge.cycleBy && !we && ye[ge.startPaused ? "pause" : "resume"](), ye
            }
        }
    }

    function i(e) {
        return null == e ? String(e) : "object" == typeof e || "function" == typeof e ? Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase() || "object" : typeof e
    }

    function r(e, t) {
        e.preventDefault(), t && e.stopPropagation()
    }

    function s(t) {
        r(t, 1), e(this).off(t.type, s)
    }

    function o() {
        this.scrollLeft = 0, this.scrollTop = 0
    }

    function l(e) {
        return !isNaN(parseFloat(e)) && isFinite(e)
    }

    function c(e, t) {
        return 0 | E(String(e.css(t)).replace(/[^\-0-9.]/g, ""))
    }

    function d(e, t, a) {
        return t > e ? t : e > a ? a : e
    }

    function u(e) {
        var t = {};
        return t.style = {}, t.save = function () {
            if (e && e.nodeType) {
                for (var a = 0; a < arguments.length; a++)t.style[arguments[a]] = e.style[arguments[a]];
                return t
            }
        }, t.restore = function () {
            if (e && e.nodeType) {
                for (var a in t.style)t.style.hasOwnProperty(a) && (e.style[a] = t.style[a]);
                return t
            }
        }, t
    }

    var f, v, p, h = "sly", m = "Sly", g = h, y = t.cancelAnimationFrame || t.cancelRequestAnimationFrame, w = t.requestAnimationFrame, b = e(document), P = "touchstart." + g + " mousedown." + g, I = "mousemove." + g + " mouseup." + g, z = "touchmove." + g + " touchend." + g, C = (document.implementation.hasFeature("Event.wheel", "3.0") ? "wheel." : "mousewheel.") + g, B = "click." + g, S = "mousedown." + g, k = ["INPUT", "SELECT", "BUTTON", "TEXTAREA"], T = [], x = Math.abs, D = Math.sqrt, A = Math.pow, E = Math.round, q = Math.max, N = Math.min, O = 0;
    b.on(C, function (e) {
        var t = e.originalEvent[g], a = +new Date;
        (!t || t.options.scrollHijack < a - O) && (O = a)
    }), function (e) {
        function t(e) {
            var t = (new Date).getTime(), n = Math.max(0, 16 - (t - a)), i = setTimeout(e, n);
            return a = t, i
        }

        w = e.requestAnimationFrame || e.webkitRequestAnimationFrame || t;
        var a = (new Date).getTime(), n = e.cancelAnimationFrame || e.webkitCancelAnimationFrame || e.clearTimeout;
        y = function (t) {
            n.call(e, t)
        }
    }(window), function () {
        function e(e) {
            for (var n = 0, i = t.length; i > n; n++) {
                var r = t[n] ? t[n] + e.charAt(0).toUpperCase() + e.slice(1) : e;
                if (null != a.style[r])return r
            }
        }

        var t = ["", "webkit", "moz", "ms", "o"], a = document.createElement("div");
        f = e("transform"), v = e("perspective") ? "translateZ(0) " : ""
    }(), t[m] = n, e.fn[h] = function (t, a) {
        var r, s;
        return e.isPlainObject(t) || (("string" === i(t) || t === !1) && (r = t === !1 ? "destroy" : t, s = Array.prototype.slice.call(arguments, 1)), t = {}), this.each(function (i, o) {
            var l = e.data(o, g);
            l || r ? l && r && l[r] && l[r].apply(l, s) : l = e.data(o, g, new n(o, t, a).init())
        })
    }, n.defaults = {
        slidee: null,
        horizontal: !1,
        itemNav: null,
        itemSelector: null,
        smart: !1,
        activateOn: null,
        activateMiddle: !1,
        scrollSource: null,
        scrollBy: 0,
        scrollHijack: 300,
        scrollTrap: !1,
        dragSource: null,
        mouseDragging: !1,
        touchDragging: !1,
        releaseSwing: !1,
        swingSpeed: .2,
        elasticBounds: !1,
        interactive: null,
        scrollBar: null,
        dragHandle: !1,
        dynamicHandle: !1,
        minHandleSize: 50,
        clickBar: !1,
        syncSpeed: .5,
        pagesBar: null,
        activatePageOn: null,
        pageBuilder: function (e) {
            return "<li>" + (e + 1) + "</li>"
        },
        forward: null,
        backward: null,
        prev: null,
        next: null,
        prevPage: null,
        nextPage: null,
        cycleBy: null,
        cycleInterval: 5e3,
        pauseOnHover: !1,
        startPaused: !1,
        moveBy: 300,
        speed: 0,
        easing: "swing",
        startAt: null,
        keyboardNavBy: null,
        draggedClass: "dragged",
        activeClass: "active",
        disabledClass: "disabled"
    }
}(jQuery, window);
!function e(t, i, r) {
    function n(a, s) {
        if (!i[a]) {
            if (!t[a]) {
                var h = "function" == typeof require && require;
                if (!s && h)return h(a, !0);
                if (o)return o(a, !0);
                var l = new Error("Cannot find module '" + a + "'");
                throw l.code = "MODULE_NOT_FOUND", l
            }
            var u = i[a] = {exports: {}};
            t[a][0].call(u.exports, function (e) {
                var i = t[a][1][e];
                return n(i ? i : e)
            }, u, u.exports, e, t, i, r)
        }
        return i[a].exports
    }

    for (var o = "function" == typeof require && require, a = 0; a < r.length; a++)n(r[a]);
    return n
}({
    1: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r() {
                return {
                    addons: [{
                        name: "keen:ua_parser",
                        input: {ua_string: "user_agent"},
                        output: "parsed_user_agent"
                    }]
                }
            }

            function n() {
                var e;
                try {
                    e = window.localStorage.getItem("distinctID"), null === e && (e = "anon_" + u.randomString(11), window.localStorage.setItem("distinctID", e))
                } catch (t) {
                    e = "anon_" + u.randomString(11)
                }
                return p.debug("analytics distinctID = " + e), e
            }

            function o() {
                var e = 0, t = window.onerror;
                window.onerror = function (i, r, n) {
                    return e++ <= c.analytics.maxTrackedErrors && mixpanel.track("USER", {
                        event_type: "error",
                        error_type: "window",
                        error_severity: "error"
                    }), t ? t(i, r, n) : !1
                };
                var i = console.warn;
                console.warn = function () {
                    var t = Array.prototype.slice.call(arguments);
                    e++ <= c.analytics.maxTrackedErrors && mixpanel.track("USER", {
                        event_type: "error",
                        error_type: "console",
                        error_severity: "warning"
                    }), i.apply(console, t)
                };
                var r = console.error;
                console.error = function () {
                    var t = Array.prototype.slice.call(arguments);
                    e++ <= c.analytics.maxTrackedErrors && mixpanel.track("USER", {
                        event_type: "error",
                        error_type: "console",
                        error_severity: "error"
                    }), r.apply(console, t)
                }
            }

            function a(e, t) {
                var i = Date.now() - w;
                clearTimeout(_), mixpanel.track("USER", {
                    event_type: "model_loaded",
                    duration: i
                }), e.panos.forEach(function (e) {
                    p.debug("adding handler for tracking pano " + e.id), e.on("enter", function () {
                        mixpanel.track("USER", {
                            event_type: "view_pano",
                            pano_id: e.id,
                            interaction_source: g,
                            navigation_source: v
                        })
                    })
                }), t.on("tour_auto", function (e) {
                    v = "tour_" + e
                }), t.on("tour_manual", function (e) {
                    v = "tour_manual"
                }), t.controls[d.PANORAMA].on("interaction.key", function () {
                    t.mode === d.TRANSITIONING || t.flying || (g = "keyboard", v = "self_guided")
                }), t.controls[d.PANORAMA].on("interaction.direct", function () {
                    t.mode === d.TRANSITIONING || t.flying || (g = "direct", v = "self_guided")
                }), t.controls[d.PANORAMA].on("interaction.gui", function () {
                    t.mode === d.TRANSITIONING || t.flying || (g = "gui", v = "self_guided")
                }), $(window).resize(function () {
                    mixpanel.register({aspect_ratio: l.aspectRatio()})
                })
            }

            function s(e, t) {
                if (b) {
                    var i = {}, r = {};
                    e.panos.forEach(function (e) {
                        p.debug("adding load handler for tracking pano " + e.id), e.on("loading", function (t) {
                            r[e.id] || (r[e.id] = x.getElapsedTime())
                        }), e.on("load", function (t) {
                            if ("high" === t) {
                                var n = x.getElapsedTime() - r[e.id];
                                if (mixpanel.track("USER", {
                                        event_type: "pano_loaded",
                                        pano_id: e.id,
                                        download_time: n.toFixed(1)
                                    }), i[e.id]) {
                                    var o = x.getElapsedTime() - i[e.id];
                                    mixpanel.track("USER", {
                                        event_type: "pano_wait",
                                        pano_id: e.id,
                                        wait_duration: o.toFixed(1),
                                        navigation_source: v
                                    })
                                }
                            }
                        }), e.on("enter", function () {
                            void 0 === i[e.id] && (i[e.id] = x.getElapsedTime(), e.isLoaded("high") && mixpanel.track("USER", {
                                event_type: "pano_wait",
                                pano_id: e.id,
                                wait_duration: 0,
                                navigation_source: v
                            }))
                        })
                    }), e.on("floor.changed", function (e, t) {
                        mixpanel.track("USER", {event_type: "floor_change", floor_id: e.name, interaction_source: g})
                    }), t.on("mode.changed", function (e, t) {
                        t !== d.TRANSITIONING && mixpanel.track("USER", {
                            event_type: "mode_change",
                            view_mode: t,
                            interaction_source: g
                        })
                    }), mixpanel.track("USER", {event_type: "session_duration_start"}), setInterval(function () {
                        document.hidden || (p.debug("Sending session duration ping"), mixpanel.track("USER", {event_type: "session_duration_ping"}))
                    }, 1e3 * c.analytics.sessionDurationPingFrequency)
                }
            }

            var h = e("three"), l = e("./util/browser"), u = e("./util/common"), c = e("./settings"), d = e("./enum/Viewmode"), f = e("./util/logger"), p = new f(i), m = new Keen({
                projectId: "53a9baf536bca4213d000000",
                writeKey: "dcfae0ec6709a6d21f2f5e50a091a0cc6ab8abc88f1c66e961f9e33db58544ca90a37d6698df874334c6dddbde8eaaeb45d8e80d963978d87ada717c1b66e8e3a46d7686538c29db04227fd2ce04a0f7e35c3c5ef07b24b2c77400f29ed15258efbe9312722711abb9fbc2d7bf245803",
                readKey: "",
                requestType: "xhr"
            }), g = "direct", v = void 0, y = null, b = !1, w = null, _ = null, x = new h.Clock(!0);
            x.start(), t.exports = {
                report: function (e, t) {
                    m.addEvent("Session starts", {
                        host: window.location.host,
                        model: e,
                        keen: r(),
                        user_agent: "${keen.user_agent}",
                        status: t,
                        referrer: {url: document.referrer, domain: u.domainFromUrl(document.referrer)},
                        embedded: l.inIframe()
                    })
                }, getMixpanelToken: function (e) {
                    var t = $.Deferred();
                    return c.debug ? t.resolve("") : e.data && e.data.mixpanel ? (p.info("Using prefetched mixpanel token"), t.resolve(e.data.mixpanel)) : ($.ajax("/api/v1/metrics/keys/").done(function (e) {
                        "mixpanel" in e ? t.resolve(e.mixpanel) : (p.error("No mixpanel token available"), t.reject("loading-failed-mixpanel"))
                    }).fail(function (e) {
                        p.error("No mixpanel token available"), t.reject("loading-failed-mixpanel")
                    }), t.promise())
                }, impression: function (e) {
                    y && (mixpanel.track("USER", {event_type: "impression", visible: e}), b && o())
                }, initMixpanel: function (e) {
                    y = e.token, mixpanel.init(y, {persistence: "localStorage"}), mixpanel.identify(n()), c.analytics.sessionTrackingRate = 1 === c.analytics.sessionTrackingRate ? 1 : .15, b = Math.random() < c.analytics.sessionTrackingRate, p.debug("tracking sample rate = " + c.analytics.sessionTrackingRate), p.debug("tracking this session = " + b);
                    var t = "anonymous", i = "anonymous";
                    mixpanel.register({
                        app: "showcase",
                        app_version: e.version,
                        model_id: e.model,
                        user_id: t,
                        group_id: i,
                        session_tracking_rate: c.analytics.sessionTrackingRate,
                        session_tracking: b,
                        start_source: e.startSource
                    })
                }, initMixpanelModel: function (e) {
                    if (y) {
                        var t = e.data.owner, i = t && t.user_sid ? t.user_sid : "anonymous", r = t && t.group_sid ? t.group_sid : "anonymous", n = "anonymous", o = "anonymous";
                        mixpanel.register({
                            manifest_id: e.data.job.uuid,
                            owner_user_id: i,
                            owner_group_id: r,
                            editor_user_id: n,
                            editor_group_id: o,
                            ua_string: l.userAgent(),
                            is_mobile: l.isMobile(),
                            iframe: l.inIframe(),
                            aspect_ratio: l.aspectRatio()
                        })
                    }
                }, sessionStart: function (e) {
                    if (y && (p.debug("analytics user_session_start"), mixpanel.track("USER", {event_type: "user_session_start"}), w = Date.now(), b)) {
                        var t = function () {
                            mixpanel.track("USER", {event_type: "long_load"})
                        };
                        _ = setTimeout(t, 15e3)
                    }
                }, modelLoaded: function (e, t) {
                    y && (a(e, t), s(e, t))
                }, track: function (e, t) {
                    y && b && (p.debug('analytics.track("USER", ' + JSON.stringify(t) + " )"), mixpanel.track(e, t))
                }, trackAlways: function (e, t) {
                    y && (p.debug('analytics.trackAlways("USER", ' + JSON.stringify(t) + " )"), mixpanel.track(e, t))
                }
            }
        }).call(this, "/js/analytics.js")
    }, {
        "./enum/Viewmode": 12,
        "./settings": 68,
        "./util/browser": 74,
        "./util/common": 75,
        "./util/logger": 78,
        three: 138
    }],
    2: [function (e, t, i) {
        "use strict";
        function r(e) {
            n.PerspectiveCamera.call(this, a.dollhouseFOV, window.innerWidth / window.innerHeight, 1, 500), this.parent = e, this.controls = null
        }

        var n = e("three"), o = e("../enum/Viewmode"), a = e("../settings");
        r.prototype = Object.create(n.PerspectiveCamera.prototype), r.prototype.set = function (e) {
            if (this.controls.target.copy(this.parent.target), this.controls.target.y = 0, this.parent.mode === o.PANORAMA)this.position.set(0, 6, 0).add(this.parent.position).add(this.parent.getDirection().multiplyScalar(-10)); else if (this.parent.mode === o.FLOORPLAN) {
                var t = new n.Vector3(0, -1, 0).applyQuaternion(this.parent.quaternion);
                this.position.copy(this.parent.position).add(t.multiplyScalar(6)), this.position.y = 6
            }
            this.controls.update()
        }, t.exports = r
    }, {"../enum/Viewmode": 12, "../settings": 68, three: 138}],
    3: [function (e, t, i) {
        "use strict";
        function r(e) {
            n.OrthographicCamera.call(this, -o.orthoBase, o.orthoBase, o.orthoBase / (window.innerWidth / window.innerHeight), -o.orthoBase / (window.innerWidth / window.innerHeight), 1, 500), this.parent = e, this.controls = null
        }

        var n = e("three"), o = (e("../util/transitions"), e("../util/easing"), e("../util/lerp"), e("../settings"));
        r.prototype = Object.create(n.OrthographicCamera.prototype), r.prototype.set = function (e) {
            var t = this.parent.model;
            this.controls.target.set(t.center.x, 0, t.center.z), this.position.set(t.center.x, 10, t.center.z);
            var i = Math.max(t.size.x, t.size.z), r = Math.min(t.size.x, t.size.z);
            this.controls.zoomToContain(Math.max(i, r * o.aspect));
            var n;
            t.size.x < t.size.z ? (n = Math.PI / 2, this.parent.getDirection().x < 0 && (n += Math.PI)) : (n = 0, this.parent.getDirection().z > 0 && (n += Math.PI)), this.controls.rotateLeft(n), this.controls.update()
        }, t.exports = r
    }, {"../settings": 68, "../util/easing": 76, "../util/lerp": 77, "../util/transitions": 81, three: 138}],
    4: [function (e, t, i) {
        "use strict";
        function r(e) {
            n.PerspectiveCamera.call(this, o.insideFOV, window.innerWidth / window.innerHeight, .1, 500), this.parent = e, this.controls = null
        }

        var n = e("three"), o = e("../settings");
        e("../util/transitions"), e("../util/lerp");
        r.prototype = Object.create(n.PerspectiveCamera.prototype), r.prototype.set = function (e, t) {
            this.parent.model.setProjectedPanos(e, e), this.parent.currentPano = e, this.parent.emit("pano.chosen", e, e), this.position.copy(e.position);
            var i;
            if (t)i = new n.Vector3(0, 0, -1).applyQuaternion(t); else {
                var i = this.parent.getDirection();
                i.y = 0, i.normalize()
            }
            var r = i.add(e.position);
            this.controls.reset(), this.controls.lookAt(r), this.controls.update(0, !0)
        }, t.exports = r
    }, {"../settings": 68, "../util/lerp": 77, "../util/transitions": 81, three: 138}],
    5: [function (e, t, i) {
        "use strict";
        function r(e, t, i, r, n) {
            a.call(this, e, t, i, r, n), this.minPolarAngle = o.dollhouseDefault.minPolarAngle, this.maxPolarAngle = o.dollhouseDefault.maxPolarAngle, this.defaultMinDistance = this.adjustedMinDistance(), this.minDistance = this.defaultMinDistance, this.maxDistance = 50
        }

        var n = e("three"), o = e("../settings"), a = e("./OutsideControls");
        r.prototype = Object.create(a.prototype), t.exports = r, r.prototype.setModel = function (e) {
            a.prototype.setModel.call(this, e), this.defaultMinDistance = this.adjustedMinDistance(), this.resetRanges()
        }, r.prototype.adjustedMinDistance = function () {
            if (void 0 === this.model)return o.dollhouseDefault.minDistance;
            var e = this.model.boundingBox.max, t = this.model.boundingBox.min, i = t.distanceTo(e);
            return Math.min(i / 2, o.dollhouseDefault.minDistance)
        }, r.prototype.resetRanges = function (e, t) {
            var i = e || this.adjustedMinDistance();
            i = Math.min(i, this.defaultMinDistance), this.minDistance = i;
            var r = t || !1;
            r ? (this.minPolarAngle = n.Math.degToRad(-15), this.maxPolarAngle = n.Math.degToRad(89.9)) : (this.minPolarAngle = o.dollhouseDefault.minPolarAngle, this.maxPolarAngle = o.dollhouseDefault.maxPolarAngle)
        }, r.prototype.calculateMaxDistance = function (e) {
            var t = this.object, i = e.boundingBox.max, r = e.boundingBox.min, n = Math.max(i.x - r.x, i.z - r.z) / 2, o = (i.y - r.y) / 2, a = n / Math.tan(t.fov / 2 * t.aspect * (Math.PI / 180));
            a += Math.min(i.x - r.x, i.z - r.z) / 2;
            var s = o / Math.tan(t.fov / 2 * (Math.PI / 180));
            return 1.1 * Math.min(Math.max(a, s, 25), this.scene.skybox.geometry.boundingSphere.radius)
        }
    }, {"../settings": 68, "./OutsideControls": 7, three: 138}],
    6: [function (e, t, i) {
        "use strict";
        function r(e, t, i, r, o) {
            n.call(this, e, t, i, r, o), this.minDistance = 15, this.maxDistance = 50, this.noRotateUpDown = !0, this.minPolarAngle = 0, this.maxPolarAngle = 0
        }

        var n = (e("three"), e("../settings"), e("./OutsideControls"));
        r.prototype = Object.create(n.prototype), t.exports = r
    }, {"../settings": 68, "./OutsideControls": 7, three: 138}],
    7: [function (e, t, i) {
        "use strict";
        function r(e, t, i, o, a) {
            this.player = e, this.model = a, this.object = t, this.object.controls = this, this.scene = o, this.domElement = void 0 !== i ? i : document, this.enabled = !0, this.target = new n.Vector3, this.noZoom = !1, this.zoomSpeed = 1, this.minDistance = 0, this.maxDistance = 1 / 0, this.noRotate = !1, this.noRotateUpDown = !1, this.rotateSpeed = 1, this.keyboardZoomSpeed = 0, this.noPan = !1, this.keyPanSpeed = 7, this.autoRotate = !1, this.autoRotateSpeed = 2, this.minPolarAngle = n.Math.degToRad(25), this.maxPolarAngle = n.Math.degToRad(65), this.noKeys = !1, this.keys = {
                LEFT: 37,
                UP: 38,
                RIGHT: 39,
                BOTTOM: 40
            }, this.rotationAcceleration = new n.Vector2, this.rotationSpeed = new n.Vector2, this.panAcceleration = new n.Vector2, this.panSpeed = new n.Vector2, this.rotateStart = new n.Vector2, this.rotateEnd = new n.Vector2, this.rotateDelta = new n.Vector2, this.panStart = new n.Vector2, this.panEnd = new n.Vector2, this.panDelta = new n.Vector2, this.panOffset = new n.Vector3, this.offset = new n.Vector3, this.dollyStart = new n.Vector2, this.dollyEnd = new n.Vector2, this.dollyDelta = new n.Vector2, this.phiDelta = 0, this.thetaDelta = 0, this.scale = 1, this.panVector = new n.Vector3, this.lastPosition = new n.Vector3, this.state = l.NONE, this.target0 = this.target.clone(), this.position0 = this.object.position.clone(), this.lastMoveTime = 0, this.pointersLimit = 2, this.pointers = [], this.absoluteScale = 1, this.currentScale = 1, this.originalTop = this.object.top, this.originalBottom = this.object.bottom, this.originalLeft = this.object.left, this.originalRight = this.object.right, this.on("touch-one-finger-start", r.touch.rotate.start), this.on("touch-one-finger-move", r.touch.rotate.move), this.on("touch-two-finger-start", r.touch.pan.start), this.on("touch-two-finger-move", r.touch.pan.move), this.on("touch-two-finger-start", r.touch.zoom.start), this.on("touch-two-finger-move", r.touch.zoom.move)
        }

        var n = e("three"), o = e("../settings"), a = e("../util/common"), s = e("events").EventEmitter, h = 1e-6, l = {
            NONE: -1,
            ROTATE: 0,
            DOLLY: 1,
            PAN: 2,
            TOUCH_ROTATE: 3,
            TOUCH_DOLLY_PAN: 4
        };
        r.prototype = Object.create(s.prototype), r.prototype.setModel = function (e) {
            this.model = e
        }, r.prototype.bindEvents = function () {
            this.domElement.addEventListener("contextmenu", function (e) {
                e.preventDefault()
            }), this.domElement.addEventListener("mousedown", this.onMouseDown.bind(this)), this.domElement.addEventListener("mousemove", this.onMouseMove.bind(this)), this.domElement.addEventListener("mouseup", this.onMouseUp.bind(this)), this.domElement.addEventListener("mouseover", function (e) {
                (0 === e.which || 0 === e.buttons) && this.onMouseUp(e)
            }.bind(this)), this.domElement.addEventListener("mousewheel", this.onMouseWheel.bind(this)), this.domElement.addEventListener("DOMMouseScroll", this.onMouseWheel.bind(this)), this.domElement.addEventListener("touchstart", this.touchstart.bind(this)), this.domElement.addEventListener("touchend", this.touchend.bind(this)), this.domElement.addEventListener("touchmove", this.touchmove.bind(this)), this.domElement.addEventListener("pointerdown", this.pointerdown.bind(this)), this.domElement.addEventListener("pointerup", this.pointerup.bind(this)), this.domElement.addEventListener("pointerout", this.pointerup.bind(this)), this.domElement.addEventListener("pointercancel", this.pointerup.bind(this)), this.domElement.addEventListener("pointermove", this.pointermove.bind(this)), document.addEventListener("keydown", this.onKeyDown.bind(this)), document.addEventListener("keyup", this.onKeyUp.bind(this))
        }, r.prototype.rotateLeft = function (e) {
            void 0 === e && (e = this.getAutoRotationAngle()), this.thetaDelta -= e
        }, r.prototype.rotateUp = function (e) {
            this.noRotateUpDown || (void 0 === e && (e = this.getAutoRotationAngle()), this.phiDelta -= e)
        }, r.prototype.panLeft = function (e) {
            var t = this.object.matrix.elements;
            this.panOffset.set(t[0], 0, t[2]).normalize(), this.panOffset.multiplyScalar(-e), this.panVector.add(this.panOffset)
        }, r.prototype.panUp = function (e) {
            var t = this.object.matrix.elements;
            this.panOffset.set(t[4], 0, t[6]).normalize(), this.panOffset.multiplyScalar(-e), this.panVector.add(this.panOffset)
        }, r.prototype.pan = function (e, t) {
            var i = this.domElement === document ? this.domElement.body : this.domElement;
            if (this.object.updateMatrix(), void 0 !== this.object.fov) {
                var r = this.object.position, n = r.clone().sub(this.target), o = n.length();
                o *= Math.tan(this.object.fov / 2 * Math.PI / 180), this.panLeft(2 * e * o / i.clientHeight), this.panUp(-2 * t * o / i.clientHeight)
            } else void 0 !== this.object.top ? (this.panLeft(e * (this.object.right - this.object.left) / i.clientWidth), this.panUp(-t * (this.object.top - this.object.bottom) / i.clientHeight)) : console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")
        }, r.prototype.dollyIn = function (e) {
            void 0 === e && (e = this.getZoomScale()), this.scale /= e
        }, r.prototype.dollyOut = function (e) {
            void 0 === e && (e = this.getZoomScale()), this.scale *= e
        }, r.prototype.update = function (e) {
            this.rotationSpeed.x = this.rotationSpeed.x * (1 - o.rotationFriction) + this.rotationAcceleration.x * o.rotationAccelerationOutside / 1e3, this.rotationSpeed.y = this.rotationSpeed.y * (1 - o.rotationFriction) + this.rotationAcceleration.y * o.rotationAccelerationOutside / 1e3, this.rotateLeft(-this.rotationSpeed.x), this.noRotateUpDown || this.rotateUp(this.rotationSpeed.y), this.panSpeed.x = this.panSpeed.x * (1 - o.panFriction) + this.panAcceleration.x * o.panAccelerationOutside, this.panSpeed.y = this.panSpeed.y * (1 - o.panFriction) + this.panAcceleration.y * o.panAccelerationOutside, this.pan(-this.panSpeed.x, this.panSpeed.y);
            var t = this.object.position;
            this.offset.copy(t).sub(this.target);
            var i = Math.atan2(this.offset.x, this.offset.z), r = Math.atan2(Math.sqrt(this.offset.x * this.offset.x + this.offset.z * this.offset.z), this.offset.y);
            this.autoRotate && this.rotateLeft(this.getAutoRotationAngle()), i += this.thetaDelta, r += this.phiDelta, r = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, r)), r = Math.max(h, Math.min(Math.PI - h, r));
            var n = this.offset.length();
            this.object.top ? (this.absoluteScale *= this.scale - .03 * this.keyboardZoomSpeed, this.absoluteScale = Math.max(o.zoomNearLimit, Math.min(this.absoluteScale, o.zoomFarLimit)), this.currentScale = .8 * this.currentScale + .2 * this.absoluteScale, this.object.left = -o.orthoBase * this.currentScale, this.object.right = o.orthoBase * this.currentScale, this.object.top = o.orthoBase * this.currentScale / o.aspect, this.object.bottom = -o.orthoBase * this.currentScale / o.aspect, this.object.updateProjectionMatrix()) : n *= this.scale, n = Math.max(this.minDistance, Math.min(this.maxDistance, n)), this.target.add(this.panVector), this.model.boundingBoxWithPadding.clampPoint(this.target, this.target), this.offset.x = n * Math.sin(r) * Math.sin(i), this.offset.y = n * Math.cos(r), this.offset.z = n * Math.sin(r) * Math.cos(i), t.copy(this.target).add(this.offset), this.object.lookAt(this.target), this.thetaDelta = 0, this.phiDelta = 0, this.scale = 1, this.panVector.set(0, 0, 0), this.lastPosition.distanceTo(this.object.position) > 0 && this.lastPosition.copy(this.object.position)
        }, r.prototype.zoomToContain = function (e) {
            this.absoluteScale = e / 2 / o.orthoBase * 1.2, this.currentScale = this.absoluteScale
        }, r.prototype.getAutoRotationAngle = function () {
            return 2 * Math.PI / 60 / 60 * this.autoRotateSpeed
        }, r.prototype.getZoomScale = function () {
            return Math.pow(.95, this.zoomSpeed)
        }, r.prototype.onMouseDown = function (e) {
            this.enabled !== !1 && (e.preventDefault(), this.player.director.nav(function () {
                if (this.mouseDown = !0, 2 === e.button) {
                    if (this.noRotate === !0)return;
                    this.emit("move"), this.state = l.ROTATE, this.rotateStart.set(e.clientX, this.noRotateUpDown ? 0 : e.clientY), this.rotationSpeed.set(0, 0)
                } else if (1 === e.button) {
                    if (this.noZoom === !0)return;
                    this.emit("move"), this.state = l.DOLLY, this.dollyStart.set(e.clientX, e.clientY)
                } else if (0 === e.button) {
                    if (this.noPan === !0)return;
                    this.emit("move"), this.state = l.PAN, this.panStart.set(e.clientX, e.clientY)
                }
            }.bind(this)))
        }, r.prototype.onMouseMove = function (e) {
            if (this.enabled !== !1 && this.mouseDown && 0 !== e.buttons) {
                e.preventDefault();
                var t = this.domElement === document ? this.domElement.body : this.domElement;
                if (this.state === l.ROTATE) {
                    if (this.noRotate === !0)return;
                    this.rotateEnd.set(e.clientX, this.noRotateUpDown ? 0 : e.clientY), this.rotateDelta.subVectors(this.rotateEnd, this.rotateStart), this.rotateLeft(2 * Math.PI * this.rotateDelta.x / t.clientWidth * this.rotateSpeed), this.rotateUp(2 * Math.PI * this.rotateDelta.y / t.clientHeight * this.rotateSpeed), this.rotateStart.copy(this.rotateEnd)
                } else if (this.state === l.DOLLY) {
                    if (this.noZoom === !0)return;
                    this.dollyEnd.set(e.clientX, e.clientY), this.dollyDelta.subVectors(this.dollyEnd, this.dollyStart), this.dollyDelta.y > 0 ? this.dollyIn() : this.dollyOut(), this.dollyStart.copy(this.dollyEnd)
                } else if (this.state === l.PAN) {
                    if (this.noPan === !0)return;
                    this.panEnd.set(e.clientX, e.clientY), this.panDelta.subVectors(this.panEnd, this.panStart), this.pan(this.panDelta.x, this.panDelta.y), this.panStart.copy(this.panEnd)
                }
                this.lastMoveTime = e.timeStamp, this.update()
            }
        }, r.prototype.onMouseUp = function (e) {
            this.enabled !== !1 && (this.mouseDown = !1, this.state = l.NONE, e.timeStamp > this.lastMoveTime + 100 ? (this.rotationSpeed.set(0, 0), this.rotationAcceleration.set(0, 0)) : this.rotationAcceleration.set(-this.rotateDelta.x, this.rotateDelta.y), this.update(), this.rotationAcceleration.set(0, 0), this.rotateDelta.set(0, 0))
        }, r.prototype.onMouseWheel = function (e) {
            if (this.enabled !== !1 && this.noZoom !== !0) {
                this.emit("move"), $("#debug-console").is(":visible") || e.preventDefault();
                var t = 0;
                void 0 !== e.wheelDelta ? t = e.wheelDelta : void 0 !== e.detail && (t = -e.detail), t > 0 ? this.player.director.nav(function () {
                    this.dollyOut()
                }.bind(this)) : this.player.director.nav(function () {
                    this.dollyIn()
                }.bind(this)), this.update()
            }
        }, r.prototype.onKeyDown = function (e) {
            this.enabled !== !1 && this.noKeys !== !0 && this.noPan !== !0 && (e.metaKey || e.ctrlKey || (e.preventDefault(), this.handleKeyDown(e.which)))
        }, r.prototype.handleKeyDown = function (e) {
            switch (e) {
                case 73:
                case this.keys.UP:
                    this.player.director.nav(function () {
                        this.noRotateUpDown ? this.keyboardZoomSpeed = 1 : this.rotationAcceleration.y = 1
                    }.bind(this)), this.emit("move");
                    break;
                case 75:
                case this.keys.BOTTOM:
                    this.player.director.nav(function () {
                        this.noRotateUpDown ? this.keyboardZoomSpeed = -1 : this.rotationAcceleration.y = -1
                    }.bind(this)), this.emit("move");
                    break;
                case 74:
                case this.keys.LEFT:
                    this.player.director.nav(function () {
                        this.rotationAcceleration.x = -1
                    }.bind(this)), this.emit("move");
                    break;
                case 76:
                case this.keys.RIGHT:
                    this.player.director.nav(function () {
                        this.rotationAcceleration.x = 1
                    }.bind(this)), this.emit("move");
                    break;
                case 87:
                    this.player.director.nav(function () {
                        this.panAcceleration.y = 1
                    }.bind(this)), this.emit("move");
                    break;
                case 83:
                    this.player.director.nav(function () {
                        this.panAcceleration.y = -1
                    }.bind(this)), this.emit("move");
                    break;
                case 65:
                    this.player.director.nav(function () {
                        this.panAcceleration.x = -1
                    }.bind(this)), this.emit("move");
                    break;
                case 68:
                    this.player.director.nav(function () {
                        this.panAcceleration.x = 1
                    }.bind(this)), this.emit("move")
            }
        }, r.prototype.onKeyUp = function (e) {
            this.enabled !== !1 && this.noKeys !== !0 && this.noPan !== !0 && (e.preventDefault(), e.stopPropagation(), this.handleKeyUp(e.which))
        }, r.prototype.handleKeyUp = function (e) {
            switch (e) {
                case 73:
                case 75:
                case this.keys.UP:
                case this.keys.BOTTOM:
                    this.keyboardZoomSpeed = 0, this.rotationAcceleration.y = 0;
                    break;
                case 74:
                case 76:
                case this.keys.LEFT:
                case this.keys.RIGHT:
                    this.rotationAcceleration.x = 0;
                    break;
                case 83:
                case 87:
                    this.panAcceleration.y = 0;
                    break;
                case 65:
                case 68:
                    this.panAcceleration.x = 0
            }
        }, r.prototype.touchstart = function (e) {
            this.enabled !== !1 && (e.preventDefault(), e.stopPropagation(), this.player.director.nav(function () {
                switch (e.touches.length) {
                    case 1:
                        this.emit("touch-one-finger-start", e);
                        break;
                    case 2:
                        this.emit("touch-two-finger-start", e);
                        break;
                    default:
                        this.state = l.NONE
                }
                this.rotationSpeed.set(0, 0)
            }.bind(this)))
        }, r.prototype.touchmove = function (e) {
            if (this.enabled !== !1) {
                switch (e.preventDefault(), e.stopPropagation(), e.touches.length) {
                    case 1:
                        this.emit("touch-one-finger-move", e), this.update();
                        break;
                    case 2:
                        this.emit("touch-two-finger-move", e), this.update();
                        break;
                    default:
                        this.state = l.NONE
                }
                this.lastMoveTime = e.timeStamp
            }
        }, r.prototype.touchend = function (e) {
            this.enabled !== !1 && (this.emit("touch-one-finger-end", e), this.emit("touch-two-finger-end", e), this.state = l.NONE, e.timeStamp > this.lastMoveTime + 100 ? (this.rotationSpeed.set(0, 0), this.rotationAcceleration.set(0, 0)) : this.rotationAcceleration.set(-this.rotateDelta.x, this.rotateDelta.y), this.update(), this.rotationAcceleration.set(0, 0), this.rotateDelta.set(0, 0))
        }, r.prototype.pointerdown = function (e) {
            this.enabled !== !1 && "touch" === e.pointerType && (this.pointers.length < this.pointersLimit && this.pointers.push({
                id: e.pointerId,
                pageX: e.pageX,
                pageY: e.pageY
            }), e.touches = this.pointers, this.touchstart(e))
        }, r.prototype.pointermove = function (e) {
            this.enabled !== !1 && "touch" === e.pointerType && (this.pointers.forEach(function (t) {
                e.pointerId === t.id && (t.pageX = e.pageX, t.pageY = e.pageY)
            }), e.touches = this.pointers, this.touchmove(e))
        }, r.prototype.pointerup = function (e) {
            this.enabled !== !1 && "touch" === e.pointerType && (this.pointers.forEach(function (t, i) {
                e.pointerId === t.id && this.pointers.splice(i, 1)
            }.bind(this)), e.touches = this.pointers, this.touchend(e))
        }, r.prototype.reset = function () {
            this.state = l.NONE, this.target.copy(this.target0), this.object.position.copy(this.position0), this.pointers = [], this.update()
        }, r.prototype.stop = function () {
            this.rotationSpeed.set(0, 0), this.rotationAcceleration.set(0, 0), this.panSpeed.set(0, 0), this.panAcceleration.set(0, 0)
        }, r.touch = {
            rotate: {
                start: function (e) {
                    this.emit("move"), this.state = l.TOUCH_ROTATE, this.rotateStart.set(e.touches[0].pageX, e.touches[0].pageY)
                }, move: function (e) {
                    if (this.state === l.TOUCH_ROTATE) {
                        this.emit("move");
                        var t = this.domElement === document ? this.domElement.body : this.domElement;
                        this.rotateEnd.set(e.touches[0].pageX, e.touches[0].pageY), this.rotateDelta.subVectors(this.rotateEnd, this.rotateStart), this.rotateLeft(2 * Math.PI * this.rotateDelta.x / t.clientWidth * this.rotateSpeed), this.rotateUp(2 * Math.PI * this.rotateDelta.y / t.clientHeight * this.rotateSpeed), this.rotateStart.copy(this.rotateEnd)
                    }
                }
            }, zoom: {
                start: function (e) {
                    this.emit("move"), this.state = l.TOUCH_DOLLY_PAN;
                    var t = e.touches[0].pageX - e.touches[1].pageX, i = e.touches[0].pageY - e.touches[1].pageY, r = Math.sqrt(t * t + i * i);
                    this.dollyStart.set(0, r)
                }, move: function (e) {
                    if (this.state === l.TOUCH_DOLLY_PAN) {
                        var t = e.touches[0].pageX - e.touches[1].pageX, i = e.touches[0].pageY - e.touches[1].pageY, r = Math.sqrt(t * t + i * i);
                        this.dollyEnd.set(0, r), this.dollyDelta.subVectors(this.dollyEnd, this.dollyStart), this.dollyDelta.y > 0 ? this.dollyOut(1 - this.dollyDelta.y / 500) : this.dollyIn(1 + this.dollyDelta.y / 500), this.dollyStart.copy(this.dollyEnd)
                    }
                }
            }, pan: {
                start: function (e) {
                    this.emit("move"), this.state = l.TOUCH_DOLLY_PAN, this.panStart.set(a.average(e.touches, "pageX"), a.average(e.touches, "pageY"))
                }, move: function (e) {
                    this.state === l.TOUCH_DOLLY_PAN && (this.panEnd.set(a.average(e.touches, "pageX"), a.average(e.touches, "pageY")), this.panDelta.subVectors(this.panEnd, this.panStart), this.pan(this.panDelta.x, this.panDelta.y), this.panStart.copy(this.panEnd), this.rotateDelta.set(0, 0))
                }
            }
        }, t.exports = r
    }, {"../settings": 68, "../util/common": 75, events: 88, three: 138}],
    8: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t, i, r) {
                this.player = e, this.scene = r, this.object = t, this.object.controls = this, this.target = new n.Vector3(0, 0, 0), this.aimFrom = this.object.position, this.lookVector = new n.Vector3, this.domElement = void 0 !== i ? i : document.documentElement, this.lookSpeed = .05, this.rotationAcc = new n.Vector2, this.rotationSpeed = new n.Vector2, this.lat = 0, this.lon = 0, this.phi = 0, this.theta = 0, this.enabled = !0, this.pointer = new n.Vector3(0, 0, -1), this.rotationHistory = [], this.rotationDifference = new n.Vector2, this.pointerDragOn = !1, this.pointerDragStart = new n.Vector3(0, 0, -1), this.pinchDistance = 0, this.pointersLimit = 2, this.pointers = [], this.domElement !== document && this.domElement.setAttribute("tabindex", -1)
            }

            var n = e("three"), o = e("../util/logger"), a = e("../settings"), s = e("../util/common"), h = e("events").EventEmitter;
            new o(i);
            r.prototype = Object.create(h.prototype), r.prototype.bindEvents = function () {
                this.domElement.addEventListener("mousemove", this.onMouseMove.bind(this)), this.domElement.addEventListener("mousedown", this.onMouseDown.bind(this)), this.domElement.addEventListener("mouseup", this.onMouseUp.bind(this)), this.domElement.addEventListener("mouseover", function (e) {
                    !this.pointerDragOn || 0 !== e.which && 0 !== e.buttons || this.onMouseUp(e)
                }.bind(this)), this.domElement.addEventListener("touchstart", this.onTouchStart.bind(this)), this.domElement.addEventListener("touchmove", this.onTouchMove.bind(this)), this.domElement.addEventListener("touchend", this.onTouchEnd.bind(this)), this.domElement.addEventListener("mousewheel", this.onMouseWheel.bind(this)), this.domElement.addEventListener("DOMMouseScroll", this.onMouseWheel.bind(this)), this.domElement.addEventListener("contextmenu", function (e) {
                    e.preventDefault()
                }), this.domElement.addEventListener("pointerdown", this.onPointerDown.bind(this)), this.domElement.addEventListener("pointerup", this.onPointerUp.bind(this)), this.domElement.addEventListener("pointerout", this.onPointerUp.bind(this)), this.domElement.addEventListener("pointercancel", this.onPointerUp.bind(this)), this.domElement.addEventListener("pointermove", this.onPointerMove.bind(this)), document.addEventListener("keydown", this.onKeyDown.bind(this)), document.addEventListener("keyup", this.onKeyUp.bind(this))
            }, r.prototype.lookAt = function (e) {
                var t = this.object.position.clone().sub(e), i = Math.atan(t.z / t.x);
                i += t.x < 0 ? Math.PI : 0, i += t.x > 0 && t.z < 0 ? 2 * Math.PI : 0, this.lon = n.Math.radToDeg(i) + 180;
                var r = Math.sqrt(t.x * t.x + t.z * t.z), o = Math.atan(t.y / r);
                this.lat = -n.Math.radToDeg(o)
            }, r.prototype.startRotationFrom = function (e, t) {
                this.domElement !== document && this.domElement.focus(), this.updatePointer(e, t), this.pointerDragOn = !0, this.pointerDragStart.copy(this.pointer), this.pointerDragStartIntersect = this.player.getMouseIntersect(this.pointer.clone(), [this.scene.skybox]).point, this.rotationHistory = [], this.rotationSpeed.set(0, 0)
            }, r.prototype.onTouchStart = function (e) {
                this.enabled && (e.preventDefault(), e.stopPropagation(), this.emit("move"), this.player.director.nav(function () {
                    switch (e.touches.length) {
                        case 1:
                            this.startRotationFrom(e.touches[0].clientX, e.touches[0].clientY);
                            break;
                        case 2:
                            var t = (e.touches[0].clientX - e.touches[1].clientX) / window.innerWidth, i = (e.touches[0].clientY - e.touches[1].clientY) / window.innerHeight;
                            this.pinchDistance = Math.sqrt(t * t + i * i)
                    }
                }.bind(this)))
            }, r.prototype.onPointerDown = function (e) {
                this.enabled && "touch" === e.pointerType && (this.pointers.length < this.pointersLimit && this.pointers.push({
                    id: e.pointerId,
                    clientX: e.clientX,
                    clientY: e.clientY
                }), e.touches = this.pointers, this.onTouchStart(e))
            }, r.prototype.onMouseDown = function (e) {
                this.enabled && (e.preventDefault(), e.stopPropagation(), this.emit("move"), this.player.director.nav(function () {
                    switch (e.button) {
                        case 0:
                            this.startRotationFrom(e.clientX, e.clientY);
                            break;
                        case 2:
                    }
                }.bind(this)))
            }, r.prototype.updateRotation = function () {
                if (this.enabled && this.pointerDragOn) {
                    var e = this.player.getMouseIntersect(this.pointerDragStart.clone(), [this.scene.skybox]).point.sub(this.player.position), t = this.player.getMouseIntersect(this.pointer.clone(), [this.scene.skybox]).point.sub(this.player.position), i = Math.sqrt(e.x * e.x + e.z * e.z), r = Math.sqrt(t.x * t.x + t.z * t.z), o = Math.atan2(e.y, i), a = Math.atan2(t.y, r);
                    this.rotationDifference.y = n.Math.radToDeg(o - a), e.y = 0, t.y = 0;
                    var s = Math.acos(e.dot(t) / e.length() / t.length());
                    isNaN(s) || (this.rotationDifference.x = n.Math.radToDeg(s), this.pointerDragStart.x < this.pointer.x && (this.rotationDifference.x *= -1)), this.pointerDragStart.copy(this.pointer)
                }
            }, r.prototype.onMouseMove = function (e) {
                this.updatePointer(e.clientX, e.clientY)
            }, r.prototype.onTouchMove = function (e) {
                if (this.enabled)switch (this.emit("move"), e.touches.length) {
                    case 1:
                        this.updatePointer(e.touches[0].clientX, e.touches[0].clientY);
                        break;
                    case 2:
                        var t = (e.touches[0].clientX - e.touches[1].clientX) / window.innerWidth, i = (e.touches[0].clientY - e.touches[1].clientY) / window.innerHeight, r = this.pinchDistance - Math.sqrt(t * t + i * i);
                        Math.abs(r) > .1 && (this.emit("interaction.direct"), this.flyDirection(new n.Vector3(0, 0, r).normalize()), this.pinchDistance -= r)
                }
            }, r.prototype.onPointerMove = function (e) {
                this.enabled && "touch" === e.pointerType && (this.pointers.forEach(function (t) {
                    e.pointerId === t.id && (t.clientX = e.clientX, t.clientY = e.clientY)
                }), e.touches = this.pointers, this.onTouchMove(e))
            }, r.prototype.updatePointer = function (e, t) {
                this.pointer.x = e / window.innerWidth * 2 - 1, this.pointer.y = 2 * -(t / window.innerHeight) + 1
            }, r.prototype.endRotation = function () {
                if (this.pointerDragOn = !1, !this.player.flying) {
                    var e = s.averageVectors(this.rotationHistory);
                    this.rotationSpeed.set(e.x * a.rotationAfterMoveMultiplier, e.y * a.rotationAfterMoveMultiplier)
                }
            }, r.prototype.onTouchEnd = function (e) {
                this.enabled && (e.preventDefault(), e.stopPropagation(), this.endRotation())
            }, r.prototype.onMouseUp = function (e) {
                this.enabled && (e.preventDefault(), e.stopPropagation(), this.endRotation())
            }, r.prototype.onPointerUp = function (e) {
                this.enabled && "touch" === e.pointerType && (this.pointers.forEach(function (t, i) {
                    e.pointerId === t.id && this.pointers.splice(i, 1)
                }.bind(this)), e.touches = this.pointers, this.onTouchEnd(e))
            }, r.prototype.update = function (e, t) {
                if (this.enabled || t) {
                    this.lon, this.lat;
                    for (this.updateRotation(), this.rotationHistory.push(this.rotationDifference.clone()); this.rotationHistory.length > a.rotationAfterMoveHistoryCount;)this.rotationHistory.shift();
                    this.lon += this.rotationDifference.x, this.lat += this.rotationDifference.y, this.rotationDifference.set(0, 0), this.rotationSpeed.x = this.rotationSpeed.x * (1 - a.rotationFriction) + this.rotationAcc.x * a.rotationAccelerationInside,
                        this.rotationSpeed.y = this.rotationSpeed.y * (1 - a.rotationFriction) + this.rotationAcc.y * a.rotationAccelerationInside, this.lon += this.rotationSpeed.x * e, this.lat += this.rotationSpeed.y * e, this.lat = Math.max(a.insideLookLimitDown, Math.min(a.insideLookLimitUp, this.lat)), this.phi = n.Math.degToRad(90 - this.lat), this.theta = n.Math.degToRad(this.lon), this.lookVector.x = Math.sin(this.phi) * Math.cos(this.theta), this.lookVector.y = Math.cos(this.phi), this.lookVector.z = Math.sin(this.phi) * Math.sin(this.theta), this.target.copy(this.lookVector).add(this.aimFrom), this.object.lookAt(this.target)
                }
            }, r.prototype.onMouseWheel = function (e) {
                if (this.enabled) {
                    this.emit("move"), $("#debug-console").is(":visible") || e.preventDefault();
                    var t = 0;
                    void 0 !== e.wheelDelta ? t = e.wheelDelta : void 0 !== e.detail && (t = -e.detail), this.emit("interaction.direct"), this.player.director.nav(function () {
                        this.flyDirection(new n.Vector3(0, 0, -t).normalize())
                    }.bind(this))
                }
            }, r.prototype.onKeyDown = function (e) {
                this.enabled && (e.metaKey || e.ctrlKey || (e.preventDefault(), this.handleKeyDown(e.which)))
            }, r.prototype.handleKeyDown = function (e) {
                switch (this.emit("interaction.key"), e) {
                    case 38:
                    case 87:
                        this.player.director.nav(function () {
                            this.flyDirection(new n.Vector3(0, 0, -1))
                        }.bind(this)), this.emit("move");
                        break;
                    case 40:
                    case 83:
                        this.player.director.nav(function () {
                            this.flyDirection(new n.Vector3(0, 0, 1))
                        }.bind(this)), this.emit("move");
                        break;
                    case 65:
                        this.player.director.nav(function () {
                            this.flyDirection(new n.Vector3(-1, 0, 0))
                        }.bind(this)), this.emit("move");
                        break;
                    case 68:
                        this.player.director.nav(function () {
                            this.flyDirection(new n.Vector3(1, 0, 0))
                        }.bind(this)), this.emit("move");
                        break;
                    case 37:
                    case 74:
                        this.player.director.nav(function () {
                            this.rotationAcc.x = -1
                        }.bind(this)), this.emit("move");
                        break;
                    case 39:
                    case 76:
                        this.player.director.nav(function () {
                            this.rotationAcc.x = 1
                        }.bind(this)), this.emit("move");
                        break;
                    case 73:
                        this.player.director.nav(function () {
                            this.rotationAcc.y = 1
                        }.bind(this)), this.emit("move");
                        break;
                    case 75:
                        this.player.director.nav(function () {
                            this.rotationAcc.y = -1
                        }.bind(this)), this.emit("move")
                }
            }, r.prototype.onKeyUp = function (e) {
                this.enabled && (e.preventDefault(), e.stopPropagation(), this.handleKeyUp(e.which))
            }, r.prototype.handleKeyUp = function (e) {
                switch (e) {
                    case 37:
                    case 74:
                        this.rotationAcc.x = 0;
                        break;
                    case 39:
                    case 76:
                        this.rotationAcc.x = 0;
                        break;
                    case 73:
                        this.rotationAcc.y = 0;
                        break;
                    case 75:
                        this.rotationAcc.y = 0
                }
            }, r.prototype.reset = function () {
                this.stop()
            }, r.prototype.stop = function () {
                this.pointerDragOn = !1, this.rotationAcc.set(0, 0), this.rotationSpeed.set(0, 0), this.pointers = []
            }, r.prototype.flyDirection = function (e) {
                if (!this.player.flying) {
                    var t = this.player.getDirection(e), i = 1 === e.z ? .4 : .75, r = 1 === Math.abs(e.x);
                    this.player.flyDirection(t, i, r)
                }
            }, t.exports = r
        }).call(this, "/js/controls/PanoramaControls.js")
    }, {"../settings": 68, "../util/common": 75, "../util/logger": 78, events: 88, three: 138}],
    9: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e) {
                this.player = e, this.nItems = this.player.model.heroLocations.length, this.endlessLoop = a.warp.loop, this.clock = new n.Clock(!0), this.resetAll()
            }

            var n = e("three"), o = e("./util/logger"), a = e("./settings"), s = e("./util/transitions"), h = e("events").EventEmitter, l = e("./enum/Viewmode"), u = e("./analytics"), c = e("./enum/WarpStyle"), s = e("./util/transitions"), d = new o(i);
            r.prototype = Object.create(h.prototype), r.prototype.resetAll = function () {
                this.currentItem = null, this.destinationItem = null, this.userCmd = !1, this.tourIsPlaying = !1, this.isWarping = !1, this.waiting = !1, this.pendingHalt = !1, this.nextFunc = null, this.onTheBus = !1, this.randomThumbnail = !1, this.reachSource = null, this.player && this.player.model ? this.defaultWarpStyle = this.player.model.data.hasOwnProperty("player_options") && this.player.model.data.player_options && this.player.model.data.player_options.fast_transitions === !1 ? c.STD : c.BLACK : (this.defaultWarpStyle = c.BLACK, d.warn('No model yet, choosing "' + this.defaultWarpStyle + '" transitions')), this.resetSpecialTransition(), this.clock.getDelta()
            }, r.prototype.describe = function () {
                return {
                    nItems: this.nItems,
                    currentItem: this.currentItem,
                    destinationItem: this.destinationItem,
                    tourIsPlaying: this.tourIsPlaying,
                    isWarping: this.isWarping,
                    waiting: this.waiting,
                    pendingHalt: this.pendingHalt,
                    onTheBus: this.onTheBus,
                    endlessLoop: this.endlessLoop,
                    viewMode: this.player.mode,
                    inTransition: this._inTransition()
                }
            }, r.prototype._inTransition = function () {
                return this.player.flying || this.player.mode === l.TRANSITIONING || this.tourIsPlaying
            }, r.prototype.isIdle = function () {
                return !(this.waiting || this.pendingHalt)
            }, r.prototype.bounceable = function () {
                var e = this.clock.getDelta();
                return this.pendingHalt || .9 > e || this.player.flying && !this.isWarping
            }, r.prototype.playTour = function () {
                if (this.tourIsPlaying)return void d.info("tour is already playing");
                if (!this.bounceable()) {
                    if (this.isWarping)return d.debug("tour now starting"), void(this.tourIsPlaying = !0);
                    if (this.isAnInteruption("tour.play"))return void d.debug("tour.play interupt");
                    this.player.emit("tour_auto", this.defaultWarpStyle), this.reachSource = "play", this.userCmd = !0, this.tourIsPlaying = !0, this.resetSpecialTransition(), this.emit("update.controls"), this.goNext()
                }
            }, r.prototype.stopTour = function () {
                this.isAnInteruption("tour.stop") || (this.userCmd = !0, this.player.path.haltWarp(), this.tourIsPlaying = !1)
            }, r.prototype.goToHighlight = function (e) {
                if (d.debug("<tour.goto " + e + ">"), !this.bounceable()) {
                    if (this.randomThumbnail)return void d.debug("skipping goto inside goto");
                    if (this.isAnInteruption("tour.goto", e)) {
                        if (this.isWarping)return this.redirectToItem(e, "gotToHighlight"), void this.emit("update.controls");
                        d.debug("interupting burns move")
                    }
                    this.randomThumbnail = !0, this.userCmd = !0, this.useSpecialTransition("Hilight"), this.destinationItem = e;
                    var t = this.player.path.selectWarpLocation(e);
                    t ? (this.player.path.transType = this.nextWarpStyle, this.player.path.brushToWarpPano(), this.isWarping = !0, this.onTheBus = !0, this.emit("update.controls"), this.player.path.warpToPano(function () {
                        u.trackAlways("USER", {
                            event_type: "reach_highlight",
                            reach_source: "thumb"
                        }), this.currentItem = e, this.isWarping = !1, this.resetSpecialTransition(), this.player.path.discardPath(), this.actionComplete("_gthE")
                    }.bind(this))) : d.warn("you made a selection but didn't move!"), this.emit("update.controls")
                }
            }, r.prototype.prevHighlight = function () {
                if (!this.bounceable()) {
                    if (this.isAnInteruption("tour.prev"))return void this.redirectToItem(this.currentItem, "prevHighlight");
                    this.userCmd = !0, this.goPrev(), this.reachSource = "prev"
                }
            }, r.prototype.nextHighlight = function () {
                if (!this.bounceable()) {
                    if (this.player.emit("tour_manual", "next"), this.isAnInteruption("tour.next"))return void(this.isWarping && !this._inTransition() && s.start(function () {
                    }, 22, function () {
                        this.detourComplete("_anh")
                    }.bind(this), 0, null, "_anh"));
                    this.userCmd = !0, this.goNext(), this.reachSource = "next"
                }
            }, r.prototype.showPath = function (e) {
                var t = this.player.path.selectWarpLocation(e);
                t && this.player.path.brushToWarpPano()
            }, r.prototype.clearPath = function () {
                this._inTransition() || this.player.path.discardPath()
            }, r.prototype.changeMode = function (e, t) {
                var i = t || "gui", r = "nav." + e;
                switch (e) {
                    case l.PANORAMA:
                        if (this.player.controls[l.PANORAMA].emit("interaction." + i), this.isAnInteruption(r))return void this.player.insideMode(null, function () {
                            this.detourComplete(e)
                        }.bind(this));
                        this.player.insideMode();
                        break;
                    case l.DOLLHOUSE:
                        if (this.player.controls[l.PANORAMA].emit("interaction." + i), this.isAnInteruption(r))return void this.player.flyToNewMode(l.DOLLHOUSE, {
                            callback: function () {
                                this.detourComplete(e)
                            }.bind(this)
                        });
                        this.player.flyToNewMode(l.DOLLHOUSE);
                        break;
                    case l.FLOORPLAN:
                        if (this.player.controls[l.PANORAMA].emit("interaction." + i), this.isAnInteruption(r))return void this.player.flyToNewMode(l.FLOORPLAN, {
                            callback: function () {
                                this.detourComplete(e)
                            }.bind(this)
                        });
                        this.player.flyToNewMode(l.FLOORPLAN)
                }
            }, r.prototype.changeFloor = function (e, t) {
                this.player.controls[l.PANORAMA].emit("interaction." + e), this.player.gotoFloor(t)
            }, r.prototype.allFloors = function () {
                this.player.controls[l.PANORAMA].emit("interaction.gui"), this.player.model.toggleAllFloors()
            }, r.prototype.actionComplete = function (e) {
                var t = e || null;
                if (void 0 === t || null === t ? d.debug("<<actionComplete>>") : d.debug('<<actionComplete("' + t + '"")>>'), this.waiting = !1, this.randomThumbnail = !1, this.resetSpecialTransition(), this.isWarping = !1, this.userCmd = !1, this.pendingHalt = !1, null !== this.destinationItem && (this.currentItem = this.destinationItem), this.nextFunc) {
                    var i = this.nextFunc;
                    this.nextFunc = null, i()
                }
                this.emit("update.controls")
            }, r.prototype.detourComplete = function (e) {
                var t = e || null;
                return d.debug('<<detourComplete("' + t + '"")>>'), this.pendingHalt ? (this.pendingHalt = !1, this.tourIsPlaying = !1, void this.actionComplete("detourComplete" + t + ")")) : void this.actionComplete("haltless " + t)
            }, r.prototype.nav = function (e) {
                var t = e || null;
                return d.debug("<usernav>"), this.isWarping ? void d.debug("Cannot navigate while traveling") : (this.onTheBus = !1, this.isAnInteruption("usernav", t) ? void setTimeout(250, function () {
                    this.detourComplete("_dredy")
                }.bind(this)) : (t && t(), void this.emit("update.controls")))
            }, r.prototype.awaitCompletion = function (e, t) {
                this.nextFunc = t, t && (this.waiting = !0), this.onTheBus = !0, e()
            }, r.prototype.isAnInteruption = function () {
                return this.waiting ? (this.waiting = !1, this.nextFunc = null, this.tourIsPlaying = !1, this.pendingHalt && d.info("Already interrupted"), this.pendingHalt = !0, !0) : !1
            }, r.prototype.atDestinationPano = function () {
                if (!this.player.currentPano || null === this.destinationItem)return !1;
                var e = this.player.currentPano.id;
                if (void 0 === e)return !1;
                var t = this.player.model.heroLocations;
                return null !== this.destinationItem && void 0 !== t[this.destinationItem] && e == t[this.destinationItem].scan_id ? !0 : !1
            }, r.prototype.currentAimIsGood = function () {
                if (this.player.mode !== l.PANORAMA)return d.debug("no aim match except in " + l.PANORAMA + " mode"), !1;
                if (null === this.destinationItem)return !1;
                var e = this.player.model.heroLocations[this.destinationItem], t = this.player.model.panos.dict[e.scan_id];
                if (void 0 === t)return d.debug("aiming into different mode"), !1;
                var i = this.player.cameras[l.PANORAMA], r = new n.Vector3(0, 0, 1).applyQuaternion(e.quaternion).normalize(), o = new n.Vector3(0, 0, 1).applyQuaternion(i.quaternion).normalize(), s = o.dot(r);
                return s > Math.cos(n.Math.degToRad(a.warp.minRotation))
            }, r.prototype.jumpToHighlight = function (e) {
                s.start(function () {
                }, 22, function () {
                    this.detourComplete("_jmp2"), this.goToHighlight(e)
                }.bind(this), 0, null, "_jmp2")
            }, r.prototype.redirectToItem = function (e, t) {
                var i = (this.player.path.wPano, this.player.path.selectWarpLocation(e));
                if (!i)return void d.warn("redirectToItem(" + e + ',"' + t + '"): no such destination');
                if (d.debug("Redirecting to " + e + " via " + t), "" === this.player.path.warpDestination.scan_id)return this.destinationItem = e, this.isWarping = !0, void this.player.path.warpToNonPano(function () {
                    this.currentItem = e, this.isWarping = !1, this.detourComplete("_npo")
                }.bind(this));
                if (this.player.mode != l.PANORAMA)return this.destinationItem = e, this.isWarping = !0, this.player.reticule.hide(), void this.player.path.warpToPano(function () {
                    this.currentItem = e, this.isWarping = !1, this.detourComplete("_npi")
                }.bind(this));
                var r;
                if (e === this.currentItem)d.debug("Going back to " + e), this.player.flying ? (this.player.path.wPano = this.player.currentPano, this.player.path.brushToWarpPano(), r = this.player.path.chooseWarpPath(!0), this.player.model.setProjectedPanos(this.player.currentPano, this.player.path.wPano), this.destinationItem = this.currentItem) : this.jumpToHighlight(e); else {
                    if (this.isWarping && !this._inTransition())return void this.jumpToHighlight(e);
                    this.destinationItem = e, this.player.path.brushToWarpPano(), r = this.player.path.chooseWarpPath(!0), r ? this.player.model.setProjectedPanos(this.player.currentPano, this.player.path.wPano) : (d.info("redirectToItem(" + e + ',"' + t + '") path undefined, now ->  ' + this.currentItem), this.player.path.wPano = this.player.currentPano, this.player.path.brushToWarpPano(), r = this.player.path.chooseWarpPath(!0), this.player.model.setProjectedPanos(this.player.currentPano, this.player.path.wPano), this.destinationItem = this.currentItem), d.debug("redirectToItem(" + e + ',"' + t + '") to "' + this.player.path.warpDestination.name + '"')
                }
            }, r.prototype.useSpecialTransition = function (e) {
                void 0 !== e && this.defaultWarpStyle !== c.BLACK && d.debug("useSpecialTransition(): " + e), this.nextWarpStyle = c.BLACK
            }, r.prototype.resetSpecialTransition = function () {
                this.nextWarpStyle = this.defaultWarpStyle
            }, r.prototype.adjustAimOnly = function () {
                this.awaitCompletion(function () {
                    this.resetSpecialTransition(), this.isWarping = !0, this.player.aimTourCamera(this.destinationItem)
                }.bind(this), this.tourInterlude.bind(this))
            }, r.prototype.warpToDestination = function () {
                this.emit("update.controls"), this.awaitCompletion(function () {
                    this.player.path.transType = this.nextWarpStyle, this.isWarping = !0, this.player.reticule.hide(), this.player.warpTo(this.destinationItem), this.emit("update.controls")
                }.bind(this), this.tourInterlude.bind(this))
            }, r.prototype.tourInterlude = function () {
                return u.trackAlways("USER", {
                    event_type: "reach_highlight",
                    reach_source: this.reachSource
                }), null !== this.destinationItem && (this.currentItem = this.destinationItem), this.tourIsPlaying ? this.atEndOfTour() && !this.endlessLoop ? void this.endTour("interlude") : (this.emit("update.controls"), void this.awaitCompletion(function () {
                    this.player.tourInterlude()
                }.bind(this), function () {
                    this.goNext()
                }.bind(this))) : void this.emit("update.controls")
            }, r.prototype.atEndOfTour = function () {
                var e = this.currentItem >= this.nItems - 1;
                return e
            }, r.prototype.chooseFirstDestination = function () {
                this.destinationItem = this.nItems > 0 ? 0 : null
            }, r.prototype.chooseFinalDestination = function () {
                this.destinationItem = this.nItems > 0 ? this.nItems - 1 : null
            }, r.prototype.endTour = function (e) {
                d.debug('endTour("' + e + '")'), this.tourIsPlaying = !1, this.resetSpecialTransition(), this.emit("update.controls")
            }, r.prototype.goPrev = function () {
                null === this.currentItem || 0 === this.currentItem ? (this.chooseFinalDestination(), this.useSpecialTransition("reverse-looping to end")) : this.destinationItem -= 1, this.tourAdvance(-1)
            }, r.prototype.goNext = function () {
                var e = this.atEndOfTour();
                this.tourIsPlaying && e && (this.endlessLoop || this.userCmd || this.endTour("goNext() reached end")), null === this.currentItem || e ? (this.chooseFirstDestination(), e && this.useSpecialTransition("looping back to start")) : null === this.destinationItem ? this.chooseFirstDestination() : this.destinationItem += 1, this.tourAdvance(1)
            }, r.prototype.tourAdvance = function (e) {
                this.onTheBus = !0, d.debug("tourAdvance(" + e + ")"), this.atDestinationPano() ? (d.debug(">> Already on destination " + this.destinationItem + " (currentItem was " + this.currentItem + ")"), this.resetSpecialTransition(), this.currentItem = this.destinationItem, this.emit("update.controls"), this.randomThumbnail ? this.adjustAimOnly() : this.currentAimIsGood() ? (this.currentItem = this.destinationItem, 0 > e ? (d.debug("Skipping backward since we are already at the simple destination"), this.goPrev()) : (d.debug("Skipping ahead since we are already at the simple destination"), this.goNext())) : this.adjustAimOnly()) : (null === this.currentItem && (this.chooseFirstDestination(), this.useSpecialTransition("start of tour"), this.currentItem = this.destinationItem), this.warpToDestination(), this.emit("update.controls"))
            }, t.exports = r
        }).call(this, "/js/director.js")
    }, {
        "./analytics": 1,
        "./enum/Viewmode": 12,
        "./enum/WarpStyle": 13,
        "./settings": 68,
        "./util/logger": 78,
        "./util/transitions": 81,
        events: 88,
        three: 138
    }],
    10: [function (e, t, i) {
        "use strict";
        var r = e("three"), n = e("./enum/Viewmode"), o = (e("./settings"), e("./util/transitions")), a = new r.ShaderPass(r.HorizontalBlurShader), s = new r.ShaderPass(r.VerticalBlurShader);
        s.renderToScreen = !0;
        var h = window.innerWidth / window.innerHeight;
        isNaN(h) && (h = 1);
        var l = {
            currentBlur: 0, aspect: h, blurStrength: 1, init: function (e, t) {
                e.addPass(a), e.addPass(s), t.on("mode.changed", function (e, t) {
                    e === n.PANORAMA && (o.cancel(l.blur), o.cancel(l.addBlur), o.start(l.removeBlur, 500, null, 0, null, "deblur"))
                })
            }, blur: function (e) {
                l.currentBlur = e;
                var t = e * l.blurStrength;
                s.uniforms.v.value = t / 512 * l.aspect, a.uniforms.h.value = t / 512
            }, addBlur: function (e) {
                e = Math.max(e, l.currentBlur), l.blur(e)
            }, removeBlur: function (e) {
                e = Math.min(1 - e, l.currentBlur), l.blur(e)
            }
        };
        l.blur(0), t.exports = l
    }, {"./enum/Viewmode": 12, "./settings": 68, "./util/transitions": 81, three: 138}],
    11: [function (e, t, i) {
        "use strict";
        var r = e("three");
        t.exports = {
            newBlue: new r.Color(4967932),
            altBlue: new r.Color(47355),
            classicBlue: new r.Color(53759),
            mpYellow: new r.Color(16502016),
            mpOrange: new r.Color(16428055),
            mpBlue: new r.Color(12096),
            mpLtGrey: new r.Color(13751252),
            mpDkGrey: new r.Color(10000019),
            mpRed: new r.Color(12525854),
            mpOrangeDesat: new r.Color(16764529),
            mpBlueDesat: new r.Color(4034734),
            mpRedDesat: new r.Color(14705505),
            white: new r.Color(16777215),
            black: new r.Color(0),
            _desat: function (e, t) {
                var i = t || .3, n = (new r.Color).copy(e).getHSL();
                return (new r.Color).setHSL(n.h, n.s * (1 - i), n.l)
            },
            _darken: function (e, t) {
                var i = t || .2, n = (new r.Color).copy(e).getHSL();
                return (new r.Color).setHSL(n.h, n.s, n.l * (1 - i))
            }
        }
    }, {three: 138}],
    12: [function (e, t, i) {
        "use strict";
        t.exports = {
            PANORAMA: "panorama",
            DOLLHOUSE: "dollhouse",
            FLOORPLAN: "floorplan",
            TRANSITIONING: "transitioning",
            toInt: function (e) {
                switch (e) {
                    case this.PANORAMA:
                        return 1;
                    case this.DOLLHOUSE:
                        return 2;
                    case this.FLOORPLAN:
                        return 3;
                    case this.TRANSITIONING:
                        return -1
                }
                throw new Error("Unknown mode: " + e)
            },
            fromInt: function (e) {
                switch (e) {
                    case"1":
                    case 1:
                        return this.PANORAMA;
                    case"2":
                    case 2:
                        return this.DOLLHOUSE;
                    case"3":
                    case 3:
                        return this.FLOORPLAN
                }
                throw new Error("Unknown mode: " + e)
            },
            convertWorkshopModeInt: function (e) {
                switch (e) {
                    case"0":
                    case 0:
                        return this.PANORAMA;
                    case"1":
                    case 1:
                        return this.FLOORPLAN;
                    case"2":
                    case 2:
                        return this.DOLLHOUSE
                }
            }
        }
    }, {}],
    13: [function (e, t, i) {
        "use strict";
        t.exports = {BLACK: "black", STD: "std"}
    }, {}],
    14: [function (e, t, i) {
        "use strict";
        var r = {
            settings: {minimum: 1, initLoadAmt: 10, trickle: !0, trickleRate: 8, trickleSpeed: 200},
            status: 0,
            configure: function (e) {
                return $.extend(Settings, e), this
            },
            set: function (e) {
                var t = e, i = $("#bar");
                if (isNaN(t))return !1;
                var r = i.attr("r"), n = Math.PI * (2 * r);
                0 > t && (t = 0), t > 100 && (t = 100);
                var o = (100 - t) / 100 * n;
                o > 295.3 && (o = 295.3), 0 > o && (o = 0), i.css({strokeDashoffset: o}), $("#cont").attr("data-pct", t), this.status = e
            },
            isStarted: function () {
                return "number" == typeof this.status
            },
            start: function () {
                this.status || this.set(this.settings.initLoadAmt);
                var e = this;
                this.settings.trickle && (this.work = setInterval(function () {
                    if (null !== e.status) {
                        var t = Math.max(Math.random() * e.settings.trickleRate, e.settings.minimum);
                        e.inc(t)
                    }
                }, 800))
            },
            inc: function (e) {
                var t = this.status;
                this.set(Math.floor(t + e))
            },
            trickle: function () {
                return this.inc(Math.random() * this.settings.trickleRate)
            },
            done: function (e) {
                return e || this.status ? (this.settings.trickle = !1, this.status = null, clearInterval(this.work), this.set(100)) : this
            }
        };
        t.exports.circleLoader = r
    }, {}],
    15: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            function i() {
                w.linkToLocation = window.location.protocol + "//" + window.location.host + window.location.pathname + "?m=" + e.sid + "&start=" + t.serialize()
            }

            var r = new n.GUI, c = r.addFolder("Flydown from Dollhouse");
            c.add(u.flydown, "movementEasing", Object.keys(a)), c.add(u.flydown, "movementDelay", 0, 1).step(.01), c.add(u.flydown, "rotationEasing", Object.keys(a)), c.add(u.flydown, "rotationDelay", 0, 1).step(.01), c.add(u.flydown, "modelTextureDelay", 0, 1).step(.01), c.add(u.flydown, "skyboxDelay", 0, 1).step(.01);
            var d = r.addFolder("Transition between panos");
            d.add(u.transition, "blur", 0, 10).onFinishChange(function () {
            }), d.add(u.transition, "flySpeed", 0, 10).step(.01).onFinishChange(function () {
                u.transition.flyTime = 0, d.__controllers.forEach(function (e) {
                    e.updateDisplay()
                })
            }), d.add(u.transition, "flyTime", 0, 5e3).onFinishChange(function () {
                u.transition.flySpeed = 0, d.__controllers.forEach(function (e) {
                    e.updateDisplay()
                })
            }), d.add(u.transition, "movementEasing", Object.keys(a));
            var f = r.addFolder("Path Display");
            f.add(u.path, "opacity", 0, 1).step(.01).onFinishChange(function () {
            }), f.add(u.path, "height", 0, .2).step(.01).onFinishChange(function () {
            }), f.add(u.path, "outsideHeight", 0, 2).step(.01).onFinishChange(function () {
            }), f.add(u.path, "ribbonWidth", .01, .35).step(.01).onFinishChange(function () {
            }), f.add(u.path, "waypointRadius", .01, 1.2).step(.01).onFinishChange(function () {
            }), f.add(u.path, "waypointPulse", 0, 3600).step(20).onFinishChange(function () {
            }), f.add(u.path, "waypointIndoorRadius", .01, 1.2).step(.01).onFinishChange(function () {
            }), f.add(u.path, "fadeInTime", 0, 1200).step(10).onFinishChange(function () {
            }), f.add(u.path, "fadeOutTime", 0, 1200).step(10).onFinishChange(function () {
            }), f.add(u.path, "color", Object.keys(h)).onFinishChange(function () {
                u.path.color = h[u.path.color], u.path.colorUp = h.desat(u.path.color), u.path.colorDown = h.darken(u.path.color)
            }), f.add(u, "reticuleColor", Object.keys(h)).onFinishChange(function () {
                u.reticuleColor = h[u.reticuleColor], t.reticule.material.uniforms.color.value.set(u.reticuleColor)
            });
            var p = r.addFolder("Warp/Teleport");
            p.add(u.warp, "softPushDist", 0, 2).onFinishChange(function () {
            }), p.add(u.warp, "softPushEnd", 0, 1).step(.01).onFinishChange(function () {
            }), p.add(u.warp, "softBendAngle", 0, 45).onFinishChange(function () {
            }), p.add(u.warp, "softBendTilt", 0, 45).onFinishChange(function () {
            }), p.add(u.warp, "softBendEnd", 0, 1).step(.01).onFinishChange(function () {
            }), p.add(u.warp, "burnsAngle", 0, 30).onFinishChange(function () {
            }), p.add(u.path, "mapGuides").onFinishChange(function () {
            }), p.add(u.warp, "teleportTime", 0, 5e3).step(10).onFinishChange(function () {
            }), p.add(u.warp, "outsideTime", 0, 5e3).step(10).onFinishChange(function () {
            }), p.add(u.path, "typ", Object.keys(l)).onFinishChange(function () {
                u.path.typ = l[u.path.typ]
            }), p.add(u.warp, "tourStepDelay", 0, 1e4).step(100).onFinishChange(function () {
            }), p.add(u.warp, "loop").onChange(function () {
            }).onFinishChange(function () {
                t.director.endlessLoop = u.warp.loop
            });
            var m = r.addFolder("Long Warp Only");
            m.add(u.warp, "minWarpTime", 0, 5e3).step(10).onFinishChange(function () {
                u.warp.flySpeed = 0, m.__controllers.forEach(function (e) {
                    e.updateDisplay()
                })
            }), m.add(u.warp, "moveDelay", 0, 5e3).step(10).onFinishChange(function () {
            }), m.add(u.warp, "timePerMeter", 0, 5e3).step(10).onFinishChange(function () {
            }), m.add(u.warp, "lookAheadDist", .01, 4).step(.01).onFinishChange(function () {
            }), m.add(u.warp, "maxTurnPerSec", 0, 180).step(1).onFinishChange(function () {
            }), m.add(u.warp, "turnFriction", 0, 1).step(.01).onFinishChange(function () {
            });
            var g = r.addFolder("Warp Esoterica");
            g.add(u.warp, "nearPanoDist", .01, 12).step(0).onFinishChange(function () {
            }), g.add(u.warp, "blur", .01, 1).onFinishChange(function () {
            }), g.add(u.warp, "flySpeed", 0, 10).step(.01).onFinishChange(function () {
                u.warp.minWarpTime = 0, g.__controllers.forEach(function (e) {
                    e.updateDisplay()
                })
            }), g.add(u.warp, "showBunny").onFinishChange(function () {
            }), g.add(u.warp, "fastTime", 0, 2500).step(10).onFinishChange(function () {
            }), g.add(u.warp, "movementEasing", Object.keys(a));
            var v = r.addFolder("Misc");
            v.add(u, "dollhouseFOV", 10, 180).onChange(function () {
                t.controls[s.DOLLHOUSE].object.fov = u.dollhouseFOV
            }), v.add(u, "insideFOV", 10, 180).onChange(function () {
                t.controls[s.PANORAMA].object.fov = u.insideFOV
            }), v.add(u, "insideLookSpeed", .01, .3).step(.01).onChange(function () {
            }), v.add(u, "rotationAccelerationInside", .1, 10).step(.1).onChange(function () {
            }), v.add(u, "rotationAccelerationOutside", .1, 10).step(.1).onChange(function () {
            });
            var y = r.addFolder("Navigation");
            y.add(u.navigation, "panoScores").onFinishChange(function () {
                u.navigation.panoScores || e.panos.forEach(function (e) {
                    e.floor.remove(e.text3d), e.text3d = null
                })
            }), y.add(u.navigation, "mouseDirection"), y.add(u.navigation, "filterStrictness", 0, 1), y.add(u.navigation, "angleFactor", -60, 0), y.add(u.navigation, "directionFactor", 1, 20), y.add(u.navigation, "distanceFactor", -5, 5);
            var b = r.addFolder("Debug");
            b.add(u, "wireframe").onFinishChange(function () {
                e.chunks.forEach(function (t) {
                    t.material && (t.wireframeTwin || (t.wireframeTwin = new o.WireframeHelper(t), t.wireframeTwin.material.depthWrite = !1, t.wireframeTwin.material.depthTest = !1, t.wireframeTwin.material.opacity = .5, t.wireframeTwin.material.transparent = !0), u.wireframe ? e.add(t.wireframeTwin) : e.remove(t.wireframeTwin))
                })
            }), b.add(u, "skyboxWireframe").onFinishChange(function () {
                u.skyboxWireframe ? (e.skybox.wireframe = new o.WireframeHelper(e.skybox), e.add(e.skybox.wireframe)) : (e.skybox.remove(e.skybox.wireframe), e.skybox.wireframe = null)
            }), b.add(u, "showSweeps").onFinishChange(function () {
                e.panos.forEach(function (e) {
                    e.marker.visible = u.showSweeps
                })
            }), b.add(u, "showMesh").onFinishChange(function () {
                e.chunks.forEach(function (e) {
                    e.visible = u.showMesh
                })
            }), b.add(u, "showFloors").onFinishChange(function () {
                e.floorList.forEach(function (e) {
                    e.collider.children.forEach(function (e) {
                        e.visible = u.showFloors
                    })
                })
            }), b.add(u, "showSkyboxes").onFinishChange(function () {
                e.panos.forEach(function (e) {
                    e.mesh.visible = u.showSkyboxes
                })
            }), b.add(u, "showNeighbors").onChange(function () {
            }), b.add(u, "modelAlpha", 0, 1).listen().onChange(function () {
                e.changeModelAlpha(u.modelAlpha)
            }), setInterval(i, 500);
            var w = {};
            i(), r.add(w, "linkToLocation").listen()
        }

        var n = e("../lib/dat.gui"), o = e("three"), a = e("../util/easing"), s = e("../enum/Viewmode"), h = e("../enum/Colors"), l = e("../enum/WarpStyle"), u = e("../settings");
        t.exports.toggle = r
    }, {
        "../enum/Colors": 11,
        "../enum/Viewmode": 12,
        "../enum/WarpStyle": 13,
        "../lib/dat.gui": 22,
        "../settings": 68,
        "../util/easing": 76,
        three: 138
    }],
    16: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t, i, r) {
                $(".gui-error .error-problem-text").text(e), $(".gui-error .error-solution-text").text(t), $(".gui-error .error-explanation").text(i), $(".gui-error .error-actions").html(r), $(window).resize(), $(".gui-error").fadeIn(), $("#bottom-logo").fadeIn()
            }

            function n(e) {
                var t = ['<div class="browser-tiles">', '<div class="tile">', '<a href="https://www.google.com/chrome/browser/" target="_blank">', '<img class="icon" src="/resources/images/icon_Google_Chrome_2011.png" ', 'rel="tiletip" title="Chrome"></a>', "</div>", '<div class="tile">', '<a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">', '<img class="icon" src="/resources/images/icon_Mozilla_Firefox.png" ', 'rel="tiletip" title="Firefox"></a>', "</div>", '<div class="tile">', '<a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie" target="_blank">', '<img class="icon" src="/resources/images/icon_Internet_Explorer_10.png" ', 'rel="tiletip" title="InternetExplorer"></a>', "</div>", '<div class="tile">', '<a href="https://support.apple.com/en-us/HT204416" target="_blank">', '<img class="icon" src="/resources/images/icon_MacOSX_Safari.png" ', 'rel="tiletip" title="Safari"></a>', "</div>", "</div>"].join("");
                r(e, "Install a new browser to explorein3D.", "WebGL requires a modern browser.", t), s.isMobile() || $("[rel=tiletip]").tooltip({
                    placement: "bottom",
                    delay: {show: 50, hide: 0},
                    trigger: "hover",
                    viewport: {selector: "body", padding: 10}
                })
            }

            function o() {
                var e = s.isMobile() ? "" : '<span class="link install-browser">install a supported browser</span> or ', t = ["If the problem persists, ", e, '<a class="link" target="_blank" href=', d, ">see our troubleshooting guide</a>."].join("");
                r("Oops, something went wrong.", "Restart your browser.", "", t), s.isMobile() || $(".install-browser").on("click touchstart", function (e) {
                    e.preventDefault(), e.stopPropagation(), n(" ")
                })
            }

            function a(e) {
                if ($("head title").text(l.pageTitle), $("#gui-message, #gui-loading, #nprogress, #gui-thumb, #bottom-logo").hide(), $("#gui-loading").fadeOut(250), h.track("USER", {
                        event_type: "showcase_error",
                        error_key: e
                    }), "webgl-unsupported" === e)s.isMobile() ? o() : n("Browser not supported."); else if ("webgl-ios" === e)r("iOS version not supported.", "Upgrade to iOS 8 or higher to explorein3D.", "", "Tap <strong>Settings > General > SoftwareUpdate</strong>."); else if ("webgl-safari" === e)r("Enable WebGL to explore in3D.", "", "", "Click <strong>Preferences > Advanced > ShowDevelop menu</strong>. Then click <strong>Develop>EnableWebGL</strong>."); else if ("webgl-generic" === e)o(); else if ("missing-urls" === e)r("Oops, there are no panoramas forthismodel.", "", "This is an older model. The website owner may have a new model ontheway."); else if ("loading-failed" === e)r("Oops, model not available.", "", "", 'If the problem persists, <a class="link" target="_blank" href=' + d + ">see our troubleshooting guide</a>."); else {
                    if ("loading-failed-maintenance" !== e)return void c.error("Unhandled error: " + e);
                    r("Maintenance in progress.", "Please come back in a few minutes.")
                }
            }

            var s = e("./../util/browser"), h = e("./../analytics"), l = e("./../settings"), u = e("./../util/logger"), c = new u(i), d = '"https://matterportsupport.zendesk.com/hc/en-us/articles/208220058-Showcase-System-Requirements"';
            t.exports.error = a
        }).call(this, "/js/gui/error.js")
    }, {"./../analytics": 1, "./../settings": 68, "./../util/browser": 74, "./../util/logger": 78}],
    17: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r() {
                te = [], ie.upMode.visible && te.push("#gui-modes-map"), ie.floors.visible && te.push(".gui-floor", ".gui-floor-title"), te.push(".hideTarget", ".pinTop.right")
            }

            function n() {
                for (var e in ie)if (ie.hasOwnProperty(e)) {
                    var t = ie[e];
                    if (!t.visible)for (var i = 0; i < t.elements.length; i++)$(t.elements[i]).hide()
                }
                ie.highlight.visible && (j.addHighlightReelHelp(), $(".pinBottom").addClass("highlightExists")), ie.tourControls.visible === !1 ? $("#drawer").addClass("fullWidth") : j.addPlayHelp(), ie.upMode.visible === !0 && j.addDollhouseHelp(), ie.coBrand.visible || $("#gui-name").addClass("noCoBrand"), ie.titleContainer.visible || $(".pinTop.right").addClass("reposition"), r()
            }

            function o(e) {
                u(), $(".pinBottom").toggleClass("open"), $("#drawer").toggleClass("open"), $("#pullTab").find("span").toggle(), e || h("highlights")
            }

            function a() {
                $(window).height() < 400 && $("#drawer").hasClass("open") && o(!0)
            }

            function s() {
                $(window).height() < 400 && $("#meta-info").is(":visible") && g(!0)
            }

            function h(e) {
                function t() {
                    u.is(":visible") && (u.slideUp(250), $("#more-hint").toggle(), $("#less-hint").toggle())
                }

                function i() {
                    c.is(":visible") && c.fadeOut()
                }

                function r() {
                    d.is(":visible") && j.closeHelp()
                }

                function n() {
                    f.hasClass("open") && o(!0)
                }

                function h() {
                    p.is(":visible") && p.fadeOut()
                }

                function l() {
                    m.hasClass("open") && m.removeClass("open")
                }

                var u = $("#meta-info"), c = $("#terms-modal"), d = $(".nav-help-dialog"), f = $("#drawer"), p = $("#share-modal"), m = $(".gui-floor");
                $("#gui-modes-map");
                switch (e) {
                    case"info":
                        i(), r(), a(), h(), l();
                        break;
                    case"terms":
                        t(), r(), n(), h(), l();
                        break;
                    case"help":
                        t(), i(), n(), h(), l();
                        break;
                    case"highlights":
                        s(), i(), h(), l();
                        break;
                    case"share":
                        i(), l();
                        break;
                    case"floor":
                        i(), h();
                        break;
                    case"view":
                        l(), h(), i();
                        break;
                    case"tour":
                        i(), h(), l();
                        break;
                    case"move":
                        i(), h(), l();
                        break;
                    case"resize":
                        t(), a(), h(), l()
                }
            }

            function l(e) {
                "touchstart" === e.type && e.preventDefault(), e.stopPropagation()
            }

            function u() {
                F && (F.reload(), F.init())
            }

            function c(e) {
                $("#gui-loading").fadeIn(500, function () {
                    e(), $(this).css("display", "table")
                }), n(), $("body").addClass("player-active"), Y.start()
            }

            function d(e, i, r) {
                if (I != e && X.warn("Model mismatch in endLoading()"), B != i && X.warn("Director mismatch in endLoading()"), R != r && X.warn("Player mismatch in endLoading()"), t.exports.player = R, Y.done(), $("#gui-loading, #gui-thumb").fadeOut(2500), I.panos.length || $("#gui-modes-inside").remove(), I.floorList.length <= 1 || !ie.floors.visible ? ie.floors.visible = !1 : (_(I), I.on("floor.changed", x)), n(), $("#gui").fadeIn(1500), ie.highlight.visible && setTimeout(function () {
                        o(), setTimeout(o, 2e3)
                    }, 2e3), R.mode !== H.PANORAMA && L(e, R.mode), !z.isMobile())for (var a = ["a", "#title-toggle", ".next-button", ".prev-button", ".gui-floor", ".meta-toggle", ".thumbImg"], s = 0; s < a.length; s++)$(a[s]).addClass("hasHover")
            }

            function f() {
                $("#gui-spinner").stop(!0, !0).show()
            }

            function p() {
                $("#gui-spinner").fadeOut(1e3)
            }

            function m(e) {
                l(e), z.requestFullscreen($("body")[0]), W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_enter_fullscreen",
                    interaction_source: "gui"
                }), F.reload()
            }

            function g(e) {
                var t = $("#meta-info");
                "block" === t.css("display") ? W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "about_collapse"
                }) : "none" === $("#meta-info").css("display") && (W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "about_expand"
                }), h("info")), $(".pinTop.right").toggleClass("hideUnderMeta"), t.slideToggle(K), $("#more-hint").toggle(), $("#less-hint").toggle(), e || a()
            }

            function v() {
                X.info("gui endTour()"), y(), $("#pause").hide(), $("#play").show(), $(".pinBottom").removeClass("playing"), $("#drawer").removeClass("playing"), $("#playHead").removeClass("playing"), B.stopTour()
            }

            function y() {
                for (var e = $(te[0]), t = 1; t < te.length; t++)e = e.add(te[t]);
                e.removeClass("hidden")
            }

            function b() {
                return B.describe().inTransition
            }

            function w(e) {
                if (ie.share.visible) {
                    var t = 580, i = 420, r = "http://www.facebook.com/sharer.php?u=" + window.location + "&t=" + encodeURIComponent(e.data.name.toString()), n = "http://twitter.com/share?text=" + encodeURIComponent(e.data.name.toString()) + "&url=" + window.location + "&related=matterport";
                    $(".faceBookLink").on("mousedown touchstart", function (e) {
                        l(e);
                        var n = window.screenY + (window.innerHeight - i) / 2, o = window.screenX + (window.innerWidth - t) / 2, a = "top=" + n + ",left=" + o + ",width=" + t + ",height=" + i;
                        window.open(r, "fbshare", a)
                    }), $(".twitterLink").on("mousedown touchstart", function (e) {
                        l(e);
                        var r = window.screenY + (window.innerHeight - i) / 2, o = window.screenX + (window.innerWidth - t) / 2, a = "top=" + r + ",left=" + o + ",width=" + t + ",height=" + i;
                        window.open(n, "twitshare", a)
                    }), $("#shareUrl").val(window.location), $(".shareTextLink").on("mousedown touchstart", function (e) {
                        l(e), $("#share-modal").fadeIn(400)
                    }), $("#share-close").on("mousedown touchstart", function (e) {
                        l(e), $("#share-modal").fadeOut()
                    }), $(".socialButton").find("a").on("mousedown touchstart", function (e) {
                        l(e), $(".socialButton").toggleClass("active"), $(".bottomShare").toggle()
                    })
                }
            }

            function _(e) {
                ee = e.floorNames();
                for (var t = $(".gui-floor"), i = 0; i < ee.length; i++) {
                    var r = $('<div class="floorChoice" data-index="' + i + '"></div>').text(ee[i]);
                    $(".gui-floor").find(".container").prepend(r)
                }
                t.find(".container").prepend('<div class="floorChoice darkGlass allFloorBtn" data-index="all" style="display:none">All</div>'), t.on("mousedown touchstart", function (e) {
                    l(e), h("floor"), t.toggleClass("open")
                }), $(".floorChoice").on("mousedown touchstart", function (i) {
                    l(i);
                    var r = $(this).data("index");
                    "all" !== r ? (B.changeFloor("gui", r), W.track("USER", {
                        event_type: "showcase_gui",
                        gui_action: "click_floor_select_button",
                        interaction_source: "gui"
                    })) : (B.allFloors(), x(e.currentFloor, "gui"), W.track("USER", {
                        event_type: "showcase_gui",
                        gui_action: "click_toggle_all_floors_button",
                        interaction_source: "gui"
                    })), t.toggleClass("open")
                })
            }

            function x(e, t) {
                e && void 0 !== e && (t = t || R.mode, t === H.DOLLHOUSE || t === H.FLOORPLAN ? $(".allFloorBtn").show() : $(".allFloorBtn").hide(), e.model.allFloorsVisible ? ($(".gui-floor-title").text("All"), $(".floorChoice").removeClass("active"), $('.floorChoice[data-index="all"]').addClass("active")) : ($(".gui-floor-title").text(ee[e.floorIndex]), $(".floorChoice").removeClass("active"), $(".floorChoice[data-index=" + e.floorIndex + "]").addClass("active")))
            }

            function S(e) {
                $("<img/>").attr("src", e).on("load", function () {
                    I || ($("#gui-thumb").css("backgroundImage", "url(" + e + ")").fadeIn(500), $("#gui-loading").addClass("use-background")), $(this).remove()
                })
            }

            function E(e) {
                Q = e.heroLocations.length;
                var t = '<li class="thumbImg" data-index=""><img src=""></li>', i = 100 / Q + "%";
                $("#status").find(".totalSteps").text(Q);
                for (var r = 0; Q > r; r++) {
                    var n = $(t);
                    if (n.attr("data-index", r), n.find("img").attr("src", e.heroLocations[r].thumb), e.heroLocations[r].name) {
                        var o = $('<div class="overlay"></div>').text(e.heroLocations[r].name);
                        n.prepend(o)
                    }
                    $("#thumb-container").append(n), $("#progressBar").append('<div class="step" data-idx="' + r + '" style="width:' + i + '"></div>')
                }
                D = 144 * Q, O = 111 * Q, $(".thumbImg").on("mouseover", function () {
                    b() || B.showPath($(this).data("index"))
                }), $(".thumbImg").on("mouseout", function () {
                    B.clearPath()
                });
                $(".thumbImg").on("click", function (e) {
                    l(e);
                    var t = $(this);
                    W.trackAlways("USER", {
                        event_type: "showcase_gui",
                        gui_action: "click_highlight"
                    }), B.goToHighlight(t.data("index"))
                }), $(".previous").find("a").on("mousedown touchstart", function (e) {
                    l(e), W.trackAlways("USER", {
                        event_type: "showcase_gui",
                        gui_action: "prev_highlight"
                    }), B.prevHighlight()
                }), $(".next").find("a").on("mousedown touchstart", function (e) {
                    l(e), W.trackAlways("USER", {
                        event_type: "showcase_gui",
                        gui_action: "next_highlight"
                    }), B.nextHighlight()
                }), $("#drawer").on("mouseleave", function (e) {
                    l(e);
                    var t = new MouseEvent("mouseup", {
                        clientX: e.clientX,
                        clientY: e.clientY,
                        screenX: e.screenX,
                        screenY: e.screenY
                    });
                    document.dispatchEvent(t)
                }), F = new Sly($("#scrollFrame"), {
                    horizontal: !0,
                    itemNav: "centered",
                    smart: !0,
                    scrollTrap: !0,
                    scrollBy: 1,
                    mouseDragging: !0,
                    touchDragging: !0,
                    speed: 300,
                    dragHandle: !0,
                    dynamicHandle: !0,
                    clickBar: !0,
                    scrollBar: $("#scroller"),
                    activateOn: null
                }).init(), F.on("active", function (e, t) {
                    J = t, h("tour"), $(".step").removeClass("active"), $("#status").find(".curIdx").text(t + 1);
                    for (var i = 0; t >= i; i++)$("#progressBar").find("[data-idx='" + i + "']").addClass("active")
                }), M()
            }

            function M() {
                var e;
                e = "undefined" != typeof window.innerWidth ? window.innerWidth : "undefined" != typeof document.documentElement && "undefined" != typeof document.documentElement.clientWidth && 0 !== document.documentElement.clientWidth ? document.documentElement.clientWidth : document.getElementsByTagName("body")[0].clientWidth;
                var t = e - 20, i = $("#scroller"), r = $("#scrollFrame");
                488 > e ? t >= O ? (i.addClass("hidden"), r.addClass("noScroll")) : (i.removeClass("hidden"), r.removeClass("noScroll")) : t >= D ? (i.addClass("hidden"), r.addClass("noScroll")) : (i.removeClass("hidden"), r.removeClass("noScroll"))
            }

            function A(e) {
                var t = function (e, t) {
                    ie[e].visible = t
                };
                t("address", e.address), t("email", e.contact_email), t("contactName", e.contact_name), t("phone", e.contact_phone), t("titleContainer", e.model_name), t("description", e.model_summary), t("coBrand", e.presented_by), t("highlight", e.highlight_reel), t("url", e.external_url), t("tourControls", e.tour_buttons)
            }

            function T(e) {
                $(".model-title").text(e.name);
                var t = $(".titleText");
                if (t.text(e.name), e.name.length > 19 && t.attr("title", e.name), $("head title").text(e.name + " - " + V.pageTitle), z.isMobile() ? $("#gui-fullscreen").css("display", "none") : $("[rel=tooltip]").tooltip({
                        delay: {
                            show: 50,
                            hide: 0
                        }, trigger: "hover", html: !1, viewport: {selector: "body", padding: 10}
                    }), ie.coBrand.visible && e.hasOwnProperty("presented_by") && e.presented_by ? ($("#cobrandTitle").text(e.presented_by), $("#loaderCoBrandName").text(e.presented_by)) : ie.coBrand.visible = !1, ie.description.visible && e.hasOwnProperty("summary") && e.summary ? $("#meta-description").text(e.summary) : ie.description.visible = !1, ie.contact.visible) {
                    var i = [], r = !0, n = function (e, t) {
                        var n = t || "<br>";
                        r && (n = "", r = !1), i.push(n, e)
                    };
                    if (ie.contactName.visible && e.hasOwnProperty("contact_name") && e.contact_name && ($("#contact-data").append('<span id="contactName"></span>').text(e.contact_name), r = !1), ie.phone.visible && e.hasOwnProperty("contact_phone") && e.contact_phone) {
                        var o = e.contact_phone;
                        e.formatted_contact_phone && (o = e.formatted_contact_phone), n(z.isMobile() ? '<a id="phone" href="callto:' + e.contact_phone + '">' + o + "</a>" : "<span>" + o + "</span>")
                    }
                    ie.email.visible && e.hasOwnProperty("contact_email") && e.contact_email && n('<a id="email" href="mailTo:' + e.contact_email + '">' + e.contact_email + "</a>"), ie.url.visible && e.hasOwnProperty("external_url") && e.external_url && n('<a id="url" target="blank" href="' + e.external_url + '">' + e.external_url + "</a>"), r ? ie.contact.visible = !1 : $("#contact-data").append(i.join(""))
                }
                if (ie.address.visible && e.hasOwnProperty("address") && e.address) {
                    var a = [], s = JSON.parse(e.address), h = !1, u = !0, c = function (e, t) {
                        var i = t || " ";
                        u && (i = "", u = !1), a.push(i, e)
                    };
                    if (s.address_1 && c(s.address_1), s.address_2 && c(s.address_2), s.city && c(s.city, ", "), s.state && (h = !0, c(s.state, ", ")), s.zip) {
                        var d = ", ";
                        h && (d = " "), c(s.zip, d)
                    }
                    u ? ie.address.visible = !1 : $("#addressTxt").text(a.join(""))
                } else ie.address.visible = !1;
                ie.address.visible || ie.contact.visible || ie.description.visible ? ($(".meta-toggle").on("mousedown touchstart", function (e) {
                    l(e), g()
                }), $("#meta-description").find("a").on("mousedown touchstart", function (e) {
                    W.trackAlways("USER", {event_type: "about_link"})
                }), $(".contact-info a").on("mousedown touchstart", function (e) {
                    var t = {event_type: "about_link"};
                    switch ($(this).attr("id")) {
                        case"phone":
                            t.contact_type = "phone";
                            break;
                        case"email":
                            t.contact_type = "email"
                    }
                    W.trackAlways("USER", t)
                }), $(".address a").on("mousedown touchstart", function (e) {
                    W.trackAlways("USER", {event_type: "map_link"})
                })) : ($(".title-container").removeClass("meta-toggle"), ie.metaInfo.visible = !1)
            }

            function C(e, t) {
                e.data.player_options && A(e.data.player_options), V.brand || (ie.coBrand.visible = !1, ie.contact.visible = !1), T(e.data), e.data.image && S(e.data.image), V.autoplay ? (W.impression(!0), c(t), k()) : ($("#gui-message").fadeIn(250, function () {
                    $(this).css("display", "table");
                    var e = $("#gui-message").fracs().visible >= .5;
                    W.impression(e)
                }), $("#button-play").on("mousedown touchstart", function (e) {
                    return l(e), z.inIframe() && z.isMobile() ? void(top.location.href = self.location.href) : ($("#gui-message").fadeOut(500, function () {
                        c(t)
                    }), void k())
                }))
            }

            function P(e, t, i) {
                I = e, B = t, R = i, R !== B.player && X.warn("Player/Director mismatch in gui.init()"), I.outsideAllowed() || (ie.upMode.visible = !1), Z.init(I), w(I), I.heroLocations.length > 1 ? E(I) : (ie.highlight.visible = !1, ie.tourControls.visible = !1), I.on("floor.changed", x), I.on("waiting", f), I.on("waiting-done", p), R.on("mode.changed", function (e, t) {
                    L(I, t)
                }), R.on("mode.changing", function (e, t) {
                    $(".nav-help-dialog").is(":visible") && j.navHelpModeChange(e, t)
                }), R.controls[H.PANORAMA].on("move", function () {
                    h("move")
                }), R.controls[H.DOLLHOUSE].on("move", function () {
                    h("move")
                }), R.controls[H.FLOORPLAN].on("move", function () {
                    h("move")
                }), B.on("update.controls", function () {
                    var t = B.describe();
                    ie.tourControls.visible && (t.tourIsPlaying || t.isWarping ? ($("#play").hide(), $("#pause").show(), t.tourIsPlaying && ($(".pinBottom").addClass("playing"), $("#drawer").addClass("playing"), $("#playHead").addClass("playing"))) : ($("#play").show(), $("#pause").hide(), $(".pinBottom").removeClass("playing"), $("#drawer").removeClass("playing"), $("#playHead").removeClass("playing"))), x(I.currentFloor);
                    var i, r, n, o = $("#progressBar"), a = $("#thumb-container");
                    if (null !== t.currentItem) {
                        var s, h;
                        $("#status").find(".curIdx").text(t.currentItem + 1), t.onTheBus ? (s = "active", h = "recent") : (h = "active", s = "recent");
                        var l = null === t.destinationItem || t.currentItem === t.destinationItem;
                        for (i = 0; i < e.heroLocations.length; i += 1)n = a.find("[data-index='" + i + "']"), r = o.find("[data-idx='" + i + "']"), n.removeClass(h), r.removeClass(h), i === t.destinationItem ? (n.addClass(s), r.addClass(s), F.activate(i)) : l && i === t.currentItem ? (n.addClass(s), r.addClass(s)) : (n.removeClass(s), r.removeClass(s))
                    } else for (i = 0; i < e.heroLocations.length; i += 1)n = a.find("[data-index='" + i + "']"), r = o.find("[data-idx='" + i + "']"), n.removeClass("active"), n.removeClass("recent"), r.removeClass("active"), r.removeClass("recent")
                }), document.addEventListener("keydown", function (e) {
                    switch (e.which) {
                        case 48:
                            V.debug && (V.modelAlpha < 1 ? V.modelAlpha = 1 : V.modelAlpha = 0, I.changeModelAlpha(V.modelAlpha));
                            break;
                        case 49:
                            B.player.isInMode(H.PANORAMA, H.TRANSITIONING) || B.changeMode(H.PANORAMA, "key");
                            break;
                        case 50:
                            ie.upMode.visible && !B.player.isInMode(H.DOLLHOUSE, H.TRANSITIONING) && (B.changeMode(H.DOLLHOUSE, "key"), x(I.currentFloor));
                            break;
                        case 51:
                            ie.upMode.visible && !B.player.isInMode(H.FLOORPLAN, H.TRANSITIONING) && B.changeMode(H.FLOORPLAN, "key");
                            break;
                        case 32:
                            V.debug && I.toggleExplode();
                            break;
                        case 13:
                            V.debug && I.toggleExplodeUp()
                    }
                    return B.player && B.player.reticule.hide(), !0
                }.bind(this))
            }

            function L(e, t) {
                x(e.currentFloor, t);
                var i = function () {
                    $("#view-controllers").is(":visible") || $("#view-controllers").slideDown(K)
                };
                t === H.DOLLHOUSE ? (p(), $("#gui-modes-dollhouse").toggleClass("active", t === H.DOLLHOUSE), $("#gui-modes-floorplan").toggleClass("active", t === H.FLOORPLAN), q = H.DOLLHOUSE, i(), $("#gui-modes-map").addClass("active")) : t === H.FLOORPLAN ? (p(), $("#gui-modes-dollhouse").toggleClass("active", t === H.DOLLHOUSE), $("#gui-modes-floorplan").toggleClass("active", t === H.FLOORPLAN), q = H.FLOORPLAN, i(), $("#gui-modes-map").addClass("active")) : "transitioning" !== t && ($("#view-controllers").slideUp(500), $("#gui-modes-map").removeClass("active", t === H.PANORAMA))
            }

            function k() {
                $("body").css("touch-action", "none"), $("#gui-parent").find("*").on("touchmove", function (e) {
                    e.preventDefault()
                }), $("#terms-text").off("touchmove").on("touchmove", function (e) {
                    e.stopPropagation()
                })
            }

            var B, R, I, F, D, O, N, U, z = (e("./../util/common"), e("./../util/browser")), V = e("./../settings"), W = e("./../analytics"), H = (e("./../objects/Model"), e("./../enum/Viewmode")), G = e("./../util/logger"), j = (e("./../util/lerp"), e("./../util/easing"), e("./../util/transitions"), e("./help")), Y = e("./circleLoader").circleLoader, Z = e("./konami"), X = new G(i), q = H.DOLLHOUSE, K = 250, Q = 0, J = 0, ee = [], te = [".hideTarget"], ie = {
                titleContainer: {
                    visible: !0,
                    elements: ["#model-title"]
                },
                coBrand: {visible: !0, elements: [".co-brand", "#loaderCoBrand"]},
                metaInfo: {visible: !0, elements: ["#meta-info", "#more-hint", "#less-hint"]},
                description: {visible: !0, elements: ["#meta-description"]},
                contact: {visible: !0, elements: [".contact-info"]},
                email: {visible: !0, elements: ["#email"]},
                address: {visible: !0, elements: [".address"]},
                phone: {visible: !0, elements: ["#phone"]},
                contactName: {visible: !0, elements: ["#contactName"]},
                url: {visible: !0, elements: ["#url"]},
                help: {visible: !0, elements: [".nav-help", "#nav-help"]},
                tourControls: {visible: !0, elements: [".next", ".previous", "#play"]},
                upMode: {visible: !0, elements: ["#gui-modes-map"]},
                highlight: {visible: !0, elements: ["#drawer", "#pullTab"]},
                share: {visible: !0, elements: [".socialButton", "#share"]},
                fullScreen: {visible: !0, elements: ["#gui-fullscreen"]},
                floors: {visible: !0, elements: [".gui-floor"]}
            };
            $(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange", function (e) {
                $("#gui-fullscreen").toggle(!z.isFullscreen()), $("#gui-fullscreen-exit").toggle(!!z.isFullscreen()), setTimeout(function () {
                    $(".icon:visible").hide().show(0)
                }, 100)
            }), z.detectIE() ? $("#gui-fullscreen").find("a").on("mouseup", m) : $("#gui-fullscreen").find("a").on("mousedown touchstart", m), $("#gui-fullscreen-exit").find("a").on("mousedown touchstart", function (e) {
                l(e), z.exitFullscreen(), W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_exit_fullscreen",
                    interaction_source: "gui"
                })
            }), $(window).on("resize", function (e) {
                var t = e.target.innerHeight, i = e.target.innerWidth;
                (t !== N || i !== U) && (ie.highlight.visible && M(), h("resize"), $(".pinTop.right").removeClass("hideUnderMeta"), u(), N = t, U = i)
            }).resize(), z.supportsFullscreen() || $("#gui-fullscreen").hide(), $("#title-toggle").on("mousedown touchstart", function (e) {
                function t() {
                    i && n.toggleClass("closed")
                }

                l(e);
                var i, r = $(".title-container"), n = $("#model-title");
                $("#title-toggle").find("i").toggleClass("icon-dpad-left icon-dpad-right"), $(".pinTop.right").toggleClass("reposition"), "none" === r.css("display") ? (W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "about_show"
                }), i = !1) : (W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "about_hide"
                }), i = !0), i || n.toggleClass("closed"), $("#meta-info").is(":visible") ? (g(), $(".title-container").animate({opacity: 1}, K).animate({width: "toggle"}, {
                    duration: K,
                    complete: t
                })) : $(".title-container").animate({width: "toggle"}, {duration: K, complete: t})
            }), $("#gui-modes-map").find("a").on("mousedown touchstart", function (e) {
                l(e), R.mode === H.DOLLHOUSE || R.mode === H.FLOORPLAN ? (W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_inside_mode_button"
                }), B.changeMode(H.PANORAMA, "gui")) : (W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_outside_mode_button"
                }), B.changeMode(q, "gui"))
            }), $("#gui-modes-floorplan").on("mousedown touchstart", function (e) {
                l(e), R.mode !== H.FLOORPLAN && (W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_floorplan_mode_button"
                }), B.changeMode(H.FLOORPLAN))
            }), $("#gui-modes-dollhouse").on("mousedown touchstart", function (e) {
                l(e), R.mode !== H.DOLLHOUSE && (W.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "click_dollhouse_mode_button"
                }), B.changeMode(H.DOLLHOUSE))
            }), $("#pullTab").on("mousedown touchstart", function (e) {
                l(e), $("#drawer").hasClass("open") ? W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "hide_highlight_reel"
                }) : W.trackAlways("USER", {event_type: "showcase_gui", gui_action: "show_highlight_reel"}), o()
            }), $("#more-menu-button").on("mousedown touchstart", function (e) {
                l(e);
                var t = $("#more-menu");
                t.toggleClass("open")
            }), $("#play").find("a").on("mousedown touchstart", function (e) {
                l(e), h("tour"), B.playTour(), W.trackAlways("USER", {
                    event_type: "showcase_gui",
                    gui_action: "play_highlights"
                })
            }), $("#pause").find("a").on("mousedown touchstart", function (e) {
                l(e), B.stopTour(), W.trackAlways("USER", {event_type: "showcase_gui", gui_action: "pause_highlights"})
            }), $(".shareContainer > div.icoContainer > a").on("mousedown touchstart", function (e) {
                l(e), h("share");
                var t = {event_type: "showcase_gui", gui_action: "share"};
                switch ($(this).attr("class")) {
                    case"faceBookLink":
                        t.site = "facebook";
                        break;
                    case"twitterLink":
                        t.site = "twitter";
                        break;
                    case"shareTextLink":
                        t.site = "link";
                        break;
                    default:
                        return
                }
                W.trackAlways("USER", t)
            }), $(".terms").on("mousedown touchstart", function (e) {
                l(e), h("terms"), $.ajax("static/terms.html").done(function (e) {
                    $("#terms-text").html(e), W.track("USER", {
                        event_type: "showcase_gui",
                        gui_action: "click_terms_button",
                        interaction_source: "gui"
                    })
                }).fail(function () {
                	 $('#terms-text').html($("#termsContent").html())
                }), $("#terms-modal").fadeIn(K)
            }), $("#terms-modal .btn").on("mousedown touchstart", function (e) {
                l(e), $("#terms-modal").fadeOut(K)
            }), $(".icon").on("mouseover", function () {
                R && R.reticule.hide()
            }), t.exports.init = P, t.exports.startLoading = c, t.exports.coverScreen = C, t.exports.endLoading = d, t.exports.endTour = v, t.exports.paneControl = h
        }).call(this, "/js/gui/gui.js")
    }, {
        "./../analytics": 1,
        "./../enum/Viewmode": 12,
        "./../objects/Model": 60,
        "./../settings": 68,
        "./../util/browser": 74,
        "./../util/common": 75,
        "./../util/easing": 76,
        "./../util/lerp": 77,
        "./../util/logger": 78,
        "./../util/transitions": 81,
        "./circleLoader": 14,
        "./help": 18,
        "./konami": 19
    }],
    18: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t) {
                var i = p.isMobile() ? _[e] : w[e];
                if (i) {
                    var o = $(".nav-help-elements"), a = o.find(".prev-button"), s = o.find(".next-button"), h = i.length / 2;
                    if (!(1 > t || t > h)) {
                        var l = i[2 * t - 1], u = '<img class="icon" src="/resources/images/' + l + '" title="navigation icon">';
                        o.find(".nav-icon").html(u);
                        var c = i[2 * t - 2];
                        o.find(".nav-text").text(c), o.find(".page-count").text(t + " / " + h), x = t, $(".nav-help-dialog .close").off().on("mouseup touchend", function (e) {
                            e.preventDefault(), e.stopImmediatePropagation(), d.track("USER", {
                                event_type: "showcase_gui",
                                gui_action: "help_close"
                            }), n()
                        }), a.off(), 1 === t ? a.hide() : a.show().on("mouseup touchend", function (e) {
                            e.preventDefault(), e.stopImmediatePropagation(), d.track("USER", {
                                event_type: "showcase_gui",
                                gui_action: "help_prev"
                            }), r(m.player.mode, --t)
                        }), s.off(), t === h ? $(".nav-help-elements .next-button").text("").on("mouseup touchend", function (e) {
                            e.preventDefault(), e.stopImmediatePropagation(), d.track("USER", {
                                event_type: "showcase_gui",
                                gui_action: "help_done"
                            }), n()
                        }) : s.text("").on("mouseup touchend", function (e) {
                            e.preventDefault(), e.stopImmediatePropagation(), d.track("USER", {
                                event_type: "showcase_gui",
                                gui_action: "help_next"
                            }), r(m.player.mode, ++t)
                        }), $(window).resize(), $(".nav-help-dialog").fadeIn()
                    }
                }
            }

            function n() {
                var e = $(".nav-help-dialog");
                e.fadeOut(1e3), x = 0
            }

            function o() {
                var e;
                try {
                    e = window.localStorage.getItem("visitCount") || "0", e = (parseFloat(e) + 1).toString(), window.localStorage.setItem("visitCount", e), g.debug("visitCount = " + e)
                } catch (t) {
                    e = "1"
                }
                (null === f.autohelp && "1" === e || "1" === f.autohelp) && setTimeout(function () {
                    r(m.player.mode, 1)
                }, 5e3)
            }

            function a() {
                y || (y = !0, w[c.PANORAMA].splice(4, 0, "", "Nav_Help_Play.png"), _[c.PANORAMA].splice(4, 0, "", "Nav_Help_Touch_Play.png"))
            }

            function s() {
                v || (v = !0, w[c.PANORAMA].splice(4, 0, "''", "Nav_Help_Highlights.png"), _[c.PANORAMA].splice(4, 0, "''", "Nav_Help_Touch_Highlights.png"))
            }

            function h() {
                b || (b = !0, w[c.PANORAMA].push("''", "Nav_Help_New_dollhouse.png"), _[c.PANORAMA].push("''", "Nav_Help_Touch_Dollhouse.png"))
            }

            function l(e, t) {
                if (e === c.PANORAMA && t === c.DOLLHOUSE) {
                    var i = p.isMobile() ? _[e] : w[e], o = i ? i.length / 2 : 0;
                    if (x === o)return $(".nav-help-dialog .close").off().on("mousedown touchstart", function (e) {
                        e.preventDefault(), e.stopPropagation(), d.track("USER", {
                            event_type: "showcase_gui",
                            gui_action: "help_close"
                        }), n(), setTimeout(function () {
                            m.player.insideMode()
                        }, 1e3)
                    }), $(".nav-help-elements .next-button").off().on("mousedown touchstart", function (e) {
                        e.preventDefault(), e.stopPropagation(), d.track("USER", {
                            event_type: "showcase_gui",
                            gui_action: "help_done"
                        }), n(), setTimeout(function () {
                            m.player.insideMode()
                        }, 1e3)
                    }), void $(".nav-help-elements .prev-button").off().on("mousedown touchstart", function (e) {
                        e.preventDefault(), e.stopPropagation(), d.track("USER", {
                            event_type: "showcase_gui",
                            gui_action: "help_prev"
                        }), S = !0, m.player.insideMode()
                    })
                }
                return e === c.DOLLHOUSE && t === c.PANORAMA && S ? (S = !1, void r(c.PANORAMA, x - 1)) : void(e !== t && (S = !1, n()))
            }

            var u = e("./../util/logger"), c = e("./../enum/Viewmode"), d = e("./../analytics"), f = e("./../settings"), p = e("./../util/browser"), m = e("./gui"), g = new u(i), v = !1, y = !1, b = !1, w = {};
            w[c.PANORAMA] = ["", "Nav_Help_Arrow_keys.png", "", "Nav_Help_Left_Mouse.png"], 
            w[c.DOLLHOUSE] = ["", "Nav_Help_Arrow_keys.png",
                              "", "Nav_Help_Left_Mouse.png"], w[c.FLOORPLAN] = ["", "Nav_Help_LeftRight_Keys.png", "", "Nav_Help_UpDown_Keys.png", "", "Nav_Help_Left_Mouse.png"];
            var _ = {};
            _[c.PANORAMA] = ["", "Nav_Help_Tap.png", "", "Nav_Help_Drag_Turn.png"], _[c.DOLLHOUSE] = ['', "Nav_Help_Tap.png", "", "Nav_Help_Drag_Rotate.png"], _[c.FLOORPLAN] = ['', "Nav_Help_Tap.png", "", "Nav_Help_Drag_Pan.png"];
            var x = 0, S = !1;
            $(".nav-help").on("mouseup touchend", function (e) {
                e.preventDefault(), e.stopPropagation(), $("#more-menu").removeClass("open"), m.paneControl("help"), d.track("USER", {
                    event_type: "showcase_gui",
                    gui_action: "help_open"
                }), $(".nav-help-dialog").is(":hidden") && r(m.player.mode, 1)
            }), t.exports.navHelpSessionStart = o, t.exports.navHelpModeChange = l, t.exports.addPlayHelp = a, t.exports.addHighlightReelHelp = s, t.exports.addDollhouseHelp = h, t.exports.closeHelp = n
        }).call(this, "/js/gui/help.js")
    }, {
        "./../analytics": 1,
        "./../enum/Viewmode": 12,
        "./../settings": 68,
        "./../util/browser": 74,
        "./../util/logger": 78,
        "./gui": 17
    }],
    19: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e) {
                n = e, u.debug("konami has the modelInstance")
            }

            var n, o = e("./../util/logger"), a = e("./../settings"), s = e("./debug"), h = e("./../util/common"), l = e("./gui"), u = new o(i), c = [];
            $(window).on("keydown", function (e) {
                c.push(e.which), c.length > a.secretPanelWord.length && c.shift(), h.equalLists(c, a.secretPanelWord) && (u.debug("Developer mode active."), a.debug = !0)
            }), $(window).on("keydown", function d(e) {
                a.debug && 72 == e.which && (n && l.player ? (s.toggle(n, l.player), $(window).off("keydown", d)) : console.warn("sorry we're not ready yet"))
            }), a.console && $("body").append('<div id="debug-console"></div>'), t.exports.init = r
        }).call(this, "/js/gui/konami.js")
    }, {"./../settings": 68, "./../util/common": 75, "./../util/logger": 78, "./debug": 15, "./gui": 17}],
    20: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.MTLLoader = function (e, t, i) {
            this.baseUrl = e, this.options = t, this.crossOrigin = i
        }, r.MTLLoader.prototype = {
            constructor: r.MTLLoader, load: function (e, t, i, n) {
                var o = this, a = new r.XHRLoader;
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    t(o.parse(e))
                })
            }, parse: function (e) {
                for (var t = e.split("\n"), i = {}, n = /\s+/, o = {}, a = 0; a < t.length; a++) {
                    var s = t[a];
                    if (s = s.trim(), 0 !== s.length && "#" !== s.charAt(0)) {
                        var h = s.indexOf(" "), l = h >= 0 ? s.substring(0, h) : s;
                        l = l.toLowerCase();
                        var u = h >= 0 ? s.substring(h + 1) : "";
                        if (u = u.trim(), "newmtl" === l)i = {name: u}, o[u] = i; else if (i)if ("ka" === l || "kd" === l || "ks" === l) {
                            var c = u.split(n, 3);
                            i[l] = [parseFloat(c[0]), parseFloat(c[1]), parseFloat(c[2])]
                        } else i[l] = u
                    }
                }
                var d = new r.MTLLoader.MaterialCreator(this.baseUrl, this.options);
                return d.setMaterials(o), d
            }
        }, r.MTLLoader.MaterialCreator = function (e, t) {
            this.baseUrl = e, this.options = t, this.materialsInfo = {}, this.materials = {}, this.materialsArray = [], this.nameLookup = {}, this.side = this.options && this.options.side ? this.options.side : r.FrontSide, this.wrap = this.options && this.options.wrap ? this.options.wrap : r.RepeatWrapping
        }, r.MTLLoader.MaterialCreator.prototype = {
            constructor: r.MTLLoader.MaterialCreator,
            setMaterials: function (e) {
                this.materialsInfo = this.convert(e), this.materials = {}, this.materialsArray = [], this.nameLookup = {}
            },
            convert: function (e) {
                if (!this.options)return e;
                var t = {};
                for (var i in e) {
                    var r = e[i], n = {};
                    t[i] = n;
                    for (var o in r) {
                        var a = !0, s = r[o], h = o.toLowerCase();
                        switch (h) {
                            case"kd":
                            case"ka":
                            case"ks":
                                this.options && this.options.normalizeRGB && (s = [s[0] / 255, s[1] / 255, s[2] / 255]), this.options && this.options.ignoreZeroRGBs && 0 === s[0] && 0 === s[1] && 0 === s[1] && (a = !1);
                                break;
                            case"d":
                                this.options && this.options.invertTransparency && (s = 1 - s)
                        }
                        a && (n[h] = s)
                    }
                }
                return t
            },
            preload: function () {
                for (var e in this.materialsInfo)this.create(e)
            },
            getIndex: function (e) {
                return this.nameLookup[e]
            },
            getAsArray: function () {
                var e = 0;
                for (var t in this.materialsInfo)this.materialsArray[e] = this.create(t), this.nameLookup[t] = e, e++;
                return this.materialsArray
            },
            create: function (e) {
                return void 0 === this.materials[e] && this.createMaterial_(e), this.materials[e]
            },
            createMaterial_: function (e) {
                var t = this.materialsInfo[e], i = {name: e, side: this.side};
                for (var n in t) {
                    var o = t[n];
                    switch (n.toLowerCase()) {
                        case"kd":
                            i.diffuse = (new r.Color).fromArray(o);
                            break;
                        case"ka":
                            i.ambient = (new r.Color).fromArray(o);
                            break;
                        case"ks":
                            i.specular = (new r.Color).fromArray(o);
                            break;
                        case"map_kd":
                            i.map = this.loadTexture(this.baseUrl + o), i.map.wrapS = this.wrap, i.map.wrapT = this.wrap;
                            break;
                        case"ns":
                            i.shininess = o;
                            break;
                        case"d":
                            1 > o && (i.transparent = !0, i.opacity = o)
                    }
                }
                return i.diffuse && (i.ambient || (i.ambient = i.diffuse), i.color = i.diffuse), this.materials[e] = new r.MeshPhongMaterial(i), this.materials[e]
            },
            loadTexture: function (e, t, i, n) {
                var o = /\.dds$/i.test(e);
                if (o)var a = r.ImageUtils.loadCompressedTexture(e, t, i, n); else {
                    var s = new Image, a = new r.Texture(s, t), h = new r.ImageLoader;
                    h.crossOrigin = this.crossOrigin, h.load(e, function (e) {
                        a.image = r.MTLLoader.ensurePowerOfTwo_(e), a.needsUpdate = !0, i && i(a)
                    })
                }
                return a
            }
        }, r.MTLLoader.ensurePowerOfTwo_ = function (e) {
            if (!r.Math.isPowerOfTwo(e.width) || !r.Math.isPowerOfTwo(e.height)) {
                var t = document.createElement("canvas");
                t.width = r.MTLLoader.nextHighestPowerOfTwo_(e.width), t.height = r.MTLLoader.nextHighestPowerOfTwo_(e.height);
                var i = t.getContext("2d");
                return i.drawImage(e, 0, 0, e.width, e.height, 0, 0, t.width, t.height), t
            }
            return e
        }, r.MTLLoader.nextHighestPowerOfTwo_ = function (e) {
            --e;
            for (var t = 1; 32 > t; t <<= 1)e |= e >> t;
            return e + 1
        }, r.EventDispatcher.prototype.apply(r.MTLLoader.prototype)
    }, {three: 138}],
    21: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.OBJLoader = function (e) {
            this.manager = void 0 !== e ? e : r.DefaultLoadingManager
        }, r.OBJLoader.prototype = {
            constructor: r.OBJLoader, load: function (e, t, i, n) {
                var o = this, a = new r.XHRLoader(o.manager);
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    t(o.parse(e))
                }, i, n)
            }, parse: function (e) {
                function t(e) {
                    var t = parseInt(e);
                    return 3 * (t >= 0 ? t - 1 : t + f.length / 3)
                }

                function i(e) {
                    var t = parseInt(e);
                    return 3 * (t >= 0 ? t - 1 : t + p.length / 3)
                }

                function n(e) {
                    var t = parseInt(e);
                    return 2 * (t >= 0 ? t - 1 : t + m.length / 2)
                }

                function o(e, t, i) {
                    u.vertices.push(f[e], f[e + 1], f[e + 2], f[t], f[t + 1], f[t + 2], f[i], f[i + 1], f[i + 2])
                }

                function a(e, t, i) {
                    u.normals.push(p[e], p[e + 1], p[e + 2], p[t], p[t + 1], p[t + 2], p[i], p[i + 1], p[i + 2])
                }

                function s(e, t, i) {
                    u.uvs.push(m[e], m[e + 1], m[t], m[t + 1], m[i], m[i + 1])
                }

                function h(e, r, h, l, u, c, d, f, p, m, g, v) {
                    var y, b = t(e), w = t(r), _ = t(h);
                    void 0 === l ? o(b, w, _) : (y = t(l), o(b, w, y), o(w, _, y)), void 0 !== u && (b = n(u), w = n(c), _ = n(d), void 0 === l ? s(b, w, _) : (y = n(f), s(b, w, y), s(w, _, y))), void 0 !== p && (b = i(p), w = i(m), _ = i(g), void 0 === l ? a(b, w, _) : (y = i(v), a(b, w, y), a(w, _, y)))
                }

                console.time("OBJLoader");
                var l, u, c, d = [];
                /^o /gm.test(e) === !1 && (u = {vertices: [], normals: [], uvs: []}, c = {name: ""}, l = {
                    name: "",
                    geometry: u,
                    material: c
                }, d.push(l));
                for (var f = [], p = [], m = [], g = /v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/, v = /vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/, y = /vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/, b = /f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/, w = /f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/, _ = /f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/, x = /f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/, S = e.split("\n"), E = 0; E < S.length; E++) {
                    var M = S[E];
                    M = M.trim();
                    var A;
                    0 !== M.length && "#" !== M.charAt(0) && (null !== (A = g.exec(M)) ? f.push(parseFloat(A[1]), parseFloat(A[2]), parseFloat(A[3])) : null !== (A = v.exec(M)) ? p.push(parseFloat(A[1]), parseFloat(A[2]), parseFloat(A[3])) : null !== (A = y.exec(M)) ? m.push(parseFloat(A[1]), parseFloat(A[2])) : null !== (A = b.exec(M)) ? h(A[1], A[2], A[3], A[4]) : null !== (A = w.exec(M)) ? h(A[2], A[5], A[8], A[11], A[3], A[6], A[9], A[12]) : null !== (A = _.exec(M)) ? h(A[2], A[6], A[10], A[14], A[3], A[7], A[11], A[15], A[4], A[8], A[12], A[16]) : null !== (A = x.exec(M)) ? h(A[2], A[5], A[8], A[11], void 0, void 0, void 0, void 0, A[3], A[6], A[9], A[12]) : /^o /.test(M) ? (u = {
                        vertices: [],
                        normals: [],
                        uvs: []
                    }, c = {name: ""}, l = {
                        name: M.substring(2).trim(),
                        geometry: u,
                        material: c
                    }, d.push(l)) : /^g /.test(M) || (/^usemtl /.test(M) ? c.name = M.substring(7).trim() : /^mtllib /.test(M) || /^s /.test(M)))
                }
                for (var T = new r.Object3D, E = 0, C = d.length; C > E; E++) {
                    l = d[E], u = l.geometry;
                    var P = new r.BufferGeometry;
                    P.addAttribute("position", new r.BufferAttribute(new Float32Array(u.vertices), 3)), u.normals.length > 0 && P.addAttribute("normal", new r.BufferAttribute(new Float32Array(u.normals), 3)), u.uvs.length > 0 && P.addAttribute("uv", new r.BufferAttribute(new Float32Array(u.uvs), 2)), c = new r.MeshLambertMaterial, c.name = l.material.name;
                    var L = new r.Mesh(P, c);
                    L.name = l.name, T.add(L)
                }
                return console.timeEnd("OBJLoader"), T
            }
        }
    }, {three: 138}],
    22: [function (e, t, i) {
        "use strict";
        var r = r || {};
        t.exports = r, r.gui = r.gui || {}, r.utils = r.utils || {}, r.controllers = r.controllers || {}, r.dom = r.dom || {}, r.color = r.color || {}, r.utils.css = function () {
            return {
                load: function (e, t) {
                    t = t || document;
                    var i = t.createElement("link");
                    i.type = "text/css", i.rel = "stylesheet", i.href = e, t.getElementsByTagName("head")[0].appendChild(i)
                }, inject: function (e, t) {
                    t = t || document;
                    var i = document.createElement("style");
                    i.type = "text/css", i.innerHTML = e, t.getElementsByTagName("head")[0].appendChild(i)
                }
            }
        }(), r.utils.common = function () {
            var e = Array.prototype.forEach, t = Array.prototype.slice;
            return {
                BREAK: {}, extend: function (e) {
                    return this.each(t.call(arguments, 1), function (t) {
                        for (var i in t)this.isUndefined(t[i]) || (e[i] = t[i])
                    }, this), e
                }, defaults: function (e) {
                    return this.each(t.call(arguments, 1), function (t) {
                        for (var i in t)this.isUndefined(e[i]) && (e[i] = t[i])
                    }, this), e
                }, compose: function () {
                    var e = t.call(arguments);
                    return function () {
                        for (var i = t.call(arguments), r = e.length - 1; r >= 0; r--)i = [e[r].apply(this, i)];
                        return i[0]
                    }
                }, each: function (t, i, r) {
                    if (t)if (e && t.forEach && t.forEach === e)t.forEach(i, r); else if (t.length === t.length + 0) {
                        for (var n = 0, o = t.length; o > n; n++)if (n in t && i.call(r, t[n], n) === this.BREAK)return
                    } else for (var n in t)if (i.call(r, t[n], n) === this.BREAK)return
                }, defer: function (e) {
                    setTimeout(e, 0)
                }, toArray: function (e) {
                    return e.toArray ? e.toArray() : t.call(e)
                }, isUndefined: function (e) {
                    return void 0 === e
                }, isNull: function (e) {
                    return null === e
                }, isNaN: function (e) {
                    return e !== e
                }, isArray: Array.isArray || function (e) {
                    return e.constructor === Array
                }, isObject: function (e) {
                    return e === Object(e)
                }, isNumber: function (e) {
                    return e === e + 0
                }, isString: function (e) {
                    return e === e + ""
                }, isBoolean: function (e) {
                    return e === !1 || e === !0
                }, isFunction: function (e) {
                    return "[object Function]" === Object.prototype.toString.call(e)
                }
            }
        }(), r.controllers.Controller = function (e) {
            var t = function (e, t) {
                this.initialValue = e[t], this.domElement = document.createElement("div"), this.object = e, this.property = t, this.__onChange = void 0, this.__onFinishChange = void 0
            };
            return e.extend(t.prototype, {
                onChange: function (e) {
                    return this.__onChange = e, this
                }, onFinishChange: function (e) {
                    return this.__onFinishChange = e, this
                }, setValue: function (e) {
                    return this.object[this.property] = e, this.__onChange && this.__onChange.call(this, e), this.updateDisplay(), this
                }, getValue: function () {
                    return this.object[this.property]
                }, updateDisplay: function () {
                    return this
                }, isModified: function () {
                    return this.initialValue !== this.getValue()
                }
            }), t
        }(r.utils.common), r.dom.dom = function (e) {
            function t(t) {
                if ("0" === t || e.isUndefined(t))return 0;
                var i = t.match(n);
                return e.isNull(i) ? 0 : parseFloat(i[1])
            }

            var i = {
                HTMLEvents: ["change"],
                MouseEvents: ["click", "mousemove", "mousedown", "mouseup", "mouseover"],
                KeyboardEvents: ["keydown"]
            }, r = {};
            e.each(i, function (t, i) {
                e.each(t, function (e) {
                    r[e] = i
                })
            });
            var n = /(\d+(\.\d+)?)px/, o = {
                makeSelectable: function (e, t) {
                    void 0 !== e && void 0 !== e.style && (e.onselectstart = t ? function () {
                        return !1
                    } : function () {
                    }, e.style.MozUserSelect = t ? "auto" : "none", e.style.KhtmlUserSelect = t ? "auto" : "none", e.unselectable = t ? "on" : "off")
                }, makeFullscreen: function (t, i, r) {
                    e.isUndefined(i) && (i = !0), e.isUndefined(r) && (r = !0), t.style.position = "absolute", i && (t.style.left = 0, t.style.right = 0), r && (t.style.top = 0, t.style.bottom = 0)
                }, fakeEvent: function (t, i, n, o) {
                    n = n || {};
                    var a = r[i];
                    if (!a)throw new Error("Event type " + i + " not supported.");
                    var s = document.createEvent(a);
                    switch (a) {
                        case"MouseEvents":
                            var h = n.x || n.clientX || 0, l = n.y || n.clientY || 0;
                            s.initMouseEvent(i, n.bubbles || !1, n.cancelable || !0, window, n.clickCount || 1, 0, 0, h, l, !1, !1, !1, !1, 0, null);
                            break;
                        case"KeyboardEvents":
                            var u = s.initKeyboardEvent || s.initKeyEvent;
                            e.defaults(n, {
                                cancelable: !0,
                                ctrlKey: !1,
                                altKey: !1,
                                shiftKey: !1,
                                metaKey: !1,
                                keyCode: void 0,
                                charCode: void 0
                            }), u(i, n.bubbles || !1, n.cancelable, window, n.ctrlKey, n.altKey, n.shiftKey, n.metaKey, n.keyCode, n.charCode);
                            break;
                        default:
                            s.initEvent(i, n.bubbles || !1, n.cancelable || !0)
                    }
                    e.defaults(s, o), t.dispatchEvent(s)
                }, bind: function (e, t, i, r) {
                    return r = r || !1, e.addEventListener ? e.addEventListener(t, i, r) : e.attachEvent && e.attachEvent("on" + t, i), o
                }, unbind: function (e, t, i, r) {
                    return r = r || !1, e.removeEventListener ? e.removeEventListener(t, i, r) : e.detachEvent && e.detachEvent("on" + t, i), o
                }, addClass: function (e, t) {
                    if (void 0 === e.className)e.className = t; else if (e.className !== t) {
                        var i = e.className.split(/ +/);
                        -1 == i.indexOf(t) && (i.push(t), e.className = i.join(" ").replace(/^\s+/, "").replace(/\s+$/, ""))
                    }
                    return o
                }, removeClass: function (e, t) {
                    if (t)if (void 0 === e.className); else if (e.className === t)e.removeAttribute("class"); else {
                        var i = e.className.split(/ +/), r = i.indexOf(t);
                        -1 != r && (i.splice(r, 1), e.className = i.join(" "))
                    } else e.className = void 0;
                    return o
                }, hasClass: function (e, t) {
                    return new RegExp("(?:^|\\s+)" + t + "(?:\\s+|$)").test(e.className) || !1
                }, getWidth: function (e) {
                    var i = getComputedStyle(e);
                    return t(i["border-left-width"]) + t(i["border-right-width"]) + t(i["padding-left"]) + t(i["padding-right"]) + t(i.width)
                }, getHeight: function (e) {
                    var i = getComputedStyle(e);
                    return t(i["border-top-width"]) + t(i["border-bottom-width"]) + t(i["padding-top"]) + t(i["padding-bottom"]) + t(i.height)
                }, getOffset: function (e) {
                    var t = {left: 0, top: 0};
                    if (e.offsetParent)do t.left += e.offsetLeft, t.top += e.offsetTop; while (e = e.offsetParent);
                    return t
                }, isActive: function (e) {
                    return e === document.activeElement && (e.type || e.href)
                }
            };
            return o
        }(r.utils.common), r.controllers.OptionController = function (e, t, i) {
            var r = function (e, n, o) {
                r.superclass.call(this, e, n);
                var a = this;
                if (this.__select = document.createElement("select"), i.isArray(o)) {
                    var s = {};
                    i.each(o, function (e) {
                        s[e] = e
                    }), o = s
                }
                i.each(o, function (e, t) {
                    var i = document.createElement("option");
                    i.innerHTML = t, i.setAttribute("value", e), a.__select.appendChild(i)
                }), this.updateDisplay(), t.bind(this.__select, "change", function () {
                    var e = this.options[this.selectedIndex].value;
                    a.setValue(e)
                }), this.domElement.appendChild(this.__select)
            };
            return r.superclass = e, i.extend(r.prototype, e.prototype, {
                setValue: function (e) {
                    var t = r.superclass.prototype.setValue.call(this, e);
                    return this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), t
                }, updateDisplay: function () {
                    return this.__select.value = this.getValue(), r.superclass.prototype.updateDisplay.call(this)
                }
            }), r
        }(r.controllers.Controller, r.dom.dom, r.utils.common), r.controllers.NumberController = function (e, t) {
            function i(e) {
                return e = e.toString(), e.indexOf(".") > -1 ? e.length - e.indexOf(".") - 1 : 0
            }

            var r = function (e, n, o) {
                r.superclass.call(this, e, n), o = o || {}, this.__min = o.min, this.__max = o.max, this.__step = o.step, t.isUndefined(this.__step) ? 0 == this.initialValue ? this.__impliedStep = 1 : this.__impliedStep = Math.pow(10, Math.floor(Math.log(this.initialValue) / Math.LN10)) / 10 : this.__impliedStep = this.__step, this.__precision = i(this.__impliedStep)
            };
            return r.superclass = e, t.extend(r.prototype, e.prototype, {
                setValue: function (e) {
                    return void 0 !== this.__min && e < this.__min ? e = this.__min : void 0 !== this.__max && e > this.__max && (e = this.__max), void 0 !== this.__step && e % this.__step != 0 && (e = Math.round(e / this.__step) * this.__step), r.superclass.prototype.setValue.call(this, e)
                }, min: function (e) {
                    return this.__min = e, this
                }, max: function (e) {
                    return this.__max = e, this
                }, step: function (e) {
                    return this.__step = e, this.__impliedStep = e, this.__precision = i(e), this
                }
            }), r
        }(r.controllers.Controller, r.utils.common), r.controllers.NumberControllerBox = function (e, t, i) {
            function r(e, t) {
                var i = Math.pow(10, t);
                return Math.round(e * i) / i
            }

            var n = function (e, r, o) {
                function a() {
                    var e = parseFloat(d.__input.value);
                    i.isNaN(e) || d.setValue(e)
                }

                function s() {
                    a(), d.__onFinishChange && d.__onFinishChange.call(d, d.getValue())
                }

                function h(e) {
                    t.bind(window, "mousemove", l), t.bind(window, "mouseup", u), c = e.clientY
                }

                function l(e) {
                    var t = c - e.clientY;
                    d.setValue(d.getValue() + t * d.__impliedStep), c = e.clientY
                }

                function u() {
                    t.unbind(window, "mousemove", l), t.unbind(window, "mouseup", u)
                }

                this.__truncationSuspended = !1, n.superclass.call(this, e, r, o);
                var c, d = this;
                this.__input = document.createElement("input"), this.__input.setAttribute("type", "text"), t.bind(this.__input, "change", a), t.bind(this.__input, "blur", s), t.bind(this.__input, "mousedown", h), t.bind(this.__input, "keydown", function (e) {
                    13 === e.keyCode && (d.__truncationSuspended = !0, this.blur(), d.__truncationSuspended = !1)
                }), this.updateDisplay(), this.domElement.appendChild(this.__input)
            };
            return n.superclass = e, i.extend(n.prototype, e.prototype, {
                updateDisplay: function () {
                    return this.__input.value = this.__truncationSuspended ? this.getValue() : r(this.getValue(), this.__precision), n.superclass.prototype.updateDisplay.call(this)
                }
            }), n
        }(r.controllers.NumberController, r.dom.dom, r.utils.common), r.controllers.NumberControllerSlider = function (e, t, i, r, n) {
            function o(e, t, i, r, n) {
                return r + (n - r) * ((e - t) / (i - t))
            }

            var a = function (e, i, r, n, s) {
                function h(e) {
                    t.bind(window, "mousemove", l), t.bind(window, "mouseup", u), l(e)
                }

                function l(e) {
                    e.preventDefault();
                    var i = t.getOffset(c.__background), r = t.getWidth(c.__background);
                    return c.setValue(o(e.clientX, i.left, i.left + r, c.__min, c.__max)), !1
                }

                function u() {
                    t.unbind(window, "mousemove", l), t.unbind(window, "mouseup", u), c.__onFinishChange && c.__onFinishChange.call(c, c.getValue())
                }

                a.superclass.call(this, e, i, {min: r, max: n, step: s});
                var c = this;
                this.__background = document.createElement("div"), this.__foreground = document.createElement("div"), t.bind(this.__background, "mousedown", h), t.addClass(this.__background, "slider"), t.addClass(this.__foreground, "slider-fg"), this.updateDisplay(), this.__background.appendChild(this.__foreground), this.domElement.appendChild(this.__background)
            };
            return a.superclass = e, a.useDefaultStyles = function () {
                i.inject(n)
            }, r.extend(a.prototype, e.prototype, {
                updateDisplay: function () {
                    var e = (this.getValue() - this.__min) / (this.__max - this.__min);
                    return this.__foreground.style.width = 100 * e + "%", a.superclass.prototype.updateDisplay.call(this)
                }
            }), a
        }(r.controllers.NumberController, r.dom.dom, r.utils.css, r.utils.common, "/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"), r.controllers.FunctionController = function (e, t, i) {
            var r = function (e, i, n) {
                r.superclass.call(this, e, i);
                var o = this;
                this.__button = document.createElement("div"), this.__button.innerHTML = void 0 === n ? "Fire" : n, t.bind(this.__button, "click", function (e) {
                    return e.preventDefault(), o.fire(), !1
                }), t.addClass(this.__button, "button"), this.domElement.appendChild(this.__button)
            };
            return r.superclass = e, i.extend(r.prototype, e.prototype, {
                fire: function () {
                    this.__onChange && this.__onChange.call(this), this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), this.getValue().call(this.object)
                }
            }), r
        }(r.controllers.Controller, r.dom.dom, r.utils.common), r.controllers.BooleanController = function (e, t, i) {
            var r = function (e, i) {
                function n() {
                    o.setValue(!o.__prev)
                }

                r.superclass.call(this, e, i);
                var o = this;
                this.__prev = this.getValue(), this.__checkbox = document.createElement("input"), this.__checkbox.setAttribute("type", "checkbox"), t.bind(this.__checkbox, "change", n, !1), this.domElement.appendChild(this.__checkbox), this.updateDisplay()
            };
            return r.superclass = e, i.extend(r.prototype, e.prototype, {
                setValue: function (e) {
                    var t = r.superclass.prototype.setValue.call(this, e);
                    return this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), this.__prev = this.getValue(), t
                }, updateDisplay: function () {
                    return this.getValue() === !0 ? (this.__checkbox.setAttribute("checked", "checked"), this.__checkbox.checked = !0) : this.__checkbox.checked = !1, r.superclass.prototype.updateDisplay.call(this)
                }
            }), r
        }(r.controllers.Controller, r.dom.dom, r.utils.common), r.color.toString = function (e) {
            return function (t) {
                if (1 == t.a || e.isUndefined(t.a)) {
                    for (var i = t.hex.toString(16); i.length < 6;)i = "0" + i;
                    return "#" + i
                }
                return "rgba(" + Math.round(t.r) + "," + Math.round(t.g) + "," + Math.round(t.b) + "," + t.a + ")"
            }
        }(r.utils.common), r.color.interpret = function (e, t) {
            var i, r, n = function () {
                r = !1;
                var e = arguments.length > 1 ? t.toArray(arguments) : arguments[0];
                return t.each(o, function (n) {
                    return n.litmus(e) ? (t.each(n.conversions, function (n, o) {
                        return i = n.read(e), r === !1 && i !== !1 ? (r = i, i.conversionName = o, i.conversion = n, t.BREAK) : void 0
                    }), t.BREAK) : void 0
                }), r
            }, o = [{
                litmus: t.isString, conversions: {
                    THREE_CHAR_HEX: {
                        read: function (e) {
                            var t = e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);
                            return null === t ? !1 : {
                                space: "HEX",
                                hex: parseInt("0x" + t[1].toString() + t[1].toString() + t[2].toString() + t[2].toString() + t[3].toString() + t[3].toString())
                            }
                        }, write: e
                    }, SIX_CHAR_HEX: {
                        read: function (e) {
                            var t = e.match(/^#([A-F0-9]{6})$/i);
                            return null === t ? !1 : {space: "HEX", hex: parseInt("0x" + t[1].toString())}
                        }, write: e
                    }, CSS_RGB: {
                        read: function (e) {
                            var t = e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
                            return null === t ? !1 : {
                                space: "RGB",
                                r: parseFloat(t[1]),
                                g: parseFloat(t[2]),
                                b: parseFloat(t[3])
                            }
                        }, write: e
                    }, CSS_RGBA: {
                        read: function (e) {
                            var t = e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);
                            return null === t ? !1 : {
                                space: "RGB",
                                r: parseFloat(t[1]),
                                g: parseFloat(t[2]),
                                b: parseFloat(t[3]),
                                a: parseFloat(t[4])
                            }
                        }, write: e
                    }
                }
            }, {
                litmus: t.isNumber, conversions: {
                    HEX: {
                        read: function (e) {
                            return {space: "HEX", hex: e, conversionName: "HEX"}
                        }, write: function (e) {
                            return e.hex
                        }
                    }
                }
            }, {
                litmus: t.isArray, conversions: {
                    RGB_ARRAY: {
                        read: function (e) {
                            return 3 != e.length ? !1 : {space: "RGB", r: e[0], g: e[1], b: e[2]}
                        }, write: function (e) {
                            return [e.r, e.g, e.b]
                        }
                    }, RGBA_ARRAY: {
                        read: function (e) {
                            return 4 != e.length ? !1 : {space: "RGB", r: e[0], g: e[1], b: e[2], a: e[3]}
                        }, write: function (e) {
                            return [e.r, e.g, e.b, e.a]
                        }
                    }
                }
            }, {
                litmus: t.isObject, conversions: {
                    RGBA_OBJ: {
                        read: function (e) {
                            return t.isNumber(e.r) && t.isNumber(e.g) && t.isNumber(e.b) && t.isNumber(e.a) ? {
                                space: "RGB",
                                r: e.r,
                                g: e.g,
                                b: e.b,
                                a: e.a
                            } : !1
                        }, write: function (e) {
                            return {r: e.r, g: e.g, b: e.b, a: e.a}
                        }
                    }, RGB_OBJ: {
                        read: function (e) {
                            return t.isNumber(e.r) && t.isNumber(e.g) && t.isNumber(e.b) ? {
                                space: "RGB",
                                r: e.r,
                                g: e.g,
                                b: e.b
                            } : !1
                        }, write: function (e) {
                            return {r: e.r, g: e.g, b: e.b}
                        }
                    }, HSVA_OBJ: {
                        read: function (e) {
                            return t.isNumber(e.h) && t.isNumber(e.s) && t.isNumber(e.v) && t.isNumber(e.a) ? {
                                space: "HSV",
                                h: e.h,
                                s: e.s,
                                v: e.v,
                                a: e.a
                            } : !1
                        }, write: function (e) {
                            return {h: e.h, s: e.s, v: e.v, a: e.a}
                        }
                    }, HSV_OBJ: {
                        read: function (e) {
                            return t.isNumber(e.h) && t.isNumber(e.s) && t.isNumber(e.v) ? {
                                space: "HSV",
                                h: e.h,
                                s: e.s,
                                v: e.v
                            } : !1
                        }, write: function (e) {
                            return {h: e.h, s: e.s, v: e.v}
                        }
                    }
                }
            }];
            return n
        }(r.color.toString, r.utils.common), r.GUI = r.gui.GUI = function (e, t, i, r, n, o, a, s, h, l, u, c, d, f, p) {
            function m(e, t, i, o) {
                if (void 0 === t[i])throw new Error("Object " + t + ' has no property "' + i + '"');
                var a;
                if (o.color)a = new u(t, i); else {
                    var s = [t, i].concat(o.factoryArgs);
                    a = r.apply(e, s)
                }
                o.before instanceof n && (o.before = o.before.__li), y(e, a), f.addClass(a.domElement, "c");
                var h = document.createElement("span");
                f.addClass(h, "property-name"), h.innerHTML = a.property;
                var l = document.createElement("div");
                l.appendChild(h), l.appendChild(a.domElement);
                var c = g(e, l, o.before);
                return f.addClass(c, N.CLASS_CONTROLLER_ROW), f.addClass(c, typeof a.getValue()), v(e, c, a), e.__controllers.push(a), a
            }

            function g(e, t, i) {
                var r = document.createElement("li");
                return t && r.appendChild(t), i ? e.__ul.insertBefore(r, params.before) : e.__ul.appendChild(r), e.onResize(), r
            }

            function v(e, t, i) {
                if (i.__li = t, i.__gui = e, p.extend(i, {
                        options: function (t) {
                            return arguments.length > 1 ? (i.remove(), m(e, i.object, i.property, {
                                before: i.__li.nextElementSibling,
                                factoryArgs: [p.toArray(arguments)]
                            })) : p.isArray(t) || p.isObject(t) ? (i.remove(), m(e, i.object, i.property, {
                                before: i.__li.nextElementSibling,
                                factoryArgs: [t]
                            })) : void 0
                        }, name: function (e) {
                            return i.__li.firstElementChild.firstElementChild.innerHTML = e, i
                        }, listen: function () {
                            return i.__gui.listen(i), i
                        }, remove: function () {
                            return i.__gui.remove(i), i
                        }
                    }), i instanceof h) {
                    var r = new s(i.object, i.property, {min: i.__min, max: i.__max, step: i.__step});
                    p.each(["updateDisplay", "onChange", "onFinishChange"], function (e) {
                        var t = i[e], n = r[e];
                        i[e] = r[e] = function () {
                            var e = Array.prototype.slice.call(arguments);
                            return t.apply(i, e), n.apply(r, e)
                        }
                    }), f.addClass(t, "has-slider"), i.domElement.insertBefore(r.domElement, i.domElement.firstElementChild)
                } else if (i instanceof s) {
                    var n = function (t) {
                        return p.isNumber(i.__min) && p.isNumber(i.__max) ? (i.remove(), m(e, i.object, i.property, {
                            before: i.__li.nextElementSibling,
                            factoryArgs: [i.__min, i.__max, i.__step]
                        })) : t
                    };
                    i.min = p.compose(n, i.min), i.max = p.compose(n, i.max)
                } else i instanceof o ? (f.bind(t, "click", function () {
                    f.fakeEvent(i.__checkbox, "click")
                }), f.bind(i.__checkbox, "click", function (e) {
                    e.stopPropagation()
                })) : i instanceof a ? (f.bind(t, "click", function () {
                    f.fakeEvent(i.__button, "click")
                }), f.bind(t, "mouseover", function () {
                    f.addClass(i.__button, "hover")
                }), f.bind(t, "mouseout", function () {
                    f.removeClass(i.__button, "hover")
                })) : i instanceof u && (f.addClass(t, "color"), i.updateDisplay = p.compose(function (e) {
                    return t.style.borderLeftColor = i.__color.toString(), e
                }, i.updateDisplay), i.updateDisplay());
                i.setValue = p.compose(function (t) {
                    return e.getRoot().__preset_select && i.isModified() && A(e.getRoot(), !0), t
                }, i.setValue)
            }

            function y(e, t) {
                var i = e.getRoot(), r = i.__rememberedObjects.indexOf(t.object);
                if (-1 != r) {
                    var n = i.__rememberedObjectIndecesToControllers[r];
                    if (void 0 === n && (n = {}, i.__rememberedObjectIndecesToControllers[r] = n), n[t.property] = t, i.load && i.load.remembered) {
                        var o, a = i.load.remembered;
                        if (a[e.preset])o = a[e.preset]; else {
                            if (!a[R])return;
                            o = a[R]
                        }
                        if (o[r] && void 0 !== o[r][t.property]) {
                            var s = o[r][t.property];
                            t.initialValue = s, t.setValue(s)
                        }
                    }
                }
            }

            function b(e, t) {
                return document.location.href + "." + t
            }

            function w(e) {
                function t() {
                    l.style.display = e.useLocalStorage ? "block" : "none"
                }

                var i = e.__save_row = document.createElement("li");
                f.addClass(e.domElement, "has-save"), e.__ul.insertBefore(i, e.__ul.firstChild), f.addClass(i, "save-row");
                var r = document.createElement("span");
                r.innerHTML = "&nbsp;", f.addClass(r, "button gears");
                var n = document.createElement("span");
                n.innerHTML = "Save", f.addClass(n, "button"), f.addClass(n, "save");
                var o = document.createElement("span");
                o.innerHTML = "New", f.addClass(o, "button"), f.addClass(o, "save-as");
                var a = document.createElement("span");
                a.innerHTML = "Revert", f.addClass(a, "button"), f.addClass(a, "revert");
                var s = e.__preset_select = document.createElement("select");
                if (e.load && e.load.remembered ? p.each(e.load.remembered, function (t, i) {
                        E(e, i, i == e.preset)
                    }) : E(e, R, !1), f.bind(s, "change", function () {
                        for (var t = 0; t < e.__preset_select.length; t++)e.__preset_select[t].innerHTML = e.__preset_select[t].value;
                        e.preset = this.value
                    }), i.appendChild(s), i.appendChild(r), i.appendChild(n), i.appendChild(o), i.appendChild(a), I) {
                    var h = document.getElementById("dg-save-locally"), l = document.getElementById("dg-local-explain");
                    h.style.display = "block";
                    var u = document.getElementById("dg-local-storage");
                    "true" === localStorage.getItem(b(e, "isLocal")) && u.setAttribute("checked", "checked"), t(), f.bind(u, "change", function () {
                        e.useLocalStorage = !e.useLocalStorage, t()
                    })
                }
                var c = document.getElementById("dg-new-constructor");
                f.bind(c, "keydown", function (e) {
                    !e.metaKey || 67 !== e.which && 67 != e.keyCode || C.hide()
                }), f.bind(r, "click", function () {
                    c.innerHTML = JSON.stringify(e.getSaveObject(), void 0, 2), C.show(), c.focus(), c.select()
                }), f.bind(n, "click", function () {
                    e.save()
                }), f.bind(o, "click", function () {
                    var t = prompt("Enter a new preset name.");
                    t && e.saveAs(t)
                }), f.bind(a, "click", function () {
                    e.revert()
                })
            }

            function _(e) {
                function t(t) {
                    return t.preventDefault(), n = t.clientX, f.addClass(e.__closeButton, N.CLASS_DRAG), f.bind(window, "mousemove", i), f.bind(window, "mouseup", r), !1
                }

                function i(t) {
                    return t.preventDefault(), e.width += n - t.clientX, e.onResize(), n = t.clientX, !1
                }

                function r() {
                    f.removeClass(e.__closeButton, N.CLASS_DRAG), f.unbind(window, "mousemove", i), f.unbind(window, "mouseup", r)
                }

                e.__resize_handle = document.createElement("div"), p.extend(e.__resize_handle.style, {
                    width: "6px",
                    marginLeft: "-3px",
                    height: "200px",
                    cursor: "ew-resize",
                    position: "absolute"
                });
                var n;
                f.bind(e.__resize_handle, "mousedown", t), f.bind(e.__closeButton, "mousedown", t), e.domElement.insertBefore(e.__resize_handle, e.domElement.firstElementChild)
            }

            function x(e, t) {
                e.domElement.style.width = t + "px", e.__save_row && e.autoPlace && (e.__save_row.style.width = t + "px"), e.__closeButton && (e.__closeButton.style.width = t + "px")
            }

            function S(e, t) {
                var i = {};
                return p.each(e.__rememberedObjects, function (r, n) {
                    var o = {}, a = e.__rememberedObjectIndecesToControllers[n];
                    p.each(a, function (e, i) {
                        o[i] = t ? e.initialValue : e.getValue()
                    }), i[n] = o
                }), i
            }

            function E(e, t, i) {
                var r = document.createElement("option");
                r.innerHTML = t, r.value = t, e.__preset_select.appendChild(r), i && (e.__preset_select.selectedIndex = e.__preset_select.length - 1)
            }

            function M(e) {
                for (var t = 0; t < e.__preset_select.length; t++)e.__preset_select[t].value == e.preset && (e.__preset_select.selectedIndex = t)
            }

            function A(e, t) {
                var i = e.__preset_select[e.__preset_select.selectedIndex];
                t ? i.innerHTML = i.value + "*" : i.innerHTML = i.value
            }

            function T(e) {
                0 != e.length && c(function () {
                    T(e)
                }), p.each(e, function (e) {
                    e.updateDisplay()
                })
            }

            e.inject(i);
            var C, P, L = "dg", k = 72, B = 20, R = "Default", I = function () {
                try {
                    return "localStorage" in window && null !== window.localStorage
                } catch (e) {
                    return !1
                }
            }(), F = !0, D = !1, O = [], N = function (e) {
                function t() {
                    var e = i.getRoot();
                    e.width += 1, p.defer(function () {
                        e.width -= 1
                    })
                }

                var i = this;
                this.domElement = document.createElement("div"), this.__ul = document.createElement("ul"), this.domElement.appendChild(this.__ul), f.addClass(this.domElement, L), this.__folders = {}, this.__controllers = [], this.__rememberedObjects = [], this.__rememberedObjectIndecesToControllers = [], this.__listening = [], e = e || {}, e = p.defaults(e, {
                    autoPlace: !0,
                    width: N.DEFAULT_WIDTH
                }), e = p.defaults(e, {
                    resizable: e.autoPlace,
                    hideable: e.autoPlace
                }), p.isUndefined(e.load) ? e.load = {preset: R} : e.preset && (e.load.preset = e.preset), p.isUndefined(e.parent) && e.hideable && O.push(this), e.resizable = p.isUndefined(e.parent) && e.resizable, e.autoPlace && p.isUndefined(e.scrollable) && (e.scrollable = !0);
                var r, n = I && "true" === localStorage.getItem(b(this, "isLocal"));
                if (Object.defineProperties(this, {
                        parent: {
                            get: function () {
                                return e.parent
                            }
                        }, scrollable: {
                            get: function () {
                                return e.scrollable
                            }
                        }, autoPlace: {
                            get: function () {
                                return e.autoPlace
                            }
                        }, preset: {
                            get: function () {
                                return i.parent ? i.getRoot().preset : e.load.preset
                            }, set: function (t) {
                                i.parent ? i.getRoot().preset = t : e.load.preset = t, M(this), i.revert()
                            }
                        }, width: {
                            get: function () {
                                return e.width
                            }, set: function (t) {
                                e.width = t, x(i, t)
                            }
                        }, name: {
                            get: function () {
                                return e.name
                            }, set: function (t) {
                                e.name = t, a && (a.innerHTML = e.name)
                            }
                        }, closed: {
                            get: function () {
                                return e.closed
                            }, set: function (t) {
                                e.closed = t, e.closed ? f.addClass(i.__ul, N.CLASS_CLOSED) : f.removeClass(i.__ul, N.CLASS_CLOSED), this.onResize(), i.__closeButton && (i.__closeButton.innerHTML = t ? N.TEXT_OPEN : N.TEXT_CLOSED)
                            }
                        }, load: {
                            get: function () {
                                return e.load
                            }
                        }, useLocalStorage: {
                            get: function () {
                                return n
                            }, set: function (e) {
                                I && (n = e, e ? f.bind(window, "unload", r) : f.unbind(window, "unload", r), localStorage.setItem(b(i, "isLocal"), e))
                            }
                        }
                    }), p.isUndefined(e.parent)) {
                    if (e.closed = !1, f.addClass(this.domElement, N.CLASS_MAIN), f.makeSelectable(this.domElement, !1), I && n) {
                        i.useLocalStorage = !0;
                        var o = localStorage.getItem(b(this, "gui"));
                        o && (e.load = JSON.parse(o))
                    }
                    this.__closeButton = document.createElement("div"), this.__closeButton.innerHTML = N.TEXT_CLOSED, f.addClass(this.__closeButton, N.CLASS_CLOSE_BUTTON), this.domElement.appendChild(this.__closeButton), f.bind(this.__closeButton, "click", function () {
                        i.closed = !i.closed
                    })
                } else {
                    void 0 === e.closed && (e.closed = !0);
                    var a = document.createTextNode(e.name);
                    f.addClass(a, "controller-name");
                    var s = g(i, a), h = function (e) {
                        return e.preventDefault(), i.closed = !i.closed, !1
                    };
                    f.addClass(this.__ul, N.CLASS_CLOSED), f.addClass(s, "title"), f.bind(s, "click", h), e.closed || (this.closed = !1)
                }
                e.autoPlace && (p.isUndefined(e.parent) && (F && (P = document.createElement("div"), f.addClass(P, L), f.addClass(P, N.CLASS_AUTO_PLACE_CONTAINER), document.body.appendChild(P), F = !1), P.appendChild(this.domElement), f.addClass(this.domElement, N.CLASS_AUTO_PLACE)), this.parent || x(i, e.width)), f.bind(window, "resize", function () {
                    i.onResize()
                }), f.bind(this.__ul, "webkitTransitionEnd", function () {
                    i.onResize()
                }), f.bind(this.__ul, "transitionend", function () {
                    i.onResize()
                }), f.bind(this.__ul, "oTransitionEnd", function () {
                    i.onResize()
                }), this.onResize(), e.resizable && _(this), r = function () {
                    I && "true" === localStorage.getItem(b(i, "isLocal")) && localStorage.setItem(b(i, "gui"), JSON.stringify(i.getSaveObject()))
                }, this.saveToLocalStorageIfPossible = r;
                i.getRoot();
                e.parent || t()
            };
            return N.toggleHide = function () {
                D = !D, p.each(O, function (e) {
                    e.domElement.style.zIndex = D ? -999 : 999, e.domElement.style.opacity = D ? 0 : 1
                })
            }, N.CLASS_AUTO_PLACE = "a", N.CLASS_AUTO_PLACE_CONTAINER = "ac", N.CLASS_MAIN = "main", N.CLASS_CONTROLLER_ROW = "cr", N.CLASS_TOO_TALL = "taller-than-window", N.CLASS_CLOSED = "closed", N.CLASS_CLOSE_BUTTON = "close-button", N.CLASS_DRAG = "drag", N.DEFAULT_WIDTH = 245, N.TEXT_CLOSED = "Close Controls", N.TEXT_OPEN = "Open Controls", f.bind(window, "keydown", function (e) {
                "text" === document.activeElement.type || e.which !== k && e.keyCode != k || N.toggleHide()
            }, !1), p.extend(N.prototype, {
                add: function (e, t) {
                    return m(this, e, t, {factoryArgs: Array.prototype.slice.call(arguments, 2)})
                }, addColor: function (e, t) {
                    return m(this, e, t, {color: !0})
                }, remove: function (e) {
                    this.__ul.removeChild(e.__li), this.__controllers.slice(this.__controllers.indexOf(e), 1);
                    var t = this;
                    p.defer(function () {
                        t.onResize()
                    })
                }, destroy: function () {
                    this.autoPlace && P.removeChild(this.domElement)
                }, addFolder: function (e) {
                    if (void 0 !== this.__folders[e])throw new Error('You already have a folder in this GUI by the name "' + e + '"');
                    var t = {name: e, parent: this};
                    t.autoPlace = this.autoPlace, this.load && this.load.folders && this.load.folders[e] && (t.closed = this.load.folders[e].closed, t.load = this.load.folders[e]);
                    var i = new N(t);
                    this.__folders[e] = i;
                    var r = g(this, i.domElement);
                    return f.addClass(r, "folder"), i
                }, open: function () {
                    this.closed = !1
                }, close: function () {
                    this.closed = !0
                }, onResize: function () {
                    var e = this.getRoot();
                    if (e.scrollable) {
                        var t = f.getOffset(e.__ul).top, i = 0;
                        p.each(e.__ul.childNodes, function (t) {
                            e.autoPlace && t === e.__save_row || (i += f.getHeight(t))
                        }), window.innerHeight - t - B < i ? (f.addClass(e.domElement, N.CLASS_TOO_TALL), e.__ul.style.height = window.innerHeight - t - B + "px") : (f.removeClass(e.domElement, N.CLASS_TOO_TALL), e.__ul.style.height = "auto")
                    }
                    e.__resize_handle && p.defer(function () {
                        e.__resize_handle.style.height = e.__ul.offsetHeight + "px"
                    }), e.__closeButton && (e.__closeButton.style.width = e.width + "px")
                }, remember: function () {
                    if (p.isUndefined(C) && (C = new d, C.domElement.innerHTML = t), this.parent)throw new Error("You can only call remember on a top level GUI.");
                    var e = this;
                    p.each(Array.prototype.slice.call(arguments), function (t) {
                        0 == e.__rememberedObjects.length && w(e), -1 == e.__rememberedObjects.indexOf(t) && e.__rememberedObjects.push(t)
                    }), this.autoPlace && x(this, this.width)
                }, getRoot: function () {
                    for (var e = this; e.parent;)e = e.parent;
                    return e
                }, getSaveObject: function () {
                    var e = this.load;
                    return e.closed = this.closed, this.__rememberedObjects.length > 0 && (e.preset = this.preset, e.remembered || (e.remembered = {}), e.remembered[this.preset] = S(this)), e.folders = {}, p.each(this.__folders, function (t, i) {
                        e.folders[i] = t.getSaveObject()
                    }), e
                }, save: function () {
                    this.load.remembered || (this.load.remembered = {}), this.load.remembered[this.preset] = S(this), A(this, !1), this.saveToLocalStorageIfPossible()
                }, saveAs: function (e) {
                    this.load.remembered || (this.load.remembered = {}, this.load.remembered[R] = S(this, !0)), this.load.remembered[e] = S(this), this.preset = e, E(this, e, !0), this.saveToLocalStorageIfPossible()
                }, revert: function (e) {
                    p.each(this.__controllers, function (t) {
                        this.getRoot().load.remembered ? y(e || this.getRoot(), t) : t.setValue(t.initialValue)
                    }, this), p.each(this.__folders, function (e) {
                        e.revert(e)
                    }), e || A(this.getRoot(), !1)
                }, listen: function (e) {
                    var t = 0 == this.__listening.length;
                    this.__listening.push(e), t && T(this.__listening)
                }
            }), N
        }(r.utils.css, '<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>', ".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid rgba(0, 0, 0, 0); }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: black url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2fa1d6; }\n    .dg .cr.number input[type=text] {\n      color: #2fa1d6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2fa1d6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n", r.controllers.factory = function (e, t, i, r, n, o, a) {
            return function (s, h) {
                var l = s[h];
                return a.isArray(arguments[2]) || a.isObject(arguments[2]) ? new e(s, h, arguments[2]) : a.isNumber(l) ? a.isNumber(arguments[2]) && a.isNumber(arguments[3]) ? new i(s, h, arguments[2], arguments[3]) : new t(s, h, {
                    min: arguments[2],
                    max: arguments[3]
                }) : a.isString(l) ? new r(s, h) : a.isFunction(l) ? new n(s, h, "") : a.isBoolean(l) ? new o(s, h) : void 0
            }
        }(r.controllers.OptionController, r.controllers.NumberControllerBox, r.controllers.NumberControllerSlider, r.controllers.StringController = function (e, t, i) {
            var r = function (e, i) {
                function n() {
                    a.setValue(a.__input.value)
                }

                function o() {
                    a.__onFinishChange && a.__onFinishChange.call(a, a.getValue())
                }

                r.superclass.call(this, e, i);
                var a = this;
                this.__input = document.createElement("input"), this.__input.setAttribute("type", "text"), t.bind(this.__input, "keyup", n), t.bind(this.__input, "change", n), t.bind(this.__input, "blur", o), t.bind(this.__input, "keydown", function (e) {
                    13 === e.keyCode && this.blur()
                }), this.updateDisplay(), this.domElement.appendChild(this.__input)
            };
            return r.superclass = e, i.extend(r.prototype, e.prototype, {
                updateDisplay: function () {
                    return t.isActive(this.__input) || (this.__input.value = this.getValue()), r.superclass.prototype.updateDisplay.call(this)
                }
            }), r
        }(r.controllers.Controller, r.dom.dom, r.utils.common), r.controllers.FunctionController, r.controllers.BooleanController, r.utils.common), r.controllers.Controller, r.controllers.BooleanController, r.controllers.FunctionController, r.controllers.NumberControllerBox, r.controllers.NumberControllerSlider, r.controllers.OptionController, r.controllers.ColorController = function (e, t, i, r, n) {
            function o(e, t, i, r) {
                e.style.background = "", n.each(h, function (n) {
                    e.style.cssText += "background: " + n + "linear-gradient(" + t + ", " + i + " 0%, " + r + " 100%); "
                })
            }

            function a(e) {
                e.style.background = "", e.style.cssText += "background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);", e.style.cssText += "background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", e.style.cssText += "background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", e.style.cssText += "background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", e.style.cssText += "background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"
            }

            var s = function (e, h) {
                function l(e) {
                    f(e), t.bind(window, "mousemove", f), t.bind(window, "mouseup", u)
                }

                function u() {
                    t.unbind(window, "mousemove", f), t.unbind(window, "mouseup", u)
                }

                function c() {
                    var e = r(this.value);
                    e !== !1 ? (m.__color.__state = e, m.setValue(m.__color.toOriginal())) : this.value = m.__color.toString()
                }

                function d() {
                    t.unbind(window, "mousemove", p), t.unbind(window, "mouseup", d)
                }

                function f(e) {
                    e.preventDefault();
                    var i = t.getWidth(m.__saturation_field), r = t.getOffset(m.__saturation_field), n = (e.clientX - r.left + document.body.scrollLeft) / i, o = 1 - (e.clientY - r.top + document.body.scrollTop) / i;
                    return o > 1 ? o = 1 : 0 > o && (o = 0), n > 1 ? n = 1 : 0 > n && (n = 0), m.__color.v = o, m.__color.s = n, m.setValue(m.__color.toOriginal()), !1
                }

                function p(e) {
                    e.preventDefault();
                    var i = t.getHeight(m.__hue_field), r = t.getOffset(m.__hue_field), n = 1 - (e.clientY - r.top + document.body.scrollTop) / i;
                    return n > 1 ? n = 1 : 0 > n && (n = 0), m.__color.h = 360 * n, m.setValue(m.__color.toOriginal()), !1
                }

                s.superclass.call(this, e, h), this.__color = new i(this.getValue()), this.__temp = new i(0);
                var m = this;
                this.domElement = document.createElement("div"), t.makeSelectable(this.domElement, !1), this.__selector = document.createElement("div"), this.__selector.className = "selector", this.__saturation_field = document.createElement("div"), this.__saturation_field.className = "saturation-field", this.__field_knob = document.createElement("div"), this.__field_knob.className = "field-knob", this.__field_knob_border = "2px solid ", this.__hue_knob = document.createElement("div"), this.__hue_knob.className = "hue-knob", this.__hue_field = document.createElement("div"), this.__hue_field.className = "hue-field", this.__input = document.createElement("input"), this.__input.type = "text", this.__input_textShadow = "0 1px 1px ", t.bind(this.__input, "keydown", function (e) {
                    13 === e.keyCode && c.call(this)
                }), t.bind(this.__input, "blur", c), t.bind(this.__selector, "mousedown", function (e) {
                    t.addClass(this, "drag").bind(window, "mouseup", function (e) {
                        t.removeClass(m.__selector, "drag")
                    })
                });
                var g = document.createElement("div");
                n.extend(this.__selector.style, {
                    width: "122px",
                    height: "102px",
                    padding: "3px",
                    backgroundColor: "#222",
                    boxShadow: "0px 1px 3px rgba(0,0,0,0.3)"
                }), n.extend(this.__field_knob.style, {
                    position: "absolute",
                    width: "12px",
                    height: "12px",
                    border: this.__field_knob_border + (this.__color.v < .5 ? "#fff" : "#000"),
                    boxShadow: "0px 1px 3px rgba(0,0,0,0.5)",
                    borderRadius: "12px",
                    zIndex: 1
                }), n.extend(this.__hue_knob.style, {
                    position: "absolute",
                    width: "15px",
                    height: "2px",
                    borderRight: "4px solid #fff",
                    zIndex: 1
                }), n.extend(this.__saturation_field.style, {
                    width: "100px",
                    height: "100px",
                    border: "1px solid #555",
                    marginRight: "3px",
                    display: "inline-block",
                    cursor: "pointer"
                }), n.extend(g.style, {
                    width: "100%",
                    height: "100%",
                    background: "none"
                }), o(g, "top", "rgba(0,0,0,0)", "#000"), n.extend(this.__hue_field.style, {
                    width: "15px",
                    height: "100px",
                    display: "inline-block",
                    border: "1px solid #555",
                    cursor: "ns-resize"
                }), a(this.__hue_field), n.extend(this.__input.style, {
                    outline: "none",
                    textAlign: "center",
                    color: "#fff",
                    border: 0,
                    fontWeight: "bold",
                    textShadow: this.__input_textShadow + "rgba(0,0,0,0.7)"
                }), t.bind(this.__saturation_field, "mousedown", l), t.bind(this.__field_knob, "mousedown", l), t.bind(this.__hue_field, "mousedown", function (e) {
                    p(e), t.bind(window, "mousemove", p), t.bind(window, "mouseup", d)
                }), this.__saturation_field.appendChild(g), this.__selector.appendChild(this.__field_knob), this.__selector.appendChild(this.__saturation_field), this.__selector.appendChild(this.__hue_field), this.__hue_field.appendChild(this.__hue_knob), this.domElement.appendChild(this.__input), this.domElement.appendChild(this.__selector), this.updateDisplay()
            };
            s.superclass = e, n.extend(s.prototype, e.prototype, {
                updateDisplay: function () {
                    var e = r(this.getValue());
                    if (e !== !1) {
                        var t = !1;
                        n.each(i.COMPONENTS, function (i) {
                            return n.isUndefined(e[i]) || n.isUndefined(this.__color.__state[i]) || e[i] === this.__color.__state[i] ? void 0 : (t = !0, {})
                        }, this), t && n.extend(this.__color.__state, e)
                    }
                    n.extend(this.__temp.__state, this.__color.__state), this.__temp.a = 1;
                    var a = this.__color.v < .5 || this.__color.s > .5 ? 255 : 0, s = 255 - a;
                    n.extend(this.__field_knob.style, {
                        marginLeft: 100 * this.__color.s - 7 + "px",
                        marginTop: 100 * (1 - this.__color.v) - 7 + "px",
                        backgroundColor: this.__temp.toString(),
                        border: this.__field_knob_border + "rgb(" + a + "," + a + "," + a + ")"
                    }), this.__hue_knob.style.marginTop = 100 * (1 - this.__color.h / 360) + "px", this.__temp.s = 1, this.__temp.v = 1, o(this.__saturation_field, "left", "#fff", this.__temp.toString()), n.extend(this.__input.style, {
                        backgroundColor: this.__input.value = this.__color.toString(),
                        color: "rgb(" + a + "," + a + "," + a + ")",
                        textShadow: this.__input_textShadow + "rgba(" + s + "," + s + "," + s + ",.7)"
                    })
                }
            });
            var h = ["-moz-", "-o-", "-webkit-", "-ms-", ""];
            return s
        }(r.controllers.Controller, r.dom.dom, r.color.Color = function (e, t, i, r) {
            function n(e, t, i) {
                Object.defineProperty(e, t, {
                    get: function () {
                        return "RGB" === this.__state.space ? this.__state[t] : (a(this, t, i), this.__state[t])
                    }, set: function (e) {
                        "RGB" !== this.__state.space && (a(this, t, i), this.__state.space = "RGB"), this.__state[t] = e
                    }
                })
            }

            function o(e, t) {
                Object.defineProperty(e, t, {
                    get: function () {
                        return "HSV" === this.__state.space ? this.__state[t] : (s(this), this.__state[t])
                    }, set: function (e) {
                        "HSV" !== this.__state.space && (s(this), this.__state.space = "HSV"), this.__state[t] = e
                    }
                })
            }

            function a(e, i, n) {
                if ("HEX" === e.__state.space)e.__state[i] = t.component_from_hex(e.__state.hex, n); else {
                    if ("HSV" !== e.__state.space)throw"Corrupted color state";
                    r.extend(e.__state, t.hsv_to_rgb(e.__state.h, e.__state.s, e.__state.v))
                }
            }

            function s(e) {
                var i = t.rgb_to_hsv(e.r, e.g, e.b);
                r.extend(e.__state, {
                    s: i.s,
                    v: i.v
                }), r.isNaN(i.h) ? r.isUndefined(e.__state.h) && (e.__state.h = 0) : e.__state.h = i.h
            }

            var h = function () {
                if (this.__state = e.apply(this, arguments), this.__state === !1)throw"Failed to interpret color arguments";
                this.__state.a = this.__state.a || 1
            };
            return h.COMPONENTS = ["r", "g", "b", "h", "s", "v", "hex", "a"], r.extend(h.prototype, {
                toString: function () {
                    return i(this)
                }, toOriginal: function () {
                    return this.__state.conversion.write(this)
                }
            }), n(h.prototype, "r", 2), n(h.prototype, "g", 1), n(h.prototype, "b", 0), o(h.prototype, "h"), o(h.prototype, "s"), o(h.prototype, "v"), Object.defineProperty(h.prototype, "a", {
                get: function () {
                    return this.__state.a
                }, set: function (e) {
                    this.__state.a = e
                }
            }), Object.defineProperty(h.prototype, "hex", {
                get: function () {
                    return "HEX" !== !this.__state.space && (this.__state.hex = t.rgb_to_hex(this.r, this.g, this.b)), this.__state.hex
                }, set: function (e) {
                    this.__state.space = "HEX", this.__state.hex = e
                }
            }), h
        }(r.color.interpret, r.color.math = function () {
            var e;
            return {
                hsv_to_rgb: function (e, t, i) {
                    var r = Math.floor(e / 60) % 6, n = e / 60 - Math.floor(e / 60), o = i * (1 - t), a = i * (1 - n * t), s = i * (1 - (1 - n) * t), h = [[i, s, o], [a, i, o], [o, i, s], [o, a, i], [s, o, i], [i, o, a]][r];
                    return {r: 255 * h[0], g: 255 * h[1], b: 255 * h[2]}
                }, rgb_to_hsv: function (e, t, i) {
                    var r, n, o = Math.min(e, t, i), a = Math.max(e, t, i), s = a - o;
                    return 0 == a ? {
                        h: NaN,
                        s: 0,
                        v: 0
                    } : (n = s / a, r = e == a ? (t - i) / s : t == a ? 2 + (i - e) / s : 4 + (e - t) / s, r /= 6, 0 > r && (r += 1), {
                        h: 360 * r,
                        s: n,
                        v: a / 255
                    })
                }, rgb_to_hex: function (e, t, i) {
                    var r = this.hex_with_component(0, 2, e);
                    return r = this.hex_with_component(r, 1, t), r = this.hex_with_component(r, 0, i)
                }, component_from_hex: function (e, t) {
                    return e >> 8 * t & 255
                }, hex_with_component: function (t, i, r) {
                    return r << (e = 8 * i) | t & ~(255 << e)
                }
            }
        }(), r.color.toString, r.utils.common), r.color.interpret, r.utils.common), r.utils.requestAnimationFrame = function () {
            return window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (e, t) {
                    window.setTimeout(e, 1e3 / 60)
                }
        }(), r.dom.CenteredDiv = function (e, t) {
            var i = function () {
                this.backgroundElement = document.createElement("div"), t.extend(this.backgroundElement.style, {
                    backgroundColor: "rgba(0,0,0,0.8)",
                    top: 0,
                    left: 0,
                    display: "none",
                    zIndex: "1000",
                    opacity: 0,
                    WebkitTransition: "opacity 0.2s linear"
                }), e.makeFullscreen(this.backgroundElement), this.backgroundElement.style.position = "fixed", this.domElement = document.createElement("div"), t.extend(this.domElement.style, {
                    position: "fixed",
                    display: "none",
                    zIndex: "1001",
                    opacity: 0,
                    WebkitTransition: "-webkit-transform 0.2s ease-out, opacity 0.2s linear"
                }), document.body.appendChild(this.backgroundElement), document.body.appendChild(this.domElement);
                var i = this;
                e.bind(this.backgroundElement, "click", function () {
                    i.hide()
                })
            };
            return i.prototype.show = function () {
                var e = this;
                this.backgroundElement.style.display = "block", this.domElement.style.display = "block", this.domElement.style.opacity = 0, this.domElement.style.webkitTransform = "scale(1.1)", this.layout(), t.defer(function () {
                    e.backgroundElement.style.opacity = 1, e.domElement.style.opacity = 1, e.domElement.style.webkitTransform = "scale(1)"
                })
            }, i.prototype.hide = function () {
                var t = this, i = function () {
                    t.domElement.style.display = "none", t.backgroundElement.style.display = "none", e.unbind(t.domElement, "webkitTransitionEnd", i), e.unbind(t.domElement, "transitionend", i), e.unbind(t.domElement, "oTransitionEnd", i)
                };
                e.bind(this.domElement, "webkitTransitionEnd", i), e.bind(this.domElement, "transitionend", i), e.bind(this.domElement, "oTransitionEnd", i), this.backgroundElement.style.opacity = 0, this.domElement.style.opacity = 0, this.domElement.style.webkitTransform = "scale(1.1)"
            }, i.prototype.layout = function () {
                this.domElement.style.left = window.innerWidth / 2 - e.getWidth(this.domElement) / 2 + "px", this.domElement.style.top = window.innerHeight / 2 - e.getHeight(this.domElement) / 2 + "px"
            }, i
        }(r.dom.dom, r.utils.common), r.dom.dom, r.utils.common)
    }, {}],
    23: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./freeze"), r = e("./LZ/BinTree"), n = e("./LZ/InWindow"), o = e("./LZ/OutWindow");
            t.exports = i({BinTree: r, InWindow: n, OutWindow: o})
        }()
    }, {"./LZ/BinTree": 24, "./LZ/InWindow": 25, "./LZ/OutWindow": 26, "./freeze": 38, amdefine: 82}],
    24: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            function i() {
                if (n.call(this), this._cyclicBufferSize = 0, this._son = [], this._hash = [], this._cutValue = 255, this._hashSizeSum = 0, this.HASH_ARRAY = !0, this.kNumHashDirectBytes = 0, this.kMinMatchCheck = 4, this.kFixHashSize = a + s, arguments.length >= 6) {
                    var e = Array.prototype.slice.call(arguments, 0);
                    this.setType(e.shift());
                    var t = e.pop();
                    this.create.apply(this, e), this.setStream(t), this.init()
                }
            }

            var r = e("../freeze"), n = e("./InWindow"), o = function () {
                var e = [];
                "undefined" != typeof Uint32Array && (e = new Uint32Array(256));
                var t, i, r, n = 3988292384;
                for (t = 0; 256 > t; t++) {
                    for (r = t, i = 0; 8 > i; i++)0 !== (1 & r) ? r = r >>> 1 ^ n : r >>>= 1;
                    e[t] = r
                }
                return e
            }();
            console.assert(256 === o.length);
            var a = 1024, s = 65536, h = 65536, l = 1, u = a, c = 0, d = (1 << 30) - 1, f = n.prototype;
            i.prototype = Object.create(f), i.prototype.setType = function (e) {
                this.HASH_ARRAY = e > 2, this.HASH_ARRAY ? (this.kNumHashDirectBytes = 0, this.kMinMatchCheck = 4, this.kFixHashSize = a + s) : (this.kNumHashDirectBytes = 2, this.kMinMatchCheck = 3, this.kFixHashSize = 0)
            }, i.prototype.init = function () {
                var e;
                for (f.init.call(this), e = 0; e < this._hashSizeSum; e++)this._hash[e] = c;
                this._cyclicBufferPos = 0, this.reduceOffsets(-1)
            }, i.prototype.movePos = function () {
                ++this._cyclicBufferPos >= this._cyclicBufferSize && (this._cyclicBufferPos = 0), f.movePos.call(this), this._pos === d && this.normalize()
            }, i.prototype.create = function (e, t, i, r) {
                var n, o, a;
                return e > d - 256 ? (console.assert(!1, "Unsupported historySize"), !1) : (this._cutValue = 16 + (i >>> 1), n = (e + t + i + r) / 2 + 256, f.create.call(this, e + t, i + r, n), this._matchMaxLen = i, o = e + 1, this._cyclicBufferSize !== o && (this._cyclicBufferSize = o, this._son = [], this._son.length = 2 * o), a = h, this.HASH_ARRAY && (a = e - 1, a |= a >>> 1, a |= a >>> 2, a |= a >>> 4, a |= a >>> 8, a >>>= 1, a |= 65535, a > 1 << 24 && (a >>>= 1), this._hashMask = a, a++, a += this.kFixHashSize), a !== this._hashSizeSum && (this._hashSizeSum = a, this._hash = [], this._hash.length = this._hashSizeSum), !0)
            }, i.prototype.getMatches = function (e) {
                var t;
                if (this._pos + this._matchMaxLen <= this._streamPos)t = this._matchMaxLen; else if (t = this._streamPos - this._pos, t < this.kMinMatchCheck)return this.movePos(), 0;
                var i = 0, r = this._pos > this._cyclicBufferSize ? this._pos - this._cyclicBufferSize : 0, n = this._bufferOffset + this._pos, h = l, d = 0, f = 0, p = 0;
                if (this.HASH_ARRAY) {
                    var m = o[this._bufferBase[n]] ^ this._bufferBase[n + 1];
                    f = m & a - 1, m ^= this._bufferBase[n + 2] << 8, p = m & s - 1, d = (m ^ o[this._bufferBase[n + 3]] << 5) & this._hashMask
                } else d = this._bufferBase[n] ^ this._bufferBase[n + 1] << 8;
                var g = this._hash[this.kFixHashSize + d];
                if (this.HASH_ARRAY) {
                    var v = this._hash[f], y = this._hash[u + p];
                    this._hash[f] = this._pos, this._hash[u + p] = this._pos, v > r && this._bufferBase[this._bufferOffset + v] === this._bufferBase[n] && (e[i++] = h = 2, e[i++] = this._pos - v - 1), y > r && this._bufferBase[this._bufferOffset + y] === this._bufferBase[n] && (y === v && (i -= 2), e[i++] = h = 3, e[i++] = this._pos - y - 1, v = y), 0 !== i && v === g && (i -= 2, h = l)
                }
                this._hash[this.kFixHashSize + d] = this._pos;
                var b, w, _ = (this._cyclicBufferPos << 1) + 1, x = this._cyclicBufferPos << 1;
                b = w = this.kNumHashDirectBytes, 0 !== this.kNumHashDirectBytes && g > r && this._bufferBase[this._bufferOffset + g + this.kNumHashDirectBytes] !== this._bufferBase[n + this.kNumHashDirectBytes] && (e[i++] = h = this.kNumHashDirectBytes, e[i++] = this._pos - g - 1);
                for (var S = this._cutValue; ;) {
                    if (r >= g || 0 === S--) {
                        this._son[_] = this._son[x] = c;
                        break
                    }
                    var E = this._pos - g, M = (E <= this._cyclicBufferPos ? this._cyclicBufferPos - E : this._cyclicBufferPos - E + this._cyclicBufferSize) << 1, A = this._bufferOffset + g, T = Math.min(b, w);
                    if (this._bufferBase[A + T] === this._bufferBase[n + T]) {
                        for (; ++T !== t && this._bufferBase[A + T] === this._bufferBase[n + T];);
                        if (T > h && (e[i++] = h = T, e[i++] = E - 1, T === t)) {
                            this._son[x] = this._son[M], this._son[_] = this._son[M + 1];
                            break
                        }
                    }
                    this._bufferBase[A + T] < this._bufferBase[n + T] ? (this._son[x] = g, x = M + 1, g = this._son[x], w = T) : (this._son[_] = g, _ = M, g = this._son[_], b = T)
                }
                return this.movePos(), i
            }, i.prototype.skip = function (e) {
                var t, i, r, n, h, l, d, f, p, m, g, v, y, b, w, _, x;
                do {
                    if (this._pos + this._matchMaxLen <= this._streamPos)t = this._matchMaxLen; else if (t = this._streamPos - this._pos, t < this.kMinMatchCheck) {
                        this.movePos();
                        continue
                    }
                    for (i = this._pos > this._cyclicBufferSize ? this._pos - this._cyclicBufferSize : 0, r = this._bufferOffset + this._pos, this.HASH_ARRAY ? (f = o[this._bufferBase[r]] ^ this._bufferBase[r + 1], l = f & a - 1, this._hash[l] = this._pos, f ^= this._bufferBase[r + 2] << 8, d = f & s - 1, this._hash[u + d] = this._pos, h = (f ^ o[this._bufferBase[r + 3]] << 5) & this._hashMask) : h = this._bufferBase[r] ^ this._bufferBase[r + 1] << 8, n = this._hash[this.kFixHashSize + h], this._hash[this.kFixHashSize + h] = this._pos, p = (this._cyclicBufferPos << 1) + 1, m = this._cyclicBufferPos << 1, g = v = this.kNumHashDirectBytes, y = this._cutValue; ;) {
                        if (i >= n || 0 === y--) {
                            this._son[p] = this._son[m] = c;
                            break
                        }
                        if (b = this._pos - n, w = (b <= this._cyclicBufferPos ? this._cyclicBufferPos - b : this._cyclicBufferPos - b + this._cyclicBufferSize) << 1, _ = this._bufferOffset + n, x = v > g ? g : v, this._bufferBase[_ + x] === this._bufferBase[r + x]) {
                            for (; ++x !== t && this._bufferBase[_ + x] === this._bufferBase[r + x];);
                            if (x === t) {
                                this._son[m] = this._son[w], this._son[p] = this._son[w + 1];
                                break
                            }
                        }
                        this._bufferBase[_ + x] < this._bufferBase[r + x] ? (this._son[m] = n, m = w + 1, n = this._son[m], v = x) : (this._son[p] = n, p = w, n = this._son[p], g = x)
                    }
                    this.movePos()
                } while (0 !== --e)
            }, i.prototype.normalizeLinks = function (e, t, i) {
                var r, n;
                for (r = 0; t > r; r++)n = e[r], i >= n ? n = c : n -= i, e[r] = n
            }, i.prototype.normalize = function () {
                var e = this._pos - this._cyclicBufferSize;
                this.normalizeLinks(this._son, 2 * this._cyclicBufferSize, e), this.normalizeLinks(this._hash, this._hashSizeSum, e), this.reduceOffsets(e)
            }, i.prototype.setCutValue = function (e) {
                this._cutValue = e
            }, r(i.prototype), t.exports = r(i)
        }()
    }, {"../freeze": 38, "./InWindow": 25, amdefine: 82}],
    25: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = e("../makeBuffer"), n = function (e, t, i, r) {
                if (arguments.length >= 4) {
                    var n = Array.prototype.slice.call(arguments, 0), o = n.pop();
                    this.create.apply(this, n), this.setStream(o), this.init()
                }
            };
            n.prototype.moveBlock = function () {
                var e, t = this._bufferOffset + this._pos + this._keepSizeBefore;
                t > 0 && t--;
                var i = this._bufferOffset + this._streamPos - t;
                for (e = 0; i > e; e++)this._bufferBase[e] = this._bufferBase[t + e];
                this._bufferOffset -= t
            }, n.prototype.readBlock = function () {
                if (!this._streamEndWasReached)for (; ;) {
                    var e = -this._bufferOffset + this._blockSize - this._streamPos;
                    if (0 === e)return;
                    var t = this._stream.read(this._bufferBase, this._bufferOffset + this._streamPos, e);
                    if (0 >= t) {
                        this._posLimit = this._streamPos;
                        var i = this._bufferOffset + this._posLimit;
                        return i > this._pointerToLastSafePosition && (this._posLimit = this._pointerToLastSafePosition - this._bufferOffset), void(this._streamEndWasReached = !0)
                    }
                    this._streamPos += t, this._streamPos >= this._pos + this._keepSizeAfter && (this._posLimit = this._streamPos - this._keepSizeAfter)
                }
            }, n.prototype.free = function () {
                this._bufferBase = null
            }, n.prototype.create = function (e, t, i) {
                this._keepSizeBefore = e, this._keepSizeAfter = t;
                var n = e + t + i;
                this._bufferBase && this._blockSize === n || (this.free(), this._blockSize = n, this._bufferBase = r(this._blockSize)), this._pointerToLastSafePosition = this._blockSize - t
            }, n.prototype.setStream = function (e) {
                this._stream = e
            }, n.prototype.releaseStream = function () {
                this._stream = null
            }, n.prototype.init = function () {
                this._bufferOffset = 0, this._pos = 0, this._streamPos = 0, this._streamEndWasReached = !1, this.readBlock()
            }, n.prototype.movePos = function () {
                if (this._pos++, this._pos > this._posLimit) {
                    var e = this._bufferOffset + this._pos;
                    e > this._pointerToLastSafePosition && this.moveBlock(), this.readBlock()
                }
            }, n.prototype.getIndexByte = function (e) {
                return this._bufferBase[this._bufferOffset + this._pos + e]
            }, n.prototype.getMatchLen = function (e, t, i) {
                var r, n;
                for (this._streamEndWasReached && this._pos + e + i > this._streamPos && (i = this._streamPos - (this._pos + e)), t++, r = this._bufferOffset + this._pos + e, n = 0; i > n && this._bufferBase[r + n] === this._bufferBase[r + n - t];)n++;
                return n
            }, n.prototype.getNumAvailableBytes = function () {
                return this._streamPos - this._pos
            }, n.prototype.reduceOffsets = function (e) {
                this._bufferOffset += e, this._posLimit -= e, this._pos -= e, this._streamPos -= e
            }, t.exports = i(n)
        }()
    }, {"../freeze": 38, "../makeBuffer": 39, amdefine: 82}],
    26: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = e("../makeBuffer"), n = function () {
                this._windowSize = 0
            };
            n.prototype.create = function (e) {
                this._buffer && this._windowSize === e || (this._buffer = r(e)), this._windowSize = e, this._pos = 0, this._streamPos = 0
            }, n.prototype.flush = function () {
                var e = this._pos - this._streamPos;
                if (0 !== e) {
                    for (; e--;)this._stream.writeByte(this._buffer[this._streamPos++]);
                    this._pos >= this._windowSize && (this._pos = 0), this._streamPos = this._pos
                }
            }, n.prototype.releaseStream = function () {
                this.flush(), this._stream = null
            }, n.prototype.setStream = function (e) {
                this.releaseStream(), this._stream = e
            }, n.prototype.init = function (e) {
                e || (this._streamPos = 0, this._pos = 0)
            }, n.prototype.copyBlock = function (e, t) {
                var i = this._pos - e - 1;
                for (0 > i && (i += this._windowSize); t--;)i >= this._windowSize && (i = 0), this._buffer[this._pos++] = this._buffer[i++], this._pos >= this._windowSize && this.flush()
            }, n.prototype.putByte = function (e) {
                this._buffer[this._pos++] = e, this._pos >= this._windowSize && this.flush()
            }, n.prototype.getByte = function (e) {
                var t = this._pos - e - 1;
                return 0 > t && (t += this._windowSize), this._buffer[t]
            }, i(n.prototype), t.exports = i(n)
        }()
    }, {"../freeze": 38, "../makeBuffer": 39, amdefine: 82}],
    27: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./freeze"), r = e("./LZMA/Decoder"), n = e("./LZMA/Encoder");
            t.exports = i({Decoder: r, Encoder: n})
        }()
    }, {"./LZMA/Decoder": 29, "./LZMA/Encoder": 30, "./freeze": 38, amdefine: 82}],
    28: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = Object.create(null);
            r.kNumRepDistances = 4, r.kNumStates = 12, r.stateInit = function () {
                return 0
            }, r.stateUpdateChar = function (e) {
                return 4 > e ? 0 : 10 > e ? e - 3 : e - 6
            }, r.stateUpdateMatch = function (e) {
                return 7 > e ? 7 : 10
            }, r.stateUpdateRep = function (e) {
                return 7 > e ? 8 : 11
            }, r.stateUpdateShortRep = function (e) {
                return 7 > e ? 9 : 11
            }, r.stateIsCharState = function (e) {
                return 7 > e
            }, r.kNumPosSlotBits = 6, r.kDicLogSizeMin = 0, r.kNumLenToPosStatesBits = 2, r.kNumLenToPosStates = 1 << r.kNumLenToPosStatesBits, r.kMatchMinLen = 2, r.getLenToPosState = function (e) {
                return e -= r.kMatchMinLen, e < r.kNumLenToPosStates ? e : r.kNumLenToPosStates - 1
            }, r.kNumAlignBits = 4, r.kAlignTableSize = 1 << r.kNumAlignBits, r.kAlignMask = r.kAlignTableSize - 1, r.kStartPosModelIndex = 4, r.kEndPosModelIndex = 14, r.kNumPosModels = r.kEndPosModelIndex - r.kStartPosModelIndex, r.kNumFullDistances = 1 << r.kEndPosModelIndex / 2, r.kNumLitPosStatesBitsEncodingMax = 4, r.kNumLitContextBitsMax = 8, r.kNumPosStatesBitsMax = 4, r.kNumPosStatesMax = 1 << r.kNumPosStatesBitsMax, r.kNumPosStatesBitsEncodingMax = 4, r.kNumPosStatesEncodingMax = 1 << r.kNumPosStatesBitsEncodingMax, r.kNumLowLenBits = 3, r.kNumMidLenBits = 3, r.kNumHighLenBits = 8, r.kNumLowLenSymbols = 1 << r.kNumLowLenBits, r.kNumMidLenSymbols = 1 << r.kNumMidLenBits, r.kNumLenSymbols = r.kNumLowLenSymbols + r.kNumMidLenSymbols + (1 << r.kNumHighLenBits), r.kMatchMaxLen = r.kMatchMinLen + r.kNumLenSymbols - 1, t.exports = i(r)
        }()
    }, {"../freeze": 38, amdefine: 82}],
    29: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./Base"), r = e("../LZ"), n = e("../RangeCoder"), o = n.Encoder.initBitModels, a = function () {
                this._choice = o(null, 2), this._lowCoder = [], this._midCoder = [], this._highCoder = new n.BitTreeDecoder(8), this._numPosStates = 0
            };
            a.prototype.create = function (e) {
                for (; this._numPosStates < e; ++this._numPosStates)this._lowCoder[this._numPosStates] = new n.BitTreeDecoder(3), this._midCoder[this._numPosStates] = new n.BitTreeDecoder(3)
            }, a.prototype.init = function () {
                var e = this._numPosStates;
                for (o(this._choice); e--;)this._lowCoder[e].init(), this._midCoder[e].init();
                this._highCoder.init()
            }, a.prototype.decode = function (e, t) {
                return 0 === e.decodeBit(this._choice, 0) ? this._lowCoder[t].decode(e) : 0 === e.decodeBit(this._choice, 1) ? 8 + this._midCoder[t].decode(e) : 16 + this._highCoder.decode(e)
            };
            var s = function () {
            };
            s.Decoder2 = function () {
                this._decoders = o(null, 768)
            }, s.Decoder2.prototype.init = function () {
                o(this._decoders)
            }, s.Decoder2.prototype.decodeNormal = function (e) {
                var t = 1;
                do t = t << 1 | e.decodeBit(this._decoders, t); while (256 > t);
                return 255 & t
            }, s.Decoder2.prototype.decodeWithMatchByte = function (e, t) {
                var i, r, n = 1;
                do if (i = t >> 7 & 1, t <<= 1, r = e.decodeBit(this._decoders, (1 + i << 8) + n), n = n << 1 | r, i !== r) {
                    for (; 256 > n;)n = n << 1 | e.decodeBit(this._decoders, n);
                    break
                } while (256 > n);
                return 255 & n
            }, s.prototype.create = function (e, t) {
                var i;
                if (!this._coders || this._numPrevBits !== t || this._numPosBits !== e)for (this._numPosBits = e, this._posMask = (1 << e) - 1, this._numPrevBits = t, this._coders = [], i = 1 << this._numPrevBits + this._numPosBits; i--;)this._coders[i] = new s.Decoder2
            }, s.prototype.init = function () {
                for (var e = 1 << this._numPrevBits + this._numPosBits; e--;)this._coders[e].init()
            }, s.prototype.getDecoder = function (e, t) {
                return this._coders[((e & this._posMask) << this._numPrevBits) + ((255 & t) >>> 8 - this._numPrevBits)]
            };
            var h = function () {
                var e;
                for (this._outWindow = new r.OutWindow, this._rangeDecoder = new n.Decoder, this._isMatchDecoders = o(null, i.kNumStates << i.kNumPosStatesBitsMax), this._isRepDecoders = o(null, i.kNumStates), this._isRepG0Decoders = o(null, i.kNumStates), this._isRepG1Decoders = o(null, i.kNumStates), this._isRepG2Decoders = o(null, i.kNumStates), this._isRep0LongDecoders = o(null, i.kNumStates << i.kNumPosStatesBitsMax), this._posSlotDecoder = [], this._posDecoders = o(null, i.kNumFullDistances - i.kEndPosModelIndex), this._posAlignDecoder = new n.BitTreeDecoder(i.kNumAlignBits), this._lenDecoder = new a, this._repLenDecoder = new a, this._literalDecoder = new s, this._dictionarySize = -1, this._dictionarySizeCheck = -1, this._posStateMask = 0, e = 0; e < i.kNumLenToPosStates; e++)this._posSlotDecoder[e] = new n.BitTreeDecoder(i.kNumPosSlotBits)
            };
            h.prototype.setDictionarySize = function (e) {
                return 0 > e ? !1 : (this._dictionarySize !== e && (this._dictionarySize = e, this._dictionarySizeCheck = Math.max(this._dictionarySize, 1), this._outWindow.create(Math.max(this._dictionarySizeCheck, 4096))), !0)
            }, h.prototype.setLcLpPb = function (e, t, r) {
                var n = 1 << r;
                return e > i.kNumLitContextBitsMax || t > 4 || r > i.kNumPosStatesBitsMax ? !1 : (this._literalDecoder.create(t, e), this._lenDecoder.create(n), this._repLenDecoder.create(n), this._posStateMask = n - 1, !0)
            }, h.prototype.init = function () {
                var e = i.kNumLenToPosStates;
                for (this._outWindow.init(!1), o(this._isMatchDecoders), o(this._isRepDecoders), o(this._isRepG0Decoders), o(this._isRepG1Decoders), o(this._isRepG2Decoders), o(this._isRep0LongDecoders), o(this._posDecoders), this._literalDecoder.init(); e--;)this._posSlotDecoder[e].init();
                this._lenDecoder.init(), this._repLenDecoder.init(), this._posAlignDecoder.init(), this._rangeDecoder.init()
            }, h.prototype.code = function (e, t, r) {
                var o, a, s, h, l, u, c, d = 0, f = 0, p = 0, m = 0, g = 0, v = 0;
                for (this._rangeDecoder.setStream(e), this._outWindow.setStream(t), this.init(), o = i.stateInit(); 0 > r || r > g;)if (a = g & this._posStateMask, 0 === this._rangeDecoder.decodeBit(this._isMatchDecoders, (o << i.kNumPosStatesBitsMax) + a))s = this._literalDecoder.getDecoder(g, v), v = i.stateIsCharState(o) ? s.decodeNormal(this._rangeDecoder) : s.decodeWithMatchByte(this._rangeDecoder, this._outWindow.getByte(d)), this._outWindow.putByte(v), o = i.stateUpdateChar(o), g++; else {
                    if (1 === this._rangeDecoder.decodeBit(this._isRepDecoders, o))h = 0, 0 === this._rangeDecoder.decodeBit(this._isRepG0Decoders, o) ? 0 === this._rangeDecoder.decodeBit(this._isRep0LongDecoders, (o << i.kNumPosStatesBitsMax) + a) && (o = i.stateUpdateShortRep(o), h = 1) : (0 === this._rangeDecoder.decodeBit(this._isRepG1Decoders, o) ? l = f : (0 === this._rangeDecoder.decodeBit(this._isRepG2Decoders, o) ? l = p : (l = m, m = p), p = f), f = d, d = l), 0 === h && (h = i.kMatchMinLen + this._repLenDecoder.decode(this._rangeDecoder, a), o = i.stateUpdateRep(o)); else if (m = p, p = f, f = d, h = i.kMatchMinLen + this._lenDecoder.decode(this._rangeDecoder, a), o = i.stateUpdateMatch(o), u = this._posSlotDecoder[i.getLenToPosState(h)].decode(this._rangeDecoder), u >= i.kStartPosModelIndex) {
                        if (c = (u >> 1) - 1, d = (2 | 1 & u) << c, u < i.kEndPosModelIndex)d += n.BitTreeDecoder.reverseDecode(this._posDecoders, d - u - 1, this._rangeDecoder, c); else if (d += this._rangeDecoder.decodeDirectBits(c - i.kNumAlignBits) << i.kNumAlignBits, d += this._posAlignDecoder.reverseDecode(this._rangeDecoder), 0 > d) {
                            if (-1 === d)break;
                            return !1
                        }
                    } else d = u;
                    if (d >= g || d >= this._dictionarySizeCheck)return !1;
                    this._outWindow.copyBlock(d, h), g += h, v = this._outWindow.getByte(0)
                }
                return this._outWindow.flush(), this._outWindow.releaseStream(), this._rangeDecoder.releaseStream(), !0
            }, h.prototype.setDecoderProperties = function (e) {
                var t, i, r, n, o, a, s;
                if (e.length < 5)return !1;
                if (t = 255 & e[0], i = t % 9, t = ~~(t / 9), r = t % 5, n = ~~(t / 5), !this.setLcLpPb(i, r, n))return !1;
                for (o = 0, a = 0, s = 1; 4 > a; a++, s *= 256)o += (255 & e[1 + a]) * s;
                return this.setDictionarySize(o)
            }, h.prototype.setDecoderPropertiesFromStream = function (e) {
                var t, i = [];
                for (t = 0; 5 > t; t++)i[t] = e.readByte();
                return this.setDecoderProperties(i)
            }, t.exports = h
        }()
    }, {"../LZ": 23, "../RangeCoder": 31, "./Base": 28, amdefine: 82}],
    30: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./Base"), r = e("../RangeCoder"), n = e("../LZ"), o = e("../freeze"), a = e("../makeBuffer"), s = r.Encoder.initBitModels, h = 0, l = 1, u = 268435455, c = 22, d = 32, f = 4096, p = 5, m = function () {
                var e, t = a(2048), i = 22, r = 2;
                for (t[0] = 0, t[1] = 1, e = 2; i > e; e++) {
                    var n, o = 1 << (e >> 1) - 1;
                    for (n = 0; o > n; n++, r++)t[r] = e
                }
                return t
            }(), g = function (e) {
                return 2048 > e ? m[e] : 1 << 21 > e ? m[e >>> 10] + 20 : m[e >>> 20] + 40
            }, v = function (e) {
                return 1 << 17 > e ? m[e >>> 6] + 12 : 1 << 27 > e ? m[e >>> 16] + 32 : m[e >>> 26] + 52
            }, y = function () {
                var e;
                for (this._state = i.stateInit(), this._previousByte = 0, this._repDistances = [], this._repDistances.length = i.kNumRepDistances, this._optimum = [], this._matchFinder = null, this._rangeEncoder = new r.Encoder, this._isMatch = s(null, i.kNumStates << i.kNumPosStatesBitsMax), this._isRep = s(null, i.kNumStates), this._isRepG0 = s(null, i.kNumStates), this._isRepG1 = s(null, i.kNumStates), this._isRepG2 = s(null, i.kNumStates), this._isRep0Long = s(null, i.kNumStates << i.kNumPosStatesBitsMax), this._posSlotEncoder = [], this._posEncoders = s(null, i.kNumFullDistances - i.kEndPosModelIndex), this._posAlignEncoder = new r.BitTreeEncoder(i.kNumAlignBits), this._lenEncoder = new y.LenPriceTableEncoder, this._repMatchLenEncoder = new y.LenPriceTableEncoder, this._literalEncoder = new y.LiteralEncoder, this._matchDistances = [], this._matchDistances.length = 2 * i.kMatchMaxLen + 2, e = 0; e < this._matchDistances.length; e++)this._matchDistances[e] = 0;
                for (this._numFastBytes = d, this._longestMatchLength = 0, this._numDistancePairs = 0, this._additionalOffset = 0, this._optimumEndIndex = 0, this._optimumCurrentIndex = 0, this._longestMatchWasFound = !1, this._posSlotPrices = [], this._distancesPrices = [], this._alignPrices = [], this._alignPriceCount = 0, this._distTableSize = 2 * c, this._posStateBits = 2, this._posStateMask = 3, this._numLiteralPosStateBits = 0, this._numLiteralContextBits = 3, this._dictionarySize = 1 << c, this._dictionarySizePrev = 4294967295, this._numFastBytesPrev = 4294967295, this.nowPos64 = 0, this._finished = !1, this._inStream = null, this._matchFinderType = l, this._writeEndMark = !1, this._needReleaseMFStream = !1, this.reps = [], this.repLens = [], this.backRes = 0, e = 0; f > e; e++)this._optimum[e] = new y.Optimal;
                for (e = 0; e < i.kNumLenToPosStates; e++)this._posSlotEncoder[e] = new r.BitTreeEncoder(i.kNumPosSlotBits);
                this._matchPriceCount = 0, this.processedInSize = [0], this.processedOutSize = [0], this.finished = [!1]
            };
            y.prototype.baseInit = function () {
                var e;
                for (this._state = i.stateInit(), this._previousByte = 0, e = 0; e < i.kNumRepDistances; e++)this._repDistances[e] = 0
            };
            var b = y.LiteralEncoder = function () {
                this._coders = null, this._numPrevBits = -1, this._numPosBits = -1, this._posMask = 0
            };
            b.Encoder2 = function () {
                this._encoders = s(null, 768)
            }, b.Encoder2.prototype.init = function () {
                s(this._encoders)
            }, b.Encoder2.prototype.encode = function (e, t) {
                var i, r = 1;
                for (i = 7; i >= 0; i--) {
                    var n = t >>> i & 1;
                    e.encode(this._encoders, r, n), r = r << 1 | n
                }
            }, b.Encoder2.prototype.encodeMatched = function (e, t, i) {
                var r, n = 1, o = !0;
                for (r = 7; r >= 0; r--) {
                    var a = i >> r & 1, s = n;
                    if (o) {
                        var h = t >>> r & 1;
                        s += 1 + h << 8, o = h === a
                    }
                    e.encode(this._encoders, s, a), n = n << 1 | a
                }
            }, b.Encoder2.prototype.getPrice = function (e, t, i) {
                var n, o, a = 0, s = 1, h = 7;
                if (e)for (; h >= 0; h--)if (o = t >>> h & 1, n = i >>> h & 1, a += r.Encoder.getPrice(this._encoders[(1 + o << 8) + s], n), s = s << 1 | n, o !== n) {
                    h--;
                    break
                }
                for (; h >= 0; h--)n = i >>> h & 1, a += r.Encoder.getPrice(this._encoders[s], n), s = s << 1 | n;
                return a
            }, b.prototype.create = function (e, t) {
                var i;
                if (!this._coders || this._numPrevBits !== t || this._numPosBits !== e) {
                    this._numPosBits = e, this._posMask = (1 << e) - 1, this._numPrevBits = t;
                    var r = 1 << this._numPrevBits + this._numPosBits;
                    for (this._coders = [], i = 0; r > i; i++)this._coders[i] = new b.Encoder2;
                }
            }, b.prototype.init = function () {
                var e, t = 1 << this._numPrevBits + this._numPosBits;
                for (e = 0; t > e; e++)this._coders[e].init()
            }, b.prototype.getSubCoder = function (e, t) {
                return this._coders[((e & this._posMask) << this._numPrevBits) + (t >> 8 - this._numPrevBits)]
            };
            var w = y.LenEncoder = function () {
                var e;
                for (this._choice = s(null, 2), this._lowCoder = [], this._midCoder = [], this._highCoder = new r.BitTreeEncoder(i.kNumHighLenBits), e = 0; e < i.kNumPosStatesEncodingMax; e++)this._lowCoder[e] = new r.BitTreeEncoder(i.kNumLowLenBits), this._midCoder[e] = new r.BitTreeEncoder(i.kNumMidLenBits)
            };
            w.prototype.init = function (e) {
                var t;
                for (s(this._choice), t = 0; e > t; t++)this._lowCoder[t].init(), this._midCoder[t].init();
                this._highCoder.init()
            }, w.prototype.encode = function (e, t, r) {
                t < i.kNumLowLenSymbols ? (e.encode(this._choice, 0, 0), this._lowCoder[r].encode(e, t)) : (t -= i.kNumLowLenSymbols, e.encode(this._choice, 0, 1), t < i.kNumMidLenSymbols ? (e.encode(this._choice, 1, 0), this._midCoder[r].encode(e, t)) : (e.encode(this._choice, 1, 1), this._highCoder.encode(e, t - i.kNumMidLenSymbols)))
            }, w.prototype.setPrices = function (e, t, n, o) {
                var a, s = r.Encoder.getPrice0(this._choice[0]), h = r.Encoder.getPrice1(this._choice[0]), l = h + r.Encoder.getPrice0(this._choice[1]), u = h + r.Encoder.getPrice1(this._choice[1]);
                for (a = 0; a < i.kNumLowLenSymbols; a++) {
                    if (a >= t)return;
                    n[o + a] = s + this._lowCoder[e].getPrice(a)
                }
                for (; a < i.kNumLowLenSymbols + i.kNumMidLenSymbols; a++) {
                    if (a >= t)return;
                    n[o + a] = l + this._midCoder[e].getPrice(a - i.kNumLowLenSymbols)
                }
                for (; t > a; a++)n[o + a] = u + this._highCoder.getPrice(a - i.kNumLowLenSymbols - i.kNumMidLenSymbols)
            };
            var _ = (i.kNumLowLenSymbols + i.kNumMidLenSymbols, y.LenPriceTableEncoder = function () {
                w.call(this), this._prices = [], this._counters = [], this._tableSize = 0
            });
            _.prototype = Object.create(w.prototype), _.prototype.setTableSize = function (e) {
                this._tableSize = e
            }, _.prototype.getPrice = function (e, t) {
                return this._prices[t * i.kNumLenSymbols + e]
            }, _.prototype.updateTable = function (e) {
                this.setPrices(e, this._tableSize, this._prices, e * i.kNumLenSymbols), this._counters[e] = this._tableSize
            }, _.prototype.updateTables = function (e) {
                var t;
                for (t = 0; e > t; t++)this.updateTable(t)
            }, _.prototype.encode = function (e) {
                return function (t, i, r) {
                    e.call(this, t, i, r), 0 === --this._counters[r] && this.updateTable(r)
                }
            }(_.prototype.encode);
            var x = y.Optimal = function () {
                this.state = 0, this.prev1IsChar = !1, this.prev2 = !1, this.posPrev2 = 0, this.backPrev2 = 0, this.price = 0, this.posPrev = 0, this.backPrev = 0, this.backs0 = 0, this.backs1 = 0, this.backs2 = 0, this.backs3 = 0
            };
            x.prototype.makeAsChar = function () {
                this.backPrev = -1, this.prev1IsChar = !1
            }, x.prototype.makeAsShortRep = function () {
                this.backPrev = 0, this.prev1IsChar = !1
            }, x.prototype.isShortRep = function () {
                return 0 === this.backPrev
            }, y.prototype.create = function () {
                var e;
                if (!this._matchFinder) {
                    var t = new n.BinTree;
                    e = 4, this._matchFinderType === h && (e = 2), t.setType(e), this._matchFinder = t
                }
                this._literalEncoder.create(this._numLiteralPosStateBits, this._numLiteralContextBits), (this._dictionarySize !== this._dictionarySizePrev || this._numFastBytesPrev !== this._numFastBytes) && (this._matchFinder.create(this._dictionarySize, f, this._numFastBytes, i.kMatchMaxLen + 1), this._dictionarySizePrev = this._dictionarySize, this._numFastBytesPrev = this._numFastBytes)
            }, y.prototype.setWriteEndMarkerMode = function (e) {
                this._writeEndMark = e
            }, y.prototype.init = function () {
                var e;
                for (this.baseInit(), this._rangeEncoder.init(), s(this._isMatch), s(this._isRep0Long), s(this._isRep), s(this._isRepG0), s(this._isRepG1), s(this._isRepG2), s(this._posEncoders), this._literalEncoder.init(), e = 0; e < i.kNumLenToPosStates; e++)this._posSlotEncoder[e].init();
                this._lenEncoder.init(1 << this._posStateBits), this._repMatchLenEncoder.init(1 << this._posStateBits), this._posAlignEncoder.init(), this._longestMatchWasFound = !1, this._optimumEndIndex = 0, this._optimumCurrentIndex = 0, this._additionalOffset = 0
            }, y.prototype.readMatchDistances = function () {
                var e = 0;
                return this._numDistancePairs = this._matchFinder.getMatches(this._matchDistances), this._numDistancePairs > 0 && (e = this._matchDistances[this._numDistancePairs - 2], e === this._numFastBytes && (e += this._matchFinder.getMatchLen(e - 1, this._matchDistances[this._numDistancePairs - 1], i.kMatchMaxLen - e))), this._additionalOffset++, e
            }, y.prototype.movePos = function (e) {
                e > 0 && (this._matchFinder.skip(e), this._additionalOffset += e)
            }, y.prototype.getRepLen1Price = function (e, t) {
                return r.Encoder.getPrice0(this._isRepG0[e]) + r.Encoder.getPrice0(this._isRep0Long[(e << i.kNumPosStatesBitsMax) + t])
            }, y.prototype.getPureRepPrice = function (e, t, n) {
                var o;
                return 0 === e ? (o = r.Encoder.getPrice0(this._isRepG0[t]), o += r.Encoder.getPrice1(this._isRep0Long[(t << i.kNumPosStatesBitsMax) + n])) : (o = r.Encoder.getPrice1(this._isRepG0[t]), 1 === e ? o += r.Encoder.getPrice0(this._isRepG1[t]) : (o += r.Encoder.getPrice1(this._isRepG1[t]), o += r.Encoder.getPrice(this._isRepG2[t], e - 2))), o
            }, y.prototype.getRepPrice = function (e, t, r, n) {
                var o = this._repMatchLenEncoder.getPrice(t - i.kMatchMinLen, n);
                return o + this.getPureRepPrice(e, r, n)
            }, y.prototype.getPosLenPrice = function (e, t, r) {
                var n, o = i.getLenToPosState(t);
                return n = e < i.kNumFullDistances ? this._distancesPrices[o * i.kNumFullDistances + e] : this._posSlotPrices[(o << i.kNumPosSlotBits) + v(e)] + this._alignPrices[e & i.kAlignMask], n + this._lenEncoder.getPrice(t - i.kMatchMinLen, r)
            }, y.prototype.backward = function (e) {
                this._optimumEndIndex = e;
                var t = this._optimum[e].posPrev, i = this._optimum[e].backPrev;
                do {
                    this._optimum[e].prev1IsChar && (this._optimum[t].makeAsChar(), this._optimum[t].posPrev = t - 1, this._optimum[e].prev2 && (this._optimum[t - 1].prev1IsChar = !1, this._optimum[t - 1].posPrev = this._optimum[e].posPrev2, this._optimum[t - 1].backPrev = this._optimum[e].backPrev2));
                    var r = t, n = i;
                    i = this._optimum[r].backPrev, t = this._optimum[r].posPrev, this._optimum[r].backPrev = n, this._optimum[r].posPrev = e, e = r
                } while (e > 0);
                return this.backRes = this._optimum[0].backPrev, this._optimumCurrentIndex = this._optimum[0].posPrev, this._optimumCurrentIndex
            }, y.prototype.getOptimum = function (e) {
                if (this._optimumEndIndex !== this._optimumCurrentIndex) {
                    var t = this._optimum[this._optimumCurrentIndex].posPrev - this._optimumCurrentIndex;
                    return this.backRes = this._optimum[this._optimumCurrentIndex].backPrev, this._optimumCurrentIndex = this._optimum[this._optimumCurrentIndex].posPrev, t
                }
                this._optimumCurrentIndex = this._optimumEndIndex = 0;
                var n;
                this._longestMatchWasFound ? (n = this._longestMatchLength, this._longestMatchWasFound = !1) : n = this.readMatchDistances();
                var o = this._numDistancePairs, a = this._matchFinder.getNumAvailableBytes() + 1;
                if (2 > a)return this.backRes = -1, 1;
                a > i.kMatchMaxLen && (a = i.kMatchMaxLen);
                var s, h = 0;
                for (s = 0; s < i.kNumRepDistances; s++)this.reps[s] = this._repDistances[s], this.repLens[s] = this._matchFinder.getMatchLen(-1, this.reps[s], i.kMatchMaxLen), this.repLens[s] > this.repLens[h] && (h = s);
                if (this.repLens[h] >= this._numFastBytes) {
                    this.backRes = h;
                    var l = this.repLens[h];
                    return this.movePos(l - 1), l
                }
                if (n >= this._numFastBytes)return this.backRes = this._matchDistances[o - 1] + i.kNumRepDistances, this.movePos(n - 1), n;
                var c = this._matchFinder.getIndexByte(-1), d = this._matchFinder.getIndexByte(-this._repDistances[0] - 2);
                if (2 > n && c !== d && this.repLens[h] < 2)return this.backRes = -1, 1;
                this._optimum[0].state = this._state;
                var p = e & this._posStateMask;
                this._optimum[1].price = r.Encoder.getPrice0(this._isMatch[(this._state << i.kNumPosStatesBitsMax) + p]) + this._literalEncoder.getSubCoder(e, this._previousByte).getPrice(!i.stateIsCharState(this._state), d, c), this._optimum[1].makeAsChar();
                var m = r.Encoder.getPrice1(this._isMatch[(this._state << i.kNumPosStatesBitsMax) + p]), g = m + r.Encoder.getPrice1(this._isRep[this._state]);
                if (d === c) {
                    var v = g + this.getRepLen1Price(this._state, p);
                    v < this._optimum[1].price && (this._optimum[1].price = v, this._optimum[1].makeAsShortRep())
                }
                var y = n >= this.repLens[h] ? n : this.repLens[h];
                if (2 > y)return this.backRes = this._optimum[1].backPrev, 1;
                this._optimum[1].posPrev = 0, this._optimum[0].backs0 = this.reps[0], this._optimum[0].backs1 = this.reps[1], this._optimum[0].backs2 = this.reps[2], this._optimum[0].backs3 = this.reps[3];
                var b = y;
                do this._optimum[b--].price = u; while (b >= 2);
                for (s = 0; s < i.kNumRepDistances; s++) {
                    var w = this.repLens[s];
                    if (!(2 > w)) {
                        var _ = g + this.getPureRepPrice(s, this._state, p);
                        do {
                            var x = _ + this._repMatchLenEncoder.getPrice(w - 2, p), S = this._optimum[w];
                            x < S.price && (S.price = x, S.posPrev = 0, S.backPrev = s, S.prev1IsChar = !1)
                        } while (--w >= 2)
                    }
                }
                var E = m + r.Encoder.getPrice0(this._isRep[this._state]);
                if (b = this.repLens[0] >= 2 ? this.repLens[0] + 1 : 2, n >= b) {
                    for (var M = 0; b > this._matchDistances[M];)M += 2;
                    for (; ; b++) {
                        var A = this._matchDistances[M + 1], T = E + this.getPosLenPrice(A, b, p), C = this._optimum[b];
                        if (T < C.price && (C.price = T, C.posPrev = 0, C.backPrev = A + i.kNumRepDistances, C.prev1IsChar = !1), b === this._matchDistances[M] && (M += 2, M === o))break
                    }
                }
                for (var P = 0; ;) {
                    if (P++, P === y)return this.backward(P);
                    var L = this.readMatchDistances();
                    if (o = this._numDistancePairs, L >= this._numFastBytes)return this._longestMatchLength = L, this._longestMatchWasFound = !0, this.backward(P);
                    e++;
                    var k, B = this._optimum[P].posPrev;
                    if (this._optimum[P].prev1IsChar ? (B--, this._optimum[P].prev2 ? (k = this._optimum[this._optimum[P].posPrev2].state, k = this._optimum[P].backPrev2 < i.kNumRepDistances ? i.stateUpdateRep(k) : i.stateUpdateMatch(k)) : k = this._optimum[B].state, k = i.stateUpdateChar(k)) : k = this._optimum[B].state, B === P - 1)k = this._optimum[P].isShortRep() ? i.stateUpdateShortRep(k) : i.stateUpdateChar(k); else {
                        var R;
                        this._optimum[P].prev1IsChar && this._optimum[P].prev2 ? (B = this._optimum[P].posPrev2, R = this._optimum[P].backPrev2, k = i.stateUpdateRep(k)) : (R = this._optimum[P].backPrev, k = R < i.kNumRepDistances ? i.stateUpdateRep(k) : i.stateUpdateMatch(k));
                        var I = this._optimum[B];
                        R < i.kNumRepDistances ? 0 === R ? (this.reps[0] = I.backs0, this.reps[1] = I.backs1, this.reps[2] = I.backs2, this.reps[3] = I.backs3) : 1 === R ? (this.reps[0] = I.backs1, this.reps[1] = I.backs0, this.reps[2] = I.backs2, this.reps[3] = I.backs3) : 2 === R ? (this.reps[0] = I.backs2, this.reps[1] = I.backs0, this.reps[2] = I.backs1, this.reps[3] = I.backs3) : (this.reps[0] = I.backs3, this.reps[1] = I.backs0, this.reps[2] = I.backs1, this.reps[3] = I.backs2) : (this.reps[0] = R - i.kNumRepDistances, this.reps[1] = I.backs0, this.reps[2] = I.backs1, this.reps[3] = I.backs2)
                    }
                    this._optimum[P].state = k, this._optimum[P].backs0 = this.reps[0], this._optimum[P].backs1 = this.reps[1], this._optimum[P].backs2 = this.reps[2], this._optimum[P].backs3 = this.reps[3];
                    var F = this._optimum[P].price;
                    c = this._matchFinder.getIndexByte(-1), d = this._matchFinder.getIndexByte(-this.reps[0] - 2), p = e & this._posStateMask;
                    var D = F + r.Encoder.getPrice0(this._isMatch[(k << i.kNumPosStatesBitsMax) + p]) + this._literalEncoder.getSubCoder(e, this._matchFinder.getIndexByte(-2)).getPrice(!i.stateIsCharState(k), d, c), O = this._optimum[P + 1], N = !1;
                    if (D < O.price && (O.price = D, O.posPrev = P, O.makeAsChar(), N = !0), m = F + r.Encoder.getPrice1(this._isMatch[(k << i.kNumPosStatesBitsMax) + p]), g = m + r.Encoder.getPrice1(this._isRep[k]), d === c && !(O.posPrev < P && 0 === O.backPrev)) {
                        var U = g + this.getRepLen1Price(k, p);
                        U <= O.price && (O.price = U, O.posPrev = P, O.makeAsShortRep(), N = !0)
                    }
                    var z = this._matchFinder.getNumAvailableBytes() + 1;
                    if (z = Math.min(f - 1 - P, z), a = z, !(2 > a)) {
                        if (a > this._numFastBytes && (a = this._numFastBytes), !N && d !== c) {
                            var V = Math.min(z - 1, this._numFastBytes), W = this._matchFinder.getMatchLen(0, this.reps[0], V);
                            if (W >= 2) {
                                for (var H = i.stateUpdateChar(k), G = e + 1 & this._posStateMask, j = D + r.Encoder.getPrice1(this._isMatch[(H << i.kNumPosStatesBitsMax) + G]) + r.Encoder.getPrice1(this._isRep[H]), Y = P + 1 + W; Y > y;)this._optimum[++y].price = u;
                                var Z = j + this.getRepPrice(0, W, H, G), X = this._optimum[Y];
                                Z < X.price && (X.price = Z, X.posPrev = P + 1, X.backPrev = 0, X.prev1IsChar = !0, X.prev2 = !1)
                            }
                        }
                        var q, K = 2;
                        for (q = 0; q < i.kNumRepDistances; q++) {
                            var Q = this._matchFinder.getMatchLen(-1, this.reps[q], a);
                            if (!(2 > Q)) {
                                var J = Q;
                                do {
                                    for (; P + Q > y;)this._optimum[++y].price = u;
                                    var $ = g + this.getRepPrice(q, Q, k, p), ee = this._optimum[P + Q];
                                    $ < ee.price && (ee.price = $, ee.posPrev = P, ee.backPrev = q, ee.prev1IsChar = !1)
                                } while (--Q >= 2);
                                if (Q = J, 0 === q && (K = Q + 1), z > Q) {
                                    var te = Math.min(z - 1 - Q, this._numFastBytes), ie = this._matchFinder.getMatchLen(Q, this.reps[q], te);
                                    if (ie >= 2) {
                                        var re = i.stateUpdateRep(k), ne = e + Q & this._posStateMask, oe = g + this.getRepPrice(q, Q, k, p) + r.Encoder.getPrice0(this._isMatch[(re << i.kNumPosStatesBitsMax) + ne]) + this._literalEncoder.getSubCoder(e + Q, this._matchFinder.getIndexByte(Q - 2)).getPrice(!0, this._matchFinder.getIndexByte(Q - 1 - (this.reps[q] + 1)), this._matchFinder.getIndexByte(Q - 1));
                                        re = i.stateUpdateChar(re), ne = e + Q + 1 & this._posStateMask;
                                        for (var ae = oe + r.Encoder.getPrice1(this._isMatch[(re << i.kNumPosStatesBitsMax) + ne]), se = ae + r.Encoder.getPrice1(this._isRep[re]), he = Q + 1 + ie; P + he > y;)this._optimum[++y].price = u;
                                        var le = se + this.getRepPrice(0, ie, re, ne), ue = this._optimum[P + he];
                                        le < ue.price && (ue.price = le, ue.posPrev = P + Q + 1, ue.backPrev = 0, ue.prev1IsChar = !0, ue.prev2 = !0, ue.posPrev2 = P, ue.backPrev2 = q)
                                    }
                                }
                            }
                        }
                        if (L > a) {
                            for (L = a, o = 0; L > this._matchDistances[o];)o += 2;
                            this._matchDistances[o] = L, o += 2
                        }
                        if (L >= K) {
                            for (E = m + r.Encoder.getPrice0(this._isRep[k]); P + L > y;)this._optimum[++y].price = u;
                            for (var ce = 0; K > this._matchDistances[ce];)ce += 2;
                            var de;
                            for (de = K; ; de++) {
                                var fe = this._matchDistances[ce + 1], pe = E + this.getPosLenPrice(fe, de, p), me = this._optimum[P + de];
                                if (pe < me.price && (me.price = pe, me.posPrev = P, me.backPrev = fe + i.kNumRepDistances, me.prev1IsChar = !1), de === this._matchDistances[ce]) {
                                    if (z > de) {
                                        var ge = Math.min(z - 1 - de, this._numFastBytes), ve = this._matchFinder.getMatchLen(de, fe, ge);
                                        if (ve >= 2) {
                                            var ye = i.stateUpdateMatch(k), be = e + de & this._posStateMask, we = pe + r.Encoder.getPrice0(this._isMatch[(ye << i.kNumPosStatesBitsMax) + be]) + this._literalEncoder.getSubCoder(e + de, this._matchFinder.getIndexByte(de - 2)).getPrice(!0, this._matchFinder.getIndexByte(de - (fe + 1) - 1), this._matchFinder.getIndexByte(de - 1));
                                            ye = i.stateUpdateChar(ye), be = e + de + 1 & this._posStateMask;
                                            for (var _e = we + r.Encoder.getPrice1(this._isMatch[(ye << i.kNumPosStatesBitsMax) + be]), xe = _e + r.Encoder.getPrice1(this._isRep[ye]), Se = de + 1 + ve; P + Se > y;)this._optimum[++y].price = u;
                                            var Ee = xe + this.getRepPrice(0, ve, ye, be), Me = this._optimum[P + Se];
                                            Ee < Me.price && (Me.price = Ee, Me.posPrev = P + de + 1, Me.backPrev = 0, Me.prev1IsChar = !0, Me.prev2 = !0, Me.posPrev2 = P, Me.backPrev2 = fe + i.kNumRepDistances)
                                        }
                                    }
                                    if (ce += 2, ce === o)break
                                }
                            }
                        }
                    }
                }
            }, y.prototype.changePair = function (e, t) {
                var i = 7;
                return 1 << 32 - i > e && t >= e << i
            }, y.prototype.writeEndMarker = function (e) {
                if (this._writeEndMark) {
                    this._rangeEncoder.encode(this._isMatch, (this._state << i.kNumPosStatesBitsMax) + e, 1), this._rangeEncoder.encode(this._isRep, this._state, 0), this._state = i.stateUpdateMatch(this._state);
                    var t = i.kMatchMinLen;
                    this._lenEncoder.encode(this._rangeEncoder, t - i.kMatchMinLen, e);
                    var r = (1 << i.kNumPosSlotBits) - 1, n = i.getLenToPosState(t);
                    this._posSlotEncoder[n].encode(this._rangeEncoder, r);
                    var o = 30, a = (1 << o) - 1;
                    this._rangeEncoder.encodeDirectBits(a >> i.kNumAlignBits, o - i.kNumAlignBits), this._posAlignEncoder.reverseEncode(this._rangeEncoder, a & i.kAlignMask)
                }
            }, y.prototype.flush = function (e) {
                this.releaseMFStream(), this.writeEndMarker(e & this._posStateMask), this._rangeEncoder.flushData(), this._rangeEncoder.flushStream()
            }, y.prototype.codeOneBlock = function (e, t, n) {
                if (e[0] = 0, t[0] = 0, n[0] = !0, this._inStream && (this._matchFinder.setStream(this._inStream), this._matchFinder.init(), this._needReleaseMFStream = !0, this._inStream = null), !this._finished) {
                    this._finished = !0;
                    var o, a, s, h = this.nowPos64;
                    if (0 === this.nowPos64) {
                        if (0 === this._matchFinder.getNumAvailableBytes())return void this.flush(this.nowPos64);
                        this.readMatchDistances(), o = this.nowPos64 & this._posStateMask, this._rangeEncoder.encode(this._isMatch, (this._state << i.kNumPosStatesBitsMax) + o, 0), this._state = i.stateUpdateChar(this._state), a = this._matchFinder.getIndexByte(0 - this._additionalOffset), this._literalEncoder.getSubCoder(this.nowPos64, this._previousByte).encode(this._rangeEncoder, a), this._previousByte = a, this._additionalOffset--, this.nowPos64++
                    }
                    if (0 === this._matchFinder.getNumAvailableBytes())return void this.flush(this.nowPos64);
                    for (; ;) {
                        var l = this.getOptimum(this.nowPos64), u = this.backRes;
                        o = this.nowPos64 & this._posStateMask;
                        var c = (this._state << i.kNumPosStatesBitsMax) + o;
                        if (1 === l && -1 === u) {
                            this._rangeEncoder.encode(this._isMatch, c, 0), a = this._matchFinder.getIndexByte(-this._additionalOffset);
                            var d = this._literalEncoder.getSubCoder(this.nowPos64, this._previousByte);
                            if (i.stateIsCharState(this._state))d.encode(this._rangeEncoder, a); else {
                                var f = this._matchFinder.getIndexByte(-this._repDistances[0] - 1 - this._additionalOffset);
                                d.encodeMatched(this._rangeEncoder, f, a)
                            }
                            this._previousByte = a, this._state = i.stateUpdateChar(this._state)
                        } else {
                            if (this._rangeEncoder.encode(this._isMatch, c, 1), u < i.kNumRepDistances) {
                                this._rangeEncoder.encode(this._isRep, this._state, 1), 0 === u ? (this._rangeEncoder.encode(this._isRepG0, this._state, 0), 1 === l ? this._rangeEncoder.encode(this._isRep0Long, c, 0) : this._rangeEncoder.encode(this._isRep0Long, c, 1)) : (this._rangeEncoder.encode(this._isRepG0, this._state, 1), 1 === u ? this._rangeEncoder.encode(this._isRepG1, this._state, 0) : (this._rangeEncoder.encode(this._isRepG1, this._state, 1), this._rangeEncoder.encode(this._isRepG2, this._state, u - 2))), 1 === l ? this._state = i.stateUpdateShortRep(this._state) : (this._repMatchLenEncoder.encode(this._rangeEncoder, l - i.kMatchMinLen, o), this._state = i.stateUpdateRep(this._state));
                                var p = this._repDistances[u];
                                if (0 !== u) {
                                    for (s = u; s >= 1; s--)this._repDistances[s] = this._repDistances[s - 1];
                                    this._repDistances[0] = p
                                }
                            } else {
                                this._rangeEncoder.encode(this._isRep, this._state, 0), this._state = i.stateUpdateMatch(this._state), this._lenEncoder.encode(this._rangeEncoder, l - i.kMatchMinLen, o), u -= i.kNumRepDistances;
                                var m = g(u), v = i.getLenToPosState(l);
                                if (this._posSlotEncoder[v].encode(this._rangeEncoder, m), m >= i.kStartPosModelIndex) {
                                    var y = (m >>> 1) - 1, b = (2 | 1 & m) << y, w = u - b;
                                    m < i.kEndPosModelIndex ? r.BitTreeEncoder.reverseEncode(this._posEncoders, b - m - 1, this._rangeEncoder, y, w) : (this._rangeEncoder.encodeDirectBits(w >> i.kNumAlignBits, y - i.kNumAlignBits), this._posAlignEncoder.reverseEncode(this._rangeEncoder, w & i.kAlignMask), this._alignPriceCount++)
                                }
                                var _ = u;
                                for (s = i.kNumRepDistances - 1; s >= 1; s--)this._repDistances[s] = this._repDistances[s - 1];
                                this._repDistances[0] = _, this._matchPriceCount++
                            }
                            this._previousByte = this._matchFinder.getIndexByte(l - 1 - this._additionalOffset)
                        }
                        if (this._additionalOffset -= l, this.nowPos64 += l, 0 === this._additionalOffset) {
                            if (this._matchPriceCount >= 128 && this.fillDistancesPrices(), this._alignPriceCount >= i.kAlignTableSize && this.fillAlignPrices(), e[0] = this.nowPos64, t[0] = this._rangeEncoder.getProcessedSizeAdd(), 0 === this._matchFinder.getNumAvailableBytes())return void this.flush(this.nowPos64);
                            if (this.nowPos64 - h >= 4096)return this._finished = !1, void(n[0] = !1)
                        }
                    }
                }
            }, y.prototype.releaseMFStream = function () {
                this._matchFinder && this._needReleaseMFStream && (this._matchFinder.releaseStream(), this._needReleaseMFStream = !1)
            }, y.prototype.setOutStream = function (e) {
                this._rangeEncoder.setStream(e)
            }, y.prototype.releaseOutStream = function () {
                this._rangeEncoder.releaseStream()
            }, y.prototype.releaseStreams = function () {
                this.releaseMFStream(), this.releaseOutStream()
            }, y.prototype.setStreams = function (e, t, r, n) {
                this._inStream = e, this._finished = !1, this.create(), this.setOutStream(t), this.init(), this.fillDistancesPrices(), this.fillAlignPrices(), this._lenEncoder.setTableSize(this._numFastBytes + 1 - i.kMatchMinLen), this._lenEncoder.updateTables(1 << this._posStateBits), this._repMatchLenEncoder.setTableSize(this._numFastBytes + 1 - i.kMatchMinLen), this._repMatchLenEncoder.updateTables(1 << this._posStateBits), this.nowPos64 = 0
            }, y.prototype.code = function (e, t, i, r, n) {
                this._needReleaseMFStream = !1;
                try {
                    for (this.setStreams(e, t, i, r); ;) {
                        if (this.codeOneBlock(this.processedInSize, this.processedOutSize, this.finished), this.finished[0])return;
                        n && n.setProgress(this.processedInSize[0], this.processedOutSize[0])
                    }
                } finally {
                    this.releaseStreams()
                }
            }, y.prototype.writeCoderProperties = function (e) {
                var t, i = a(p);
                for (i[0] = 9 * (5 * this._posStateBits + this._numLiteralPosStateBits) + this._numLiteralContextBits, t = 0; 4 > t; t++)i[1 + t] = this._dictionarySize >>> 8 * t;
                for (t = 0; p > t; t++)e.writeByte(i[t])
            }, y.prototype.fillDistancesPrices = function () {
                var e = [];
                e.length = i.kNumFullDistances;
                var t, n;
                for (t = i.kStartPosModelIndex; t < i.kNumFullDistances; t++) {
                    n = g(t);
                    var o = (n >>> 1) - 1, a = (2 | 1 & n) << o;
                    e[t] = r.BitTreeEncoder.reverseGetPrice(this._posEncoders, a - n - 1, o, t - a)
                }
                for (var s = 0; s < i.kNumLenToPosStates; s++) {
                    var h = this._posSlotEncoder[s], l = s << i.kNumPosSlotBits;
                    for (n = 0; n < this._distTableSize; n++)this._posSlotPrices[l + n] = h.getPrice(n);
                    for (n = i.kEndPosModelIndex; n < this._distTableSize; n++)this._posSlotPrices[l + n] += (n >>> 1) - 1 - i.kNumAlignBits << r.Encoder.kNumBitPriceShiftBits;
                    var u = s * i.kNumFullDistances;
                    for (t = 0; t < i.kStartPosModelIndex; t++)this._distancesPrices[u + t] = this._posSlotPrices[l + t];
                    for (; t < i.kNumFullDistances; t++)this._distancesPrices[u + t] = this._posSlotPrices[l + g(t)] + e[t]
                }
                this._matchPriceCount = 0
            }, y.prototype.fillAlignPrices = function () {
                var e;
                for (e = 0; e < i.kAlignTableSize; e++)this._alignPrices[e] = this._posAlignEncoder.reverseGetPrice(e);
                this._alignPriceCount = 0
            }, y.prototype.setAlgorithm = function (e) {
                return !0
            }, y.prototype.setDictionarySize = function (e) {
                var t = 29;
                if (e < 1 << i.kDicLogSizeMin || e > 1 << t)return !1;
                this._dictionarySize = e;
                for (var r = 0; e > 1 << r;)r++;
                return this._distTableSize = 2 * r, !0
            }, y.prototype.setNumFastBytes = function (e) {
                return 5 > e || e > i.kMatchMaxLen ? !1 : (this._numFastBytes = e, !0)
            }, y.prototype.setMatchFinder = function (e) {
                if (0 > e || e > 2)return !1;
                var t = this._matchFinderType;
                return this._matchFinderType = e, this._matchFinder && t != this._matchFinderType && (this._dictionarySizePrev = -1, this._matchFinder = null), !0
            }, y.prototype.setLcLpPb = function (e, t, r) {
                return 0 > t || t > i.kNumLitPosStatesBitsEncodingMax || 0 > e || e > i.kNumLitContextBitsMax || 0 > r || r > i.kNumPosStatesBitsEncodingMax ? !1 : (this._numLiteralPosStateBits = t, this._numLiteralContextBits = e, this._posStateBits = r, this._posStateMask = (1 << this._posStateBits) - 1, !0)
            }, y.prototype.setEndMarkerMode = function (e) {
                this._writeEndMark = e
            }, y.EMatchFinderTypeBT2 = h, y.EMatchFinderTypeBT4 = l, o(y.prototype), t.exports = o(y)
        }()
    }, {"../LZ": 23, "../RangeCoder": 31, "../freeze": 38, "../makeBuffer": 39, "./Base": 28, amdefine: 82}],
    31: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./freeze"), r = e("./RangeCoder/BitTreeDecoder"), n = e("./RangeCoder/BitTreeEncoder"), o = e("./RangeCoder/Decoder"), a = e("./RangeCoder/Encoder");
            t.exports = i({BitTreeDecoder: r, BitTreeEncoder: n, Decoder: o, Encoder: a})
        }()
    }, {
        "./RangeCoder/BitTreeDecoder": 32,
        "./RangeCoder/BitTreeEncoder": 33,
        "./RangeCoder/Decoder": 34,
        "./RangeCoder/Encoder": 35,
        "./freeze": 38,
        amdefine: 82
    }],
    32: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = e("./Encoder"), n = function (e) {
                this._numBitLevels = e, this.init()
            };
            n.prototype.init = function () {
                this._models = r.initBitModels(null, 1 << this._numBitLevels)
            }, n.prototype.decode = function (e) {
                for (var t = 1, i = this._numBitLevels; i--;)t = t << 1 | e.decodeBit(this._models, t);
                return t - (1 << this._numBitLevels)
            }, n.prototype.reverseDecode = function (e) {
                for (var t, i = 1, r = 0, n = 0; n < this._numBitLevels; ++n)t = e.decodeBit(this._models, i), i = i << 1 | t, r |= t << n;
                return r
            }, n.reverseDecode = function (e, t, i, r) {
                for (var n, o = 1, a = 0, s = 0; r > s; ++s)n = i.decodeBit(e, t + o), o = o << 1 | n, a |= n << s;
                return a
            }, i(n.prototype), t.exports = i(n)
        }()
    }, {"../freeze": 38, "./Encoder": 35, amdefine: 82}],
    33: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = e("./Encoder"), n = function (e) {
                this._numBitLevels = e, this.init()
            };
            n.prototype.init = function () {
                this._models = r.initBitModels(null, 1 << this._numBitLevels)
            }, n.prototype.encode = function (e, t) {
                var i, r = 1;
                for (i = this._numBitLevels; i > 0;) {
                    i--;
                    var n = t >>> i & 1;
                    e.encode(this._models, r, n), r = r << 1 | n
                }
            }, n.prototype.reverseEncode = function (e, t) {
                var i, r = 1;
                for (i = 0; i < this._numBitLevels; i++) {
                    var n = 1 & t;
                    e.encode(this._models, r, n), r = r << 1 | n, t >>>= 1
                }
            }, n.reverseEncode = function (e, t, i, r, n) {
                var o, a = 1;
                for (o = 0; r > o; o++) {
                    var s = 1 & n;
                    i.encode(e, t + a, s), a = a << 1 | s, n >>>= 1
                }
            }, n.prototype.getPrice = function (e) {
                var t, i = 0, n = 1;
                for (t = this._numBitLevels; t > 0;) {
                    t--;
                    var o = e >>> t & 1;
                    i += r.getPrice(this._models[n], o), n = n << 1 | o
                }
                return i
            }, n.prototype.reverseGetPrice = function (e) {
                var t, i = 0, n = 1;
                for (t = this._numBitLevels; t > 0; t--) {
                    var o = 1 & e;
                    e >>>= 1, i += r.getPrice(this._models[n], o), n = n << 1 | o
                }
                return i
            }, n.reverseGetPrice = function (e, t, i, n) {
                var o, a = 0, s = 1;
                for (o = i; o > 0; o--) {
                    var h = 1 & n;
                    n >>>= 1, a += r.getPrice(e[t + s], h), s = s << 1 | h
                }
                return a
            }, i(n.prototype), t.exports = i(n)
        }()
    }, {"../freeze": 38, "./Encoder": 35, amdefine: 82}],
    34: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = function (e) {
                e && (this.setStream(e), this.init())
            };
            r.prototype.setStream = function (e) {
                this._stream = e
            }, r.prototype.releaseStream = function () {
                this._stream = null
            }, r.prototype.init = function () {
                var e = 5;
                for (this._code = 0, this._range = -1; e--;)this._code = this._code << 8 | this._stream.readByte()
            }, r.prototype.decodeDirectBits = function (e) {
                for (var t, i = 0, r = e; r--;)this._range >>>= 1, t = this._code - this._range >>> 31, this._code -= this._range & t - 1, i = i << 1 | 1 - t, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8);
                return i
            }, r.prototype.decodeBit = function (e, t) {
                var i = e[t], r = (this._range >>> 11) * i;
                return (2147483648 ^ this._code) < (2147483648 ^ r) ? (this._range = r, e[t] += 2048 - i >>> 5, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8), 0) : (this._range -= r, this._code -= r, e[t] -= i >>> 5, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8), 1)
            }, i(r.prototype), t.exports = i(r)
        }()
    }, {"../freeze": 38, amdefine: 82}],
    35: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("../freeze"), r = 4294967295, n = 16777215, o = 255, a = 4278190080, s = 11, h = 1 << s, l = 5, u = 2, c = 6, d = function (e) {
                this.init(), e && this.setStream(e)
            };
            d.prototype.setStream = function (e) {
                this._stream = e
            }, d.prototype.releaseStream = function () {
                this._stream = null
            }, d.prototype.init = function () {
                this._position = 0, this.low = 0, this.range = r, this._cacheSize = 1, this._cache = 0
            }, d.prototype.flushData = function () {
                var e;
                for (e = 0; 5 > e; e++)this.shiftLow()
            }, d.prototype.flushStream = function () {
                this._stream.flush && this._stream.flush()
            }, d.prototype.shiftLow = function () {
                var e = this.low > r ? 1 : 0;
                if (this.low < a || e) {
                    this._position += this._cacheSize;
                    var t = this._cache;
                    do this._stream.writeByte(t + e & o), t = o; while (0 !== --this._cacheSize);
                    this._cache = this.low >>> 24
                }
                this._cacheSize++, this.low = 256 * (this.low & n)
            }, d.prototype.encodeDirectBits = function (e, t) {
                var i, r;
                for (r = 1 << t - 1, i = t - 1; i >= 0; i--, r >>>= 1)this.range >>>= 1, e & r && (this.low += this.range), this.range <= n && (this.range *= 256, this.shiftLow())
            }, d.prototype.getProcessedSizeAdd = function () {
                return this._cacheSize + this._position + 4
            }, d.initBitModels = function (e, t) {
                var i;
                for (t && !e && ("undefined" != typeof Uint16Array ? e = new Uint16Array(t) : (e = [], e.length = t)), i = 0; i < e.length; i++)e[i] = h >>> 1;
                return e
            }, d.prototype.encode = function (e, t, i) {
                var r = e[t], o = (this.range >>> s) * r;
                0 === i ? (this.range = o, e[t] = r + (h - r >>> l)) : (this.low += o, this.range -= o, e[t] = r - (r >>> l)), this.range <= n && (this.range *= 256, this.shiftLow())
            };
            var f = [];
            "undefined" != typeof Uint32Array && (f = new Uint32Array(h >>> u)), function () {
                var e, t, i = s - u;
                for (e = i - 1; e >= 0; e--) {
                    var r = 1 << i - e - 1, n = 1 << i - e;
                    for (t = r; n > t; t++)f[t] = (e << c) + (n - t << c >>> i - e - 1)
                }
            }(), d.getPrice = function (e, t) {
                return f[((e - t ^ -t) & h - 1) >>> u]
            }, d.getPrice0 = function (e) {
                return f[e >>> u]
            }, d.getPrice1 = function (e) {
                return f[h - e >>> u]
            }, d.kNumBitPriceShiftBits = c, i(d.prototype), t.exports = i(d)
        }()
    }, {"../freeze": 38, amdefine: 82}],
    36: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./freeze"), r = function () {
            };
            r.prototype.readByte = function () {
                throw new Error("abstract method readByte() not implemented")
            }, r.prototype.read = function (e, t, i) {
                for (var r = 0; i > r;) {
                    var n = this.readByte();
                    if (0 > n)return 0 === r ? -1 : r;
                    e[t++] = n, r++
                }
                return r
            }, r.prototype.seek = function (e) {
                throw new Error("abstract method seek() not implemented")
            }, r.prototype.writeByte = function (e) {
                throw new Error("abstract method readByte() not implemented")
            }, r.prototype.write = function (e, t, i) {
                var r;
                for (r = 0; i > r; r++)this.writeByte(e[t++]);
                return i
            }, r.prototype.flush = function () {
            }, t.exports = i(r)
        }()
    }, {"./freeze": 38, amdefine: 82}],
    37: [function (e, t, i) {
        (function (i) {
            if ("function" != typeof r)var r = e("amdefine")(t);
            !function () {
                "use strict";
                var r = e("./freeze"), n = (e("./makeBuffer"), e("./LZMA")), o = e("./Stream"), a = function (e) {
                    if ("readByte" in e)return e;
                    var t = new o;
                    return t.pos = 0, t.size = e.length, t.readByte = function () {
                        return this.eof() ? -1 : e[this.pos++]
                    }, t.read = function (t, i, r) {
                        for (var n = 0; r > n && this.pos < e.length;)t[i++] = e[this.pos++], n++;
                        return n
                    }, t.seek = function (e) {
                        this.pos = e
                    }, t.eof = function () {
                        return this.pos >= e.length
                    }, t
                }, s = function (e) {
                    var t = new o, r = !0;
                    if (e)if ("number" == typeof e)t.buffer = new i(e), r = !1; else {
                        if ("writeByte" in e)return e;
                        t.buffer = e, r = !1
                    } else t.buffer = new i(16384);
                    return t.pos = 0, t.writeByte = function (e) {
                        if (r && this.pos >= this.buffer.length) {
                            var t = new i(2 * this.buffer.length);
                            this.buffer.copy(t), this.buffer = t
                        }
                        this.buffer[this.pos++] = e
                    }, t.getBuffer = function () {
                        if (this.pos !== this.buffer.length) {
                            if (!r)throw new TypeError("outputsize does not match decoded input");
                            var e = new i(this.pos);
                            this.buffer.copy(e, 0, 0, this.pos), this.buffer = e
                        }
                        return this.buffer
                    }, t._coerced = !0, t
                }, h = Object.create(null);
                h.decompress = function (e, t, i, r) {
                    var o = new n.Decoder;
                    if (!o.setDecoderProperties(e))throw"Incorrect stream properties";
                    if (!o.code(t, i, r))throw"Error in data stream";
                    return !0
                }, h.decompressFile = function (e, t) {
                    var i, r, o = new n.Decoder;
                    if (e = a(e), !o.setDecoderPropertiesFromStream(e))throw"Incorrect stream properties";
                    var h = 0;
                    for (i = 0, r = 1; 4 > i; i++, r *= 256)h += e.readByte() * r;
                    var l = 0;
                    for (i = 0, r = 1; 4 > i; i++, r *= 256)l += e.readByte() * r;
                    var u = h + 4294967296 * l;
                    if (4294967295 === h && 4294967295 === l ? u = -1 : l >= 2097152 && (u = -1), u >= 0 && !t && (t = u), t = s(t), !o.code(e, t, u))throw"Error in data stream";
                    return "getBuffer" in t ? t.getBuffer() : !0
                };
                var l = [{a: 0, d: 0, fb: 0, mf: null, lc: 0, lp: 0, pb: 0}, {
                    a: 0,
                    d: 16,
                    fb: 64,
                    mf: "hc4",
                    lc: 3,
                    lp: 0,
                    pb: 2
                }, {a: 0, d: 20, fb: 64, mf: "hc4", lc: 3, lp: 0, pb: 2}, {
                    a: 1,
                    d: 19,
                    fb: 64,
                    mf: "bt4",
                    lc: 3,
                    lp: 0,
                    pb: 2
                }, {a: 2, d: 20, fb: 64, mf: "bt4", lc: 3, lp: 0, pb: 2}, {
                    a: 2,
                    d: 21,
                    fb: 128,
                    mf: "bt4",
                    lc: 3,
                    lp: 0,
                    pb: 2
                }, {a: 2, d: 22, fb: 128, mf: "bt4", lc: 3, lp: 0, pb: 2}, {
                    a: 2,
                    d: 23,
                    fb: 128,
                    mf: "bt4",
                    lc: 3,
                    lp: 0,
                    pb: 2
                }, {a: 2, d: 24, fb: 255, mf: "bt4", lc: 3, lp: 0, pb: 2}, {
                    a: 2,
                    d: 25,
                    fb: 255,
                    mf: "bt4",
                    lc: 3,
                    lp: 0,
                    pb: 2
                }], u = function (e) {
                    var t = new n.Encoder, i = {a: 1, d: 23, fb: 128, lc: 3, lp: 0, pb: 2, mf: "bt4", eos: !1};
                    if (e) {
                        "number" == typeof e && (e = l[e]);
                        var r;
                        for (r in e)Object.prototype.hasOwnProperty.call(e, r) && (i[r] = e[r])
                    }
                    return t.setAlgorithm(i.a), t.setDictionarySize(1 << +i.d), t.setNumFastBytes(+i.fb), t.setMatchFinder("bt4" === i.mf ? n.Encoder.EMatchFinderTypeBT4 : n.Encoder.EMatchFinderTypeBT2), t.setLcLpPb(+i.lc, +i.lp, +i.pb), t.setEndMarkerMode(!!i.eos), t
                };
                h.compress = function (e, t, i, r) {
                    var n = u(i);
                    return n.writeCoderProperties(t), n.code(e, t, -1, -1, {
                        setProgress: function (e, t) {
                            r && r(e, t)
                        }
                    }), !0
                }, h.compressFile = function (e, t, i, r) {
                    var n = u(i);
                    e = a(e);
                    var o;
                    "size" in e && e.size >= 0 ? o = e.size : (o = -1, n.setEndMarkerMode(!0)), t = s(t), n.writeCoderProperties(t);
                    var h = function (e) {
                        var i;
                        for (i = 0; 8 > i; i++)t.writeByte(255 & e), e = Math.floor(e / 256)
                    };
                    return h(o), n.code(e, t, o, -1, {
                        setProgress: function (e, t) {
                            r && r(e, t)
                        }
                    }), "getBuffer" in t ? t.getBuffer() : !0
                }, t.exports = r(h)
            }()
        }).call(this, e("buffer").Buffer)
    }, {"./LZMA": 27, "./Stream": 36, "./freeze": 38, "./makeBuffer": 39, amdefine: 82, buffer: 84}],
    38: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            Object.freeze ? t.exports = Object.freeze : t.exports = function (e) {
                return e
            }
        }()
    }, {amdefine: 82}],
    39: [function (e, t, i) {
        (function (i) {
            if ("function" != typeof r)var r = e("amdefine")(t);
            !function () {
                "use strict";
                var e = function (e) {
                    var t, i = [];
                    for (t = 0; e > t; t++)i[t] = 0;
                    return i
                };
                "undefined" != typeof Uint8Array ? e = function (e) {
                    return new Uint8Array(e)
                } : "undefined" != typeof i && (e = function (e) {
                    var t = new i(e);
                    return t.fill(0), t
                }), t.exports = e
            }()
        }).call(this, e("buffer").Buffer)
    }, {amdefine: 82, buffer: 84}],
    40: [function (e, t, i) {
        if ("function" != typeof r)var r = e("amdefine")(t);
        !function () {
            "use strict";
            var i = e("./lib/freeze"), r = e("./lib/LZ"), n = e("./lib/LZMA"), o = e("./lib/RangeCoder"), a = e("./lib/Stream"), s = e("./lib/Util");
            t.exports = i({
                version: "0.9.0",
                LZ: r,
                LZMA: n,
                RangeCoder: o,
                Stream: a,
                Util: s,
                compress: s.compress,
                compressFile: s.compressFile,
                decompress: s.decompress,
                decompressFile: s.decompressFile
            })
        }()
    }, {
        "./lib/LZ": 23,
        "./lib/LZMA": 27,
        "./lib/RangeCoder": 31,
        "./lib/Stream": 36,
        "./lib/Util": 37,
        "./lib/freeze": 38,
        amdefine: 82
    }],
    41: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.EffectComposer = function (e, t) {
            if (this.renderer = e, void 0 === t) {
                var i = window.innerWidth || 1, n = window.innerHeight || 1, o = {
                    minFilter: r.LinearFilter,
                    magFilter: r.LinearFilter,
                    format: r.RGBFormat,
                    stencilBuffer: !1
                };
                t = new r.WebGLRenderTarget(i, n, o)
            }
            this.renderTarget1 = t, this.renderTarget2 = t.clone(),
                this.writeBuffer = this.renderTarget1, this.readBuffer = this.renderTarget2, this.passes = [], void 0 === r.CopyShader && console.error("THREE.EffectComposer relies on THREE.CopyShader"), this.copyPass = new r.ShaderPass(r.CopyShader)
        }, r.EffectComposer.prototype = {
            swapBuffers: function () {
                var e = this.readBuffer;
                this.readBuffer = this.writeBuffer, this.writeBuffer = e
            }, addPass: function (e) {
                this.passes.push(e)
            }, insertPass: function (e, t) {
                this.passes.splice(t, 0, e)
            }, render: function (e) {
                this.writeBuffer = this.renderTarget1, this.readBuffer = this.renderTarget2;
                var t, i, n = !1, o = this.passes.length;
                for (i = 0; o > i; i++)if (t = this.passes[i], t.enabled) {
                    if (t.render(this.renderer, this.writeBuffer, this.readBuffer, e, n), t.needsSwap) {
                        if (n) {
                            var a = this.renderer.context;
                            a.stencilFunc(a.NOTEQUAL, 1, 4294967295), this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, e), a.stencilFunc(a.EQUAL, 1, 4294967295)
                        }
                        this.swapBuffers()
                    }
                    t instanceof r.MaskPass ? n = !0 : t instanceof r.ClearMaskPass && (n = !1)
                }
            }, reset: function (e) {
                void 0 === e && (e = this.renderTarget1.clone(), e.width = window.innerWidth, e.height = window.innerHeight), this.renderTarget1 = e, this.renderTarget2 = e.clone(), this.writeBuffer = this.renderTarget1, this.readBuffer = this.renderTarget2
            }, setSize: function (e, t) {
                var i = this.renderTarget1.clone();
                i.width = e, i.height = t, this.reset(i)
            }
        }
    }, {three: 138}],
    42: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.MaskPass = function (e, t) {
            this.scene = e, this.camera = t, this.enabled = !0, this.clear = !0, this.needsSwap = !1, this.inverse = !1
        }, r.MaskPass.prototype = {
            render: function (e, t, i, r) {
                var n = e.context;
                n.colorMask(!1, !1, !1, !1), n.depthMask(!1);
                var o, a;
                this.inverse ? (o = 0, a = 1) : (o = 1, a = 0), n.enable(n.STENCIL_TEST), n.stencilOp(n.REPLACE, n.REPLACE, n.REPLACE), n.stencilFunc(n.ALWAYS, o, 4294967295), n.clearStencil(a), e.render(this.scene, this.camera, i, this.clear), e.render(this.scene, this.camera, t, this.clear), n.colorMask(!0, !0, !0, !0), n.depthMask(!0), n.stencilFunc(n.EQUAL, 1, 4294967295), n.stencilOp(n.KEEP, n.KEEP, n.KEEP)
            }
        }, r.ClearMaskPass = function () {
            this.enabled = !0
        }, r.ClearMaskPass.prototype = {
            render: function (e, t, i, r) {
                var n = e.context;
                n.disable(n.STENCIL_TEST)
            }
        }
    }, {three: 138}],
    43: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.RenderPass = function (e, t, i, n, o) {
            this.scene = e, this.camera = t, this.overrideMaterial = i, this.clearColor = n, this.clearAlpha = void 0 !== o ? o : 1, this.oldClearColor = new r.Color, this.oldClearAlpha = 1, this.enabled = !0, this.clear = !0, this.needsSwap = !1
        }, r.RenderPass.prototype = {
            render: function (e, t, i, r) {
                this.scene.overrideMaterial = this.overrideMaterial, this.clearColor && (this.oldClearColor.copy(e.getClearColor()), this.oldClearAlpha = e.getClearAlpha(), e.setClearColor(this.clearColor, this.clearAlpha)), e.render(this.scene, this.camera, i, this.clear), this.clearColor && e.setClearColor(this.oldClearColor, this.oldClearAlpha), this.scene.overrideMaterial = null
            }
        }
    }, {three: 138}],
    44: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.ShaderPass = function (e, t) {
            this.textureID = void 0 !== t ? t : "tDiffuse", this.uniforms = r.UniformsUtils.clone(e.uniforms), this.material = new r.ShaderMaterial({
                uniforms: this.uniforms,
                vertexShader: e.vertexShader,
                fragmentShader: e.fragmentShader
            }), this.renderToScreen = !1, this.enabled = !0, this.needsSwap = !0, this.clear = !1, this.camera = new r.OrthographicCamera(-1, 1, 1, -1, 0, 1), this.scene = new r.Scene, this.quad = new r.Mesh(new r.PlaneBufferGeometry(2, 2), null), this.scene.add(this.quad)
        }, r.ShaderPass.prototype = {
            render: function (e, t, i, r) {
                this.uniforms[this.textureID] && (this.uniforms[this.textureID].value = i), this.quad.material = this.material, this.renderToScreen ? e.render(this.scene, this.camera) : e.render(this.scene, this.camera, t, this.clear)
            }
        }
    }, {three: 138}],
    45: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.CopyShader = {
            uniforms: {tDiffuse: {type: "t", value: null}, opacity: {type: "f", value: 1}},
            vertexShader: ["varying vec2 vUv;", "void main() {", "vUv = uv;", "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );", "}"].join("\n"),
            fragmentShader: ["uniform float opacity;", "uniform sampler2D tDiffuse;", "varying vec2 vUv;", "void main() {", "vec4 texel = texture2D( tDiffuse, vUv );", "gl_FragColor = opacity * texel;", "}"].join("\n")
        }
    }, {three: 138}],
    46: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.HorizontalBlurShader = {
            uniforms: {tDiffuse: {type: "t", value: null}, h: {type: "f", value: 1 / 512}},
            vertexShader: ["varying vec2 vUv;", "void main() {", "vUv = uv;", "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );", "}"].join("\n"),
            fragmentShader: ["uniform sampler2D tDiffuse;", "uniform float h;", "varying vec2 vUv;", "void main() {", "vec4 sum = vec4( 0.0 );", "sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;", "sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;", "sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;", "sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;", "sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;", "sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;", "sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;", "sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;", "gl_FragColor = sum;", "}"].join("\n")
        }
    }, {three: 138}],
    47: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.VerticalBlurShader = {
            uniforms: {tDiffuse: {type: "t", value: null}, v: {type: "f", value: 1 / 512}},
            vertexShader: ["varying vec2 vUv;", "void main() {", "vUv = uv;", "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );", "}"].join("\n"),
            fragmentShader: ["uniform sampler2D tDiffuse;", "uniform float v;", "varying vec2 vUv;", "void main() {", "vec4 sum = vec4( 0.0 );", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;", "sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;", "gl_FragColor = sum;", "}"].join("\n")
        }
    }, {three: 138}],
    48: [function (e, t, i) {
        "use strict";
        var r = e("three");
        r.Box3.prototype.setFromObjects = function (e) {
            return this.makeEmpty(), e.forEach(function (e) {
                e.geometry.boundingBox || e.geometry.computeBoundingBox(), this.union(e.geometry.boundingBox)
            }.bind(this)), this
        }, r.Mesh.prototype.raycast = function () {
            var e = new r.Matrix4, t = new r.Ray, i = new r.Sphere, n = new r.Vector3, o = new r.Vector3, a = new r.Vector3, s = new r.Vector3, h = new r.Vector3, l = new r.Vector3;
            return function (u, c) {
                var d = this.geometry, f = this.material;
                if (void 0 !== f && (null === d.boundingSphere && d.computeBoundingSphere(), i.copy(d.boundingSphere), i.applyMatrix4(this.matrixWorld), u.ray.isIntersectionSphere(i) !== !1 && (e.getInverse(this.matrixWorld), t.copy(u.ray).applyMatrix4(e), null === d.boundingBox || t.isIntersectionBox(d.boundingBox) !== !1))) {
                    var p, m, g;
                    if (d instanceof r.BufferGeometry) {
                        var v = d.attributes;
                        if (void 0 !== v.index) {
                            var y = v.index.array, b = v.position.array, w = d.drawcalls;
                            0 === w.length && (w = [{start: 0, count: y.length, index: 0}]);
                            for (var _ = 0, x = w.length; x > _; ++_)for (var S = w[_].start, E = w[_].count, M = w[_].index, A = S, T = S + E; T > A; A += 3) {
                                if (p = M + y[A], m = M + y[A + 1], g = M + y[A + 2], n.fromArray(b, 3 * p), o.fromArray(b, 3 * m), a.fromArray(b, 3 * g), f.side === r.BackSide)var C = t.intersectTriangle(a, o, n, !0); else var C = t.intersectTriangle(n, o, a, f.side !== r.DoubleSide);
                                if (null !== C) {
                                    C.applyMatrix4(this.matrixWorld);
                                    var P = u.ray.origin.distanceTo(C);
                                    P < u.near || P > u.far || c.push({
                                        distance: P,
                                        point: C,
                                        face: new r.Face3(p, m, g, r.Triangle.normal(n, o, a)),
                                        faceIndex: Math.floor(A / 3),
                                        object: this
                                    })
                                }
                            }
                        } else for (var b = v.position.array, A = 0, T = b.length; T > A; A += 9) {
                            if (n.fromArray(b, A), o.fromArray(b, A + 3), a.fromArray(b, A + 6), f.side === r.BackSide)var C = t.intersectTriangle(a, o, n, !0); else var C = t.intersectTriangle(n, o, a, f.side !== r.DoubleSide);
                            if (null !== C) {
                                C.applyMatrix4(this.matrixWorld);
                                var P = u.ray.origin.distanceTo(C);
                                P < u.near || P > u.far || (p = A / 3, m = p + 1, g = p + 2, c.push({
                                    distance: P,
                                    point: C,
                                    face: new r.Face3(p, m, g, r.Triangle.normal(n, o, a)),
                                    index: p,
                                    object: this
                                }))
                            }
                        }
                    } else if (d instanceof r.Geometry)for (var L = f instanceof r.MeshFaceMaterial, k = L === !0 ? f.materials : null, B = d.vertices, R = d.faces, I = 0, F = R.length; F > I; I++) {
                        var D = R[I], O = L === !0 ? k[D.materialIndex] : f;
                        if (void 0 !== O) {
                            if (p = B[D.a], m = B[D.b], g = B[D.c], O.morphTargets === !0) {
                                var N = d.morphTargets, U = this.morphTargetInfluences;
                                n.set(0, 0, 0), o.set(0, 0, 0), a.set(0, 0, 0);
                                for (var z = 0, V = N.length; V > z; z++) {
                                    var W = U[z];
                                    if (0 !== W) {
                                        var H = N[z].vertices;
                                        n.addScaledVector(s.subVectors(H[D.a], p), W), o.addScaledVector(h.subVectors(H[D.b], m), W), a.addScaledVector(l.subVectors(H[D.c], g), W)
                                    }
                                }
                                n.add(p), o.add(m), a.add(g), p = n, m = o, g = a
                            }
                            if (O.side === r.BackSide)var C = t.intersectTriangle(g, m, p, !0); else var C = t.intersectTriangle(p, m, g, O.side !== r.DoubleSide);
                            if (null !== C) {
                                C.applyMatrix4(this.matrixWorld);
                                var P = u.ray.origin.distanceTo(C);
                                P < u.near || P > u.far || c.push({
                                    distance: P,
                                    point: C,
                                    face: D,
                                    faceIndex: I,
                                    object: this
                                })
                            }
                        }
                    }
                }
            }
        }()
    }, {three: 138}],
    49: [function (e, t, i) {
        (function (i, r) {
            "use strict";
            function n(e) {
                this.urls = e;
                var t = i("bWVzc2FnZSBiaW5hcnlfbWVzaCB7CglyZXBlYXRlZCBjaHVua19zaW1wbGUgY2h1bmsgPSAxOwoJcmVwZWF0ZWQgY2h1bmtfcXVhbnRpemVkIHF1YW50aXplZF9jaHVuayA9IDI7Cn0KCi8vIERlZmluaXRpb24gb2YgdmVydGljZXM6IDNEIGNvb3JkaW5hdGVzLCBhbmQgMkQgdGV4dHVyZSBjb29yZGluYXRlcy4KbWVzc2FnZSB2ZXJ0aWNlc19zaW1wbGUgewoJcmVwZWF0ZWQgZmxvYXQgeHl6ID0gMSBbcGFja2VkPXRydWVdOyAgLy8geF8wLHlfMCx6XzAsIHhfMSx5XzEsel8xLCAuLi4KCXJlcGVhdGVkIGZsb2F0IHV2ID0gMiBbcGFja2VkPXRydWVdOyAgLy8gdV8wLHZfMCwgdV8xLHZfMSwgLi4uCn0KCi8vIEluZGV4ZXMgb2YgdmVydGljZXMgb2YgZmFjZXMKbWVzc2FnZSBmYWNlc19zaW1wbGUgewoJcmVwZWF0ZWQgdWludDMyIGZhY2VzID0gMSBbcGFja2VkPXRydWVdOyAvLyBpMDAsaTAxLGkwMiwgaTEwLGkxMSxpMTIsIC4uLgp9CgovLyBBIHNpbXBseSBlbmNvZGVkIGNodW5rLgovLyBUT0RPOiBhZGQgY2h1bmsgcHJvcGVyaXRlcyAoc3VjaCBhcyAicmVmbGVjdGl2ZSIpCm1lc3NhZ2UgY2h1bmtfc2ltcGxlIHsKCW9wdGlvbmFsIHZlcnRpY2VzX3NpbXBsZSB2ZXJ0aWNlcyA9IDE7CglvcHRpb25hbCBmYWNlc19zaW1wbGUgZmFjZXMgPSAyOwoJb3B0aW9uYWwgc3RyaW5nIGNodW5rX25hbWUgPSAzOwoJb3B0aW9uYWwgc3RyaW5nIG1hdGVyaWFsX25hbWUgPSA0Owp9CgovLyBRdWFudGl6ZWQgdmVyc2lvbnMgZm9sbG93OgptZXNzYWdlIHZlcnRpY2VzX3F1YW50aXplZCB7CglvcHRpb25hbCBmbG9hdCBxdWFudGl6YXRpb24gPSAxOwoJcmVwZWF0ZWQgZmxvYXQgdHJhbnNsYXRpb24gPSAyOwoJcmVwZWF0ZWQgc2ludDMyIHggPSAzIFtwYWNrZWQ9dHJ1ZV07CglyZXBlYXRlZCBzaW50MzIgeSA9IDQgW3BhY2tlZD10cnVlXTsKCXJlcGVhdGVkIHNpbnQzMiB6ID0gNSBbcGFja2VkPXRydWVdOwp9CgptZXNzYWdlIHV2X3F1YW50aXplZCB7CglvcHRpb25hbCBzdHJpbmcgbmFtZSA9IDE7CglvcHRpb25hbCBmbG9hdCBxdWFudGl6YXRpb24gPSAyOwoJcmVwZWF0ZWQgc2ludDMyIHUgPSAzIFtwYWNrZWQ9dHJ1ZV07CglyZXBlYXRlZCBzaW50MzIgdiA9IDQgW3BhY2tlZD10cnVlXTsKfQoKLy8gSW5kZXhlcyBvZiB2ZXJ0aWNlcyBvZiBmYWNlcwptZXNzYWdlIGZhY2VzX2NvbXByZXNzZWQgewoJcmVwZWF0ZWQgc2ludDMyIGZhY2VzID0gMSBbcGFja2VkPXRydWVdOyAvLyBpMDAsaTAxLGkwMiwgaTEwLGkxMSxpMTIsIC4uLgp9CgptZXNzYWdlIGNodW5rX3F1YW50aXplZCB7CglvcHRpb25hbCBzdHJpbmcgY2h1bmtfbmFtZSA9IDE7CglvcHRpb25hbCBzdHJpbmcgbWF0ZXJpYWxfbmFtZSA9IDI7CglvcHRpb25hbCB2ZXJ0aWNlc19xdWFudGl6ZWQgdmVydGljZXMgPSAzOwoJcmVwZWF0ZWQgdXZfcXVhbnRpemVkIHV2cyA9IDQ7CglvcHRpb25hbCBmYWNlc19zaW1wbGUgZmFjZXMgPSA1Owp9Cg==", "base64");
                this.builder = a.loadProto(t), this.decoder = this.builder.build("binary_mesh")
            }

            var o = e("three"), a = e("protobufjs"), s = e("../util/logger"), h = e("../util/common"), l = new s(r);
            n.prototype = {
                constructor: n, load: function (e, t, i, r, n, o) {
                    l.time("download"), h.getFileAsArrayBuffer(e, function (e) {
                        l.timeEnd("download"), this.parse(e, t, n, o)
                    }.bind(this), o)
                }, parse: function (e, t, i, r) {
                    var n = this.readProtobuf(e);
                    if (!n)return r();
                    try {
                        l.time("convert to webgl"), this.convertProtobufToSceneObject(n, t, i, r), l.timeEnd("convert to webgl")
                    } catch (o) {
                        return l.error("failed parsing .dam"), l.error(o.message), r()
                    }
                }, readProtobuf: function (e) {
                    var t;
                    try {
                        l.time("parse proto"), t = this.decoder.decode(e), l.timeEnd("parse proto")
                    } catch (i) {
                        return l.error("failed parsing proto for .dam"), l.error(i.message), null
                    }
                    return t
                }, convertProtobufToSceneObject: function (e, t, i, r) {
                    function n(e) {
                        return e in c || (c[e] = new o.MeshBasicMaterial({map: o.ImageUtils.loadTexture(u.urls.get(e), void 0, s)})), c[e]
                    }

                    function a(e) {
                        var i = new o.BufferGeometry;
                        i.addAttribute("position", new o.BufferAttribute(new Float32Array(e.vertices.xyz, 0, 3), 3)), e.vertices.uv.length > 0 && i.addAttribute("uv", new o.BufferAttribute(new Float32Array(e.vertices.uv, 0, 2), 2)), i.addAttribute("index", new o.BufferAttribute(new Uint32Array(e.faces.faces, 0, 1), 1)), i.applyMatrix(h), i.computeOffsets(), i.computeBoundingBox();
                        var r = new o.Mesh(i, n(t + e.material_name));
                        return r.name = e.chunk_name, r
                    }

                    function s() {
                        return d++, d === Object.keys(c).length ? i(f) : void 0
                    }

                    if (0 === e.chunk.length)return l.warn("No chunks in damfile..."), i([]);
                    var h = new o.Matrix4;
                    h.set(1, 0, 0, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 1);
                    var u = this, c = {}, d = 0, f = e.chunk.map(a);
                    return f ? void 0 : (l.error(".dam protobuf came out with no chunks..."), r())
                }
            }, t.exports = n
        }).call(this, e("buffer").Buffer, "/js/loaders/DamLoader.js")
    }, {"../util/common": 75, "../util/logger": 78, buffer: 84, protobufjs: 135, three: 138}],
    50: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e) {
                o.call(this, e)
            }

            var n = (e("three"), e("../lib/lzma-purejs")), o = e("./DamLoader"), a = e("../util/logger"), s = new a(i);
            r.prototype = Object.create(o.prototype), r.prototype.constructor = r, r.prototype.parse = function (e, t, i, r) {
                var a;
                try {
                    s.time("lzma"), a = n.decompressFile(new Uint8Array(e)), s.timeEnd("lzma")
                } catch (h) {
                    s.timeEnd("lzma"), console.error("LZMA failed parsing..."), console.error(h.message), r()
                }
                return o.prototype.parse.call(this, a, t, i, r)
            }, t.exports = r
        }).call(this, "/js/loaders/LZMADamLoader.js")
    }, {"../lib/lzma-purejs": 40, "../util/logger": 78, "./DamLoader": 49, three: 138}],
    51: [function (e, t, i) {
        (function (i) {
            "use strict";
            var r = (e("three"), e("../settings")), n = e("../util/browser"), o = e("./LZMADamLoader"), a = e("./DamLoader"), s = e("./ZipBundleLoader"), h = e("../util/logger"), l = new h(i), u = [["_50k", ".dam.lzma", "high", o], ["_50k", ".dam", "high", a], ["", ".dam.lzma", "low", o], ["", ".dam", "low", a], ["", "_obj.zip", "low", s]];
            t.exports = {
                load: function (e, t, i, o, a) {
                    a = a || 0;
                    var s = u[a];
                    if (!s)return void(o && o("no suitable model file found..."));
                    var h = s[0], c = s[1], d = s[2], f = new s[3](t), p = t.get(e + h + c);
                    if (p) {
                        var m = e + h + "_texture_jpg_" + d + "/";
                        n.isMobile() && "high" == d && (n.detectSamsungS6() ? (l.warn("Galaxy S6 cannot handle large textures, turning down quality."), d = "low", m = e + h + "_texture_jpg_" + d + "/") : t.count(m) > r.maxMobileTextures && (l.warn("Model probably too large for mobile, turning down quality."), d = "low", m = e + h + "_texture_jpg_" + d + "/")), l.debug("trying " + h + c), f.load(p, m, e + h, c, i, function () {
                            this.load(e, t, i, o, ++a)
                        }.bind(this))
                    } else l.debug("skipping " + c + ", not available"), this.load(e, t, i, o, ++a)
                }
            }
        }).call(this, "/js/loaders/ModelLoader.js")
    }, {
        "../settings": 68,
        "../util/browser": 74,
        "../util/logger": 78,
        "./DamLoader": 49,
        "./LZMADamLoader": 50,
        "./ZipBundleLoader": 53,
        three: 138
    }],
    52: [function (e, t, i) {
        (function (i, r) {
            "use strict";
            function n(e) {
                this.model = e, this.modelDataPath = this.model.urls.get("vision.modeldata"), this.sweepLocationsPath = this.model.urls.get("sweep_locations.csv");
                var t = i("Ly8KLy8gUHJvdG9jb2wgQnVmZmVyIGZvciBwdWNrIHZpc2liaWxpdHkgYW5kIHJlbGF0ZWQgZGF0YQovLwovL3BhY2thZ2UgZW9zLnN0b3JhZ2U7CgovLyBpbXBvcnQgImVvcy9pbmZyYS9jb21tb24ucHJvdG8iOwovLyBUaGUgZm9sbG93aW5nIHdlcmUgbWFudWFsbHkgZXh0cmFjdGVkIGhlcmUsIEpTIGRvZXMgbm90IGxpa2UgcHJvdG9idWYgaW1wb3J0cwoKbWVzc2FnZSBBZmZpbmUzZiB7CglvcHRpb25hbCBRdWF0ZXJuaW9uZiByb3RhdGlvbiA9IDE7CglvcHRpb25hbCBWZWN0b3IzZiB0cmFuc2xhdGlvbiA9IDI7Cn0KCm1lc3NhZ2UgUXVhdGVybmlvbmYgewoJb3B0aW9uYWwgZmxvYXQgdyA9IDE7CglvcHRpb25hbCBmbG9hdCB4ID0gMjsKCW9wdGlvbmFsIGZsb2F0IHkgPSAzOwoJb3B0aW9uYWwgZmxvYXQgeiA9IDQ7Cn0KCm1lc3NhZ2UgVmVjdG9yM2YgewoJb3B0aW9uYWwgZmxvYXQgeCA9IDE7CglvcHRpb25hbCBmbG9hdCB5ID0gMjsKCW9wdGlvbmFsIGZsb2F0IHogPSAzOwp9CgovLwovLyBPbmUgc3dlZXAgLyBwYW5vCi8vCm1lc3NhZ2UgU3dlZXBMb2NhdGlvbiB7CglvcHRpb25hbCBieXRlcyB1dWlkID0gMTsgIC8qIHV1aWQgKi8KCW9wdGlvbmFsIEFmZmluZTNmIHBvc2UgPSAyOyAgLyogY2FtZXJhIHBvc2UgKHgsIHkseikgaW4gbWV0ZXIgYW5kIGEgcXVhdGVybmlvbiovCglvcHRpb25hbCBWZWN0b3IzZiBwdWNrID0gMzsgIC8qIHB1Y2sgbG9jYXRpb24gLSB4IGFueSBpcyBnZW5lcmFsbHkgdGhlIHNhbWUgYXMgcG9zZSwgeiBpcyB0aGUgaGVpZ2h0IG9mIHRoZSBjbG9zZXN0IGZsb29yIHVuZGVyIHRoZSBjYW1lcmEgKi8KCW9wdGlvbmFsIGludDMyIGdyb3VwID0gNDsgIC8qIGZsb29yIGluZGV4ICovCglvcHRpb25hbCBpbnQzMiBzdWJncm91cCA9IDU7ICAvKiByb29tIGluZGV4ICovCglyZXBlYXRlZCBpbnQzMiB2aXNpYmxlcyA9IDY7ICAvKiBsaXN0IG9mIGluZGljZXMgdG8gYWxsIHB1Y2tzIHZpc2libGUgZnJvbSB0aGlzIHB1Y2sgKi8KCXJlcGVhdGVkIGZsb2F0IHNjb3JlcyA9IDc7IC8qIHVzZWQgYXMgcGFydCBvZiBzY29yaW5nIGZ1bmN0aW9uIGZvciBkZXRlcm1pbmluZyB3aGljaCBwdWNrIHRvIGdvIHRvIG5leHQgKi8KfQoKLy8KLy8gQWxsIHB1Y2tzIGluIGEgbW9kZWwuIFB1Y2tzIGFyZSBzdG9yZWQgaW4gc2Nhbm5pbmcgb3JkZXIuCi8vCm1lc3NhZ2UgTmF2aWdhdGlvbkluZm8gewoJcmVwZWF0ZWQgU3dlZXBMb2NhdGlvbiBzd2VlcExvY2F0aW9ucyA9IDE7Cn0K", "base64"), r = o.loadProto(t);
                this.decoder = r.build("NavigationInfo")
            }

            var o = (e("three"), e("protobufjs")), a = e("../util/common"), s = e("../util/math"), h = e("../util/logger"), l = new h(r);
            n.prototype.load = function () {
                var e = $.Deferred();
                return this.modelDataPath ? (l.info("Using vision.modeldata"), this.loadVisionModelData(e)) : this.sweepLocationsPath ? (l.warn("Using sweep_locations.csv"), this.loadSweepLocationsCSV(e)) : (l.warn("No sweep file found"), e.resolve([])), e
            }, n.prototype.loadVisionModelData = function (e) {
                a.getFileAsArrayBuffer(this.modelDataPath, function (t) {
                    try {
                        var i = this.decoder.decode(t)
                    } catch (r) {
                        return l.warn("Could not decode vision.modeldata, trying sweep_locations.csv"), this.loadSweepLocationsCSV(e)
                    }
                    var n = i.sweepLocations.map(function (e) {
                        return {
                            uuid: e.uuid.toUTF8().replace(/-/g, ""),
                            position: {x: e.pose.translation.x, y: e.pose.translation.y, z: e.pose.translation.z},
                            quaternion: {
                                x: e.pose.rotation.x,
                                y: e.pose.rotation.y,
                                z: e.pose.rotation.z,
                                w: e.pose.rotation.w
                            },
                            puck: {x: e.puck.x, y: e.puck.y, z: e.puck.z},
                            floor: e.group,
                            neighbours: e.visibles
                        }
                    }).map(function (e) {
                        return e.position = s.convertVisionVector(e.position), e.quaternion = s.convertVisionQuaternion(e.quaternion), e.puck = s.convertVisionVector(e.puck), e
                    });
                    n.forEach(function (e) {
                        e.neighbours = e.neighbours.map(function (e) {
                            return n[e].uuid
                        })
                    }), e.resolve(n)
                }.bind(this), function () {
                    l.warn("Could not load vision.modeldata, trying sweep_locations.csv"), this.loadSweepLocationsCSV(e)
                }.bind(this))
            }, n.prototype.loadSweepLocationsCSV = function (e) {
                $.ajax(this.sweepLocationsPath).done(function (t) {
                    var i = t.split("\n").map(function (e) {
                        return e.split(", ")
                    }).filter(function (e) {
                        return e.length > 1
                    }).map(function (e) {
                        return {
                            uuid: e[0],
                            position: {x: parseFloat(e[1]), y: parseFloat(e[2]), z: parseFloat(e[3])},
                            quaternion: {
                                x: parseFloat(e[4]),
                                y: parseFloat(e[5]),
                                z: parseFloat(e[6]),
                                w: parseFloat(e[7])
                            }
                        }
                    }).map(function (e) {
                        return e.position = s.convertVisionVector(e.position), e.quaternion = s.convertVisionQuaternion(e.quaternion), e
                    });
                    e.resolve(i)
                }).fail(function () {
                    l.warn("Could not load sweep_locations.csv, no sweeps loaded."), e.resolve([])
                })
            }, t.exports = n
        }).call(this, e("buffer").Buffer, "/js/loaders/SweepDataLoader.js")
    }, {"../util/common": 75, "../util/logger": 78, "../util/math": 79, buffer: 84, protobufjs: 135, three: 138}],
    53: [function (e, t, i) {
        "use strict";
        function r(e) {
            this.urls = e, this.objloader = new n.OBJLoader, this.mtlloader = new n.MTLLoader
        }

        var n = e("three"), o = e("jszip"), a = e("../util/common");
        r.prototype = {
            constructor: r, load: function (e, t, i, r, n, s) {
                var h = this;
                console.time("Downloading OBJ"), a.getFileAsArrayBuffer(e, function (e) {
                    console.timeEnd("Downloading OBJ");
                    var r = new o(e), a = h.parseMTL(i, r, t), s = h.parseOBJ(i, r, a), l = h.parsePanos(i, r);
                    n(s, l)
                }, s)
            }, parseMTL: function (e, t, i) {
                var r = this, o = this.mtlloader.parse(t.file(e + ".mtl").asText());
                return o.baseUrl = i, o.loadTexture = function (e) {
                    var t = new Image, i = new n.Texture(t);
                    return t.onload = function () {
                        i.needsUpdate = !0
                    }, t.crossOrigin = n.ImageUtils.crossOrigin, t.src = r.urls.get(e), i
                }, o
            }, parseOBJ: function (e, t, i) {
                console.time("Unzipping OBJ");
                var r = t.file(e + ".obj").asText();
                console.timeEnd("Unzipping OBJ"), console.time("Parsing OBJ");
                var o = this.objloader.parse(r);
                console.timeEnd("Parsing OBJ");
                var a = [];
                return o.traverse(function (e) {
                    if (e instanceof n.Mesh) {
                        for (var t = e.geometry, r = 0; r < t.vertices.length; r += 3) {
                            var o = t.vertices[r], s = t.vertices[r + 1], h = t.vertices[r + 2];
                            t.vertices[r] = s, t.vertices[r + 1] = h, t.vertices[r + 2] = o
                        }
                        if (e.material.name) {
                            var l = i.create(e.material.name);
                            l && (e.material = l)
                        }
                        a.push(e)
                    }
                }), a
            }, parsePanos: function (e, t) {
                return t.file(e + "_locations.csv").asText()
            }
        }, t.exports = r
    }, {"../util/common": 75, jszip: 104, three: 138}],
    54: [function (e, t, i) {
        (function (t) {
            "use strict";
            function i(e, t) {
                V.info("Model data loaded"), V.debug("UUID: " + e.data.job.uuid), M.initMixpanel({
                    model: W,
                    version: "2.0.43",
                    startSource: H,
                    token: t
                }), M.initMixpanelModel(e), x.coverScreen(e, function () {
                    M.sessionStart({model: e, startSource: H}), e.load(o, s)
                })
            }

            function r(e) {
                try {
                    I = new f.WebGLRenderer
                } catch (t) {
                    return h()
                }
                O = new f.PerspectiveCamera, D = new f.Scene;
                var i = new f.AmbientLight(16777215);
                D.add(i), I.autoClear = !1, I.setPixelRatio(window.devicePixelRatio ? window.devicePixelRatio : 1), I.setSize(window.innerWidth, window.innerHeight), D.skybox = new C, D.add(D.skybox), B = new m(e, O, U, D, I), D.add(B.reticule), R = new g(B), B.director = R, F = new f.EffectComposer(I), F.addPass(new f.RenderPass(D, O)), T.init(F, B), U.appendChild(I.domElement), e.constrained = w.isMobile()
            }

            function n(e) {
                var t = {}, i = w.valueFromHash("start", "");
                if ("" !== i)V.debug("Start override found in parameters, trying to parse..."), t = B.optionsFromString(i) || {}; else if (e.heroImage && e.heroImage.metadata.camera_position) {
                    var r = e.heroImage.metadata;
                    V.debug("Using start position from thumbnail image"), t.position = P.convertWorkshopVector(r.camera_position), t.quaternion = P.convertWorkshopQuaternion(r.camera_quaternion), 0 === r.camera_mode ? (t.mode = v.PANORAMA, t.pano = e.panos.get(r.scan_id)) : e.outsideAllowed() ? 1 === r.camera_mode ? t.mode = v.FLOORPLAN : 2 === r.camera_mode ? t.mode = v.DOLLHOUSE : (V.debug("Unknown camera mode: " + r.camera_mode), t.mode = null) : (V.warn('Caution, start mode "' + r.camera_mode + '" is disallowed for this model'), t.mode = null)
                }
                return t.mode = t.mode || v.PANORAMA, t.pano || (V.debug("No pano selected, choosing the closest one to player location"), t.pano = e.panos.findClosest(t.position || B.position)), t
            }

            function o(e) {
                V.info("Model geometry loaded"), r(e), x.init(e, R, B);
                var t = n(e);
                t.pano ? (V.info("Preloading panorama " + t.pano.id + " before starting..."), t.pano.loadCube("high", function () {
                    new L(e, B).start(), a(e, t)
                })) : (V.info("No start panorama found."), a(e, t))
            }

            function a(e, t) {
                t.pano;
                M.report(e.sid, "started-playing"), V.info("Initial loading done, starting in " + t.mode), N = e, M.modelLoaded(e, B), D.add(e), D.plane = new f.Mesh(new f.PlaneBufferGeometry(1e5, 1e5), new f.MeshBasicMaterial({side: f.DoubleSide})), D.plane.position.y = 0, D.plane.rotateX(-Math.PI / 2), D.plane.visible = !1, D.add(D.plane), D.updateMatrixWorld(), x.endLoading(e, R, B), $(U).fadeIn(2e3), c(), B.controls.dollhouse.setModel(e), B.controls.floorplan.setModel(e), B.start(t), E.navHelpSessionStart(), _.showScreenshotLocations && e.data.images.forEach(function (e) {
                    if (e.metadata && e.metadata.camera_position) {
                        var t = P.convertWorkshopVector(e.metadata.camera_position), i = new f.Mesh(new f.BoxGeometry(.3, .3, .3));
                        i.position = t.clone(), D.add(i);
                        var r = P.convertWorkshopQuaternion(e.metadata.camera_quaternion), n = new f.Vector3(0, 0, -1).applyQuaternion(r);
                        D.add(new f.ArrowHelper(n, t.clone(), 1, 16711680))
                    }
                }), _.showAxis && (D.add(new f.ArrowHelper(new f.Vector3(0, 1, 0), new f.Vector3(0, 0, 0), 1, 255)), D.add(new f.ArrowHelper(new f.Vector3(0, 0, 1), new f.Vector3(0, 0, 0), 1, 16711680)), D.add(new f.ArrowHelper(new f.Vector3(1, 0, 0), new f.Vector3(0, 0, 0), 1, 65280))), l()
            }

            function s(e) {
                V.error(e), S.error(e), M.report(W, "error-" + e)
            }

            function h() {
                var e = w.details();
                e && "Safari" === e.name && e.version > 500 && e.version < 600 ? (S.error("webgl-safari"), M.report(W, "error-webgl-safari")) : (S.error("webgl-generic"), M.report(W, "error-webgl-generic"))
            }

            function l() {
                window.requestAnimationFrame(l), u()
            }

            function u() {
                if (!B.paused) {
                    c();
                    var e = Math.min(1, z.getDelta());
                    N.update(e), A.update(e), B.update(e), T.currentBlur > 0 ? F.render() : I.render(D, O)
                }
            }

            function c() {
                (window.innerWidth != Z || window.innerHeight != X) && (Z = window.innerWidth, X = window.innerHeight, _.aspect = window.innerWidth / window.innerHeight, T.aspect = window.innerWidth / window.innerHeight, B.setSize(window.innerWidth, window.innerHeight), I.setSize(window.innerWidth, window.innerHeight), F.setSize(window.innerWidth, window.innerHeight))
            }

            function d(e) {
                e.stopPropagation(), e.preventDefault()
            }

            e("./lib/three71-shim"), e("./lib/shaders/CopyShader.js"), e("./lib/shaders/HorizontalBlurShader.js"), e("./lib/shaders/VerticalBlurShader.js"), e("./lib/postprocessing/EffectComposer.js"), e("./lib/postprocessing/RenderPass.js"), e("./lib/postprocessing/MaskPass.js"), e("./lib/postprocessing/ShaderPass.js"), e("./lib/MTLLoader.js"), e("./lib/OBJLoader.js");
            var f = e("three"), p = e("./util/sentry"), m = e("./player"), g = e("./director"), v = e("./enum/Viewmode"), y = e("./util/logger"), b = e("./showcase"), w = e("./util/browser"), _ = e("./settings"), x = e("./gui/gui"), S = e("./gui/error"), E = e("./gui/help"), M = (e("./gui/konami"), e("./analytics")), A = e("./util/transitions"), T = e("./effects"), C = e("./objects/Skybox"), P = (e("./util/common"), e("./util/math")), L = (e("./objects/Panorama"), e("./preloaders")), k = e("events").EventEmitter, B = (e("./util/lerp"), null), R = null, I = null, F = null, D = null, O = null, N = null, U = document.getElementById("player"), z = new f.Clock, V = new y(t);
            y.level = _.logLevel;
            var W = w.valueFromHash("model") || w.valueFromHash("m");
            k.defaultMaxListeners = 1e3, _.captureErrors && p.captureErrors("https://6e533a56ed0147d999052427fe4d507f@app.getsentry.com/44952", {maxMessageLength: 2e3}, {
                model: W,
                version: "2.0.43"
            }), U.addEventListener("dragenter", d, !1), U.addEventListener("dragover", d, !1), V.info("Version", "2.0.43");
            var H = w.valueFromHash("play", !1) ? "autoplay" : w.inIframe() ? "click" : "fullpage", G = window.MP_PREFETCHED_MODELDATA || {}, j = M.getMixpanelToken({data: G.keys || null}), Y = b.getModel({
                url: W,
                floors: w.valueFromHash("f", !0),
                autoload: !1,
                data: G.model || null
            });
            $.when(Y, j).done(i).fail(function (e) {
                "loading-failed-mixpanel" === e ? Y.done(i).fail(s) : s(e)
            }), window.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame;
            var Z = 0, X = 0
        }).call(this, "/js/main.js")
    }, {
        "./analytics": 1,
        "./director": 9,
        "./effects": 10,
        "./enum/Viewmode": 12,
        "./gui/error": 16,
        "./gui/gui": 17,
        "./gui/help": 18,
        "./gui/konami": 19,
        "./lib/MTLLoader.js": 20,
        "./lib/OBJLoader.js": 21,
        "./lib/postprocessing/EffectComposer.js": 41,
        "./lib/postprocessing/MaskPass.js": 42,
        "./lib/postprocessing/RenderPass.js": 43,
        "./lib/postprocessing/ShaderPass.js": 44,
        "./lib/shaders/CopyShader.js": 45,
        "./lib/shaders/HorizontalBlurShader.js": 46,
        "./lib/shaders/VerticalBlurShader.js": 47,
        "./lib/three71-shim": 48,
        "./objects/Panorama": 62,
        "./objects/Skybox": 65,
        "./player": 66,
        "./preloaders": 67,
        "./settings": 68,
        "./showcase": 70,
        "./util/browser": 74,
        "./util/common": 75,
        "./util/lerp": 77,
        "./util/logger": 78,
        "./util/math": 79,
        "./util/sentry": 80,
        "./util/transitions": 81,
        events: 88,
        three: 138
    }],
    55: [function (e, t, i) {
        "use strict";
        function r(e, t, i) {
            e = e.clone();
            var r = e.size(), o = new n.BoxGeometry(r.x, r.y, r.z);
            o.boundingBox = e, n.Mesh.call(this, o, t), this.position.copy(e.center()), this.frustumCulled = !1, i && this.add(new n.WireframeHelper(this))
        }

        var n = e("three");
        r.prototype = Object.create(n.Mesh.prototype), r.prototype.constructor = r, t.exports = r
    }, {three: 138}],
    56: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e) {
                l.time("Computing a nice bounding cubemap");
                var t = new n.ShaderMaterial({
                    fragmentShader: o.model.fragmentShader,
                    vertexShader: o.model.vertexShader,
                    uniforms: n.UniformsUtils.clone(o.model.uniforms),
                    side: n.BackSide,
                    transparent: !0
                });
                t.uniforms.modelAlpha.value = 0, t.uniforms.opacity.value = 1 - s.modelAlpha, a.call(this, e, t), l.timeEnd("Computing a nice bounding cubemap")
            }

            var n = e("three"), o = (e("../enum/Viewmode"), e("../shaders")), a = e("./BoundingMesh"), s = e("../settings"), h = e("../util/logger"), l = new h(i);
            r.prototype = Object.create(a.prototype), r.prototype.constructor = r, t.exports = r
        }).call(this, "/js/objects/BoundingTextureSkybox.js")
    }, {
        "../enum/Viewmode": 12,
        "../settings": 68,
        "../shaders": 69,
        "../util/logger": 78,
        "./BoundingMesh": 55,
        three: 138
    }],
    57: [function (e, t, i) {
        "use strict";
        function r(e) {
            n.Mesh.call(this, e.geometry, e.material), e.clone(this);
            var t = n.UniformsUtils.clone(o.model.uniforms);
            t.map.value = this.material.map, this.materialInside = new n.ShaderMaterial({
                fragmentShader: o.model.fragmentShader,
                vertexShader: o.model.vertexShader,
                uniforms: t
            }), t = n.UniformsUtils.clone(o.modelDollhouse.uniforms), t.map.value = this.material.map, this.materialDollhouse = new n.ShaderMaterial({
                fragmentShader: o.modelDollhouse.fragmentShader,
                vertexShader: o.modelDollhouse.vertexShader,
                uniforms: t
            }), this.material = this.materialInside
        }

        var n = e("three"), o = e("../shaders"), a = e("../enum/Viewmode");
        r.prototype = Object.create(n.Mesh.prototype), r.prototype.setMode = function (e) {
            e === a.DOLLHOUSE ? (this.materialDollhouse.transparent = this.material.transparent, this.materialDollhouse.uniforms.opacity.value = this.material.uniforms.opacity.value, this.material = this.materialDollhouse) : (this.materialInside.transparent = this.material.transparent, this.materialInside.uniforms.opacity.value = this.material.uniforms.opacity.value, this.material = this.materialInside)
        }, t.exports = r
    }, {"../enum/Viewmode": 12, "../shaders": 69, three: 138}],
    58: [function (e, t, i) {
        "use strict";
        function r(e) {
            this.chunksize = e || 10, this.chunks = {}, this.boundingBoxes = {}, this.children = [], this.offset = new n.Vector3(0, .5, 0), this.material = new n.MeshBasicMaterial({
                color: 16777215 * Math.random(),
                side: n.DoubleSide
            })
        }

        var n = e("three");
        e("../enum/Viewmode");
        r.prototype.add = function (e) {
            var t, i, r, o, a, s, h, l, u, c, d, f, p = e.attributes;
            p ? (t = p.position.array, i = void 0 !== p.index ? p.index.array : void 0) : (t = e.vertices, r = e.faces);
            var m = (this.boundingBox, new n.Vector3);
            if (i)for (o = 0, a = i.length; a > o; o += 3) {
                var g = 3 * i[o], v = 3 * i[o + 1], y = 3 * i[o + 2];
                s = (t[g] + t[v] + t[y]) / 3, h = (t[g + 1] + t[v + 1] + t[y + 1]) / 3, l = (t[g + 2] + t[v + 2] + t[y + 2]) / 3, u = Math.floor(s / this.chunksize), c = Math.floor(h / this.chunksize), d = Math.floor(l / this.chunksize), f = [u, c, d].join("."), f in this.chunks || (this.chunks[f] = [], this.boundingBoxes[f] = new n.Box3), this.chunks[f].push(t[g], t[g + 1], t[g + 2], t[v], t[v + 1], t[v + 2], t[y], t[y + 1], t[y + 2]), this.boundingBoxes[f].expandByPoint(m.set(t[g], t[g + 1], t[g + 2])), this.boundingBoxes[f].expandByPoint(m.set(t[v], t[v + 1], t[v + 2])), this.boundingBoxes[f].expandByPoint(m.set(t[y], t[y + 1], t[y + 2]))
            } else for (o = 0, a = t.length; a > o; o += 9)s = (t[o] + t[o + 3] + t[o + 6]) / 3, h = (t[o + 1] + t[o + 4] + t[o + 7]) / 3, l = (t[o + 2] + t[o + 5] + t[o + 8]) / 3, u = Math.floor(s / this.chunksize), c = Math.floor(h / this.chunksize), d = Math.floor(l / this.chunksize), f = [u, c, d].join("."), f in this.chunks || (this.chunks[f] = [], this.boundingBoxes[f] = new n.Box3), this.chunks[f].push(t[o], t[o + 1], t[o + 2], t[o + 3], t[o + 4], t[o + 5], t[o + 6], t[o + 7], t[o + 8]), this.boundingBoxes[f].expandByPoint(m.set(t[o], t[o + 1], t[o + 2])), this.boundingBoxes[f].expandByPoint(m.set(t[o + 3], t[o + 4], t[o + 5])), this.boundingBoxes[f].expandByPoint(m.set(t[o + 6], t[o + 7], t[o + 8]))
        }, r.prototype.build = function () {
            var e = new n.Object3D;
            e.material = this.material;
            for (var t in this.chunks) {
                var i = this.chunks[t], r = new n.BufferGeometry;
                r.addAttribute("position", new n.BufferAttribute(new Float32Array(i), 3)), r.boundingBox = this.boundingBoxes[t];
                var o = new n.Mesh(r, this.material);
                o.visible = !1, e.add(o), this.chunks[t] = []
            }
            return e
        }, t.exports = r
    }, {"../enum/Viewmode": 12, three: 138}],
    59: [function (e, t, i) {
        "use strict";
        function r(e, t, i) {
            n.Object3D.call(this), this.model = e, this.floorIndex = t, this.name = i || "Floor " + (t + 1), this.panos = [], this.chunks = [], this.colliderBuilder = new s(10), this.collider = null, this.boundingBox = new n.Box3, this.size = null, this.hidden = !1, this.conservativeBoundingBox = new n.Box3, this.debugColor = 16777215 * Math.random(), this.transition = null
        }

        var n = e("three"), o = (e("../settings"), e("../util/common")), a = e("../util/lerp"), s = e("./ChunkedCollider"), h = e("../util/transitions"), l = e("../util/easing");
        e("../objects/Panorama");
        r.prototype = Object.create(n.Object3D.prototype), r.prototype.enter = function (e) {
            this.model.selectFloor(this, e)
        }, r.prototype.hide = function () {
            this.hidden || (this.hidden = !0, this.chunks.forEach(function (e) {
                e.material.transparent = !0
            }), h.cancel(this.transition), this.transition = h.start(a.allUniforms(this.chunks, "opacity", .08), 300, null, 0, l.easeInOutQuad))
        }, r.prototype.show = function (e) {
            this.hidden && (this.hidden = !1, h.cancel(this.transition), this.transition = h.start(a.allUniforms(this.chunks, "opacity", 1), 600, function () {
                this.hidden || this.chunks.forEach(function (e) {
                    e.material.transparent = !1
                })
            }.bind(this), e ? 0 : .5, l.easeInOutQuad))
        }, r.prototype.toggle = function (e, t) {
            e = void 0 === e ? this.hidden : e, e ? this.show(t) : this.hide()
        }, r.prototype.containsPoint = function (e) {
            return this.collider.children.some(function (t) {
                return t.geometry.boundingBox || t.geometry.computeBoundingBox(), t.geometry.boundingBox.containsPoint(e)
            })
        }, r.prototype.distanceToPoint = function (e) {
            var t = null, i = 1 / 0;
            return this.collider.children.forEach(function (r) {
                r.geometry.boundingBox || r.geometry.computeBoundingBox();
                var n = r.geometry.boundingBox.distanceToPoint(e);
                (!t || i > n) && (i = n, t = r)
            }), i
        }, r.prototype.addChunk = function (e) {
            e.renderOrder = 2, this.add(e), this.chunks.push(e), this.boundingBox.union(e.geometry.boundingBox), this.size = this.boundingBox.size(), this.colliderBuilder.add(e.geometry)
        }, r.prototype.addPano = function (e) {
            this.panos.push(e), this.add(e.mesh), this.add(e.marker);
            var t = new n.Vector3(1, 1, 1), i = (new n.Box3).setFromCenterAndSize(e.position, t);
            this.boundingBox.union(i)
        }, r.prototype.build = function () {
            this.collider = this.colliderBuilder.build(!0), this.add(this.collider), this.conservativeBoundingBox.copy(this.boundingBox), this.conservativeBoundingBox.min.y = o.lowerMedian(this.collider.children.map(function (e) {
                return e.geometry.boundingBox.min.y
            }), 5), this.conservativeBoundingBox.max.y = o.lowerMedian(this.collider.children.map(function (e) {
                return e.geometry.boundingBox.max.y
            }), 5), this.colliderBuilder = null
        }, r.prototype.toShortString = function () {
            return o.nth(this.floorIndex + 1)
        }, r.prototype.toString = function () {
            return this.name
        }, t.exports = r
    }, {
        "../objects/Panorama": 62,
        "../settings": 68,
        "../util/common": 75,
        "../util/easing": 76,
        "../util/lerp": 77,
        "../util/transitions": 81,
        "./ChunkedCollider": 58,
        three: 138
    }],
    60: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t) {
                n.Object3D.call(this), this.sid = t.sid, this.data = t, this.options = e, this.urls = new o(this, e.urlFiles), this.images = [], this.heroImage = r.getHeroImage(t.images, this.data.player_options), this.heroLocations = [], this.floors = {}, this.floorList = [], this.floorsEnabled = void 0 !== e.floors ? e.floors : !0, this.changingFloor = !1, this.chunks = [], this.panos = new p, this.colliders = [], this.supportedModes = {}, this.supportedModes[s.PANORAMA] = !0, this.supportedModes[s.DOLLHOUSE] = !t.player_options || t.player_options.dollhouse, this.supportedModes[s.FLOORPLAN] = !t.player_options || t.player_options.floor_plan, this.supportedModes[s.TRANSITIONING] = !0, this.mode = s.DOLLHOUSE, this.size = null, this.center = null, this.boundingBox = new n.Box3, this.boundingBoxWithPadding = new n.Box3, this.exploded = !1, this.currentFloor = null, this.allFloorsVisible = !0, this.stayPut = c.stayPut, this.projectedPano0 = null, this.projectedPano1 = null, this.floorsEnabled && t.floors && -1 !== t.floors.indexOf(",") && t.floors.split(",").forEach(function (e, t) {
                    this.addFloor(new h(this, t, e.trim()))
                }.bind(this)), this.waitQueue = [], this.on("load", function (e) {
                    0 !== this.waitQueue.length && (this.waitQueue = this.waitQueue.filter(function (t) {
                        return !(e === t.pano && e.isLoaded(t.quality))
                    }), 0 === this.waitQueue.length && this.emit("waiting-done"))
                }.bind(this))
            }

            var n = e("three"), o = e("../util/ModelUrls"), a = e("./BoundingTextureSkybox"), s = e("../enum/Viewmode"), h = e("./Floor"), l = e("./Chunk"), u = (e("../shaders"), e("../util/math")), c = e("../settings"), d = e("../util/logger"), f = e("../objects/Panorama"), p = e("../util/PanoramaCollection"), m = e("../loaders/ModelLoader"), g = e("../loaders/SweepDataLoader"), v = e("../util/transitions"), y = e("../util/easing"), b = (e("../util/lerp"), e("../util/common")), w = (e("./../util/browser"), e("events").EventEmitter), _ = new d(i);
            r.prototype = Object.create(n.Mesh.prototype), b.extend(r, w), r.prototype.load = function (e, t) {
                var i = function () {
                    return $.when(this.loadPanos(), this.loadMesh())
                }, r = this.urls.init().then(i.bind(this)), n = this.loadHighlightReel();
                $.when(r, n).then(this.build.bind(this)).done(e).fail(t)
            }, r.prototype.loadMesh = function () {
                function e(e) {
                    _.error(e), r.reject("loading-failed")
                }

                function t(e) {
                    var t = e.match(/group([0-9]*)/);
                    if (!t)return 0;
                    try {
                        return parseInt(t[1], 10)
                    } catch (i) {
                        return _.warn('Non-int value "' + t[1] + '" for mesh group, defaulting to floor 0'), 0
                    }
                }

                function i(e, i) {
                    if (0 === e.length) {
                        _.warn("No geometry found for model, loading faux geometry, disabling outside mode"), o.supportedModes[s.DOLLHOUSE] = !1, o.supportedModes[s.FLOORPLAN] = !1;
                        var a = new n.Mesh(new n.PlaneBufferGeometry(5, 5, 1, 1), new n.MeshBasicMaterial);
                        a.visible = !1, a.rotateX(-Math.PI / 2), a.geometry.computeBoundingBox(), e = [a]
                    }
                    e.forEach(function (e) {
                        var i = o.floorsEnabled ? t(e.name) : 0;
                        o.addChunk(i, e)
                    }), r.resolve(o)
                }

                var r = $.Deferred(), o = this;
                return m.load(this.data.job.uuid, o.urls, i, e), r.promise()
            }, r.prototype.loadPanos = function () {
                var e = new g(this);
                return e.load().then(function (e) {
                    return this.data.sweeps && Object.keys(this.data.sweeps).length > 0 && (e = e.filter(function (e) {
                        return this.data.sweeps[e.uuid].enabled
                    }.bind(this))), this.panos.extend(e.map(function (e) {
                        return new f(this, e.uuid, e)
                    }.bind(this))), this.panos.forEach(function (e) {
                        e.neighbourUUIDs && (e.neighbourUUIDs.forEach(function (t) {
                            var i = this.panos.get(t);
                            i && this.panos.setNeighbour(e, i, !0)
                        }.bind(this)), e.neighbourPanos = this.panos.getNeighbours(e) || this.panos.setNeighbour(e, e, !0))
                    }.bind(this)), 0 === this.panos.length && (_.warn("Model has no panos, turning off inside mode"), this.supportedModes[s.PANORAMA] = !1), $.when(this)
                }.bind(this))
            }, r.prototype.loadHighlightReel = function () {
                var e = $.Deferred(), t = "/api/v1/jsonstore/model/highlights/" + this.sid + "/active_reel";
                return $.ajax(t, {
                    crossDomain: !0, dataType: "json", beforeSend: function (e) {
                        c.authorizationHeader ? (_.debug("Token present, using authorization header"), e.setRequestHeader("Authorization", c.authorizationHeader)) : _.debug("Token not present, hoping my cookie has auth info...")
                    }
                }).done(function (t) {
                    t.reel ? (_.info("Got highlight reel with " + t.reel.length + " items"), this.images = this.validateHighlights(this.data.images, t.reel)) : _.info("No highlight reel found"), e.resolve()
                }.bind(this)).fail(function () {
                    _.warn("Getting highlight reel failed, no highlights available"), e.resolve()
                }), e
            }, r.prototype.waitForPanoLoad = function (e, t) {
                e.isLoaded(t) || (this.waitQueue.push({
                    pano: e,
                    quality: t
                }), 1 === this.waitQueue.length && this.emit("waiting"))
            }, r.prototype.update = function (e) {
                this.panos.forEach(function (t) {
                    t.update(e)
                })
            }, r.prototype.hide = function () {
                this.floorList.forEach(function (e) {
                    e.hide()
                })
            }, r.prototype.show = function () {
                this.floorList.forEach(function (e) {
                    e.show()
                })
            }, r.prototype.floorNames = function () {
                return this.floorList.reduce(function (e, t) {
                    return e.concat(t.name)
                }, [])
            }, r.prototype.warpDestFloors = function (e) {
                if (this.stayPut = !0, !e)return this.toggleAllFloors(!0), void(this.stayPut = c.stayPut);
                var t = e.floor_visibility;
                if (void 0 === t || t.length < 2)this.toggleAllFloors(!0); else {
                    this.toggleAllFloors(!1);
                    for (var i = null, r = 0, n = 0; n < t.length; n += 1)t[n] && (n < this.floorList.length ? (i = this.floorList[n], r += 1) : _.warn("Invalid floor selection in warpDestination"));
                    r > 1 ? this.toggleAllFloors(!0) : i ? this._changeFloor(i) : _.info("hmm what floor did we want?")
                }
                this.stayPut = c.stayPut
            }, r.prototype.toggleStartFloors = function () {
                var e = 0, t = null;
                if (this.heroImage && this.heroImage.metadata && this.heroImage.metadata.floor_visibility) {
                    var i = this.heroImage.metadata.floor_visibility;
                    if (i.length > 1) {
                        this.toggleAllFloors(!1);
                        for (var r = 0; r < i.length; r += 1)i[r] && (r < this.floorList.length ? (t = this.floorList[r], e += 1) : _.warn("Invalid floor selection: " + r))
                    }
                }
                e > 1 || 1 > e ? this.toggleAllFloors(!0) : this._changeFloor(t)
            }, r.prototype.selectFloor = function (e, t) {
                this.allFloorsVisible = !1, this._changeFloor(e, t)
            }, r.prototype.toggleAllFloors = function (e) {
                this.allFloorsVisible = void 0 !== e ? e : !this.allFloorsVisible, this._changeFloor(this.currentFloor)
            }, r.prototype._changeFloor = function (e, t) {
                if (t = t || this.mode, this.currentFloor = e, this.emit("floor.changed", this.currentFloor, t), t === s.PANORAMA)this.show(); else if ((t === s.FLOORPLAN || t === s.DOLLHOUSE) && (this.floorList.forEach(function (e, t) {
                        e.toggle(e === this.currentFloor || this.allFloorsVisible, this.allFloorsVisible)
                    }.bind(this)), !this.stayPut)) {
                    var i = new n.Vector3(0, -e.conservativeBoundingBox.min.y, 0);
                    _.debug("Moving the house " + i.distanceTo(this.position).toPrecision(4))
                }
                var r = this, o = e;
                v.start(function () {
                }, 300, function () {
                    r.floorList.forEach(function (e) {
                        e.chunks.forEach(function (t) {
                            t.renderOrder = e === o ? 1 : 2
                        })
                    })
                }.bind(this))
            }, r.prototype.toggleExplode = function () {
                function e(e, t) {
                    e.position.x = i[e.floorIndex] * t, e.position.y = 1 * e.floorIndex * t
                }

                var t, i = [], r = 0;
                this.floorList.forEach(function (e, n, o) {
                    t = n > 0 ? Math.max(o[n - 1].boundingBox.max.x - e.boundingBox.min.x, e.boundingBox.size().x / 2) : 0, r += t, i[n] = r
                }), i = i.map(function (e) {
                    return e - r / 2
                }), this.exploded ? this.floorList.forEach(function (t) {
                    v.start(function (i) {
                        e(t, 1 - i)
                    }.bind(this), 1500, null, 0, y.easeOutExpo)
                }.bind(this)) : this.floorList.forEach(function (t) {
                    v.start(function (i) {
                        e(t, i)
                    }.bind(this), 1500, null, 0, y.easeOutExpo)
                }.bind(this)), this.exploded = !this.exploded
            }, r.prototype.toggleExplodeUp = function () {
                function e(e, i) {
                    e.position.y = (5 * e.floorIndex - t.y / 2) * i, e.panos.forEach(function (t) {
                        t.position.y = t.origin.y + e.position.y, t.mesh.position.y = t.origin.y + e.position.y
                    })
                }

                var t = this.size;
                this.exploded ? this.floorList.forEach(function (t) {
                    v.start(function (i) {
                        e(t, 1 - i)
                    }, 1500, null, 0, y.easeOutExpo)
                }) : this.floorList.forEach(function (t) {
                    v.start(function (i) {
                        e(t, i)
                    }, 1500, null, 0, y.easeOutExpo)
                }), this.exploded = !this.exploded
            }, r.prototype.nextFloor = function (e) {
                return this.floors[this.currentFloor.floorIndex + e] || null
            }, r.prototype.addFloor = function (e) {
                this.add(e), this.floors[e.floorIndex] = this.floorList[e.floorIndex] = e
            }, r.prototype.getOrMakeFloor = function (e) {
                var t = this.floors[e];
                return t || (t = new h(this, e), this.addFloor(t)), t
            }, r.prototype.getFloorAtPoint = function (e) {
                for (var t = null, i = 1 / 0, r = 0; r < this.floorList.length; r++) {
                    var n = this.floorList[r], o = n.distanceToPoint(e);
                    (!t || i > o) && (i = o, t = n)
                }
                return t
            }, r.prototype.addChunk = function (e, t) {
                t = new l(t), this.getOrMakeFloor(e).addChunk(t), this.chunks.push(t)
            }, r.prototype.setMode = function (e) {
                if (!this.supportedModes[e])throw new Exception("Mode not supported for this model: " + e);
                this.mode = e, this.chunks.forEach(function (t) {
                    t.setMode(e)
                })
            }, r.prototype.build = function () {
                return this.heroLocations = r.getHeroLocations(this.images), null === this.heroImage && _.warn("No hero image defined."), this.currentFloor = this.floors[this.floorList.length - 1], this.floorList.forEach(function (e) {
                    e.build()
                }.bind(this)), this.colliders = this.floorList.reduce(function (e, t) {
                    return e.concat(t.collider.children)
                }, []), this.panos.forEach(function (e) {
                    e.build1(), e.on("enter", function () {
                        e.floor !== this.currentFloor && this.selectFloor(e.floor)
                    }.bind(this))
                }.bind(this)), this.panos.forEach(function (e) {
                    e.build2()
                }), this.floorList.forEach(function (e) {
                    this.boundingBox.union(e.boundingBox)
                }.bind(this)), this.size = this.boundingBox.size(), this.center = this.boundingBox.center(), this.boundingBoxWithPadding.copy(this.boundingBox).expandByScalar(5), this.floorList.forEach(function (e) {
                    _.info("Floor " + e + ": " + e.children.length + " chunks, " + e.panos.length + " panos.")
                }.bind(this)), this.panos.populate_path_graph(), this.skybox = new a(this.boundingBox), this.skybox.matrixWorldNeedsUpdate = !0, this.add(this.skybox), _.debug("Done building model"), f.raycastsDone > 0 && (_.warn("raycasts: " + f.raycastsDone), _.warn("raycasts skipped: " + f.raycastsSkipped)), $.when(this)
            }, r.prototype.setProjectedPanos = function (e, t) {
                function i(i) {
                    i.material.uniforms.progress.value = 0, e.skybox.loaded || (e.skybox.needsUpdate = !0), e.skybox.loaded = !0, i.material.uniforms.pano0Map.value = e.skybox, i.material.uniforms.pano0Position.value.copy(e.position), i.material.uniforms.pano0Matrix.value.makeRotationFromQuaternion(r.clone().multiply(e.quaternion)), t.skybox.loaded || (t.skybox.needsUpdate = !0), t.skybox.loaded = !0, i.material.uniforms.pano1Map.value = t.skybox, i.material.uniforms.pano1Position.value.copy(t.position), i.material.uniforms.pano1Matrix.value.makeRotationFromQuaternion(r.clone().multiply(t.quaternion))
                }

                var r = this.parent.quaternion.clone();
                this.projectedPano0 = e, this.projectedPano1 = t, i(this.skybox), this.chunks.forEach(i)
            }, r.prototype.changeModelAlpha = function (e) {
                this.chunks.forEach(function (t) {
                    t.material && t.material.uniforms.modelAlpha && (t.material.uniforms.modelAlpha.value = e)
                })
            }, r.prototype.setSide = function (e) {
                this.floorList.forEach(function (t) {
                    t.collider.material.side = e
                })
            }, r.prototype.validateHighlights = function (e, t) {
                var i, r, n = {};
                for (i = 0; i < e.length; i++)r = e[i], n[r.sid] = r;
                var o = [];
                for (i = 0; i < t.length; i += 1) {
                    var a = t[i];
                    r = n[a.sid], r && o.push(r)
                }
                var h = this.supportedModes[s.DOLLHOUSE], l = this.supportedModes[s.FLOORPLAN];
                return o = o.filter(function (e) {
                    if (!e.metadata)return !0;
                    if (void 0 === e.metadata.camera_mode)return !0;
                    var t = s.convertWorkshopModeInt(e.metadata.camera_mode);
                    return t === s.PANORAMA || t === s.FLOORPLAN && l || t === s.DOLLHOUSE && h
                }), o.length !== e.length && _.info("Disallowed " + (e.length - o.length) + " highlight images"), o
            }, r.getHeroImage = function (e) {
                for (var t = 0; t < e.length; t++)if (e[t].is_hero)return e[t];
                return null
            }, r.getHeroLocations = function (e) {
                if (e.length > 0) {
                    for (var t = [], i = !1, n = 0; n < e.length; n += 1) {
                        var o = e[n], a = o.thumbnail_signed_src, h = o.name;
                        if (o.metadata && void 0 !== o.metadata.camera_quaternion) {
                            var l = (o.metadata.camera_quaternion, {
                                position: u.convertWorkshopVector(o.metadata.camera_position),
                                quaternion: u.convertWorkshopQuaternion(o.metadata.camera_quaternion),
                                scan_id: o.metadata.scan_id,
                                camera_mode: s.convertWorkshopModeInt(o.metadata.camera_mode),
                                ortho_zoom: o.metadata.ortho_zoom,
                                floor_visibility: void 0 !== o.metadata.floor_visibility ? o.metadata.floor_visibility.slice(0) : [],
                                thumb: a,
                                name: r.filterImageName(h),
                                is_hero: o.is_hero
                            });
                            t.push(l), i = i || o.is_hero
                        }
                    }
                    return t.length > 0 && !i && (t[0].is_hero = !0), t
                }
                return []
            }, r.prototype.outsideAllowed = function () {
                return this.supportedModes[s.DOLLHOUSE] && this.supportedModes[s.FLOORPLAN]
            }, r.filterImageName = function (e) {
                return "" === e || e.match(/^[0-9.]+_[0-9.]+$/) ? null : e
            }, t.exports = r
        }).call(this, "/js/objects/Model.js")
    }, {
        "../enum/Viewmode": 12,
        "../loaders/ModelLoader": 51,
        "../loaders/SweepDataLoader": 52,
        "../objects/Panorama": 62,
        "../settings": 68,
        "../shaders": 69,
        "../util/ModelUrls": 71,
        "../util/PanoramaCollection": 72,
        "../util/common": 75,
        "../util/easing": 76,
        "../util/lerp": 77,
        "../util/logger": 78,
        "../util/math": 79,
        "../util/transitions": 81,
        "./../util/browser": 74,
        "./BoundingTextureSkybox": 56,
        "./Chunk": 57,
        "./Floor": 59,
        events: 88,
        three: 138
    }],
    61: [function (e, t, i) {
        "use strict";
        function r(e) {
            this.player = e, this.obj3d = null, this.UP = new n.Vector3(0, 1, 0)
        }

        var n = e("three"), o = e("../settings");
        r.prototype.prefs = {
            linewidth: 3,
            height: .07,
            opacity: .45,
            endScale: .05
        }, r.prototype.discard = function () {
            if (this.obj3d) {
                var e = this.obj3d.parent;
                e && e.remove(this.obj3d)
            }
            this.obj3d = null
        }, r.prototype.draw = function () {
            if (this.discard(), o.showNeighbors) {
                var e = this.player.currentPano.floor;
                this.obj3d = new n.Object3D;
                var t = this.player.model.panos.getNeighbours(this.player.currentPano), i = this.player.currentPano.floorPosition.clone().sub(this.player.model.position);
                i.y += this.prefs.height;
                var r = .1525, a = .127, s = .0127, h = .1, l = .19, u = .2032, c = .2286, d = .255, f = new n.Matrix4;
                for (var p in t)if (t[p]) {
                    var m = this.player.model.panos.dict[p], g = (m.position.clone().sub(this.player.model.position), m.position.clone().sub(m.floorPosition)), v = m.floorPosition.clone().sub(this.player.model.position);
                    v.y += this.prefs.height;
                    var y = new n.Geometry;
                    y.vertices.push(new n.Vector3(0, -s, 0), new n.Vector3(-s, 0, 0), new n.Vector3(0, s, 0), new n.Vector3(s, 0, 0), new n.Vector3(0, -s, 0)), y.vertices.push(new n.Vector3(0, -d, 0), new n.Vector3(d, -d, 0), new n.Vector3(d, r, 0), new n.Vector3(-r, r, 0), new n.Vector3(-r, a, 0), new n.Vector3(-l, h, 0), new n.Vector3(-l, -u, 0), new n.Vector3(-r, -c, 0), new n.Vector3(-r, -d, 0), new n.Vector3(0, -d, 0)), f.identity().setPosition(g), y.applyMatrix(f), y.vertices.push(new n.Vector3(0, -this.prefs.endScale, 0)), y.vertices.push(new n.Vector3(-this.prefs.endScale, -this.prefs.endScale, 0), new n.Vector3(-this.prefs.endScale, this.prefs.endScale, 0), new n.Vector3(this.prefs.endScale, this.prefs.endScale, 0), new n.Vector3(this.prefs.endScale, -this.prefs.endScale, 0)), f.lookAt(v, i, this.UP).setPosition(v), y.applyMatrix(f), y.vertices.push(v, i);
                    var b = new n.Line(y, new n.LineBasicMaterial({
                        color: m.debugColor.getHex(),
                        transparent: !0,
                        opacity: this.prefs.opacity,
                        depthWrite: !1,
                        name: "sLine" + p,
                        linewidth: this.prefs.linewidth
                    }));
                    this.obj3d.add(b)
                }
                e.add(this.obj3d)
            }
        }, r.prototype.update = function () {
            o.showNeighbors && this.obj3d && this.obj3d.updateMatrixWorld()
        }, t.exports = r
    }, {"../settings": 68, three: 138}],
    62: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t, i) {
                this.model = e, this.id = t, this.neighbourUUIDs = i.neighbours || null, this.neighbourPanos = null, this.floor = null, this.failedLoadingAt = 0, this.maxLoadRetries = 4, this.origin = i.position.clone(), this.position = i.position.clone(), this.quaternion = i.quaternion.clone(), this.mesh = new n.Mesh(d), this.mesh.position.copy(this.position), this.mesh.quaternion.copy(this.quaternion), this.mesh.name = "skybox", this.mesh.visible = !1, this.mesh.updateMatrix(), this.marker = new n.Mesh(f, new n.MeshBasicMaterial({
                    map: s.loadTextureFromCache("/resources/images/marker-256x256.png"),
                    side: n.DoubleSide,
                    opacity: 0,
                    transparent: !0,
                    depthWrite: !1
                })), this.marker.name = "marker", this.marker.pano = this, this.debugColor = (new n.Color).setHSL(.06 + .53 * Math.random(), .8 + .2 * Math.random(), .5 + .2 * Math.random()), i.puck ? this.floorPosition = i.puck.clone() : this.floorPosition = null, this.skybox = new n.Texture([null, null, null, null, null, null]), this.skybox.flipY = !1, a.colorMarkerOnLoad && this.on("load", function () {
                    this.marker.material.color.set(65280)
                })
            }

            var n = e("three"), o = e("../util/logger"), a = e("../settings"), s = (e("../enum/Viewmode"), e("../util/common")), h = e("../util/transitions"), l = e("../util/lerp"), u = e("events").EventEmitter, c = new o(i), d = (new n.BufferGeometry).fromGeometry(new n.SphereGeometry(.1)), f = new n.PlaneBufferGeometry(.4, .4, 1, 1);
            r.prototype = Object.create(u.prototype), r.prototype.enter = function () {
                this.emit("enter")
            }, r.prototype.exit = function () {
                this.skybox.dispose(), this.skybox.image.__webglTextureCube = null, this.skybox.loaded = !1, this.emit("exit")
            }, r.prototype.hoverOn = function (e) {
                h.start(l.property(this.marker.material, "opacity", a[e].markerOpacityOnHover), 250), a.navigation.panoScores & a.navigation.mouseDirection && this.addTextSprite("HIT", 12525854)
            }, r.prototype.hoverOff = function (e) {
                h.start(l.property(this.marker.material, "opacity", a[e].markerOpacity), 250)
            }, r.prototype.build1 = function () {
                this.floor = this.floor || this.raycastToFindFloor() || this.model.getFloorAtPoint(this.position), this.floor.addPano(this), this.floorPosition = this.floorPosition || this.raycastFloorPosition(), this.neighbourPanos = this.neighbourPanos || this.findNeighourPanos(), a.colorMarkerByFloor && this.marker.material.color.set(this.floor.debugColor)
            }, r.prototype.build2 = function () {
                this.floorPosition = this.floorPosition || this.interpolateFloorPosition(), this.height = this.position.distanceTo(this.floorPosition), this.placeMarker()
            }, r.prototype.update = function (e) {
                this.mesh.updateMatrixWorld(), this.marker.updateMatrixWorld(), this.position.setFromMatrixPosition(this.mesh.matrixWorld), this.floorPosition.setFromMatrixPosition(this.marker.matrixWorld)
            }, r.prototype.interpolateFloorPosition = function () {
                var e = this.getNeighbourList().filter(function (e) {
                    return !!e.floorPosition
                }).sort(function (e, t) {
                    return e.position.distanceTo(this.position) - t.position.distanceTo(this.position)
                }.bind(this)), t = this.position.clone();
                return e.length >= 2 ? t.y = (e[0].floorPosition.y + e[1].floorPosition.y) / 2 : t.add(a.noMeshFloorPositionOffset), t
            }, r.prototype.getNeighbourList = function () {
                return this.model.panos.filter(function (e) {
                    return e !== this && this.model.panos.isNeighbour(this, e)
                }.bind(this))
            }, r.prototype.raycastFloorPosition = function () {
                var e = new n.Raycaster(this.position, new n.Vector3(0, -1, 0)), t = e.intersectObjects(this.model.colliders);
                return t.length ? t[0].point : null
            }, r.prototype.raycastToFindFloor = function () {
                var e = [new n.Vector3(0, -1, 0), new n.Vector3(1, -1, 0), new n.Vector3(0, -1, 1), new n.Vector3(-1, -1, 0), new n.Vector3(0, -1, -1), new n.Vector3(1, 0, 0), new n.Vector3(0, 0, 1), new n.Vector3(-1, 0, 0), new n.Vector3(0, 0, -1)];
                return function () {
                    for (var t = 0; t < e.length; t++) {
                        var i = new n.Raycaster(this.position.clone(), e[t].clone()), r = i.intersectObjects(this.model.colliders);
                        if (r.length)return r[0].object.parent.parent
                    }
                    return null
                }
            }(), r.prototype.placeMarker = function () {
                this.marker.position.copy(this.floorPosition), this.marker.position.y += .05, this.marker.lookAt(new n.Vector3(0, 1, 0).add(this.marker.position))
            }, r.prototype.findClosestMidtpointPanoTo = function (e) {
                (new n.Vector3).addVectors(this.position, e.position).divideScalar(2);
                return this.model.panos.find([r.filters.notIn([this, e])], [r.sortFunctions.distanceToPoint(point)])
            }, r.prototype.loadCube = function (e, t, i, r) {
                r || (this.emit("loading", e), this.model.emit("loading", this), r = 0);
                var n = this.getCubemapUrls(e), o = n.filter(function (e) {
                    return null === e
                });
                "low" === e && o.length > 0 && (c.info("Pano", this.id, "not available in low res, loading high res right away"), e = "high", n = this.getCubemapUrls(e)), $.when(this.loadCubeImage(n[0]), this.loadCubeImage(n[1]), this.loadCubeImage(n[2]), this.loadCubeImage(n[3]), this.loadCubeImage(n[4]), this.loadCubeImage(n[5])).done(function (i, r, n, o, a, s) {
                    this.skybox[e] = [i, r, n, o, a, s], "high" !== e && this.skybox.high || (this.skybox.image = this.skybox[e], this.skybox.low = null), this.skybox.needsUpdate = !0, this.emit("load", e), this.model.emit("load", this), t && t()
                }.bind(this)).fail(function () {
                    r < this.maxLoadRetries ? (c.warn("Downloading cubemap for pano", this.id, "failed, retrying after 1s wait (retry", (r + 1).toString() + ")"), setTimeout(function () {
                        this.loadCube(e, t, i, r + 1)
                    }.bind(this), 1e3)) : (c.error("Downloading cubemap for pano", this.id, "failed, giving up after", r.toString(), "retries"), this.failedLoadingAt = Date.now(), i && i())
                }.bind(this))
            }, r.prototype.loadCubeImage = function (e) {
                var t = $.Deferred(), i = new Image;
                return i.onerror = function () {
                    t.reject()
                }, i.onload = function () {
                    t.resolve(i)
                }, i.crossOrigin = n.ImageUtils.crossOrigin, i.src = e, t
            }, r.prototype.getCubemapUrls = function (e, t) {
                return [2, 4, 0, 5, 1, 3].map(function (t, i) {
                    return this.model.urls.get("pan/" + e + "/" + this.id + "_skybox" + t + ".jpg")
                }.bind(this))
            }, r.prototype.isLoaded = function (e) {
                return this.skybox.high ? !0 : e in this.skybox
            }, r.raycastsSkipped = 0, r.raycastsDone = 0, r.prototype.findNeighourPanos = function () {
                return this.model.panos.setNeighbour(this.id, this.id, !1), this.model.panos.forEach(function (e) {
                    if (e !== this && (!this.model.panos.neighbourMap[this.id] || void 0 === this.model.panos.neighbourMap[this.id][e.id])) {
                        var t = this.position.distanceTo(e.position);
                        if (t > a.panoramaNeighbourMaxDistance)return this.model.panos.setNeighbour(this, e, !1), void r.raycastsSkipped++;
                        var i = e.position.clone().sub(this.position).normalize(), o = new n.Raycaster(this.position, i.clone(), 0, t), s = o.intersectObjects(this.model.colliders);
                        r.raycastsDone++, this.model.panos.setNeighbour(this, e, 0 === s.length), a.showNeighbourRaycasts && (s.length ? this.floor.model.add(new n.ArrowHelper(i, this.position, s[0].distance, 16711680)) : this.floor.model.add(new n.ArrowHelper(i, this.position, t, 16777215, 0, 0)))
                    }
                }.bind(this)), this.model.panos.neighbourMap[this.id]
            }, r.prototype.worldPosition = function () {
                return this.position
            }, r.prototype.addTextSprite = function (e, t) {
                this.removeTextSprite();
                var i = document.createElement("canvas"), r = i.getContext("2d");
                i.width = 256, i.height = 256;
                var o = "Arial", a = 60;
                r.font = "bold " + a + "px " + o, r.fillStyle = "white";
                var s = r.measureText(e).width;
                r.fillText(e, (i.width - s) / 2, (i.height + a) / 2);
                var h = new n.Texture(i);
                h.needsUpdate = !0;
                var l = new n.SpriteMaterial({map: h, color: t || 16428055});
                this.text3d = new n.Sprite(l), this.text3d.position.copy(this.mesh.position), this.floor.add(this.text3d)
            }, r.prototype.removeTextSprite = function () {
                this.text3d && (this.floor.remove(this.text3d), this.text3d = null)
            }, r.filters = {
                inDirection: function (e, t, i) {
                    return function (r) {
                        var n = r.position.clone().sub(e).normalize();
                        return n.dot(t) > i
                    }
                }, inFloorDirection: function (e, t, i) {
                    return function (r) {
                        var n = r.floorPosition.clone().sub(e).normalize();
                        return n.dot(t) > i
                    }
                }, inPanoDirection: function (e, t, i) {
                    return i = a.navigation.panoScores ? a.navigation.filterStrictness : i, function (r) {
                        var n = r.floorPosition.clone().sub(e).normalize(), o = r.position.clone().sub(e).normalize();
                        return n.dot(t) > i || o.dot(t) > i
                    }
                }, atFloor: function (e) {
                    return function (t) {
                        return e ? t.floor === e : !0
                    }
                }, not: function (e) {
                    return function (t) {
                        return t != e
                    }
                }, notIn: function (e) {
                    return function (t) {
                        return -1 === e.indexOf(t)
                    }
                }, isLoaded: function () {
                    return function (e) {
                        return e.isLoaded()
                    }
                }, isNotLoaded: function () {
                    return function (e) {
                        return !e.isLoaded()
                    }
                }, isCloseEnoughTo: function (e, t) {
                    return function (i) {
                        return e.distanceTo(i.floorPosition) < t
                    }
                }, hasMinimumHeightDifferenceTo: function (e, t) {
                    return function (i) {
                        return Math.abs(i.position.y - e.y) > t
                    }
                }, isNotBehindNormal: function (e, t) {
                    var i = new n.Vector3;
                    return t = t.clone(), function (r) {
                        var n = i.copy(r.position).sub(e).normalize();
                        return n.dot(t) > 0
                    }
                }, isNeighbourPanoTo: function (e) {
                    return function (t) {
                        return e && e.neighbourPanos ? !!e.neighbourPanos[t.id] : !0
                    }
                }, isNeighbourOfNeighbourTo: function (e) {
                    return function (t) {
                        return e.neighbourPanos[t.id] ? !0 : e.getNeighbourList().some(function (e) {
                            return e.neighbourPanos[t.id]
                        })
                    }
                }, isNotRecentlyFailed: function (e) {
                    return function (t) {
                        return Date.now() - t.failedLoadingAt > e
                    }
                }, isOnVisibleFloor: function () {
                    return function (e) {
                        return !e.floor.hidden
                    }
                }
            }, r.sortFunctions = {
                distanceToPoint: function (e) {
                    return function (t, i) {
                        return t.position.distanceTo(e) - i.position.distanceTo(e)
                    }
                }, floorDistanceToPoint: function (e) {
                    return function (t, i) {
                        return t.floorPosition.distanceTo(e) - i.floorPosition.distanceTo(e)
                    }
                }, choose: function (e) {
                    return function (t, i) {
                        return e.id === t.id ? -1 : e.id === i.id ? 1 : 0
                    }
                }
            }, r.scoreFunctions = {
                distance: function (e) {
                    return function (t) {
                        return e ? e.position.distanceTo(t.position) * a.navigation.distanceFactor : 0
                    }
                }, distanceSquared: function (e) {
                    return function (t) {
                        return e ? e.position.distanceToSquared(t.position) * a.navigation.distanceFactor : 0
                    }
                }, direction: function (e, t) {
                    return function (i) {
                        var r = i.position.clone().sub(e).normalize();
                        return r.dot(t) * a.navigation.directionFactor
                    }
                }, angle: function (e, t) {
                    return function (i) {
                        var r = i.position.clone().sub(e).normalize();
                        return r.angleTo(t) * a.navigation.angleFactor
                    }
                }, inFieldOfView: function (e, t) {
                    return function (i) {
                        var r = i.position.clone().sub(e).normalize();
                        return r.dot(t) > .75 ? 10 : -1
                    }
                }, penalizeHeightDifferenceUnder: function (e, t) {
                    return function (i) {
                        return e.y - i.position.y < t ? -20 : 0
                    }
                }
            }, t.exports = r
        }).call(this, "/js/objects/Panorama.js")
    }, {
        "../enum/Viewmode": 12,
        "../settings": 68,
        "../util/common": 75,
        "../util/lerp": 77,
        "../util/logger": 78,
        "../util/transitions": 81,
        events: 88,
        three: 138
    }],
    63: [function (e, t, i) {
        "use strict";
        function r(e) {
            var t = n.UniformsUtils.clone(h.waypoint.uniforms);
            t.map.value = n.ImageUtils.loadTexture("/resources/images/reticule-256x256.png"), t.opacity.value = 0, t.color.value.set(o.reticuleColor), n.Mesh.call(this, new n.PlaneBufferGeometry(.4, .4, 1, 1), new n.ShaderMaterial({
                side: n.DoubleSide,
                depthWrite: !1,
                depthTest: !1,
                transparent: !0,
                vertexShader: h.waypoint.vertexShader,
                fragmentShader: h.waypoint.fragmentShader,
                uniforms: t,
                name: "waypoint",
                opacity: 0
            })), this.player = e, this.direction = new n.Vector3, this.hidden = !0, this.mouseLastMoveTime = Date.now()
        }

        var n = e("three"), o = e("../settings"), a = e("../util/transitions"), s = e("../util/lerp"), h = e("../shaders");
        r.prototype = Object.create(n.Mesh.prototype), r.prototype.move = function (e, t, i) {
            this.hidden = i, this.mouseLastMoveTime = Date.now()
        }, r.prototype.hide = function () {
            this.hidden || (this.hidden = !0, a.start(s.property(this.material.uniforms.opacity, "value", 0), o.reticuleOpacityTransitionTime))
        }, r.prototype.show = function () {
            this.hidden = !1, this.material.opacity <= 0 && a.start(s.property(this.material.uniforms.opacity, "value", o[this.player.mode].reticuleOpacity), o.reticuleOpacityTransitionTime)
        }, r.prototype.update = function () {
            Date.now() - this.mouseLastMoveTime > o.hideReticuleTimeout && !this.hidden && this.hide()
        }, r.prototype.updatePosition = function (e, t) {
            if (!this.hidden) {
                if (!t)return this.hide();
                var i = t.point, r = e.distanceTo(i), n = 1 + .01 * r;
                1 > r && (n -= 1 - r), this.show(), this.scale.set(n, n, n), this.direction = this.direction.multiplyScalar(.8), this.direction.add(t.face.normal.clone().multiplyScalar(.2)), this.position.copy(i).add(t.face.normal.clone().multiplyScalar(.01)), this.lookAt(this.position.clone().add(this.direction))
            }
        }, t.exports = r
    }, {"../settings": 68, "../shaders": 69, "../util/lerp": 77, "../util/transitions": 81, three: 138}],
    64: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e) {
                this.obj3d = null;
                var t = "ribbon.png";
                "chevron" === h.path.style && (t = "pathTile.png"), this.texture = this.loadTileTexture("/resources/images/" + t), this.endTex = this.loadTileTexture("/resources/images/End.png"), this.startTex = this.loadTileTexture("/resources/images/Start.png"), this.nodes = [], this.nodeColors = [], this.shortPaths = {}, this.floorPathPoints = null, this.camPathPoints = null, this.floorPathDistance = 0, this.floorCurvePoints = null, this.floorCurveColors = null, this.camCurvePoints = null, this.warpDestination = null, this.wPano = null, this.warpPathPoints = null, this.warpPathLengths = [0], this.warpLength = 0, this.closeWarpDistance = 4, this.player = e, this.createCpm(this.player.scene), this.bunnyObj = new n.AxisHelper(.1), this.bunnyObj.visible = h.warp.showBunny, this.player.scene.add(this.bunnyObj), this.UP = new n.Vector3(0, 1, 0), this.longestStep = 0, this.transType = null, this.canSeePath = !1, this.burnsDir = 1, this.hasBeenIndoors = !1, this.updateDefaultsFromModelData()
            }

            var n = e("three"), o = e("../util/logger"), a = e("../enum/Viewmode"), s = e("../enum/WarpStyle"), h = e("../settings"), l = (e("../util/math"), e("../util/lerp")), u = e("../util/easing"), c = e("../util/transitions"), d = e("../effects"), f = e("../shaders"), p = (e("../gui/gui"), new o(i));
            r.prototype.updateDefaultsFromModelData = function () {
                var e = this.player.model.data;
                e.hasOwnProperty("player_options") && e.player_options && e.player_options.fast_transitions === !1 ? this.defaultWarpType = s.STD : this.defaultWarpType = h.path.typ
            }, r.prototype.pointPathDistance = function (e) {
                for (var t = 0, i = 1; i < e.length; i += 1)t += e[i - 1].distanceTo(e[i]);
                return t
            }, r.prototype.pointPathLengths = function (e) {
                for (var t = [0], i = 1; i < e.length; i += 1)t.push(t[i - 1] + e[i - 1].distanceTo(e[i]));
                return t
            }, r.prototype.interpAlongPath = function (e, t, i) {
                var r, o = new n.Vector3, a = t[t.length - 1];
                if (1 > i) {
                    r = i * a;
                    for (var s = 1; s < t.length; s += 1)if (t[s] > r) {
                        var h = (r - t[s - 1]) / (t[s] - t[s - 1]);
                        return o.copy(e[s]), o.sub(e[s - 1]), o.multiplyScalar(h), o.add(e[s - 1]), o
                    }
                } else o.copy(e[e.length - 1]);
                return o
            }, r.prototype.pathHeight = function () {
                return this.player.mode !== a.FLOORPLAN ? h.path.height : h.path.outsideHeight
            }, r.prototype.createCpm = function (e) {
                this.currentPanoMarker = this.makeWaypointObj(this.endTex, "Current"), this.currentPanoMarker.material.uniforms.opacity.value = 0, this.placeCpm(), e.add(this.currentPanoMarker)
            }, r.prototype.placeCpm = function () {
                this.hasBeenIndoors && this.player.currentPano ? (this.currentPanoMarker.parent != this.player.currentPano.floor && (this.currentPanoMarker.parent && this.currentPanoMarker.parent.remove(this.currentPanoMarker), this.player.currentPano.floor.add(this.currentPanoMarker)), this.currentPanoMarker.position.copy(this.player.currentPano.floorPosition).sub(this.player.model.position), this.currentPanoMarker.position.y += this.pathHeight()) : this.popOutCpm()
            }, r.prototype.fadeInCpm = function (e) {
                this.hasBeenIndoors && c.start(l.property(this.currentPanoMarker.material.uniforms.opacity, "value", 1), e)
            }, r.prototype.fadeOutCpm = function (e) {
                c.start(l.property(this.currentPanoMarker.material.uniforms.opacity, "value", 0), e)
            }, r.prototype.popInCpm = function () {
                this.hasBeenIndoors && this.fadeInCpm(2)
            }, r.prototype.popOutCpm = function () {
                this.fadeOutCpm(2)
            }, r.prototype.brushPrefs = {
                linewidth: 7,
                strokeWidth: 15,
                cvSegments: 48,
                paveStep: .1,
                paveWidth: .2,
                lookBlendDist: 3,
                maxTurn: n.Math.degToRad(2)
            }, r.prototype.panoPathDistance = function (e) {
                var t = this.player.model.panos;
                if (!e || e.length < 2)return 0;
                for (var i = [], r = 0; r < e.length; r += 1)i.push(t.dict[e[r]].floorPosition);
                return this.pointPathDistance(i)
            }, r.prototype.loadTileTexture = function (e) {
                return n.ImageUtils.loadTexture(e, n.UVMapping, function (t) {
                    t.wrapS = n.RepeatWrapping, t.wrapT = n.RepeatWrapping, t.needsUpdate = !0, p.debug('path texture "' + e + '" is ready')
                }, function () {
                    p.error('path texture "' + e + '" failed')
                })
            }, r.prototype.selectWarpLocation = function (e) {
                var t = this.player.model.heroLocations.length;
                if (1 > t)return p.warn("no hero locations in this model"), !1;
                if (null !== this.warpDestination && 2 > t)return p.info("only one hero location is available"), this.warpDestination = this.player.model.heroLocations[0],
                    !0;
                var i = this.player.model.heroLocations[e];
                return void 0 === i ? (p.warn("index " + e + " is not a valid warp destination from a list of " + t), !1) : ("" === i.scan_id ? p.debug('New brush/warp destination: "' + i.camera_mode + '" out of ' + t + " choices.") : p.debug('New brush/warp destination: "' + i.scan_id + '" out of ' + t + " choices."), this.warpDestination = i, !0)
            }, r.prototype.lookupWarpPano = function () {
                if (null === this.warpDestination)return p.warn("lookupWarpPano() fail, no destination"), !1;
                var e = this.warpDestination.scan_id || this.warpDestination.id;
                return this.wPano = this.player.model.panos.dict[e], void 0 === this.wPano ? (this.wPano = null, "" !== e && p.debug('unable to find pano "' + e + '"'), !1) : !0
            }, r.prototype.determinePathVisibility = function () {
                return this.canSeePath = !1, this.canSeePath = this.canSeePath || this.defaultWarpType === s.STD, this.canSeePath = this.canSeePath || h.path.alwaysShow, this.canSeePath
            }, r.prototype.brushToWarpPano = function () {
                return this.discardPath(), this.lookupWarpPano() ? (this.warpDestination.camera_mode !== a.PANORAMA && p.warn("Can only brush from pano to pano"), this.wPano ? this.player.currentPano ? this.wPano ? void(this.player.currentPano.id === this.wPano.id ? p.debug("Already at destination pano") : (this.findShortestPath(), p.debug('Brushing from "' + this.player.currentPano.id + '" to "' + this.wPano.id + '" (' + (this.nodes ? this.nodes.length : 0) + ")"), void 0 === this.nodes || null === this.nodes || this.nodes.length < 1 ? (p.info('No "walkable" route, using slide-style transition'), this.drawPathNothing(), this.transType = s.BLACK) : this.determinePathVisibility() ? "none" === h.path.style ? this.drawPathNothing() : "chevron" === h.path.style ? this.drawPathPavement() : this.drawPathRibbon() : this.drawPathNothing(), this.addHint())) : void p.info("No wPano, visibility undefined") : void p.debug("No current pano, visibility undefined") : void p.info("No brush")) : void 0
            }, r.prototype.findShortestPath = function () {
                var e = this.player.currentPano.id + ":" + this.wPano.id;
                if (this.shortPaths.hasOwnProperty(e))return void(this.nodes = this.shortPaths[e] ? this.shortPaths[e].slice() : null);
                var t = this.wPano.id + ":" + this.player.currentPano.id;
                return this.shortPaths.hasOwnProperty(t) ? void(this.nodes = this.shortPaths[t] ? this.shortPaths[t].slice().reverse() : null) : (this.nodes = this.player.model.panos.path_graph.findShortestPath(this.player.currentPano.id, this.wPano.id), void(this.shortPaths[e] = this.nodes ? this.nodes.slice() : null))
            }, r.prototype.makeFloorPathPoints = function () {
                var e, t, i, r, n, o = 0;
                this.floorPathPoints = [], this.camPathPoints = [], this.nodeColors = [];
                var a = this.player.model.panos;
                e = a.dict[this.nodes[0]], r = e.floor.floorIndex;
                for (var s = 0; s < this.nodes.length; s += 1)e = a.dict[this.nodes[s]], t = e.floorPosition.clone().sub(this.player.model.position), t.y += this.pathHeight(), this.floorPathPoints.push(t), this.camPathPoints.push(e.position.clone()), i = e.floor.floorIndex, this.nodeColors.push(i > r ? h.path.colorUp : r > i ? h.path.colorDown : h.path.color), s > 0 && (n = this.camPathPoints[s].distanceTo(this.camPathPoints[s - 1]), n > o && (o = n));
                return o > this.longestStep && (this.longestStep = o, p.debug("path contains " + o + " meter segment")), this.floorPathPoints
            }, r.prototype.makeFloorCurvePoints = function () {
                var e = this.player.mode === a.PANORAMA ? h.path.waypointIndoorRadius : h.path.waypointRadius;
                this.floorPathDistance = this.pointPathDistance(this.floorPathPoints) - 2 * e;
                var t = this.floorPathPoints.slice(0), i = t[1].clone().sub(t[0]);
                i.y = 0, i.normalize().multiplyScalar(e), t[0] = (new n.Vector3).copy(t[0]).add(i), i = t[t.length - 2].clone().sub(t[t.length - 1]), i.y = 0, i.normalize().multiplyScalar(e), t[t.length - 1] = (new n.Vector3).copy(t[t.length - 1]).add(i);
                var r = new n.SplineCurve3(t), o = Math.floor(this.floorPathDistance / this.brushPrefs.paveStep);
                o = 4 * Math.floor(o / 4), o = Math.max(4, o), this.floorCurvePoints = r.getSpacedPoints(o), this.floorCurveColors = [];
                for (var s, l, u, c = new n.Vector3, d = 0; d < this.floorCurvePoints.length; d += 1) {
                    u = 0, s = this.floorCurvePoints[d].distanceTo(this.floorPathPoints[0]);
                    for (var f = 1; f < this.floorPathPoints.length; f += 1)c.copy(this.floorCurvePoints[d]).sub(this.floorPathPoints[f]), c.y *= 4, l = c.length(), s > l && (u = f);
                    this.floorCurveColors.push(this.nodeColors[u])
                }
                return this.floorCurvePoints
            }, r.prototype.makeCameraCurvePoints = function () {
                var e = this.pointPathDistance(this.camPathPoints), t = new n.SplineCurve3(this.camPathPoints);
                return this.camCurvePoints = t.getSpacedPoints(Math.max(2, Math.floor(e / this.brushPrefs.paveStep))), this.camCurvePoints
            }, r.prototype.chooseWarpPath = function (e) {
                var t, i, r, o = this.player.cameras[a.PANORAMA];
                if (this.player.currentPano === this.wPano || !e)return this.warpPathPoints = null, this.warpLength = 0, !1;
                this.findShortestPath(), void 0 === this.nodes || null === this.nodes || this.nodes.length < 1 ? (p.debug("warp path to unreachable node"), t = this.wPano.position.clone().sub(o.position), i = t.clone().negate(), t.multiplyScalar(.15).add(o.position), i.multiplyScalar(.15).add(this.wPano.position), t.y = o.position.y, i.y = this.wPano.position.y, r = new n.CubicBezierCurve3(o.position.clone(), t, i, this.wPano.position.clone()), this.warpPathPoints = r.getSpacedPoints(this.brushPrefs.cvSegments)) : (p.debug("follow warp path (path distance was " + this.nodes.length + " nodes, " + this.floorPathDistance + ")"), this.makeCameraCurvePoints(), this.warpPathPoints = this.camCurvePoints.slice(0)), this.warpLength = 0, this.warpPathLengths = [0];
                for (var s = new n.Vector3, h = new n.Vector3, l = 1; l < this.warpPathPoints.length; l += 1)s.copy(this.warpPathPoints[l - 1]), s.y *= 4, h.copy(this.warpPathPoints[l]), h.y *= 4, this.warpLength += s.distanceTo(h), this.warpPathLengths[l] = this.warpLength;
                return !0
            }, r.prototype.drawPathNothing = function () {
                this.discardPath(), this.obj3d = new n.Object3D, this.player.currentPano.floor.add(this.obj3d), void 0 !== this.nodes && null !== this.nodes && this.nodes.length > 0 && (this.makeFloorPathPoints(), this.makeFloorCurvePoints())
            }, r.prototype.drawPathRibbon = function () {
                this.discardPath(), this.obj3d = new n.Object3D, this.bunnyObj.visible = h.warp.showBunny;
                var e = .6 * h.path.ribbonWidth * .5;
                this.makeFloorPathPoints(), this.makeFloorCurvePoints();
                for (var t = new n.Vector3, i = new n.Vector3(0, this.pathHeight(), 0), r = new n.Geometry, o = 0; o < this.floorCurvePoints.length; o += 1) {
                    var s = (new n.Vector3).copy(this.floorCurvePoints[o]);
                    0 === o ? s.sub(this.floorCurvePoints[o + 1]) : s.sub(this.floorCurvePoints[o - 1]).negate(), s.normalize(), t.crossVectors(s, this.UP), t.multiplyScalar(e);
                    var l = (new n.Vector3).copy(this.floorCurvePoints[o]).add(i);
                    l.sub(t), r.vertices.push(l), l = (new n.Vector3).copy(this.floorCurvePoints[o]).add(i), l.add(t), r.vertices.push(l)
                }
                var u, c = 0;
                for (o = 0; o < this.floorCurvePoints.length - 1; o += 1) {
                    var d = 2 * o, p = c;
                    c += this.floorCurvePoints[o + 1].distanceTo(this.floorCurvePoints[o]);
                    var m = c, g = this.floorCurveColors[o], v = this.floorCurveColors[o + 1];
                    u = new n.Face3(d, d + 1, d + 2), u.vertexColors = [new n.Color(g), new n.Color(g), new n.Color(v)], r.faces.push(u), r.faceVertexUvs[0].push([new n.Vector2(0, p), new n.Vector2(1, p), new n.Vector2(0, m)]), u = new n.Face3(d + 2, d + 1, d + 3), u.vertexColors = [new n.Color(v), new n.Color(g), new n.Color(v)], r.faces.push(u), r.faceVertexUvs[0].push([new n.Vector2(0, m), new n.Vector2(1, p), new n.Vector2(1, m)])
                }
                var y, b;
                this.player.mode === a.PANORAMA ? (b = n.UniformsUtils.clone(f.ribbon.uniforms), b.map.value = this.texture, b.opacity.value = 0, b.color.value.set(h.path.color), y = new n.ShaderMaterial({
                    side: n.DoubleSide,
                    depthWrite: !1,
                    transparent: !0,
                    vertexShader: f.ribbon.vertexShader,
                    fragmentShader: f.ribbon.fragmentShader,
                    uniforms: b,
                    name: "ribbonT",
                    opacity: 0
                })) : y = new n.MeshBasicMaterial({
                    color: 16777215,
                    side: n.DoubleSide,
                    name: "ribbonOut",
                    vertexColors: n.VertexColors
                });
                var w = new n.Mesh(r, y);
                w.name = "ribbon", this.obj3d.add(w), this.player.currentPano.floor.add(this.obj3d), this.player.mode === a.PANORAMA && (w.renderOrder = 100)
            }, r.prototype.drawPathPavement = function () {
                this.discardPath(), this.obj3d = new n.Object3D;
                var e = .25;
                this.makeFloorPathPoints(), this.makeFloorCurvePoints();
                for (var t, i = new n.Vector3, r = new n.Geometry, o = new n.Vector3, s = 0; s < this.floorCurvePoints.length; s += 1)o.copy(this.floorCurvePoints[s]), 0 === s ? o.sub(this.floorCurvePoints[s + 1]).negate() : o.sub(this.floorCurvePoints[s - 1]), o.normalize(), i.crossVectors(o, this.UP), i.multiplyScalar(this.brushPrefs.paveWidth), t = (new n.Vector3).copy(this.floorCurvePoints[s]), t.sub(i), r.vertices.push(t), r.vertices.push((new n.Vector3).copy(this.floorCurvePoints[s])), t = (new n.Vector3).copy(this.floorCurvePoints[s]), t.add(i), r.vertices.push(t);
                var l, u, c;
                for (s = 0; s < this.floorCurvePoints.length - 1; s += 1)l = 3 * s + 1, u = s * e, c = u + e, r.faces.push(new n.Face3(l - 1, l, l + 3)), r.faceVertexUvs[0].push([new n.Vector2(0, u), new n.Vector2(.5, u), new n.Vector2(.5, c)]), r.faces.push(new n.Face3(l + 3, l + 2, l - 1)), r.faceVertexUvs[0].push([new n.Vector2(.5, c), new n.Vector2(0, c), new n.Vector2(0, u)]), r.faces.push(new n.Face3(l + 3, l, l + 1)), r.faceVertexUvs[0].push([new n.Vector2(.5, c), new n.Vector2(.5, u), new n.Vector2(1, u)]), r.faces.push(new n.Face3(l + 3, l + 1, l + 4)), r.faceVertexUvs[0].push([new n.Vector2(.5, c), new n.Vector2(1, u), new n.Vector2(1, c)]);
                var d = this.player.mode === a.PANORAMA ? new n.MeshBasicMaterial({
                    color: h.path.color,
                    side: n.DoubleSide,
                    transparent: !0,
                    depthWrite: !1,
                    opacity: 0,
                    name: "paveT",
                    map: this.texture
                }) : new n.MeshBasicMaterial({
                    color: h.path.color,
                    side: n.DoubleSide,
                    transparent: !0,
                    depthWrite: !1,
                    opacity: 1,
                    name: "paveO",
                    map: this.texture
                });
                this.obj3d.add(new n.Mesh(r, d)), this.player.currentPano.floor.add(this.obj3d)
            }, r.prototype.hintPrefs = {
                rad: .18,
                width: .0125,
                depth: .0625,
                setBack: -.04,
                markRad: .25,
                markInnerRad: .16
            }, r.prototype.makeWaypointObj = function (e, t) {
                var i = new n.Geometry, r = this.player.mode === a.PANORAMA ? h.path.waypointIndoorRadius : h.path.waypointRadius, o = this.pathHeight();
                i.vertices.push(new n.Vector3(-r, o, r), new n.Vector3(-r, o, -r), new n.Vector3(r, o, -r), new n.Vector3(r, o, r)), i.faces.push(new n.Face3(0, 1, 2), new n.Face3(2, 3, 0)), i.faceVertexUvs[0].push([new n.Vector2(0, 0), new n.Vector2(1, 0), new n.Vector2(1, 1)]), i.faceVertexUvs[0].push([new n.Vector2(1, 1), new n.Vector2(0, 1), new n.Vector2(0, 0)]);
                var s = n.UniformsUtils.clone(f.waypoint.uniforms);
                s.map.value = e, s.opacity.value = 0, s.color.value.set(h.path.color);
                var l = {
                    side: n.DoubleSide,
                    depthWrite: !1,
                    transparent: !0,
                    vertexShader: f.waypoint.vertexShader,
                    fragmentShader: f.waypoint.fragmentShader,
                    uniforms: s,
                    name: "waypoint",
                    opacity: 0
                };
                this.player.mode !== a.PANORAMA && (l.depthTest = !1, l.name = "wayPtOut");
                var u = new n.ShaderMaterial(l), c = new n.Mesh(i, u);
                return c.name = t, c
            }, r.prototype.waypoints = function () {
                var e = this.player.mode === a.DOLLHOUSE || this.player.mode === a.FLOORPLAN, t = h.path.mapGuides && !this.player.director.tourIsPlaying && e;
                if (t = t || this.transType === s.STD, this.canSeePath || t) {
                    var i = this.floorPathPoints[this.floorPathPoints.length - 1];
                    if (e) {
                        var r = this.floorPathPoints[0], o = this.floorCurvePoints[0], l = this.floorCurvePoints[1], u = (new n.Vector3).copy(l).sub(o);
                        u.y = 0, u.normalize();
                        var d = Math.acos(u.x), f = this.makeWaypointObj(this.startTex, "Start");
                        f.rotateOnAxis(new n.Vector3(0, 1, 0), d), f.position.copy(r), this.obj3d.add(f)
                    }
                    if (void 0 === this.nodes || null === this.nodes || this.nodes.length < 1)return void p.debug("no tour route");
                    var m = this.makeWaypointObj(this.endTex, "End"), g = this.player.model.panos.dict[this.nodes[0]].floor.floorIndex, v = this.player.model.panos.dict[this.nodes[this.nodes.length - 1]].floor.floorIndex;
                    t && h.path.pulseMarkers && c.start(function (e, t) {
                        if (!this.obj3d)return !0;
                        var i = Math.pow(Math.abs(.5 - e), 2);
                        m.material.uniforms.pulse.value = 1 - .7 * i;
                        var r = 1.5 - .5 * i;
                        m.scale.set(r, 1, r)
                    }.bind(this), -h.path.waypointPulse), v > g ? m.material.uniforms.color.value.set(h.path.colorUp) : g > v && m.material.uniforms.color.value.set(h.path.colorDown), m.position.copy(i), this.obj3d.add(m)
                }
            }, r.prototype.addHint = function () {
                return this.obj3d ? (this.waypoints(), this.player.mode !== a.PANORAMA ? void this.appearSlow() : void this.appearSlow()) : void p.info("no path/hint object")
            }, r.prototype.discardPath = function () {
                if (this.obj3d) {
                    var e = this.obj3d.parent;
                    e && e.remove(this.obj3d)
                }
                this.obj3d = null, this.popInCpm()
            }, r.prototype.discardSlow = function () {
                if (this.obj3d) {
                    if (this.player.mode !== a.PANORAMA)return void this.discardPath();
                    for (var e, t = this, i = 0, r = function () {
                        this.discardPath()
                    }.bind(this), n = 0; n < t.obj3d.children.length; n += 1)e = t.obj3d.children[n], void 0 !== e.material && e.material.transparent === !0 && (void 0 !== e.material.uniforms ? c.start(l.property(e.material.uniforms.opacity, "value", 0), h.path.fadeOutTime, r, 0, u[h.warp.blendEasing]) : c.start(l.property(e.material, "opacity", 0), h.path.fadeOutTime, r, 0, u[h.warp.blendEasing]), i += 1, r = null);
                    0 === i && this.discardPath(), this.player.mode !== a.PANORAMA && this.fadeInCpm(h.path.fadeInTime - 3)
                }
            }, r.prototype.appearSlow = function () {
                var e, t = this;
                this.fadeOutCpm(h.path.fadeInTime);
                for (var i = this.player.mode === a.PANORAMA ? h.path.opacity : 1, r = 0; r < t.obj3d.children.length; r += 1)e = t.obj3d.children[r], void 0 !== e.material && e.material.transparent === !0 && (void 0 !== e.material.uniforms ? c.start(l.property(e.material.uniforms.opacity, "value", i), h.path.fadeInTime, null, 0, u[h.warp.blendEasing]) : c.start(l.property(e.material, "opacity", i), h.path.fadeInTime, null, 0, u[h.warp.blendEasing]))
            }, r.prototype.update = function () {
                this.obj3d && this.obj3d.updateMatrixWorld()
            }, r.prototype.waitNextStep = function (e) {
                var t = new n.Euler, i = new n.Vector3;
                p.debug("Starting wait: " + (void 0 !== e));
                var r = function () {
                    this.player.mode === a.DOLLHOUSE && (this.player.cameras[a.DOLLHOUSE].controls.rotationAcceleration.x = 0), e && e()
                }.bind(this), o = function (e, o) {
                    if (this.player.director.pendingHalt)return r(), !0;
                    var s = o || 1e3 / 60;
                    if (h.warp.doBurns)if (this.player.mode === a.PANORAMA) {
                        var l = this.player.cameras[a.PANORAMA];
                        t.setFromQuaternion(l.quaternion, h.warp.eOrder);
                        var u = s * this.burnsDir * n.Math.degToRad(h.warp.burnsAngle) / h.warp.tourStepDelay;
                        t.y += u, i.set(0, 0, -1), i.applyEuler(t), i.add(l.position), l.controls.lookAt(i), l.controls.lookVector.copy(i), l.lookAt(i)
                    } else if (this.player.mode === a.DOLLHOUSE) {
                        var c = this.player.cameras[a.DOLLHOUSE];
                        c.controls.rotationAcceleration.x = this.burnsDir * Math.min(c.controls.rotationAcceleration.x + .05, .02)
                    } else this.player.controls[a.FLOORPLAN].absoluteScale *= .9996
                }.bind(this);
                c.start(o, h.warp.tourStepDelay, r, 0, u.easeInOutQuad, "wait")
            }, r.prototype.warpToNonPano = function (e) {
                this.discardPath(), this.warpDestination.camera_mode === a.DOLLHOUSE || this.warpDestination.camera_mode === a.FLOORPLAN ? this.player.flyToNewMode(this.warpDestination.camera_mode, {
                    duration: h.warp.outsideTime,
                    warpDest: this.warpDestination,
                    callback: e,
                    force: !0
                }) : (p.warn("no warp destination!!!"), e && e())
            }, r.prototype._resetWarpShaderParams = function (e) {
                this.player.mode === a.PANORAMA && (void 0 !== e.material.uniforms.blackout && (e.material.uniforms.blackout.value = 0), void 0 !== e.material.uniforms.stasis && (e.material.uniforms.stasis.value = 0), void 0 !== e.material.uniforms.modelAlpha && (e.material.uniforms.modelAlpha.value = 0))
            }, r.prototype._clearWarpShading = function () {
                for (var e = this.player.model.chunks, t = 0; t < e.length; t += 1)this._resetWarpShaderParams(e[t]), e[t].visible = !0;
                this._resetWarpShaderParams(this.player.model.skybox)
            }, r.prototype._warpStopFlying = function () {
                this.player.flying = !1, this.placeCpm()
            }, r.prototype._wrapupTravelOnlyBits = function () {
                this._warpStopFlying(), this.warpPathPoints && (this.player.currentPano.exit(), this.wPano.enter(), this.player.currentPano = this.wPano), this.player.spider.draw(), this.placeCpm()
            }, r.prototype._wrapupTravel = function (e) {
                this._wrapupTravelOnlyBits(), this.warpCameraAim(e)
            }, r.prototype._wrapupWarpShading = function (e) {
                this._clearWarpShading(), this._wrapupTravel(e)
            }, r.prototype.wrapupWarpShadingOnly = function (e) {
                this._clearWarpShading(), this.player.flying = !1, this._wrapupTravelOnlyBits(), this.transType = null;
                for (var t = this.player.model.panos, i = 0; i < t.length; i += 1)t.list[i].marker.material.opacity = h.panorama.markerOpacity;
                e && e()
            }, r.prototype._warpCameraAim = function (e, t, i) {
                var r = this.warpDestination.quaternion, o = this.player.cameras[a.PANORAMA], s = new n.Vector3(0, 0, 1).applyQuaternion(r).normalize(), l = new n.Vector3(0, 0, 1).applyQuaternion(o.quaternion).normalize(), d = l.dot(s), f = n.Math.radToDeg(Math.acos(d)), m = new n.Euler(0, 0, 0, h.warp.eOrder).setFromQuaternion(r, h.warp.eOrder), g = (new n.Euler).setFromQuaternion(o.quaternion, h.warp.eOrder), v = new n.Euler(m.x - g.x, m.y - g.y, m.z - g.z, h.warp.eOrder);
                v.y = v.y > Math.PI ? v.y -= 2 * Math.PI : v.y < -Math.PI ? v.y += 2 * Math.PI : v.y, this.burnsDir = Math.sign(v.y);
                var y = new n.Euler(0, 0, 0, h.warp.eOrder), b = new n.Vector3, w = function (e, t) {
                    return this.player.director.pendingHalt ? !0 : (y.x = g.x + e * v.x, y.y = g.y + e * v.y, y.z = g.z + e * v.z, b.set(0, 0, -1), b.applyEuler(y), b.add(o.position), o.controls.lookAt(b), o.controls.lookVector.copy(b), void o.lookAt(b))
                }.bind(this);
                return f > h.warp.minRotation ? c.start(w, t, i, 0, u[h.warp.movementEasing]) : (p.debug("Aim angle only is " + f.toPrecision(3) + " degrees, skipping explicit re-aim"), void(i && i()))
            }, r.prototype._warpBendAim = function (e, t, i, r) {
                var o = r || 0, s = this.player.cameras[a.PANORAMA], l = new n.Euler(0, 0, 0, h.warp.eOrder).setFromQuaternion(this.warpDestination.quaternion, h.warp.eOrder), d = (new n.Euler).setFromQuaternion(s.quaternion, h.warp.eOrder), f = new n.Euler(l.x - d.x, l.y - d.y, l.z - d.z, h.warp.eOrder);
                f.y = f.y > Math.PI ? f.y -= 2 * Math.PI : f.y < -Math.PI ? f.y += 2 * Math.PI : f.y;
                var p = Math.min(n.Math.degToRad(h.warp.softBendTilt), Math.abs(f.x));
                f.x = p * Math.sign(f.x), p = Math.min(n.Math.degToRad(Math.max(0, h.warp.softBendAngle)), p), this.burnsDir = Math.sign(f.y), p *= Math.sign(f.y), f.y = p;
                var m = new n.Euler(0, 0, 0, h.warp.eOrder), g = new n.Vector3, v = function (e, t) {
                    if (.5 > e)m.x = d.x + e * f.x, m.y = d.y + e * f.y, m.z = d.z + e * f.z; else {
                        var i = (1 - e) * h.warp.softBendEnd;
                        m.x = l.x - i * f.x, m.y = l.y - i * f.y, m.z = l.z - i * f.z
                    }
                    g.set(0, 0, -1), g.applyEuler(m), g.add(s.position), s.controls.lookAt(g), s.controls.lookVector.copy(g), s.lookAt(g)
                }.bind(this);
                return c.start(v, t, i, o, u[h.warp.movementEasing])
            }, r.prototype._warpStepCameraAim = function (e, t, i) {
                var r = this.player.cameras[a.PANORAMA], o = new n.Euler(0, 0, 0, h.warp.eOrder).setFromQuaternion(this.warpDestination.quaternion, h.warp.eOrder), s = (new n.Euler).setFromQuaternion(r.quaternion, h.warp.eOrder), l = new n.Euler(o.x - s.x, o.y - s.y, o.z - s.z, h.warp.eOrder);
                l.y = l.y > Math.PI ? l.y -= 2 * Math.PI : l.y < -Math.PI ? l.y += 2 * Math.PI : l.y, this.burnsDir = Math.sign(l.y);
                var d = new n.Euler(0, 0, 0, h.warp.eOrder), f = new n.Vector3, p = function (e, t) {
                    .5 > e ? d.copy(s) : d.copy(o), f.set(0, 0, -1), f.applyEuler(d), f.add(r.position), r.controls.lookAt(f), r.controls.lookVector.copy(f), r.lookAt(f)
                }.bind(this);
                return c.start(p, t, i, 0, u[h.warp.movementEasing])
            }, r.prototype.setBurnsDir = function () {
                var e = this.player.cameras[a.PANORAMA], t = new n.Euler(0, 0, 0, h.warp.eOrder).setFromQuaternion(this.warpDestination.quaternion, h.warp.eOrder), i = (new n.Euler).setFromQuaternion(e.quaternion, h.warp.eOrder), r = new n.Euler(t.x - i.x, t.y - i.y, t.z - i.z, h.warp.eOrder);
                r.y = r.y > Math.PI ? r.y -= 2 * Math.PI : r.y < -Math.PI ? r.y += 2 * Math.PI : r.y, this.burnsDir = Math.sign(r.y)
            }, r.prototype.stepWarpPath = function (e, t) {
                var i = this.player.cameras[a.PANORAMA];
                if (!this.warpPathPoints)return i.position.copy(this.wPano.position), !0;
                var r = this.warpPathPoints[0], o = this.wPano.position;
                if (null !== this.nodes && this.camPathPoints.length > 1) {
                    var s = new n.Vector3;
                    .5 > e ? s.copy(this.camPathPoints[1]).sub(r).normalize().multiplyScalar(h.warp.softPushDist * e).add(r) : s.copy(this.camPathPoints[this.camPathPoints.length - 2]).sub(o).normalize().multiplyScalar(h.warp.softPushDist * h.warp.softPushEnd * (1 - e)).add(o), i.position.copy(s)
                } else.5 > e ? i.position.copy(r) : i.position.copy(o)
            }, r.prototype.haltWarp = function () {
                var e, t, i, r = 5e5, o = this.player.model.panos, h = this.player.cameras[a.PANORAMA].position, l = new n.Vector3, u = this.player;
                if (p.debug("haltWarp() in player mode " + this.player.mode + " player.director.tourIsPlaying is " + this.player.director.tourIsPlaying + " flying is " + this.player.flying), !this.player.director.tourIsPlaying)return void p.info("Early path.haltWarp() exit");
                if (this.player.flying && this.transType !== s.STD || u.mode !== a.PANORAMA)return void(this.player.director.pendingHalt && p.warn("path.haltWarp(): multiple pendingHalt events"));
                p.info("path.haltTour() final clause");
                var d = this.player.director.tourIsPlaying, f = this.player.flying;
                if (p.info("haltWarp() Caution: path is tweaking director"), this.player.director.tourIsPlaying = !1, this.player.flying = !1, this.player.cameras[a.DOLLHOUSE].controls.rotationAcceleration.x = 0, this.player.director.pendingHalt)p.warn("path.haltWarp() strange..."); else if (f && d)if (this.transType === s.STD)for (e = 0; e < o.length; e += 1)o.list[e] !== this.player.currentPano && (i = l.copy(o.list[e].position).sub(h).lengthSq(), r > i && (t = o.list[e], r = i)); else p.warn("path.haltWarp() should not issue this message");
                d && this._clearWarpShading(), this.discardSlow(), p.debug("new transitions count: " + c.countActive()), this.player.mode === a.PANORAMA && f && d && t && this.player.flyToPano(t)
            }, r.prototype.warpCameraAim = function (e) {
                var t = h.warp.minWarpTime;
                if (this.transType === s.BLACK)t = h.warp.teleportTime; else {
                    var i = this.player.cameras[a.PANORAMA], r = new n.Euler(0, 0, 0, h.warp.eOrder).setFromQuaternion(this.warpDestination.quaternion, h.warp.eOrder), o = (new n.Euler).setFromQuaternion(i.quaternion, h.warp.eOrder), l = new n.Euler(r.x - o.x, r.y - o.y, r.z - o.z, h.warp.eOrder);
                    l.y = l.y > Math.PI ? l.y -= 2 * Math.PI : l.y < -Math.PI ? l.y += 2 * Math.PI : l.y;
                    var u = 1e3 * Math.abs(l.y) / n.Math.degToRad(h.warp.maxTurnPerSec);
                    t = Math.max(t, u)
                }
                var c = function () {
                    this._warpStopFlying(), this.discardSlow(), e && e()
                }.bind(this);
                this._warpCameraAim(e, t, c)
            }, r.prototype.warpCommonParameters = function (e, t, i) {
                this.player.model.skybox.material.uniforms.blackout.value = 0, this.player.model.skybox.material.uniforms.stasis.value = 0;
                var r = l.uniform(this.player.model.skybox, "progress", 1), n = l.allUniforms(this.player.model.chunks, "progress", 1), o = !1, a = function () {
                    return this.player.director.pendingHalt ? (o = !0, !0) : void 0
                }.bind(this), s = function (e, t) {
                    return i && o ? (this.player.model.skybox.material.uniforms.progress.value = 0, !0) : void r(e, t)
                }.bind(this), d = function (e, t) {
                    return i && o ? (n(0), !0) : void n(e, t)
                }.bind(this);
                c.start(a, e, null, t, null, "safeHaltWatch"), c.start(s, e, null, t, u[h.warp.blendEasing], "skyboxProgress"), c.start(d, e, null, t, u[h.warp.blendEasing], "chunkProgress")
            }, r.prototype.half_warp = function () {
                return this.discardSlow(), this.lookupWarpPano() ? (this.transType = s.BLACK, void this.warpTravel_BLACK(function () {
                    this._clearWarpShading()
                }.bind(this), -.5)) : (this.transType = null, void this.warpToNonPano())
            }, r.prototype.warpTravel_STD = function (e) {
                var t, i = Math.min(.1, h.warp.lookAheadDist / this.warpLength), r = this.player.cameras[a.PANORAMA], o = (Math.min(.25, 3 / this.warpLength), Math.min(.35, 7 / this.warpLength)), f = new n.Euler(0, 0, 0, h.warp.eOrder), m = new n.Vector3, g = (new n.Euler).setFromQuaternion(r.quaternion, h.warp.eOrder), v = (new n.Euler).copy(g), y = r.position.clone(), b = h.warp.minWarpTime, w = !1;
                b += this.warpLength * h.warp.timePerMeter, h.warp.flySpeed > .01 && (b = 1e3 * this.warpLength / h.warp.flySpeed), b += h.warp.moveDelay;
                var _ = h.warp.moveDelay / b, x = this.warpDestination.quaternion, S = new n.Vector3(0, 0, -1).applyQuaternion(x).normalize(), E = this.warpPathPoints[this.warpPathPoints.length - 1].clone().sub(this.warpPathPoints[this.warpPathPoints.length - 2]).normalize(), M = E.dot(S), A = n.Math.radToDeg(Math.acos(M)), T = function (e) {
                    var t = o, i = n.Math.smoothstep(e, 0, t) * (1 - n.Math.smoothstep(e, 1 - t, 1));
                    return i
                };
                this.warpCommonParameters(b, _, !0);
                var C = function () {
                    w ? (this.discardSlow(), c.start(function () {
                    }, 100, function () {
                        this.transType = s.BLACK, this.warpTravel_BLACK(function () {
                            this._clearWarpShading(), this.player.director.onTheBus = !0, this.player.director.detourComplete("_scoot")
                        }.bind(this), -.5)
                    }.bind(this), 0, null, "_jump2end")) : this._wrapupWarpShading(e)
                }.bind(this), P = function () {
                    return this.player.director.pendingHalt ? (w = !0, !0) : void 0
                }.bind(this), L = function (e, r) {
                    return this.warpPathPoints ? w ? !0 : void(t = this.interpAlongPath(this.warpPathPoints, this.warpPathLengths, Math.min(e + i, 1))) : (p.debug("Lost bunny."), !0)
                }.bind(this), k = function (e, o) {
                    if (w)return p.debug(">>>> Walkthrough interupted at t=" + e), !0;
                    if (!this.warpPathPoints)return !0;
                    var a = this.warpLength * e, s = n.Math.smoothstep(a, 0, this.brushPrefs.lookBlendDist), l = n.Math.smoothstep(a, this.warpLength - this.brushPrefs.lookBlendDist, this.warpLength);
                    h.warp.matchCam && (s *= 1 - l);
                    var u = (new n.Matrix4).lookAt(y, t, this.UP);
                    f.setFromRotationMatrix(u, h.warp.eOrder), g.setFromQuaternion(r.quaternion, h.warp.eOrder);
                    var c = new n.Euler(f.x - g.x, f.y - g.y, f.z - g.z, h.warp.eOrder);
                    c.y = c.y % (2 * Math.PI), c.y = c.y > Math.PI ? c.y -= 2 * Math.PI : c.y < -Math.PI ? c.y += 2 * Math.PI : c.y, f.x = g.x + s * c.x, f.y = g.y + s * c.y, f.z = g.z + s * c.z, c = new n.Euler(f.x - v.x, f.y - v.y, f.z - v.z, h.warp.eOrder), c.y = c.y % (2 * Math.PI), c.y = c.y > Math.PI ? c.y -= 2 * Math.PI : c.y < -Math.PI ? c.y += 2 * Math.PI : c.y;
                    var d = n.Math.degToRad(h.warp.maxTurnPerSec) * o / 1e3;
                    c.y = Math.sign(c.y) * Math.min(d, Math.abs(c.y)), v.x = v.x + c.x * h.warp.turnFriction, v.y = v.y + c.y * h.warp.turnFriction, v.z = v.z + c.z * h.warp.turnFriction;
                    var b = t.clone().sub(y).normalize();
                    if (A < h.warp.maxAimRotation && l > 0) {
                        var _ = 1 - l;
                        b.x = b.x * _ + l * E.x, b.y = b.y * _ + l * E.y, b.z = b.z * _ + l * E.z, b.normalize()
                    }
                    this.bunnyObj.position.copy(r.position).add(b), m.set(0, 0, -1).applyEuler(v).normalize(), m.multiplyScalar(8), m.add(r.position), e > 1 - i && h.warp.matchCam || (r.controls.lookAt(m), r.controls.lookVector.copy(m), r.lookAt(m))
                }.bind(this), B = function (e, t) {
                    if (!this.warpPathPoints)return r.position.copy(this.wPano.position), !0;
                    if (w)return !0;
                    var i = this.interpAlongPath(this.warpPathPoints, this.warpPathLengths, e);
                    r.position.copy(i), y = this.interpAlongPath(this.warpPathPoints, this.warpPathLengths, .99 * e)
                }.bind(this), R = function (e, t) {
                    return w || !this.warpPathPoints ? (d.blur(0), !0) : void d.blur(e, t)
                }.bind(this), I = l.allUniforms(this.player.model.chunks, "modelAlpha", 1), F = function (e, t) {
                    return w || !this.warpPathPoints ? (I(0), !0) : void I(e, t)
                }.bind(this);
                c.start(P, b, null, 0, null, "_haltWatcher"), h.warp.blur > 0 && (d.blurStrength = h.warp.blur, c.start(R, b, null, _, T, "blurring")), c.start(F, b, null, _, T, "modelAlpha"), c.start(B, b, null, _, u[h.warp.blendEasing], "followPath"), L(0), c.start(L, b, null, _, u[h.warp.blendEasing], "goBunny"), c.start(k, b, C, 0, u[h.warp.blendEasing], "lookAtBunny")
            }, r.prototype.warpTravel_BLACK = function (e, t) {
                var i = t || 0, r = (this.player.cameras[a.PANORAMA], h.warp.teleportTime);
                this.warpCommonParameters(r, i, !1), this.player.model.chunks.forEach(function (e) {
                    e.material.uniforms.blackout.value = 1
                }), this.player.model.skybox.material.uniforms.blackout.value = 1, c.start(function (e, t) {
                    for (var i = 2 * Math.abs(.5 - e) * h.panorama.markerOpacity, r = this.player.model.panos, n = 0; n < r.length; n += 1)r.list[n].marker.material.opacity = i;
                    this.currentPanoMarker.material.uniforms.opacity.value = 0
                }.bind(this), r, null, i, u[h.warp.blendEasing], "markerOpacities"), this._warpBendAim(null, r, null, i);
                var n = function () {
                    this.wrapupWarpShadingOnly(e)
                }.bind(this);
                c.start(this.stepWarpPath.bind(this), r, n, i, u[h.warp.blendEasing], "stepMotion")
            }, r.prototype.warpCameraTravel = function (e, t) {
                var i = this.transType;
                if (this.transType = null, !e) {
                    this.player.flying = !1;
                    var r = function () {
                        this._wrapupTravel(t), t && t()
                    }.bind(this);
                    return void this.player.flyToPano(this.wPano, r)
                }
                i == s.BLACK ? this.warpTravel_BLACK(t) : this.warpTravel_STD(t)
            }, r.prototype.warpToPano = function (e) {
                if (this.player.flying)return void p.warn("Cannot warp when already flying");
                if (this.transType || (this.transType = this.defaultWarpType), !this.lookupWarpPano())return this.transType = null, void this.warpToNonPano(e);
                if (this.player.mode !== a.PANORAMA)return this.transType = null, this.discardSlow(), void this.player.flyToNewMode(a.PANORAMA, {
                    pano: this.wPano,
                    duration: h.warp.outsideTime,
                    warpDest: this.warpDestination,
                    callback: e,
                    force: !0
                });
                if (this.hasBeenIndoors = !0, !this.wPano)return p.warn("no warp destination, callback dropped"), void(this.transType = null);
                var t = !(this.player.model.panos.isNeighbour(this.player.currentPano, this.wPano) && this.wPano !== this.player.currentPano && this.wPano.position.distanceTo(this.player.currentPano.position) < h.warp.nearPanoDist), i = this.chooseWarpPath(t);
                return i && !this.wPano.isLoaded("low") ? (this.player.model.waitForPanoLoad(this.wPano, "low"), void this.wPano.loadCube("low", function () {
                    this.warpToPano(e)
                }.bind(this))) : (this.player.currentPano || (p.warn("Arrived at a very strange spot!"), this.player.currentPano = this.wPano, this.placeCpm(), this.fadeOutCpm(h.path.fadeOutTime), this.player.spider.draw()), this.player.flying = !0, p.debug("Warping to pano ", this.wPano.position), this.player.emit("pano.chosen", this.wPano, this.player.currentPano), this.player.model.setProjectedPanos(this.player.currentPano, this.wPano), void(i ? this.warpCameraTravel(t, e) : this.warpCameraAim(e)))
            }, t.exports = r
        }).call(this, "/js/objects/ShowPath.js")
    }, {
        "../effects": 10,
        "../enum/Viewmode": 12,
        "../enum/WarpStyle": 13,
        "../gui/gui": 17,
        "../settings": 68,
        "../shaders": 69,
        "../util/easing": 76,
        "../util/lerp": 77,
        "../util/logger": 78,
        "../util/math": 79,
        "../util/transitions": 81,
        three: 138
    }],
    65: [function (e, t, i) {
        "use strict";
        function r() {
            var e = new n.SphereGeometry(250, 20, 5), t = e.parameters, i = (new n.BufferGeometry).fromGeometry(e), r = new n.ShaderMaterial({
                fragmentShader: o.skysphere.fragmentShader,
                vertexShader: o.skysphere.vertexShader,
                uniforms: n.UniformsUtils.clone(o.skysphere.uniforms),
                side: n.BackSide
            });
            r.uniforms.radius.value = e.parameters.radius, i.parameters = t, n.Mesh.call(this, i, r)
        }

        var n = e("three"), o = e("../shaders");
        r.prototype = Object.create(n.Mesh.prototype), r.prototype.constructor = r, t.exports = r
    }, {"../shaders": 69, three: 138}],
    66: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t, i, r, o) {
                this.model = e, this.currentPano = null, this.scene = r, this.renderer = o, this.domElement = i, this.paused = !1, this.flying = !1, this.camera = t, this.target = new n.Vector3, this.mouse = new n.Vector3(0, 0, .5), this.mouseAtMouseDown = new n.Vector2, this.mouseCouldBeClickToMove = !1, this.mouseLastMoveTime = Date.now(), this.mouseDown = !1, this.reticule = new a(this), this.panoMarkers = [], this.path = new c(this), this.spider = new d(this), this.cameras = {
                    panorama: new _(this),
                    dollhouse: new x(this),
                    floorplan: new S(this)
                };
                var u = new s(this, this.cameras.panorama, i, r);
                u.enabled = !1;
                var p = new h(this, this.cameras.dollhouse, i, r);
                p.enabled = !1;
                var m = new l(this, this.cameras.floorplan, i, r);
                m.enabled = !1, this.control = p, this.controls = {}, this.controls[f.PANORAMA] = u, this.controls[f.DOLLHOUSE] = p, this.controls[f.FLOORPLAN] = m, this.quaternion = new n.Quaternion, this.position = new n.Vector3(15, 10, 15), this.raycaster = new n.Raycaster, this.intersect = null, this.bindEvents(), u.bindEvents(), p.bindEvents(), m.bindEvents();
                var g = f.DOLLHOUSE;
                Object.defineProperty(this, "mode", {
                    get: function () {
                        return g
                    }, set: function (e) {
                        this.controls[g] && (this.controls[g].reset(), this.controls[g].enabled = !1), this.controls[e] && (this.controls[e].enabled = !0), this.control = this.controls[e], this.emit("mode.changed", g, e), g = e
                    }.bind(this)
                })
            }

            var n = e("three"), o = e("./util/logger"), a = e("./objects/Reticule"), s = e("./controls/PanoramaControls"), h = e("./controls/DollhouseControls"), l = e("./controls/FloorplanControls"), u = e("./objects/Panorama"), c = e("./objects/ShowPath"), d = e("./objects/NSpider"), f = e("./enum/Viewmode"), p = e("./settings"), m = e("./util/common"), g = e("./util/math"), v = e("./util/lerp"), y = e("./util/easing"), b = e("./util/transitions"), w = e("events").EventEmitter, _ = e("./cameras/PanoramaCamera"), x = e("./cameras/DollhouseCamera"), S = e("./cameras/FloorplanCamera"), E = (e("./shaders"), new o(i));
            r.prototype = Object.create(w.prototype), r.prototype.bindEvents = function () {
                function e(e, t) {
                    this.mouse.x = e / window.innerWidth * 2 - 1, this.mouse.y = 2 * -(t / window.innerHeight) + 1, this.mouseAtMouseDown.x = e / window.innerWidth * 2 - 1, this.mouseAtMouseDown.y = 2 * -(t / window.innerHeight) + 1, this.mouseCouldBeClickToMove = !0, this.mouseDown = !0
                }

                function t(e, t, i) {
                    this.mouse.x = e / window.innerWidth * 2 - 1, this.mouse.y = 2 * -(t / window.innerHeight) + 1, this.mouseAtMouseDown.distanceTo(this.mouse) > .02 && (this.mouseCouldBeClickToMove = !1), this.mouseLastMoveTime = Date.now(), this.reticule.move(e, t, i)
                }

                function i(e, t, i) {
                    if (this.mouseDown = !1, this.controls[f.PANORAMA].emit("interaction.direct"), this.mouseCouldBeClickToMove) {
                        if (this.intersect)return this.flyToPanoClosestToMouse();
                        if (this.mode === f.PANORAMA) {
                            var r = this.closestPanoInDirection(this.getMouseDirection());
                            return r ? this.flyToPano(r) : this.bump(this.getMouseDirection())
                        }
                    }
                }

                this.domElement.addEventListener("mousedown", function (t) {
                    0 === t.button && e.call(this, t.clientX, t.clientY)
                }.bind(this)), this.domElement.addEventListener("touchstart", function (t) {
                    if (!this.mouseDown) {
                        var i = m.average(t.changedTouches, "clientX"), r = m.average(t.changedTouches, "clientY");
                        e.call(this, i, r)
                    }
                }.bind(this)), this.domElement.addEventListener("pointerdown", function (t) {
                    this.mouseDown || e.call(this, t.clientX, t.clientY)
                }.bind(this)), this.domElement.addEventListener("mousemove", function (e) {
                    t.call(this, e.clientX, e.clientY, !1)
                }.bind(this), !1), this.domElement.addEventListener("touchmove", function (e) {
                    var i = m.average(e.changedTouches, "clientX"), r = m.average(e.changedTouches, "clientY");
                    t.call(this, i, r, !0)
                }.bind(this), !1), this.domElement.addEventListener("pointermove", function (e) {
                    t.call(this, e.clientX, e.clientY, !0)
                }.bind(this)), this.domElement.addEventListener("mouseover", function (e) {
                    !this.mouseDown || 0 !== e.which && 0 !== e.buttons || (this.mouseDown = !1)
                }.bind(this)), this.domElement.addEventListener("mouseup", function (e) {
                    i.call(this, e.clientX, e.clientY, !1)
                }.bind(this)), this.domElement.addEventListener("touchend", function (e) {
                    this.updateIntersect();
                    var t = m.average(e.changedTouches, "clientX"), r = m.average(e.changedTouches, "clientY");
                    i.call(this, t, r, !0)
                }.bind(this)), this.domElement.addEventListener("pointerup", function (e) {
                    this.updateIntersect(), i.call(this, e.clientX, e.clientY, !0)
                }.bind(this)), this.domElement.addEventListener("pointerout", function (e) {
                    this.mouseDown = !1
                }.bind(this)), this.domElement.addEventListener("pointercancel", function (e) {
                    this.mouseDown = !1
                }.bind(this)), this.on("mode.changed", function (e, t) {
                    var i = t === f.PANORAMA ? n.DoubleSide : n.FrontSide;
                    this.model.setSide(i), this.model.setMode(t)
                }.bind(this)), this.on("mode.changing", function (e, t) {
                    var i = p[t].markerOpacity;
                    this.model.panos.forEach(function (e) {
                        b.start(v.property(e.marker.material, "opacity", i), p.markerOpacityTransitionTime, null, 0, null, "panoOpac")
                    }), this.model.setMode(t)
                }.bind(this))
            }, r.prototype.start = function (e) {
                var t = e.mode, i = e.pano, r = e.position, n = e.quaternion;
                if (this.model.outsideAllowed()) {
                    var o = this.controls[f.DOLLHOUSE];
                    o.maxDistance = o.calculateMaxDistance(this.model), t === f.PANORAMA ? this.insideModeWithFlyIn(i, r, n) : t === f.FLOORPLAN ? (this.floorplanMode(), this.path.unseenHero = !1) : t === f.DOLLHOUSE ? (this.dollhouseMode(r, n), this.path.unseenHero = !1) : (i = this.model.panos.findClosest(r), this.insideModeWithFlyIn(i, r, n))
                } else {
                    E.info("map modes are deactivated, starting inside");
                    var a = this.findPanoramicHero();
                    a ? (E.info("starting at 1st highlight"), i = this.model.panos.dict[a.scan_id], r = a.position, n = a.quaternion) : (i = i || this.model.panos.list[0], E.info("starting at nearest pano " + i.id)), this.startInside(i, r, n), this.path.unseenHero = !1
                }
                this.panoMarkers = this.model.panos.list.reduce(function (e, t) {
                    return e.concat(t.marker)
                }, [])
            }, r.prototype.findPanoramicHero = function () {
                var e = this.model.heroLocations;
                if (!e)return null;
                for (var t = 0; t < e.length; t += 1)if (e[t].camera_mode === f.PANORAMA)return e[t];
                return null
            }, r.prototype.startInside = function (e, t, i) {
                t = t || e.position, i = i || e.quaternion;
                var r = p[f.PANORAMA], o = p.panorama.transitionTime, a = new n.Vector3(0, 0, -1).applyQuaternion(i), s = a.clone().add(e.position);
                return e && !e.isLoaded("low") ? (this.model.waitForPanoLoad(e, "low"), void e.loadCube("low", function () {
                    this.startInside(e, t, i)
                }.bind(this))) : (this.mode = f.PANORAMA, this.control.object.set(e), this.control.object.position.copy(t), this.control.object.quaternion.copy(i), this.control.lookAt(s), this.path.hasBeenIndoors = !0, this.update(0), p.modelAlpha = 0, this.model.changeModelAlpha(0), this.model.skybox.material.uniforms.opacity.value = 0, e.floor.enter(f.PANORAMA), b.start(v.uniform(this.model.skybox, "opacity", r.skyboxOpacity), o * r.skyboxOpacityLength, null, r.skyboxOpacityDelay, null, "skyReOpac"), this.model.panos.forEach(function (e) {
                    b.start(v.property(e.marker.material, "opacity", r.markerOpacity), p.markerOpacityTransitionTime, null, 0, null, "panoReOpac")
                }), b.start(v.property(this.reticule.material, "opacity", 0), o, null, 0, null, "retReOpac"), b.start(function () {
                }, o, function () {
                    this.mode = f.PANORAMA
                }.bind(this), 0, null, "waitModeFlip"), void(this.mode = f.TRANSITIONING))
            }, r.prototype.pause = function () {
                this.paused = !0
            }, r.prototype.play = function () {
                this.paused = !1
            }, r.prototype.updateAspect = function (e) {
                var t = this.controls[f.FLOORPLAN].object;
                t.top = t.right / e, t.bottom = t.left / e;
                for (var i in this.controls)this.controls[i].object.aspect = e, this.controls[i].object.updateProjectionMatrix();
                if (this.control) {
                    var r = this.control.object;
                    this.camera.projectionMatrix.copy(r.projectionMatrix)
                }
            }, r.prototype.update = function (e) {
                var t = this.control;
                t && (t.update(e), this.quaternion.copy(t.object.quaternion), this.position.copy(t.object.position), this.target.copy(t.target), t.object.updateProjectionMatrix(), this.camera.projectionMatrix.copy(t.object.projectionMatrix)), this.camera.position.copy(this.position), this.camera.quaternion.copy(this.quaternion), this.mouseDown || this.updateIntersect(), this.reticule.update(), this.path.update(), this.spider.update()
            }, r.prototype.updateIntersect = function () {
                this.intersect = this.getMouseIntersect(), this.intersect && this.updateClosestPano(this.intersect), this.closestPano || this.closestPanoInDirection(this.getMouseDirection()) ? (this.reticule.updatePosition(this.position, this.intersect), p.navigation.panoScores && !p.navigation.mouseDirection && this.closestPanoInDirection(this.getDirection(new n.Vector3(0, 0, -1)))) : this.reticule.hide()
            }, r.prototype.getMouseDirection = function (e) {
                e = e || this.mouse;
                var t = new n.Vector3(e.x, e.y, -1).unproject(this.camera), i = new n.Vector3(e.x, e.y, 1).unproject(this.camera);
                return i.sub(t).normalize()
            }, r.prototype.getMouseIntersect = function (e, t) {
                e = e || this.mouse.clone(), t = t || this.model.floorList.reduce(function (e, t) {
                        return t.hidden ? e : e.concat(t.collider.children)
                    }, this.mode === f.PANORAMA ? this.panoMarkers : []);
                var i = new n.Vector3(e.x, e.y, -1).unproject(this.camera);
                this.raycaster.set(i, this.getMouseDirection(e));
                var r = this.raycaster.intersectObjects(t);
                if (0 === r.length)return null;
                var o = r[0];
                if (o.face) {
                    o.normal = o.face.normal.applyQuaternion(o.object.quaternion);
                    var a = this.position.clone().sub(o.point);
                    a.dot(o.normal) < 0 && o.normal.negate(), this.currentPano ? o.onFloor = o.point.y < this.position.y - .5 * this.currentPano.height : o.onFloor = o.point.y < this.position.y - .5, o.horizontal = o.normal.y > .8
                }
                return o
            }, r.prototype.updateClosestPano = function (e) {
                var t = [];
                this.mode === f.PANORAMA ? (t.push(u.filters.not(this.currentPano)), t.push(u.filters.inFloorDirection(this.currentPano.floorPosition, this.getDirection(), .25)), t.push(u.filters.isNeighbourPanoTo(this.currentPano)), t.push(u.filters.isCloseEnoughTo(e.point, p.panoFloorClickRadius)), t.push(u.filters.isNotBehindNormal(e.point, e.normal))) : (t.push(u.filters.inDirection(this.position, this.getDirection(), .25)), t.push(u.filters.isOnVisibleFloor()));
                var i = this.model.panos.find(t, [u.sortFunctions.floorDistanceToPoint(e.point)]);
                i != this.closestPano && (this.mode !== f.TRANSITIONING && (this.closestPano && this.closestPano.hoverOff(this.mode), i && i.hoverOn(this.mode)), this.closestPano = i)
            }, r.prototype.dollhouseMode = function (e, t) {
                this.emit("mode.changing", this.mode, f.DOLLHOUSE), this.mode = f.DOLLHOUSE, this.controls[f.DOLLHOUSE].reset();
                var i = new n.Vector3(this.model.center.x, 0, this.model.center.z), r = new n.Vector3(15, 10, 15);
                if (e && t) {
                    var o = new n.Vector3(0, 0, -1).applyQuaternion(t);
                    this.raycaster.set(e.clone(), o.clone());
                    var a = this.raycaster.intersectObjects([this.scene.plane]);
                    a.length ? (i.copy(a[0].point), r.copy(e)) : E.warn("Tried to initiate dollhouse mode that did not intersect plane", e, t)
                }
                this.controls[f.DOLLHOUSE].target.copy(i), this.cameras[f.DOLLHOUSE].position.copy(r), p.modelAlpha = 1, this.model.skybox.material.uniforms.opacity.value = 0, this.model.changeModelAlpha(1)
            }, r.prototype.insideMode = function (e, t) {
                var i = t || null;
                if (this.mode !== f.PANORAMA && this.mode !== f.TRANSITIONING) {
                    var r = this.model.currentFloor ? [u.filters.atFloor(this.model.currentFloor)] : [];
                    e = e || this.currentPano || this.model.panos.find(r, [u.sortFunctions.distanceToPoint(this.control.target)]), this.flyToNewMode(f.PANORAMA, {
                        pano: e,
                        callback: i
                    })
                }
            }, r.prototype.insideModeWithFlyIn = function (e, t, i) {
                if (this.dollhouseMode(), this.update(0), e) {
                    t || (t = e.position);
                    var r;
                    i ? r = i : (i = this.control.object.quaternion, r = null);
                    var o = new n.Vector3(1, 0, 0).applyQuaternion(i), a = this.control.maxDistance;
                    this.fitDollhouse(e, t, i, o), setTimeout(function () {
                        this.control.maxDistance = a, this.flyToNewMode(f.PANORAMA, {pano: e, quaternion: r})
                    }.bind(this), 3e3)
                }
            }, r.prototype.fitDollhouse = function (e, t, i, r) {
                var o = new n.Vector3(0, 0, -1).applyQuaternion(i), a = o.clone().add(e.position);
                this.control.target.copy(a);
                var s = new n.Vector3(0, 1, 0), h = r.clone().applyAxisAngle(s, Math.PI / 2), l = this.model.boundingBox.max.clone(), u = this.model.boundingBox.min.clone(), c = [new n.Vector3(l.x, 0, l.z).sub(e.position), new n.Vector3(l.x, 0, u.z).sub(e.position), new n.Vector3(u.x, 0, l.z).sub(e.position), new n.Vector3(u.x, 0, u.z).sub(e.position)], d = 0, f = 0, p = 0;
                c.forEach(function (e, t, i) {
                    var n = Math.abs(e.dot(r)), o = e.dot(h);
                    n > d && (d = n, f = o), o > p && (p = o)
                });
                var m = Math.max(Math.abs(new n.Vector3(0, l.y, 0).sub(e.position).dot(s)), Math.abs(new n.Vector3(0, u.y, 0).sub(e.position).dot(s))), g = t.clone().add(h.clone().multiplyScalar(f)), v = t.clone().add(h.clone().multiplyScalar(p));
                f = d / Math.tan(this.control.object.fov / 2 * this.control.object.aspect * (Math.PI / 180)), p = m / Math.tan(this.control.object.fov / 2 * (Math.PI / 180)), f = Math.max(f, 10), p = Math.max(p, 10);
                var y = t.clone().sub(g.clone().add(o.clone().multiplyScalar(-f))).length(), b = t.clone().sub(g.clone().add(o.clone().multiplyScalar(-p))).length();
                this.control.maxDistance = this.scene.skybox.geometry.boundingSphere.radius - 1, y >= b ? this.control.object.position.set(0, 6, 0).add(g).add(o.multiplyScalar(1.1 * -f)) : this.control.object.position.set(0, 6, 0).add(v).add(o.multiplyScalar(1.1 * -p))
            }, r.prototype.floorplanMode = function () {
                this.emit("mode.changing", this.mode, f.FLOORPLAN), this.mode = f.FLOORPLAN;
                var e = this.cameras[f.FLOORPLAN], t = this.controls[f.FLOORPLAN];
                if (t.reset(), this.model.heroImage && this.model.heroImage.metadata) {
                    var i = e.position.clone().sub(t.target), r = g.convertWorkshopQuaternion(this.model.heroImage.metadata.camera_quaternion), o = g.convertWorkshopVector(this.model.heroImage.metadata.camera_position), a = this.model.heroImage.metadata.ortho_zoom, s = new n.Vector3(-1, 0, 0).applyQuaternion(r).normalize(), h = Math.atan2(s.x, s.z);
                    t.target.copy(o);
                    var l = i.length();
                    t.offset.x = l * Math.sin(h), t.offset.y = 0, t.offset.z = l * Math.cos(h), e.position.copy(t.target).add(t.offset), e.quaternion.copy(r), t.currentScale = a / 4 / (window.innerWidth / window.innerHeight), t.absoluteScale = t.currentScale, t.update()
                } else {
                    E.info("no floorplan metadata");
                    var u = new n.Vector3(this.model.center.x, 0, this.model.center.z), c = new n.Vector3(this.model.center.x, 10, this.model.center.z);
                    t.target.copy(u), e.position.copy(c)
                }
                p.modelAlpha = 1, this.model.skybox.material.uniforms.opacity.value = 0, this.model.changeModelAlpha(1), this.model.toggleStartFloors()
            }, r.prototype.flyToPano = function (e, t) {
                if (this.mode !== f.PANORAMA)return void this.flyToNewMode(f.PANORAMA, {pano: e});
                if (e !== this.currentPano) {
                    if (this.model.waitForPanoLoad(e, "high"), !e.isLoaded("low"))return void e.loadCube("low", function () {
                        this.flyToPano(e, t)
                    }.bind(this));
                    if (this.currentPano || (this.currentPano = e, this.path.placeCpm(), this.path.fadeOutCpm(p.path.fadeOutTime), this.spider.draw()), !this.flying) {
                        this.flying = !0;
                        var i = Math.min(this.currentPano.position.distanceTo(e.position), p.transition.flytimeMaxDistanceThreshold) * p.transition.flytimeDistanceMultiplier + p.transition.flyTime;
                        p.transition.flySpeed > .01 && (i = 1e3 * this.currentPano.position.distanceTo(e.position) / p.transition.flySpeed), E.debug("Flying to pano ", e.position), this.emit("pano.chosen", e, this.currentPano), this.model.setProjectedPanos(this.currentPano, e), b.start(v.uniform(this.model.skybox, "progress", 1), i, null, 0, y[p.transition.blendEasing], "skyFly"), b.start(v.allUniforms(this.model.chunks, "progress", 1), i, null, 0, y[p.transition.blendEasing], "chunkFly"), b.start(v.vector(this.cameras[f.PANORAMA].position, e.position), i, function () {
                            this.flying = !1, this.currentPano.exit(), e.enter(), this.currentPano = e, this.path.hasBeenIndoors = !0, this.path.placeCpm(), this.path.fadeOutCpm(p.path.fadeOutTime), this.spider.draw(), t && t()
                        }.bind(this), 0, y[p.transition.movementEasing], "camFly")
                    }
                }
            }, r.prototype.flyToPanoClosestToMouse = function () {
                if (Date.now() - this.mouseLastMoveTime > 50 && (this.intersect = this.getMouseIntersect(), this.intersect && this.updateClosestPano(this.intersect)), this.closestPano)return this.flyToPano(this.closestPano);
                var e = this.getMouseDirection();
                this.flyDirection(e) || this.flyToPano(this.currentPano)
            }, r.prototype.flyDirection = function (e, t, i) {
                var r = this.closestPanoInDirection(e, t, i);
                return r ? (this.flyToPano(r), !0) : (this.bump(e), !1)
            }, r.prototype.closestPanoInDirection = function (e, t, i) {
                t = void 0 !== t ? t : .75;
                var r = i ? "angle" : "direction", n = this.model.panos.findByScore([u.filters.inPanoDirection(this.position, e, t), u.filters.isNeighbourPanoTo(this.currentPano), u.filters.not(this.currentPano)], [u.scoreFunctions.distanceSquared(this.currentPano), u.scoreFunctions[r](this.position, e)]);
                return n
            }, r.prototype.bump = function (e) {
                if (this.mode === f.PANORAMA && !this.flying) {
                    var t, i, r, n = p.transition, o = (n.flytimeMaxDistanceThreshold * n.flytimeDistanceMultiplier + n.flyTime) / 8, a = this.camera.getWorldDirection().dot(e), s = Math.abs(a) > .5;
                    if (s)t = function () {
                        b.start(v.property(this.cameras[f.PANORAMA], "zoom", a > 0 ? 1.04 : .96), o, i, 0, y.easeInOutSine, "bumpZStart")
                    }.bind(this), i = function () {
                        b.start(v.property(this.cameras[f.PANORAMA], "zoom", 1), 5 * o, r, 0, y.easeInOutSine, "bumpZRelax")
                    }.bind(this); else {
                        var h = this.camera.position.clone(), l = e.clone();
                        this.raycaster.set(h, l);
                        var u = this.model.floorList.reduce(function (e, t) {
                            return e.concat(t.collider.children)
                        }, []), c = this.raycaster.intersectObjects(u), d = c.length > 0 ? c[0].distance / 25 : .04, m = h.clone().add(l.multiplyScalar(d));
                        t = function () {
                            b.start(v.vector(this.cameras[f.PANORAMA].position, m), o, i, 0, y.easeInOutSine, "bumpTStart")
                        }.bind(this), i = function () {
                            b.start(v.vector(this.cameras[f.PANORAMA].position, h), 5 * o, r, 0, y.easeInOutSine, "bumpTRelax")
                        }.bind(this)
                    }
                    r = function () {
                        this.flying = !1
                    }.bind(this), this.flying = !0, t()
                }
            }, r.prototype.changeFloor = function (e) {
                var t = this.model.nextFloor(e);
                if (t)if (this.mode === f.PANORAMA) {
                    var i = this.model.panos.findByScore([u.filters.atFloor(t)], [u.scoreFunctions.distance(this.currentPano), u.scoreFunctions.direction(this.position, new n.Vector3(0, e, 0)), u.scoreFunctions.penalizeHeightDifferenceUnder(this.position, .5)]);
                    i ? this.flyToPano(i) : E.warn("No pano found on selected floor, not moving there.")
                } else this.model.selectFloor(t)
            }, r.prototype.gotoFloor = function (e) {
                var t = e - this.model.currentFloor.floorIndex;
                t ? this.changeFloor(t) : this.model.allFloorsVisible && this.model.toggleAllFloors(!1)
            }, r.prototype.getDirection = function (e) {
                return e = e ? e.clone() : new n.Vector3(0, 0, -1), e.applyQuaternion(this.camera.quaternion)
            }, r.prototype.flyToSameMode = function (e, t, i, r) {
                var o = [];
                if (this.mode === f.TRANSITIONING)return E.warn("should not be transitioning here"), o;
                var a = i || !1;
                if (E.debug("New pose in mode " + this.mode), e && !e.isLoaded("low"))return this.model.waitForPanoLoad(e, "high"), e.loadCube("low", function () {
                    o = this.flyToSameMode(e, t, i, r)
                }.bind(this)), o;
                var s = p[this.mode], h = void 0 !== t ? t : s.transitionTime, l = new n.Vector3, u = new n.Vector3;
                if (this.mode === f.PANORAMA)E.warn("we should not be here for panorama views"), o.push(b.start(function () {
                }, h, function () {
                    this.mode = f.PANORAMA, r && r()
                }.bind(this), 0, null, "waitPanoDone")); else if (this.mode === f.DOLLHOUSE)if (a) {
                    var c = new n.Vector3(0, 1, 0);
                    this.controls[f.DOLLHOUSE].resetRanges(1, !0), this.model.warpDestFloors(i), u.copy(i.position);
                    var d = new n.Vector3(0, 0, -1).applyQuaternion(i.quaternion), m = new n.Raycaster(u.clone(), d.clone(), 0, 1 / 0), g = m.intersectObjects(this.model.colliders), w = 3;
                    g.length ? (l.copy(g[0].point), w = .75 * u.distanceTo(l)) : (l.copy(d).multiplyScalar(3).add(u), E.debug("Tried to restore dollhouse mode that did not intersect...", i.position, i.quaternion));
                    var _ = (new n.Matrix4).lookAt(u, l, c), x = (new n.Euler).setFromRotationMatrix(_, p.warp.eOrder), S = l.distanceTo(u), M = (new n.Matrix4).lookAt(this.cameras[f.DOLLHOUSE].position, this.controls[f.DOLLHOUSE].target, c), A = (new n.Euler).setFromRotationMatrix(M, p.warp.eOrder), T = this.cameras[f.DOLLHOUSE].position.distanceTo(this.controls[f.DOLLHOUSE].target);
                    this.controls[f.DOLLHOUSE].resetRanges(Math.min(T, w), !0);
                    var C = new n.Euler(x.x - A.x, x.y - A.y, x.z - A.z, p.warp.eOrder);
                    C.y = C.y > Math.PI ? C.y -= 2 * Math.PI : C.y < -Math.PI ? C.y += 2 * Math.PI : C.y, this.path.burnsDir = Math.sign(C.y);
                    var P = new n.Euler(0, 0, 0, p.warp.eOrder), L = new n.Vector3;
                    o.push(b.start(v.vector(this.controls[f.DOLLHOUSE].target, l), h, null, p.flydown.movementDelay, y[p.flydown.movementEasing])), o.push(b.start(function (e, t) {
                        P.x = A.x + e * C.x, P.y = A.y + e * C.y, P.z = A.z + e * C.z;
                        var i = T + e * (S - T);
                        L.set(0, 0, i).applyEuler(P).add(this.controls[f.DOLLHOUSE].target), this.cameras[f.DOLLHOUSE].position.copy(L).add(this.model.position)
                    }.bind(this), h, null, p.flydown.movementDelay, y[p.flydown.movementEasing])), o.push(b.start(function (e, t) {
                        this.controls[f.DOLLHOUSE].update(), this.quaternion.copy(this.cameras[f.DOLLHOUSE].quaternion), this.position.copy(this.cameras[f.DOLLHOUSE].position)
                    }.bind(this), h, null, p.flydown.movementDelay, y[p.flydown.movementEasing])), o.push(b.start(function () {
                    }, h, function () {
                        this.mode = f.DOLLHOUSE, r && r()
                    }.bind(this)))
                } else E.warn("not warping in flyToSameMode()? ignore it then"); else if (this.path.placeCpm(), this.path.fadeInCpm(p.path.fadeInTime), i) {
                    this.model.warpDestFloors(i);
                    var k = this.cameras[f.FLOORPLAN], B = this.controls[f.FLOORPLAN], R = B.target.clone(), I = i.position.clone().sub(R), F = k.position.clone().sub(B.target), D = F.length(), O = new n.Vector3(-1, 0, 0).applyQuaternion(i.quaternion).normalize(), N = Math.atan2(B.offset.x, B.offset.z), U = Math.atan2(O.x, O.z), z = B.absoluteScale, V = i.ortho_zoom / 4 / (window.innerWidth / window.innerHeight);
                    o.push(b.start(function (e, t) {
                        B.target.copy(I).multiplyScalar(e).add(R);
                        var i = N + (U - N) * e;
                        B.offset.x = D * Math.sin(i), B.offset.z = D * Math.cos(i), k.position.copy(B.target).add(B.offset), B.absoluteScale = z + e * (V - z), B.update(), this.quaternion.copy(k.quaternion), this.position.copy(k.position), this.target.copy(B.target), this.camera.projectionMatrix.copy(k.projectionMatrix)
                    }.bind(this), h, null, 0, y[p.flydown.movementEasing])), o.push(b.start(function () {
                    }, h, function () {
                        this.mode = f.FLOORPLAN, r && r()
                    }.bind(this)))
                } else E.info("flyToSameMode() funny floorplan view? skipping");
                return this.mode = f.TRANSITIONING, o
            }, r.prototype.flyToNewMode = function (e, t) {
                t = t || {};
                var i = t.pano, r = t.duration, o = t.warpDest, a = t.callback, s = t.force, h = t.quaternion, l = [];
                if (e === this.mode)return E.debug("Already in " + e + " mode"), s && (l = this.flyToSameMode(i, r, o, a)), l;
                if (this.mode === f.TRANSITIONING)return l;
                var u = o || !1;
                if (E.debug("Switching mode to " + e), i && this.model.waitForPanoLoad(i, "high"), i && !i.isLoaded("low"))return i.loadCube("low", function () {
                    l = this.flyToNewMode(e, t)
                }.bind(this)), l;
                var c = this.mode, d = this.cameras[e], t = $.extend({}, p[e], p[c + "-" + e]), m = void 0 !== r ? r : t.transitionTime;
                if (this.emit("mode.changing", c, e), d.set(i, h), e === f.PANORAMA)setTimeout(function () {
                    i.floor.enter(e)
                }, m / 2), this.path.fadeOutCpm(p.path.fadeOutTime); else if (e === f.DOLLHOUSE) {
                    if (u && (this.model.stayPut = !0), o ? (this.controls[f.DOLLHOUSE].resetRanges(1, !0), this.model.warpDestFloors(o)) : this.model.toggleAllFloors(!0), this.path.placeCpm(), this.path.fadeInCpm(p.path.fadeInTime), u) {
                        var g = new n.Vector3(this.model.center.x, 0, this.model.center.z), w = new n.Vector3(15, 10, 15), _ = new n.Vector3(0, 0, -1).applyQuaternion(o.quaternion), x = new n.Raycaster(o.position.clone(), _.clone(), 0, 1 / 0), S = x.intersectObjects([this.scene.plane]);
                        S.length ? (g.copy(S[0].point), w.copy(o.position), this.controls[f.DOLLHOUSE].resetRanges(.75 * w.distanceTo(g), !0)) : (E.warn("Tried to restore dollhouse mode that did not intersect...", o.position, o.quaternion), this.controls[f.DOLLHOUSE].resetRanges(3, !0)), this.controls[f.DOLLHOUSE].target.copy(g), d.position.copy(w).add(this.model.position), this.controls[f.DOLLHOUSE].update()
                    }
                } else {
                    if (this.path.placeCpm(), this.path.fadeInCpm(p.path.fadeInTime), o) {
                        this.model.warpDestFloors(o);
                        var M = this.cameras[f.FLOORPLAN], A = this.controls[f.FLOORPLAN], T = M.position.clone().sub(A.target), C = new n.Vector3(-1, 0, 0).applyQuaternion(o.quaternion).normalize(), P = Math.atan2(C.x, C.z);
                        A.target.copy(o.position);
                        var L = T.length();
                        A.offset.x = L * Math.sin(P), A.offset.y = 0, A.offset.z = L * Math.cos(P), M.position.copy(A.target).add(A.offset);
                        A.target.clone().sub(d.position);
                        d.quaternion.copy(o.quaternion), A.currentScale = o.ortho_zoom / 4 / (window.innerWidth / window.innerHeight), A.absoluteScale = A.currentScale, A.update()
                    } else this.model.currentFloor.enter(e);
                    this.model.stayPut = !1
                }
                return l.push(b.start(v.vector(this.position, d.position), m, null, p.flydown.movementDelay, y[p.flydown.movementEasing])), l.push(b.start(v.quaternion(this.quaternion, d.quaternion), m * t.rotationDuration, null, t.rotationDelay, y[p.flydown.rotationEasing])), l.push(b.start(v.matrix4(this.camera.projectionMatrix, d.projectionMatrix), m * t.cameraMatrixDuration, null, t.cameraMatrixDelay, t.cameraMatrixEase)), l.push(b.start(v.property(p, "modelAlpha", t.modelAlpha, this.model.changeModelAlpha.bind(this.model)), m * t.modelAlphaLength, null, t.modelAlphaDelay)), l.push(b.start(v.uniform(this.model.skybox, "opacity", t.skyboxOpacity), m * t.skyboxOpacityLength, null, t.skyboxOpacityDelay)), l.push(b.start(v.property(this.reticule.material.uniforms.opacity, "value", 0), m)), l.push(b.start(function () {
                }, m, function () {
                    c === f.PANORAMA && e !== f.PANORAMA ? this.currentPano.exit() : c !== f.PANORAMA && e === f.PANORAMA && (this.currentPano.enter(), this.path.hasBeenIndoors = !0, this.path.placeCpm(), this.path.fadeOutCpm(p.path.fadeOutTime), this.spider.draw()), c === f.DOLLHOUSE && this.controls[f.DOLLHOUSE].resetRanges(), this.mode = e, u && c !== f.PANORAMA && e === f.PANORAMA ? this.path.warpToPano(a) : a && a()
                }.bind(this))), this.mode = f.TRANSITIONING, l
            }, r.prototype.warpTo = function (e) {
                return this.path.selectWarpLocation(e) ? this.flying ? (E.warn("Invalid warpTo(" + e + ") when flying"), void this.director.actionComplete()) : (this.path.brushToWarpPano(), void this.path.warpToPano(function () {
                    this.path.discardSlow(), this.director.actionComplete("_wtpDel")
                }.bind(this))) : (E.warn("Invalid warpTo() index " + e), void this.director.actionComplete())
            }, r.prototype.aimTourCamera = function (e) {
                E.debug("player.aimTourCamera(" + e + ") calling warpTo(" + e + ")"), this.warpTo(e)
            }, r.prototype.tourInterlude = function () {
                this.path.discardSlow(), this.path.waitNextStep(function () {
                    this.director.describe().pendingHalt ? this.director.detourComplete("_intDel") : this.director.actionComplete("_intDel")
                }.bind(this))
            }, r.prototype.isInMode = function () {
                for (var e = 0; e < arguments.length; e++)if (this.mode === arguments[e])return !0;
                return !1
            }, r.prototype.serialize = function () {
                return [f.toInt(this.mode), this.currentPano ? this.currentPano.id : "", this.position.x.toFixed(4), this.position.y.toFixed(4), this.position.z.toFixed(4), this.quaternion.x.toFixed(4), this.quaternion.y.toFixed(4), this.quaternion.z.toFixed(4), this.quaternion.w.toFixed(4)].join(",")
            }, r.prototype.optionsFromString = function (e) {
                var t = e.split(",");
                try {
                    var i = {
                        mode: f.fromInt(t[0]),
                        pano: this.model.panos.get(t[1]),
                        position: new n.Vector3(parseFloat(t[2]), parseFloat(t[3]), parseFloat(t[4])),
                        quaternion: new n.Quaternion(parseFloat(t[5]), parseFloat(t[6]), parseFloat(t[7]), parseFloat(t[8]))
                    };
                    return E.debug("Overriding start with params:", i), i
                } catch (r) {
                    return E.warn('Invalid start override, ignoring: "' + e + '"', r.message), null
                }
            }, r.prototype.setSize = function (e, t) {
                this.aspect = e / t, this.cameras.dollhouse.aspect = this.aspect, this.cameras.dollhouse.updateProjectionMatrix(), this.cameras.panorama.aspect = this.aspect, this.cameras.panorama.updateProjectionMatrix(), this.cameras.floorplan.top = p.orthoBase / this.aspect, this.cameras.floorplan.bottom = -p.orthoBase / this.aspect, this.cameras.floorplan.updateProjectionMatrix()
            }, t.exports = r
        }).call(this, "/js/player.js")
    }, {
        "./cameras/DollhouseCamera": 2,
        "./cameras/FloorplanCamera": 3,
        "./cameras/PanoramaCamera": 4,
        "./controls/DollhouseControls": 5,
        "./controls/FloorplanControls": 6,
        "./controls/PanoramaControls": 8,
        "./enum/Viewmode": 12,
        "./objects/NSpider": 61,
        "./objects/Panorama": 62,
        "./objects/Reticule": 63,
        "./objects/ShowPath": 64,
        "./settings": 68,
        "./shaders": 69,
        "./util/common": 75,
        "./util/easing": 76,
        "./util/lerp": 77,
        "./util/logger": 78,
        "./util/math": 79,
        "./util/transitions": 81,
        events: 88,
        three: 138
    }],
    67: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t) {
                this.model = e, this.panos = e.panos, this.player = t, this.imagePanos = this.listImagePanos(), this.retryMinimumTime = 1e4
            }

            var n = (e("three"), e("./enum/Viewmode")), o = (e("./settings"), e("./objects/Panorama")), a = e("./util/logger"), s = new a(i);
            r.prototype.start = function () {
                this.loadNextPano(function (e) {
                    e ? this.start() : (s.debug("No suitable pano loaded, waiting a little while before looking again"), setTimeout(function () {
                        this.start()
                    }.bind(this), 1e3))
                }.bind(this))
            }, r.prototype.validLoadTarget = function (e) {
                return e && !e.isLoaded("high") && Date.now() - e.failedLoadingAt > this.retryMinimumTime
            }, r.prototype.listImagePanos = function () {
                for (var e = [], t = 0; t < this.model.images.length; t++) {
                    var i = this.model.images[t];
                    if (i.metadata && i.metadata.scan_id) {
                        var r = this.model.panos.get(i.metadata.scan_id);
                        r && !r.isLoaded("high") && e.push(r)
                    }
                }
                return e
            }, r.prototype.nextNotLoadedImage = function () {
                for (; this.imagePanos.length > 0;) {
                    var e = this.imagePanos[0];
                    if (!e.isLoaded("high"))return e;
                    this.imagePanos.shift()
                }
                return null
            }, r.prototype.loadNextPano = function (e) {
                var t, i;
                this.model.waitQueue.length > 0 ? (t = this.model.waitQueue[0].pano, s.debug("Overrode pano selection: Flying to an unloaded pano " + t.id)) : this.validLoadTarget(this.player.currentPano) ? (t = this.player.currentPano, s.debug("Overrode pano selection: Currently at an unloaded pano " + t.id)) : this.validLoadTarget(this.player.closestPano) ? (t = this.player.closestPano, s.debug("Overrode pano selection: Hovering over an unloaded pano " + t.id)) : this.validLoadTarget(this.nextNotLoadedImage()) ? (i = "high", t = this.imagePanos[0], s.debug("Overrode pano selection: Highlight image " + t.id)) : this.player.mode === n.PANORAMA && (t = this.panos.findByScore([this.validLoadTarget.bind(this), o.filters.isNeighbourPanoTo(this.player.currentPano)], [o.scoreFunctions.distance(this.player.currentPano), o.scoreFunctions.direction(this.player.position, this.player.getDirection()), o.scoreFunctions.inFieldOfView(this.player.position, this.player.getDirection())]), t ? s.debug("Normal pano selection: neighbor " + t.id) : (t = this.panos.findByScore([this.validLoadTarget.bind(this), o.filters.isNeighbourOfNeighbourTo(this.player.currentPano)], [o.scoreFunctions.distance(this.player.currentPano), o.scoreFunctions.direction(this.player.position, this.player.getDirection()), o.scoreFunctions.inFieldOfView(this.player.position, this.player.getDirection())]), t && (i = "high", s.debug("Normal pano selection: neighbor of neighbor " + t.id)))), t ? (i = i || t.isLoaded("low") ? "high" : "low", s.debug("Preloading " + i + "-res pano " + t.id), t.loadCube(i, function () {
                    e(t)
                }, function () {
                    s.warn("Failed preloading pano", t.id, ", marking it as failed and forgetting it for a while"), e()
                })) : e && e(null)
            }, t.exports = r
        }).call(this, "/js/preloaders.js")
    }, {"./enum/Viewmode": 12, "./objects/Panorama": 62, "./settings": 68, "./util/logger": 78, three: 138}],
    68: [function (e, t, i) {
        "use strict";
        function r() {
            var e = o.valueFromHash("auth");
            if (e)return e;
            var t = o.valueFromCookie("token");
            return t ? "Token " + t : null
        }

        var n = e("three"), o = e("./util/browser"), a = e("./enum/Viewmode"), s = e("./enum/Colors"), h = e("./enum/WarpStyle"), l = e("./util/easing"), u = {
            brand: o.valueFromHash("brand", !0),
            debug: !1,
            version: "2.0.43",
           // pageTitle: "Matterport 3D Showcase",
            pageTitle: "3D",
            authorizationHeader: r(),
            autoplay: o.valueFromHash("play", !1) || !o.inIframe(),
            autohelp: o.valueFromHash("help", null),
            logLevel: o.valueFromHash("log", 2),
            showNeighbors: !1,
            crossOrigin: "use-credentials",
            fancierTransition: !1,
            wireframe: !1,
            skyboxWireframe: !1,
            modelAlpha: 1,
            highlightPanoSelection: !1,
            showSweeps: !0,
            showSkyboxes: !1,
            showMesh: !0,
            showFloors: !1,
            stayPut: !0,
            captureErrors: !1,
            maxMobileTextures: 12,
            dollhouseFOV: 70,
            dollhouseDefault: {minDistance: 15, minPolarAngle: n.Math.degToRad(25), maxPolarAngle: n.Math.degToRad(65)},
            insideFOV: 70,
            insideLookSpeed: .12,
            insideLookLimitUp: 40,
            insideLookLimitDown: -40,
            orthoBase: 10,
            aspect: window.innerWidth / window.innerHeight,
            hideReticuleTimeout: 1e3,
            signedUrlRefreshRate: 240,
            analytics: {
                inactivityThreshold: 30,
                sessionTrackingRate: o.valueFromHash("sessionTrackingRate", .15),
                maxTrackedErrors: 20,
                sessionDurationPingFrequency: 10
            },
            flydown: {
                movementEasing: "easeInOutQuad",
                movementDelay: .001,
                rotationEasing: "easeInOutQuad",
                rotationDelay: .5,
                modelTextureDelay: .75,
                skyboxDelay: .75
            },
            transition: {
                flySpeed: .01,
                flyTime: 750,
                flytimeMaxDistanceThreshold: 5,
                flytimeDistanceMultiplier: 150,
                blur: .8,
                movementEasing: "easeInOutQuad",
                blendEasing: "easeInOutQuad"
            },
            path: {
                color: s.newBlue,
                colorUp: s._desat(s.newBlue, .5),
                colorDown: s._darken(s.newBlue, .35),
                opacity: .5,
                style: "ribbon",
                height: .025,
                ribbonWidth: .24,
                outsideHeight: .5,
                waypointRadius: .5,
                waypointIndoorRadius: .24,
                pulseMarkers: o.valueFromHash("ppm", !0),
                waypointPulse: 1e3,
                preferShort: o.valueFromHash("shortStep", !1),
                typ: h.BLACK,
                mapGuides: o.valueFromHash("guides", !0),
                alwaysShow: o.valueFromHash("paths", !1),
                fadeInTime: 400,
                fadeOutTime: 300
            },
            warp: {
                nearPanoDist: .1,
                matchCam: !1,
                blur: .33,
                fastTime: 1500,
                teleportTime: 1500,
                outsideTime: 2e3,
                lookAheadDist: 1.55,
                softPushDist: .37,
                softPushEnd: .3,
                softBendAngle: 8,
                softBendTilt: 4,
                softBendEnd: .3,
                doBurns: o.valueFromHash("kb", !0),
                burnsAngle: o.valueFromHash("bdeg", 15),
                burnsDollAngle: o.valueFromHash("bhdeg", 15),
                maxTurnPerSec: 500,
                minRotation: 12,
                maxAimRotation: 33.2,
                turnFriction: .2,
                flySpeed: .01,
                minWarpTime: 1200,
                moveDelay: 1e3,
                tourStepDelay: 6e3,
                timePerMeter: 800,
                movementEasing: "easeInOutQuad",
                blendEasing: "easeInOutQuad",
                showBunny: !1,
                loop: o.valueFromHash("lp", !1),
                eOrder: "YXZ"
            },
            rotationFriction: .09,
            rotationAccelerationInside: 4.5,
            rotationAccelerationOutside: 2.5,
            rotationAfterMoveMultiplier: 30,
            rotationAfterMoveHistoryCount: 5,
            panFriction: .09,
            panAccelerationOutside: 1,
            startMode: o.valueFromHash("startMode", a.DOLLHOUSE),
            onload: o.valueFromHash("onload", a.PANORAMA),
            zoomNearLimit: .1,
            zoomFarLimit: 10,
            navigation: {
                panoScores: !1,
                mouseDirection: !0,
                filterStrictness: .75,
                angleFactor: -30,
                directionFactor: 10,
                distanceFactor: -1
            },
            secretPanelWord: [38, 38, 40, 40, 37, 39, 37, 39, 66, 65],
            console: o.valueFromHash("console", !1),
            noMeshFloorPositionOffset: new n.Vector3(0, -1.2, 0),
            panoramaNeighbourMaxDistance: 5,
            panoFloorClickRadius: .35,
            showScreenshotLocations: !1,
            showAxis: !1,
            showNeighbourRaycasts: !1,
            colorMarkerOnLoad: !1,
            colorMarkerByFloor: !1
        };
        u = $.extend(u, {
            reticuleOpacityTransitionTime: 250,
            reticuleColor: s.newBlue,
            markerOpacityTransitionTime: 500,
            panorama: {
                transitionTime: 1e3,
                modelAlpha: 0,
                modelAlphaDelay: u.flydown.modelTextureDelay,
                modelAlphaLength: 1,
                skyboxOpacity: 1,
                skyboxOpacityDelay: u.flydown.skyboxDelay,
                skyboxOpacityLength: .9,
                fovLength: 1,
                fovDelay: 0,
                cameraMatrixDuration: .8,
                cameraMatrixDelay: 0,
                cameraMatrixEase: l.easeInCubic,
                reticuleOpacity: 1,
                markerOpacity: .3,
                markerOpacityOnHover: 1
            },
            dollhouse: {
                transitionTime: 1e3,
                modelAlpha: 1,
                modelAlphaDelay: 0,
                modelAlphaLength: 1 - u.flydown.modelTextureDelay,
                skyboxOpacity: 0,
                skyboxOpacityDelay: 0,
                skyboxOpacityLength: 1 - u.flydown.skyboxDelay,
                fovLength: 1,
                fovDelay: 0,
                cameraMatrixDuration: .8,
                cameraMatrixDelay: .3,
                cameraMatrixEase: l.easeInCubic,
                reticuleOpacity: 1,
                markerOpacity: 0,
                markerOpacityOnHover: 0
            },
            floorplan: {
                transitionTime: 1e3,
                modelAlpha: 1,
                modelAlphaDelay: 0,
                modelAlphaLength: 1 - u.flydown.modelTextureDelay,
                skyboxOpacity: 0,
                skyboxOpacityDelay: 0,
                skyboxOpacityLength: 1 - u.flydown.skyboxDelay,
                fovLength: 1,
                fovDelay: 0,
                cameraMatrixDuration: .5,
                cameraMatrixDelay: 0,
                cameraMatrixEase: l.easeOutCubic,
                reticuleOpacity: 1,
                markerOpacity: 0,
                markerOpacityOnHover: 0
            },
            transitioning: {reticuleOpacity: 0},
            "floorplan-dollhouse": {rotationDelay: 0, rotationDuration: 1},
            "floorplan-panorama": {rotationDelay: .5, rotationDuration: 1},
            "dollhouse-panorama": {rotationDelay: .5, rotationDuration: 1},
            "dollhouse-floorplan": {
                rotationDelay: 0,
                rotationDuration: 1,
                cameraMatrixDuration: 1.05,
                cameraMatrixDelay: .5
            },
            "panorama-dollhouse": {rotationDelay: 0, rotationDuration: .5},
            "panorama-floorplan": {transitionTime: 1500, rotationDelay: 0, rotationDuration: .5}
        }), t.exports = u
    }, {
        "./enum/Colors": 11,
        "./enum/Viewmode": 12,
        "./enum/WarpStyle": 13,
        "./util/browser": 74,
        "./util/easing": 76,
        three: 138
    }],
    69: [function (e, t, i) {
        (function (i) {
            "use strict";
            var r = e("three"), n = e("./settings");
            t.exports = {
                cube: {
                    uniforms: {tCube: {type: "t", value: null}, opacity: {type: "f", value: 1}},
                    vertexShader: i("dmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uOwoKdm9pZCBtYWluKCkgewogIHZXb3JsZFBvc2l0aW9uID0gcG9zaXRpb247CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwp9Cg==", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyQ3ViZSB0Q3ViZTsKdW5pZm9ybSBmbG9hdCBvcGFjaXR5OwoKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uOwoKdm9pZCBtYWluKCkgewogIHZlYzQgdENvbG9yID0gdGV4dHVyZUN1YmUoIHRDdWJlLCB2ZWMzKCAtdldvcmxkUG9zaXRpb24ueCwgdldvcmxkUG9zaXRpb24ueXogKSApOwogIGdsX0ZyYWdDb2xvciA9IHZlYzQodENvbG9yLnJnYiwgb3BhY2l0eSk7Cn0K", "base64")
                },
                model: {
                    uniforms: {
                        map: {type: "t", value: null},
                        modelAlpha: {type: "f", value: n.modelAlpha},
                        opacity: {type: "f", value: 1},
                        progress: {type: "f", value: 0},
                        stasis: {type: "i", value: 0},
                        blackout: {type: "i", value: 0},
                        pano0Map: {type: "t", value: null},
                        pano0Position: {type: "v3", value: new r.Vector3},
                        pano0Matrix: {type: "m4", value: new r.Matrix4},
                        pano1Map: {type: "t", value: null},
                        pano1Position: {type: "v3", value: new r.Vector3},
                        pano1Matrix: {type: "m4", value: new r.Matrix4}
                    },
                    vertexShader: i("dW5pZm9ybSB2ZWMzIHBhbm8wUG9zaXRpb247CnVuaWZvcm0gbWF0NCBwYW5vME1hdHJpeDsKCnVuaWZvcm0gdmVjMyBwYW5vMVBvc2l0aW9uOwp1bmlmb3JtIG1hdDQgcGFubzFNYXRyaXg7Cgp2YXJ5aW5nIHZlYzIgdlV2Owp2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb24wOwp2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb24xOwoKdm9pZCBtYWluKCkgewoKICB2VXYgPSB1djsKICB2ZWM0IHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7CgogIHZlYzMgcG9zaXRpb25Mb2NhbFRvUGFub0NlbnRlcjAgPSB3b3JsZFBvc2l0aW9uLnh5eiAtIHBhbm8wUG9zaXRpb247CiAgdldvcmxkUG9zaXRpb24wID0gKHZlYzQocG9zaXRpb25Mb2NhbFRvUGFub0NlbnRlcjAsIDEuMCkgKiBwYW5vME1hdHJpeCkueHl6OwogIHZXb3JsZFBvc2l0aW9uMC54ICo9IC0xLjA7CgogIHZlYzMgcG9zaXRpb25Mb2NhbFRvUGFub0NlbnRlcjEgPSB3b3JsZFBvc2l0aW9uLnh5eiAtIHBhbm8xUG9zaXRpb247CiAgdldvcmxkUG9zaXRpb24xID0gKHZlYzQocG9zaXRpb25Mb2NhbFRvUGFub0NlbnRlcjEsIDEuMCkgKiBwYW5vMU1hdHJpeCkueHl6OwogIHZXb3JsZFBvc2l0aW9uMS54ICo9IC0xLjA7CgogIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTsKCn0K", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyMkQgbWFwOwp1bmlmb3JtIGZsb2F0IG1vZGVsQWxwaGE7CnVuaWZvcm0gZmxvYXQgb3BhY2l0eTsKdW5pZm9ybSBmbG9hdCBwcm9ncmVzczsKdW5pZm9ybSBpbnQgc3Rhc2lzOwp1bmlmb3JtIGludCBibGFja291dDsKCnVuaWZvcm0gdmVjMyBwYW5vMFBvc2l0aW9uOwp1bmlmb3JtIHNhbXBsZXJDdWJlIHBhbm8wTWFwOwoKdW5pZm9ybSB2ZWMzIHBhbm8xUG9zaXRpb247CnVuaWZvcm0gc2FtcGxlckN1YmUgcGFubzFNYXA7Cgp2YXJ5aW5nIHZlYzIgdlV2Owp2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb24wOwp2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb24xOwoKdm9pZCBtYWluKCkgewoJdmVjMyBjcDAgPSB2V29ybGRQb3NpdGlvbjAueHl6OwoJdmVjMyBjcDEgPSB2V29ybGRQb3NpdGlvbjEueHl6OwoJaWYgKHN0YXNpcyE9MCkgewoJCWNwMCA9IG1peChjcDAsY3AxLHByb2dyZXNzKTsKCQljcDEgPSBjcDA7Cgl9Cgl2ZWM0IGNvbG9yRnJvbVBhbm8wID0gdGV4dHVyZUN1YmUoIHBhbm8wTWFwLCBjcDApOwoJdmVjNCBjb2xvckZyb21QYW5vMSA9IHRleHR1cmVDdWJlKCBwYW5vMU1hcCwgY3AxKTsKCgljb25zdCB2ZWM0IEJMQUNLID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAxLjApOwoJdmVjNCBjb2xvckZyb21QYW5vczsKCWlmIChibGFja291dCE9MCkgewoJCWNvbG9yRnJvbVBhbm9zID0gbWl4KGNvbG9yRnJvbVBhbm8wLCBCTEFDSywgbWluKDEuMCxwcm9ncmVzcyoyLjApKTsKCQljb2xvckZyb21QYW5vcyA9IG1peChjb2xvckZyb21QYW5vcywgY29sb3JGcm9tUGFubzEsIG1heCgwLjAscHJvZ3Jlc3MqMi4wLTEuMCkpOwoJfSBlbHNlIHsKCQljb2xvckZyb21QYW5vcyA9IG1peChjb2xvckZyb21QYW5vMCwgY29sb3JGcm9tUGFubzEsIHByb2dyZXNzKTsKCX0KCgl2ZWM0IGNvbG9yRnJvbVRleHR1cmUgPSB0ZXh0dXJlMkQoIG1hcCwgdlV2ICk7Cgljb2xvckZyb21QYW5vcyA9IG1peChjb2xvckZyb21QYW5vcywgY29sb3JGcm9tVGV4dHVyZSwgbW9kZWxBbHBoYSk7CgoJZmxvYXQgd2hpdGVuZXNzID0gMS4wIC0gc21vb3Roc3RlcCgwLjEsIDAuMiwgb3BhY2l0eSk7Cgljb2xvckZyb21QYW5vcyA9IG1peChjb2xvckZyb21QYW5vcywgdmVjNCgwLjUsIDAuNSwgMC41LCAxLjApLCB3aGl0ZW5lc3MpOwoJZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvckZyb21QYW5vcy5yZ2IsIG9wYWNpdHkpOwp9Cg==", "base64")
                },
                modelDollhouse: {
                    uniforms: {map: {type: "t", value: null}, opacity: {type: "f", value: 1}},
                    vertexShader: i("dmFyeWluZyB2ZWMyIHZVdjsKCnZvaWQgbWFpbigpIHsKCiAgdlV2ID0gdXY7CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwoKfQo=", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyMkQgbWFwOwp1bmlmb3JtIGZsb2F0IG9wYWNpdHk7CnZhcnlpbmcgdmVjMiB2VXY7Cgp2ZWM0IHdoaXRlID0gdmVjNCgwLjUsIDAuNSwgMC41LCAxLjApOwoKdm9pZCBtYWluKCkgewoKICB2ZWM0IGNvbG9yRnJvbVRleHR1cmUgPSB0ZXh0dXJlMkQoIG1hcCwgdlV2ICk7CiAgZmxvYXQgd2hpdGVuZXNzID0gMS4wIC0gc21vb3Roc3RlcCgwLjEsIDAuMiwgb3BhY2l0eSk7CiAgY29sb3JGcm9tVGV4dHVyZSA9IG1peChjb2xvckZyb21UZXh0dXJlLCB3aGl0ZSwgd2hpdGVuZXNzKTsKICBnbF9GcmFnQ29sb3IgPSB2ZWM0KGNvbG9yRnJvbVRleHR1cmUucmdiLCBvcGFjaXR5KTsKCn0K", "base64")
                },
                ribbon: {
                    uniforms: {
                        map: {type: "t", value: null},
                        opacity: {type: "f", value: 1},
                        color: {type: "c", value: new r.Color(16711680)}
                    },
                    vertexShader: i("dmFyeWluZyB2ZWMyIHZVdjsKCnZvaWQgbWFpbigpIHsKCiAgdlV2ID0gdXY7CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwoKfQo=", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyMkQgbWFwOwp1bmlmb3JtIGZsb2F0IG9wYWNpdHk7CnZhcnlpbmcgdmVjMiB2VXY7CnVuaWZvcm0gdmVjMyBjb2xvcjsKCnZvaWQgbWFpbigpIHsKCS8vIFRPRE8gYWRkIHNjcm9sbC1pbiBhbmQgcHVsc2luZyBiZWhhdmlvcnMKICB2ZWM0IGNvbG9yRnJvbVRleHR1cmUgPSB0ZXh0dXJlMkQoIG1hcCwgdlV2ICk7CiAgZ2xfRnJhZ0NvbG9yID0gdmVjNCgoY29sb3IucmdiKmNvbG9yRnJvbVRleHR1cmUucmdiKSwKICAJCQkJCQkob3BhY2l0eSpjb2xvckZyb21UZXh0dXJlLmEpKTsKfQo=", "base64")
                },
                waypoint: {
                    uniforms: {
                        map: {type: "t", value: null},
                        opacity: {type: "f", value: 1},
                        pulse: {type: "f", value: 1},
                        color: {type: "c", value: new r.Color(16711680)}
                    },
                    vertexShader: i("dmFyeWluZyB2ZWMyIHZVdjsKCnZvaWQgbWFpbigpIHsKCiAgdlV2ID0gdXY7CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwoKfQo=", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyMkQgbWFwOwp1bmlmb3JtIGZsb2F0IG9wYWNpdHk7CnVuaWZvcm0gZmxvYXQgcHVsc2U7IC8vIGFub3RoZXIgb3BhY2l0eSwgd2l0aCBhIGRpZmZlcmVudCBjbG9jawp2YXJ5aW5nIHZlYzIgdlV2Owp1bmlmb3JtIHZlYzMgY29sb3I7Cgp2b2lkIG1haW4oKSB7CgkvLyBUT0RPIGFkZCBzY3JvbGwtaW4gYW5kIHB1bHNpbmcgYmVoYXZpb3JzCiAgdmVjNCBjb2xvckZyb21UZXh0dXJlID0gdGV4dHVyZTJEKCBtYXAsIHZVdiApOwkJLy8gd2Ugb25seSB1c2UgdGhlIGFscGhhIQogIGdsX0ZyYWdDb2xvciA9IHZlYzQoY29sb3IucmdiLAogIAkJCQkJCShwdWxzZSpvcGFjaXR5KmNvbG9yRnJvbVRleHR1cmUuYSkpOwp9Cg==", "base64")
                },
                modelDebug: {
                    uniforms: {
                        map: {type: "t", value: null},
                        modelAlpha: {type: "f", value: n.modelAlpha},
                        depthmapRatio: {type: "f", value: 0},
                        opacity: {type: "f", value: 1},
                        progress: {type: "f", value: 0},
                        considerOcclusion: {type: "i", value: n.fancierTransition},
                        highlightPanoSelection: {type: "i", value: 0},
                        useThirdPano: {type: "i", value: n.useThirdPano},
                        pano0Map: {type: "t", value: null},
                        pano0Depth: {type: "t", value: null},
                        pano0Position: {type: "v3", value: new r.Vector3},
                        pano0Matrix: {type: "m4", value: new r.Matrix4},
                        pano0Weight: {type: "f", value: n.transition.pano0Weight},
                        pano1Map: {type: "t", value: null},
                        pano1Depth: {type: "t", value: null},
                        pano1Position: {type: "v3", value: new r.Vector3},
                        pano1Matrix: {type: "m4", value: new r.Matrix4},
                        pano1Weight: {type: "f", value: n.transition.pano1Weight},
                        pano2Map: {type: "t", value: null},
                        pano2Depth: {type: "t", value: null},
                        pano2Position: {type: "v3", value: new r.Vector3},
                        pano2Matrix: {type: "m4", value: new r.Matrix4},
                        pano2Weight: {type: "f", value: n.transition.pano2Weight}
                    },
                    vertexShader: i("dW5pZm9ybSB2ZWMzIHBhbm8wUG9zaXRpb247CnVuaWZvcm0gbWF0NCBwYW5vME1hdHJpeDsKCnVuaWZvcm0gdmVjMyBwYW5vMVBvc2l0aW9uOwp1bmlmb3JtIG1hdDQgcGFubzFNYXRyaXg7Cgp1bmlmb3JtIHZlYzMgcGFubzJQb3NpdGlvbjsKdW5pZm9ybSBtYXQ0IHBhbm8yTWF0cml4OwoKdmFyeWluZyB2ZWMyIHZVdjsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMDsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMTsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMjsKCnZhcnlpbmcgdmVjNCB3b3JsZFBvc2l0aW9uOwoKdm9pZCBtYWluKCkgewoKICB2VXYgPSB1djsKICB3b3JsZFBvc2l0aW9uID0gbW9kZWxNYXRyaXggKiB2ZWM0KHBvc2l0aW9uLCAxLjApOwoKICB2ZWMzIHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIwID0gd29ybGRQb3NpdGlvbi54eXogLSBwYW5vMFBvc2l0aW9uOwogIHZXb3JsZFBvc2l0aW9uMCA9ICh2ZWM0KHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIwLCAxLjApICogcGFubzBNYXRyaXgpLnh5ejsKICB2V29ybGRQb3NpdGlvbjAueCAqPSAtMS4wOwoKICB2ZWMzIHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIxID0gd29ybGRQb3NpdGlvbi54eXogLSBwYW5vMVBvc2l0aW9uOwogIHZXb3JsZFBvc2l0aW9uMSA9ICh2ZWM0KHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIxLCAxLjApICogcGFubzFNYXRyaXgpLnh5ejsKICB2V29ybGRQb3NpdGlvbjEueCAqPSAtMS4wOwoKICB2ZWMzIHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIyID0gd29ybGRQb3NpdGlvbi54eXogLSBwYW5vMlBvc2l0aW9uOwogIHZXb3JsZFBvc2l0aW9uMiA9ICh2ZWM0KHBvc2l0aW9uTG9jYWxUb1Bhbm9DZW50ZXIyLCAyLjApICogcGFubzJNYXRyaXgpLnh5ejsKICB2V29ybGRQb3NpdGlvbjIueCAqPSAtMS4wOwoKICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7Cgp9Cg==", "base64"),
                    fragmentShader: i("dW5pZm9ybSBzYW1wbGVyMkQgbWFwOwp1bmlmb3JtIGZsb2F0IGRlcHRobWFwUmF0aW87CnVuaWZvcm0gZmxvYXQgbW9kZWxBbHBoYTsKdW5pZm9ybSBmbG9hdCBvcGFjaXR5Owp1bmlmb3JtIGZsb2F0IHByb2dyZXNzOwp1bmlmb3JtIGludCBjb25zaWRlck9jY2x1c2lvbjsKdW5pZm9ybSBpbnQgaGlnaGxpZ2h0UGFub1NlbGVjdGlvbjsKdW5pZm9ybSBpbnQgdXNlVGhpcmRQYW5vOwoKdW5pZm9ybSB2ZWMzIHBhbm8wUG9zaXRpb247CnVuaWZvcm0gc2FtcGxlckN1YmUgcGFubzBNYXA7CnVuaWZvcm0gc2FtcGxlckN1YmUgcGFubzBEZXB0aDsKdW5pZm9ybSBmbG9hdCBwYW5vMFdlaWdodDsKCnVuaWZvcm0gdmVjMyBwYW5vMVBvc2l0aW9uOwp1bmlmb3JtIHNhbXBsZXJDdWJlIHBhbm8xTWFwOwp1bmlmb3JtIHNhbXBsZXJDdWJlIHBhbm8xRGVwdGg7CnVuaWZvcm0gZmxvYXQgcGFubzFXZWlnaHQ7Cgp1bmlmb3JtIHZlYzMgcGFubzJQb3NpdGlvbjsKdW5pZm9ybSBzYW1wbGVyQ3ViZSBwYW5vMk1hcDsKdW5pZm9ybSBzYW1wbGVyQ3ViZSBwYW5vMkRlcHRoOwp1bmlmb3JtIGZsb2F0IHBhbm8yV2VpZ2h0OwoKdmFyeWluZyB2ZWMyIHZVdjsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMDsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMTsKdmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uMjsKCnZhcnlpbmcgdmVjNCB3b3JsZFBvc2l0aW9uOwoKdm9pZCBtYWluKCkgewoKICB2ZWM0IGRlcHRoRnJvbVBhbm8wID0gdGV4dHVyZUN1YmUoIHBhbm8wRGVwdGgsIHZXb3JsZFBvc2l0aW9uMC54eXogKTsKICB2ZWM0IGRlcHRoRnJvbVBhbm8xID0gdGV4dHVyZUN1YmUoIHBhbm8xRGVwdGgsIHZXb3JsZFBvc2l0aW9uMS54eXogKTsKICB2ZWM0IGRlcHRoRnJvbVBhbm8yID0gdGV4dHVyZUN1YmUoIHBhbm8yRGVwdGgsIHZXb3JsZFBvc2l0aW9uMi54eXogKTsKCiAgdmVjNCBjb2xvckZyb21QYW5vMCA9IHRleHR1cmVDdWJlKCBwYW5vME1hcCwgdldvcmxkUG9zaXRpb24wLnh5eiApOwogIHZlYzQgY29sb3JGcm9tUGFubzEgPSB0ZXh0dXJlQ3ViZSggcGFubzFNYXAsIHZXb3JsZFBvc2l0aW9uMS54eXogKTsKICB2ZWM0IGNvbG9yRnJvbVBhbm8yID0gdGV4dHVyZUN1YmUoIHBhbm8yTWFwLCB2V29ybGRQb3NpdGlvbjIueHl6ICk7CgogIGZsb2F0IGRpc3RhbmNlVG9QYW5vMCA9IGRpc3RhbmNlKHdvcmxkUG9zaXRpb24ueHl6LCBwYW5vMFBvc2l0aW9uKTsKICBmbG9hdCBkaXN0YW5jZVRvUGFubzEgPSBkaXN0YW5jZSh3b3JsZFBvc2l0aW9uLnh5eiwgcGFubzFQb3NpdGlvbik7CiAgZmxvYXQgZGlzdGFuY2VUb1Bhbm8yID0gZGlzdGFuY2Uod29ybGRQb3NpdGlvbi54eXosIHBhbm8yUG9zaXRpb24pOwoKICBmbG9hdCBjYW1lcmFUb1Bhbm8wID0gZGlzdGFuY2UoY2FtZXJhUG9zaXRpb24ueHl6LCBwYW5vMFBvc2l0aW9uKTsKICBmbG9hdCBjYW1lcmFUb1Bhbm8xID0gZGlzdGFuY2UoY2FtZXJhUG9zaXRpb24ueHl6LCBwYW5vMVBvc2l0aW9uKTsKICBmbG9hdCBjYW1lcmFUb1Bhbm8yID0gZGlzdGFuY2UoY2FtZXJhUG9zaXRpb24ueHl6LCBwYW5vMlBvc2l0aW9uKTsKCiAgZmxvYXQgY29udHJpYnV0aW9uRnJvbVBhbm8wID0gY2FtZXJhVG9QYW5vMCA9PSAwLjAgPyAxMDAwLjAgOiBwYW5vMFdlaWdodCAvIGNhbWVyYVRvUGFubzA7CiAgZmxvYXQgY29udHJpYnV0aW9uRnJvbVBhbm8xID0gY2FtZXJhVG9QYW5vMSA9PSAwLjAgPyAxMDAwLjAgOiBwYW5vMVdlaWdodCAvIGNhbWVyYVRvUGFubzE7CiAgZmxvYXQgY29udHJpYnV0aW9uRnJvbVBhbm8yID0gY2FtZXJhVG9QYW5vMiA9PSAwLjAgPyAxMDAwLjAgOiBwYW5vMldlaWdodCAvIGNhbWVyYVRvUGFubzI7CgogIGNvbnRyaWJ1dGlvbkZyb21QYW5vMCAqPSAxLjAgLyBkaXN0YW5jZVRvUGFubzA7CiAgY29udHJpYnV0aW9uRnJvbVBhbm8xICo9IDEuMCAvIGRpc3RhbmNlVG9QYW5vMTsKICBjb250cmlidXRpb25Gcm9tUGFubzIgKj0gMS4wIC8gZGlzdGFuY2VUb1Bhbm8yOwoKICBpZihjb25zaWRlck9jY2x1c2lvbiA9PSAxKSB7CiAgICBib29sIG9jY2x1ZGVkRnJvbVBhbm8wID0gZGlzdGFuY2VUb1Bhbm8wIC8gMTAuMCA+IDEuMDEgLSBkZXB0aEZyb21QYW5vMC54OwogICAgYm9vbCBvY2NsdWRlZEZyb21QYW5vMSA9IGRpc3RhbmNlVG9QYW5vMSAvIDEwLjAgPiAxLjAxIC0gZGVwdGhGcm9tUGFubzEueDsKICAgIGJvb2wgb2NjbHVkZWRGcm9tUGFubzIgPSBkaXN0YW5jZVRvUGFubzIgLyAxMC4wID4gMS4wMSAtIGRlcHRoRnJvbVBhbm8yLng7CgogICAgaWYob2NjbHVkZWRGcm9tUGFubzApe2NvbnRyaWJ1dGlvbkZyb21QYW5vMCAqPSAwLjE7fQogICAgaWYob2NjbHVkZWRGcm9tUGFubzEpe2NvbnRyaWJ1dGlvbkZyb21QYW5vMSAqPSAwLjE7fQogICAgaWYob2NjbHVkZWRGcm9tUGFubzIpe2NvbnRyaWJ1dGlvbkZyb21QYW5vMiAqPSAwLjE7fQogICAgLy9pZihvY2NsdWRlZEZyb21QYW5vMCAmJiBvY2NsdWRlZEZyb21QYW5vMSAmJiAhb2NjbHVkZWRGcm9tUGFubzIpIHsgY29udHJpYnV0aW9uRnJvbVBhbm8yICs9IDAuNTsgfQogIH0KCiAgZmxvYXQgY29udHJpYnV0aW9uU3VtID0gY29udHJpYnV0aW9uRnJvbVBhbm8wICsgY29udHJpYnV0aW9uRnJvbVBhbm8xICsgY29udHJpYnV0aW9uRnJvbVBhbm8yOwogIGNvbnRyaWJ1dGlvbkZyb21QYW5vMCAvPSBjb250cmlidXRpb25TdW07CiAgY29udHJpYnV0aW9uRnJvbVBhbm8xIC89IGNvbnRyaWJ1dGlvblN1bTsKICBjb250cmlidXRpb25Gcm9tUGFubzIgLz0gY29udHJpYnV0aW9uU3VtOwoKICB2ZWM0IGNvbG9yRnJvbVBhbm9zID0gY29sb3JGcm9tUGFubzAgKiBjb250cmlidXRpb25Gcm9tUGFubzA7CiAgY29sb3JGcm9tUGFub3MgKz0gY29sb3JGcm9tUGFubzEgKiBjb250cmlidXRpb25Gcm9tUGFubzE7CiAgY29sb3JGcm9tUGFub3MgKz0gY29sb3JGcm9tUGFubzIgKiBjb250cmlidXRpb25Gcm9tUGFubzI7CgogIHZlYzQgZGVwdGhGcm9tUGFub3MgPSBkZXB0aEZyb21QYW5vMCAqIGNvbnRyaWJ1dGlvbkZyb21QYW5vMDsKICBkZXB0aEZyb21QYW5vcyArPSBkZXB0aEZyb21QYW5vMSAqIGNvbnRyaWJ1dGlvbkZyb21QYW5vMTsKICBkZXB0aEZyb21QYW5vcyArPSBkZXB0aEZyb21QYW5vMiAqIGNvbnRyaWJ1dGlvbkZyb21QYW5vMjsKCiAgdmVjNCBjb2xvckZyb21UZXh0dXJlID0gdGV4dHVyZTJEKCBtYXAsIHZVdiApOwogIGNvbG9yRnJvbVBhbm9zID0gbWl4KGNvbG9yRnJvbVBhbm9zLCBjb2xvckZyb21UZXh0dXJlLCBtb2RlbEFscGhhKTsKCiAgaWYoaGlnaGxpZ2h0UGFub1NlbGVjdGlvbiA9PSAxKSB7CiAgICBjb2xvckZyb21QYW5vcy5yID0gY29udHJpYnV0aW9uRnJvbVBhbm8wOwogICAgY29sb3JGcm9tUGFub3MuZyA9IGNvbnRyaWJ1dGlvbkZyb21QYW5vMTsKICAgIGNvbG9yRnJvbVBhbm9zLmIgPSBjb250cmlidXRpb25Gcm9tUGFubzI7CiAgfQoKICBnbF9GcmFnQ29sb3IgPSB2ZWM0KG1peChjb2xvckZyb21QYW5vcywgZGVwdGhGcm9tUGFub3MsIGRlcHRobWFwUmF0aW8pLnJnYiwgb3BhY2l0eSk7Cgp9Cg==", "base64")
                },
                customDepth: {
                    uniforms: {panoPosition: {type: "v3", value: new r.Vector3}},
                    vertexShader: i("dmFyeWluZyB2ZWM0IHdvcmxkUG9zaXRpb247Cgp2b2lkIG1haW4oKSB7CgogIHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwoKfQo=", "base64"),
                    fragmentShader: i("dW5pZm9ybSB2ZWMzIHBhbm9Qb3NpdGlvbjsKdmFyeWluZyB2ZWM0IHdvcmxkUG9zaXRpb247Cgp2b2lkIG1haW4oKSB7CgogIGZsb2F0IGRlcHRoID0gZGlzdGFuY2Uod29ybGRQb3NpdGlvbi54eXosIHBhbm9Qb3NpdGlvbik7CiAgZmxvYXQgY29sb3IgPSAxLjAgLSBkZXB0aCAvIDEwLjA7CiAgZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvciwgY29sb3IsIGNvbG9yLCAxLjApOwoKfQo=", "base64")
                },
                skysphere: {
                    uniforms: {radius: {type: "f", value: 0}},
                    vertexShader: i("dmFyeWluZyB2ZWM0IHdvcmxkUG9zaXRpb247Cgp2b2lkIG1haW4oKSB7CgogIHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7CiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApOwoKfQo=", "base64"),
                    fragmentShader: i("dmFyeWluZyB2ZWM0IHdvcmxkUG9zaXRpb247CnVuaWZvcm0gZmxvYXQgcmFkaXVzOwoKdm9pZCBtYWluKCkgewoKICB2ZWM0IHRvcENvbG9yID0gdmVjNCgwLjA5NCwgMC4xMDIsIDAuMTEsIDEuMCk7CiAgdmVjNCBib3R0b21Db2xvciA9IHZlYzQoMC4yLCAwLjIxNiwgMC4yMzUsIDEuMCk7CiAgZmxvYXQgbm9ybWFsaXplZEhlaWdodCA9ICh3b3JsZFBvc2l0aW9uLnkgKyByYWRpdXMpIC8gKHJhZGl1cyAqIDIuMCk7CiAgZmxvYXQgcmF0aW8gPSBzbW9vdGhzdGVwKDAuMCwgMC41LCBub3JtYWxpemVkSGVpZ2h0KTsKICBnbF9GcmFnQ29sb3IgPSBtaXgoYm90dG9tQ29sb3IsIHRvcENvbG9yLCByYXRpbyk7Cgp9Cg==", "base64")
                }
            }
        }).call(this, e("buffer").Buffer)
    }, {"./settings": 68, buffer: 84, three: 138}],
    70: [function (e, t, i) {
        (function (i) {
            "use strict";
            var r = e("three"), n = e("url"), o = e("./settings"), a = e("./util/logger"), s = e("./objects/Panorama"), h = new a(i), l = e("./objects/Model"), u = e("./shaders"), c = e("./util/transitions"), d = e("./objects/Chunk"), f = e("./objects/Reticule"), p = e("./objects/Skybox"), m = e("./objects/Floor"), g = e("./cameras/DollhouseCamera"), v = e("./cameras/FloorplanCamera"), y = e("./cameras/PanoramaCamera"), b = e("./controls/DollhouseControls"), w = e("./controls/FloorplanControls"), _ = e("./controls/PanoramaControls");
            r.ImageUtils.crossOrigin = o.crossOrigin, t.exports = {
                shaders: u,
                transitions: c,
                Model: l,
                Chunk: d,
                Floor: m,
                Skybox: p,
                Reticule: f,
                Panorama: s,
                DollhouseCamera: g,
                FloorplanCamera: v,
                PanoramaCamera: y,
                DollhouseControls: b,
                FloorplanControls: w,
                PanoramaControls: _,
                getModel: function (e) {
                    if (!e.url)throw'getModel(): missing parameter "url"';
                    if (e.autoload = void 0 !== e.autoload ? e.autoload : !0, e.url.match(/^https?/)) {
                        var t = n.parse(e.url);
                        this.urlBase = t.protocol + "//" + t.host + "/", this.urlModel = e.url
                    } else this.urlBase = window.location.protocol + "//" + window.location.host + "/", this.urlModel = this.urlBase + "api/player/models/" + e.url;
                    this.urlMaintenance = this.urlBase + "maintenance.json", e.urlFiles = this.urlModel + (this.urlModel.match(/\/$/) ? "files" : "/files");
                    var i = this._getPlatformError();
                    return i ? $.Deferred().reject(i).promise() : (this.options = e, this._loadModel().then(this._buildModel.bind(this)))
                },
                _getPlatformError: function () {
                    return "IE" === $.ua.browser.name && parseInt($.ua.browser.major) < 11 ? "webgl-unsupported" : "iOS" === $.ua.os.name && /^[0-7]/.test($.ua.os.version) ? "webgl-ios" : Modernizr.webgl ? null : "webgl-unsupported"
                },
                _loadModel: function () {
                    var e = $.Deferred();
                    if (this.options.data)return h.info("Using prefetched model data"), e.resolve(this.options.data).promise();
                    var t = this;
                    return $.ajax(t.urlModel, {
                        crossDomain: !0, dataType: "json", beforeSend: function (e) {
                            o.authorizationHeader ? (h.debug("Token present, using authorization header"), e.setRequestHeader("Authorization", o.authorizationHeader)) : h.debug("Token not present, hoping my cookie has auth info...")
                        }
                    }).done(function (t) {
                        e.resolve(t)
                    }).fail(function () {
                        h.debug("initial model retrieval failed, checking if in maintenance mode"), $.ajax(t.urlMaintenance).done(function (t) {
                            h.debug("maintenance mode:" + t.maintenance_mode), t.maintenance_mode ? e.reject("loading-failed-maintenance") : e.reject("loading-failed")
                        }).fail(function (t) {
                            h.debug("No maintenance mode detected, defaulting to missing model"), e.reject("loading-failed")
                        })
                    }), e.promise()
                },
                _buildModel: function (e) {
                    var t = $.Deferred();
                    e.images.forEach(function (e) {
                        if (e.metadata && "string" == typeof e.metadata)try {
                            e.metadata = JSON.parse(e.metadata)
                        } catch (t) {
                            h.warn("Unable to parse image metadata"), e.metadata = null
                        }
                    });
                    var i = new l(this.options, e);
                    return this.options.autoload ? i.load(function () {
                        t.resolve(i)
                    }, function (e) {
                        t.reject(e)
                    }) : t.resolve(i), t
                }
            }
        }).call(this, "/js/showcase.js")
    }, {
        "./cameras/DollhouseCamera": 2,
        "./cameras/FloorplanCamera": 3,
        "./cameras/PanoramaCamera": 4,
        "./controls/DollhouseControls": 5,
        "./controls/FloorplanControls": 6,
        "./controls/PanoramaControls": 8,
        "./objects/Chunk": 57,
        "./objects/Floor": 59,
        "./objects/Model": 60,
        "./objects/Panorama": 62,
        "./objects/Reticule": 63,
        "./objects/Skybox": 65,
        "./settings": 68,
        "./shaders": 69,
        "./util/logger": 78,
        "./util/transitions": 81,
        three: 138,
        url: 95
    }],
    71: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r(e, t) {
                this.cache = {}, this.sid = e.sid, this.baseUrl = null, this.formats = ["*dam", "*dam.lzma", "*_obj.zip", "pan/*.jpg", "*texture_jpg_high/*.jpg", "*texture_jpg_low/*.jpg", "*.csv", "*.modeldata"], this.endpoint = t + "?type=2&filter=" + this.formats.join(",")
            }

            var n = e("./logger"), o = e("../settings"), a = new n(i);
            r.prototype = {
                init: function () {
                    return setInterval(function () {
                        a.debug("refreshing urls..."), this.refresh().done(function () {
                            a.debug("refreshed")
                        }).fail(function () {
                            a.error("failed url refresh, urls might go stale soon")
                        })
                    }.bind(this), 1e3 * o.signedUrlRefreshRate), this.refresh()
                }, refresh: function () {
                    var e = $.Deferred();
                    return $.ajax(this.endpoint, {
                        crossDomain: !0, dataType: "json", beforeSend: function (e) {
                            o.authorizationHeader && e.setRequestHeader("Authorization", o.authorizationHeader)
                        }
                    }).done(function (t) {
                        this.cache = t, "base.url" in t && (this.baseUrl = t["base.url"]), Object.keys(t).length > 0 ? e.resolve() : e.reject("missing-urls")
                    }.bind(this)).fail(function (t) {
                        e.reject("loading-failed")
                    }), e.promise()
                }, get: function (e) {
                    return this.cache[e] ? this.baseUrl ? this.baseUrl.replace("{{filename}}", e) + this.cache[e] : this.cache[e] : (a.debug("Did not find signed URL for " + e), null)
                }, count: function (e) {
                    for (var t = Object.keys(this.cache), i = 0, r = 0; r < t.length; r++)-1 !== t[r].indexOf(e) && i++;
                    return i
                }
            }, t.exports = r
        }).call(this, "/js/util/ModelUrls.js")
    }, {"../settings": 68, "./logger": 78}],
    72: [function (e, t, i) {
        (function (i) {
            "use strict";
            function r() {
                this.list = [], this.dict = {}, this.length = 0, this.neighbourMap = {}, this.path_graph = null
            }

            var n = e("three"), o = e("./common"), a = e("../settings"), s = e("../objects/Panorama"), a = e("../settings"), h = e("./PathGraph"), l = e("./logger"), u = new l(i);
            r.prototype.forEach = function (e) {
                for (var t = 0; t < this.list.length; t++)e(this.list[t])
            }, r.prototype.add = function (e) {
                this.list.push(e), this.dict[e.id] = e, this.length++
            }, r.prototype.extend = function (e) {
                for (var t = 0; t < e.length; t++)this.add(e[t])
            }, r.prototype.get = function (e) {
                return this.dict[e]
            }, r.prototype.filter = function (e) {
                return this.list.filter(e)
            }, r.prototype.find = function (e, t) {
                var i = o.filterAll(this.list, e);
                return 0 === i.length ? null : (t && t.forEach(function (e) {
                    i = o.stableSort(i, e)
                }), i[0])
            }, r.prototype.findByScore = function (e, t) {
                var i = o.filterAll(this.list, e);
                return 0 === i.length ? null : (i = i.map(function (e) {
                    return {
                        pano: e, score: t.reduce(function (t, i) {
                            return t + i(e)
                        }, 0)
                    }
                }).sort(function (e, t) {
                    return t.score - e.score
                }), a.navigation.panoScores && this.showPanoScores(i), i[0].pano)
            }, r.prototype.showPanoScores = function (e) {
                this.list.forEach(function (e) {
                    e.removeTextSprite()
                });
                var t = 6344768;
                e.forEach(function (e) {
                    e.pano.addTextSprite(e.score.toFixed(2), t), t = 16428055
                })
            }, r.prototype.isNeighbour = function (e, t) {
                return this.neighbourMap[e.id][t.id]
            }, r.prototype.getNeighbours = function (e) {
                return this.neighbourMap[e.id]
            }, r.prototype.setNeighbour = function (e, t, i) {
                return this.neighbourMap[e.id] || (this.neighbourMap[e.id] = {}), this.neighbourMap[t.id] || (this.neighbourMap[t.id] = {}), this.neighbourMap[e.id][e.id] = !0, this.neighbourMap[t.id][t.id] = !0, this.neighbourMap[e.id][t.id] = i, this.neighbourMap[t.id][e.id] = i, this.neighbourMap[e.id]
            }, r.prototype.findClosest = function (e, t) {
                var i = t ? [s.filters.inDirection(e, t, .75)] : [];
                return this.find(i, [s.sortFunctions.distanceToPoint(e)])
            }, r.prototype.populate_path_graph = function () {
                var e, t, i, r, o, a, s, l, c = Date.now(), d = {}, f = 0, p = new n.Vector3(0, 0, 0), m = 0, g = 0;
                for (e = 0; e < this.list.length; e += 1) {
                    o = this.list[e], s = {}, l = !1, i = o.neighbourPanos || o.findNeighourPanos();
                    for (t in i)if (i[t]) {
                        a = this.dict[t], p.copy(o.floorPosition), p.sub(a.floorPosition);
                        var v = Math.sqrt(p.x * p.x + p.z * p.z), y = (Math.abs(p.y) / Math.max(v, .01), Math.max(0, Math.abs(p.y) - .2));
                        y > 0 ? (m += 1, y = Math.pow(4 * y, 2), v = Math.pow(v, 2), r = Math.sqrt(y * y + v * v)) : (g += 1, r = p.length()), s[a.id] = r, l = !0
                    }
                    l ? d[o.id] = s : f += 1
                }
                this.path_graph = new h(d), u.info("graph ready in " + (Date.now() - c) + "ms, " + f + " had no neighbors")
            }, t.exports = r
        }).call(this, "/js/util/PanoramaCollection.js")
    }, {"../objects/Panorama": 62, "../settings": 68, "./PathGraph": 73, "./common": 75, "./logger": 78, three: 138}],
    73: [function (e, t, i) {
        "use strict";
        var r = function (e) {
            var t = function (e) {
                var t, i = [];
                for (t in e)Object.prototype.hasOwnProperty.call(e, t) && i.push(t);
                return i
            }, i = function (e, t) {
                return parseFloat(e) - parseFloat(t)
            }, r = function (r, n, o, a) {
                a = a || 1 / 0;
                var s, h = {}, l = {0: [n]}, u = {}, c = function (e, t) {
                    var i = "" + e;
                    l[i] || (l[i] = []), l[i].push(t)
                };
                for (h[n] = 0; l && (s = t(l)).length;) {
                    s.sort(i);
                    var d = s[0], f = l[d], p = f.shift(), m = parseFloat(d), g = r[p] || {};
                    f.length || delete l[d];
                    for (var v in g)if (Object.prototype.hasOwnProperty.call(g, v)) {
                        var y = g[v], b = y + m, w = h[v];
                        (w === e || w > b) && (h[v] = b, c(b, v), u[v] = p)
                    }
                }
                return h[o] === e ? null : u
            }, n = function (e, t) {
                for (var i, r = [], n = t; n;)r.push(n), i = e[n], n = e[n];
                return r.reverse(), r
            }, o = function (e, t) {
                for (var i, o, a, s = t.shift(), h = []; t.length;) {
                    if (i = t.shift(), o = r(e, s, i), !o)return null;
                    if (a = n(o, i), !t.length)return h.concat(a);
                    h.push.apply(h, a.slice(0, -1)), s = i
                }
            }, a = function (e, t) {
                try {
                    return Array.prototype.slice.call(e, t)
                } catch (i) {
                    for (var r = [], n = t || 0, o = e.length; o > n; ++n)r.push(e[n]);
                    return r
                }
            }, s = function (e) {
                this.map = e
            };
            return s.prototype.findShortestPath = function (e, t) {
                return "[object Array]" === Object.prototype.toString.call(e) ? o(this.map, e) : 2 === arguments.length ? o(this.map, [e, t]) : o(this.map, a(arguments))
            }, s.findShortestPath = function (e, t, i) {
                return "[object Array]" === Object.prototype.toString.call(t) ? o(e, t) : 3 === arguments.length ? o(e, [t, i]) : o(e, a(arguments, 1))
            }, s
        }();
        t.exports = r
    }, {}],
    74: [function (e, t, i) {
        "use strict";
        t.exports = {
            isFullscreen: function () {
                return document.fullscreenElement || document.mozFullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement
            }, supportsFullscreen: function () {
                return document.fullscreenEnabled || document.mozFullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled
            }, isPointerLocked: function () {
                return document.pointerLockElement || document.mozPointerLockElement || document.webkitPointerLockElement
            }, requestFullscreen: function (e, t) {
                e.requestFullscreen ? e.requestFullscreen() : e.mozRequestFullScreen ? e.mozRequestFullScreen() : e.webkitRequestFullscreen ? e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT) : e.msRequestFullscreen && e.msRequestFullscreen(), t && $(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange", browser.requestPointerLock)
            }, requestPointerLock: function () {
                var e;
                if (document.fullscreenElement)e = document.fullscreenElement(); else if (document.mozFullscreenElement)e = document.mozFullscreenElement(); else if (document.mozFullScreenElement)e = document.mozFullScreenElement(); else {
                    if (!document.webkitFullscreenElement)return;
                    e = document.webkitFullscreenElement()
                }
                e.requestPointerLock = e.requestPointerLock || e.mozRequestPointerLock || e.webkitRequestPointerLock, e.requestPointerLock(), $(document).off("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange", this)
            }, exitPointerLock: function () {
                document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock, document.exitPointerLock()
            }, exitFullscreen: function () {
                document.exitFullscreen ? document.exitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitExitFullscreen && document.webkitExitFullscreen()
            }, details: function () {
                var e = navigator.userAgent.match("(Firefox|Chrome|Safari)/([\\d]+)");
                return e ? {name: e[1], version: parseInt(e[2]), platform: navigator.platform} : {}
            }, is: function (e) {
                return this.details() && this.details().name === e
            }, inIframe: function () {
                return window.parent !== window
            }, aspectRatio: function () {
                var e = window.innerWidth / window.innerHeight;
                return isFinite(e) ? e : 0
            }, userAgent: function () {
                return window.navigator.userAgent
            }, isMobile: function () {
                var e = navigator.userAgent || navigator.vendor || window.opera;
                return /(android|bb\d+|meego).+mobile|android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0, 4))
            }, detectIE: function () {
                var e = window.navigator.userAgent, t = e.indexOf("MSIE ");
                return t > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)
            }, detectSafari: function () {
                var e = window.navigator.userAgent, t = e.indexOf("Safari"), i = e.indexOf("Chrome");
                return t > 0 && 0 > i
            }, detectSamsungS6: function () {
                var e = window.navigator.userAgent, t = e.indexOf("SM-G92");
                return t > 0
            }, valueFromCookie: function (e, t) {
                var i = new RegExp(e + "=([0-9a-f]+)(; ?|$)").exec(document.cookie);
                if (!i)return t;
                var r = i[1];
                return "boolean" == typeof t ? "true" === r || "1" === r : "number" == typeof t ? parseFloat(r) : r
            }, valueFromHash: function (e, t) {
                var i = new RegExp("[#&?]" + e + "=([^#&?]*)"), r = i.exec(window.location.href);
                if (!r)return t;
                var n = r[1];
                return "boolean" == typeof t ? "true" === n || "1" === n : "number" == typeof t ? parseFloat(n) : window.decodeURIComponent(n)
            }
        }
    }, {}],
    75: [function (e, t, i) {
        "use strict";
        var r = e("three");
        t.exports = {
            _xhr: function (e, t, i) {
                var r = new XMLHttpRequest;
                if (i && "withCredentials" in r)r.open("GET", t, i); else if ("undefined" != typeof XDomainRequest)r = new XDomainRequest, r.open(e, t); else {
                    if (i)throw"Browser does not support CORS!";
                    r.open("GET", t)
                }
                return r
            }, getFile: function (e, t, i) {
                var r = this._xhr("get", e, !1);
                r.onreadystatechange = function (e) {
                    4 == this.readyState && (200 == this.status ? t(this.response) : i && i())
                }, r.send()
            }, getFileAsArrayBuffer: function (e, t, i) {
                var r = this._xhr("get", e, !1);
                r.responseType = "arraybuffer", r.onreadystatechange = function (e) {
                    4 == this.readyState && (200 == this.status ? t(this.response) : i && i())
                }, r.send()
            }, getFilesAsArrayBuffer: function (e, t, i) {
                var r = [], n = 0;
                e.forEach(function (i, o) {
                    util.getFileAsArrayBuffer(i, function (i) {
                        r.splice(o, 0, i), ++n === e.length && t.apply(this, r)
                    }, function () {
                        r.splice(o, 0, null), ++n
                    })
                })
            }, domainFromUrl: function (e) {
                var t = /^([^:]*:\/\/)?([^/]+)/.exec(e);
                return t ? t[2] : e
            }, average: function (e, t) {
                if (0 === e.length)return null;
                for (var i = 0, r = 0, n = 0; n < e.length; n++) {
                    var o = t ? e[n][t] : e[n];
                    i += o, r++
                }
                return i / r
            }, averageVectors: function (e, t) {
                var i = new r.Vector3;
                if (0 === e.length)return i;
                for (var n = 0, o = 0; o < e.length; o++) {
                    var a = t ? e[o][t] : e[o];
                    i.add(a), n++
                }
                return i.divideScalar(n)
            }, equalLists: function (e, t) {
                if (e.length !== t.length)return !1;
                for (var i = 0; i < e.length; i++)if (e[i] !== t[i])return !1;
                return !0
            }, lowerMedian: function (e, t) {
                if (0 === e.length)return null;
                t = t || 2, e.sort(function (e, t) {
                    return e - t
                });
                var i = Math.floor(e.length / t);
                return e[i]
            }, stableSort: function (e, t) {
                return e.map(function (e, t) {
                    return {value: e, index: t}
                }).sort(function (e, i) {
                    var r = t(e.value, i.value);
                    return 0 !== r ? r : e.index - i.index
                }).map(function (e) {
                    return e.value
                })
            }, filterAll: function (e, t) {
                return e.filter(function (e) {
                    return t.every(function (t) {
                        return t(e)
                    })
                })
            }, formatDate: function (e) {
                return [e.getFullYear(), e.getMonth() + 1, e.getDate()].join("-")
            }, formatDatetime: function (e) {
                return [e.getFullYear(), e.getMonth() + 1, e.getDate(), e.getHours(), e.getMinutes()].join("-")
            }, randomString: function (e) {
                for (var t = "", i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", r = 0; e > r; r++)t += i.charAt(Math.floor(Math.random() * i.length));
                return t
            }, nth: function (e) {
                return e %= 10, 1 == e ? e + "st" : 2 == e ? e + "nd" : 3 == e ? e + "rd" : e + "th"
            }, _textureCache: {}, loadTextureFromCache: function (e) {
                return this._textureCache[e] || (this._textureCache[e] = r.ImageUtils.loadTexture(e)), this._textureCache[e]
            }, extend: function (e, t) {
                for (var i in t.prototype)e.prototype[i] = t.prototype[i]
            }
        }, Math.sign = function (e) {
            return 0 > e ? -1 : 1
        }
    }, {three: 138}],
    76: [function (e, t, i) {
        "use strict";
        var r = {};
        r.linearTween = function (e, t, i, r) {
            return i * e / r + t
        }, r.easeInQuad = function (e, t, i, r) {
            return e /= r, i * e * e + t
        }, r.easeOutQuad = function (e, t, i, r) {
            return e /= r, -i * e * (e - 2) + t
        }, r.easeInOutQuad = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? i / 2 * e * e + t : (e--, -i / 2 * (e * (e - 2) - 1) + t)
        }, r.easeInCubic = function (e, t, i, r) {
            return e /= r, i * e * e * e + t
        }, r.easeOutCubic = function (e, t, i, r) {
            return e /= r, e--, i * (e * e * e + 1) + t
        }, r.easeInOutCubic = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? i / 2 * e * e * e + t : (e -= 2, i / 2 * (e * e * e + 2) + t)
        }, r.easeInQuart = function (e, t, i, r) {
            return e /= r, i * e * e * e * e + t
        }, r.easeOutQuart = function (e, t, i, r) {
            return e /= r, e--, -i * (e * e * e * e - 1) + t
        }, r.easeInOutQuart = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? i / 2 * e * e * e * e + t : (e -= 2, -i / 2 * (e * e * e * e - 2) + t)
        }, r.easeInQuint = function (e, t, i, r) {
            return e /= r, i * e * e * e * e * e + t
        }, r.easeOutQuint = function (e, t, i, r) {
            return e /= r, e--, i * (e * e * e * e * e + 1) + t
        }, r.easeInOutQuint = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? i / 2 * e * e * e * e * e + t : (e -= 2, i / 2 * (e * e * e * e * e + 2) + t)
        }, r.easeInSine = function (e, t, i, r) {
            return -i * Math.cos(e / r * (Math.PI / 2)) + i + t
        }, r.easeOutSine = function (e, t, i, r) {
            return i * Math.sin(e / r * (Math.PI / 2)) + t
        }, r.easeInOutSine = function (e, t, i, r) {
            return -i / 2 * (Math.cos(Math.PI * e / r) - 1) + t
        }, r.easeInExpo = function (e, t, i, r) {
            return i * Math.pow(2, 10 * (e / r - 1)) + t
        }, r.easeOutExpo = function (e, t, i, r) {
            return i * (-Math.pow(2, -10 * e / r) + 1) + t
        }, r.easeInOutExpo = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? i / 2 * Math.pow(2, 10 * (e - 1)) + t : (e--, i / 2 * (-Math.pow(2, -10 * e) + 2) + t)
        }, r.easeInCirc = function (e, t, i, r) {
            return e /= r, -i * (Math.sqrt(1 - e * e) - 1) + t
        }, r.easeOutCirc = function (e, t, i, r) {
            return e /= r, e--, i * Math.sqrt(1 - e * e) + t
        }, r.easeInOutCirc = function (e, t, i, r) {
            return e /= r / 2, 1 > e ? -i / 2 * (Math.sqrt(1 - e * e) - 1) + t : (e -= 2, i / 2 * (Math.sqrt(1 - e * e) + 1) + t);
        }, r.easeInElastic = function (e, t, i, r) {
            var n = 1.70158, o = 0, a = i;
            return 0 === e ? t : 1 === (e /= r) ? t + i : (o || (o = .3 * r), a < Math.abs(i) ? (a = i, n = o / 4) : n = o / (2 * Math.PI) * Math.asin(i / a), -(a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * r - n) * (2 * Math.PI) / o)) + t)
        }, r.easeOutElastic = function (e, t, i, r) {
            var n = 1.70158, o = 0, a = i;
            return 0 === e ? t : 1 === (e /= r) ? t + i : (o || (o = .3 * r), a < Math.abs(i) ? (a = i, n = o / 4) : n = o / (2 * Math.PI) * Math.asin(i / a), a * Math.pow(2, -10 * e) * Math.sin((e * r - n) * (2 * Math.PI) / o) + i + t)
        }, r.easeInOutElastic = function (e, t, i, r) {
            var n = 1.70158, o = 0, a = i;
            return 0 === e ? t : 2 === (e /= r / 2) ? t + i : (o || (o = r * (.3 * 1.5)), a < Math.abs(i) ? (a = i, n = o / 4) : n = o / (2 * Math.PI) * Math.asin(i / a), 1 > e ? -.5 * (a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * r - n) * (2 * Math.PI) / o)) + t : a * Math.pow(2, -10 * (e -= 1)) * Math.sin((e * r - n) * (2 * Math.PI) / o) * .5 + i + t)
        }, r.easeInBack = function (e, t, i, r, n) {
            return void 0 === n && (n = 1.70158), i * (e /= r) * e * ((n + 1) * e - n) + t
        }, r.easeOutBack = function (e, t, i, r, n) {
            return void 0 === n && (n = 1.70158), i * ((e = e / r - 1) * e * ((n + 1) * e + n) + 1) + t
        }, r.easeInOutBack = function (e, t, i, r, n) {
            return void 0 === n && (n = 1.70158), (e /= r / 2) < 1 ? i / 2 * (e * e * (((n *= 1.525) + 1) * e - n)) + t : i / 2 * ((e -= 2) * e * (((n *= 1.525) + 1) * e + n) + 2) + t
        }, r.easeOutBounce = function (e, t, i, r) {
            return (e /= r) < 1 / 2.75 ? i * (7.5625 * e * e) + t : 2 / 2.75 > e ? i * (7.5625 * (e -= 1.5 / 2.75) * e + .75) + t : 2.5 / 2.75 > e ? i * (7.5625 * (e -= 2.25 / 2.75) * e + .9375) + t : i * (7.5625 * (e -= 2.625 / 2.75) * e + .984375) + t
        }, r.easeInBounce = function (e, t, i, n) {
            return i - r.easeOutBounce(n - e, 0, i, n) + t
        }, r.easeInOutBounce = function (e, t, i, n) {
            return n / 2 > e ? .5 * r.easeInBounce(2 * e, 0, i, n) + t : .5 * r.easeOutBounce(x, 2 * e - n, 0, i, n) + .5 * i + t
        }, t.exports = r
    }, {}],
    77: [function (e, t, i) {
        "use strict";
        t.exports = {
            vector: function (e, t) {
                var i = e.clone();
                return t = t.clone(), function (r) {
                    e.set(i.x * (1 - r) + t.x * r, i.y * (1 - r) + t.y * r, i.z * (1 - r) + t.z * r)
                }
            }, quaternion: function (e, t) {
                var i = e.clone();
                return function (r) {
                    e.copy(i).slerp(t, r)
                }
            }, property: function (e, t, i, r) {
                var n = e[t];
                return function (o) {
                    e[t] = n * (1 - o) + i * o, r && r(e[t])
                }
            }, uniform: function (e, t, i) {
                var r = e.material.uniforms[t].value;
                return function (n) {
                    e.material.uniforms[t] && (e.material.uniforms[t].value = r * (1 - n) + i * n)
                }
            }, matrix4: function (e, t) {
                var i = e.clone();
                return function (r) {
                    for (var n = e.elements, o = i.elements, a = t.elements, s = 0; 16 > s; s++)n[s] = o[s] * (1 - r) + a[s] * r
                }
            }, allUniforms: function (e, t, i) {
                var r = e.map(function (e) {
                    return this.uniform(e, t, i)
                }.bind(this));
                return function (e) {
                    r.forEach(function (t) {
                        t(e)
                    })
                }
            }
        }
    }, {}],
    78: [function (e, t, i) {
        "use strict";
        function r(e) {
            var t = e.split("/"), i = "[" + t[t.length - 1].replace(".js", "") + "]", a = {};
            r.startTime || (r.startTime = Date.now());
            var s, h, l, u;
            if (n.console) {
                var c = function (e) {
                    $("#debug-console").append("<p>" + e + "</p>"), $("#debug-console")[0].scrollTop = $("#debug-console")[0].scrollHeight
                };
                s = function (e) {
                    c(Array.prototype.slice.call(arguments).join(" "))
                }, h = function (e) {
                    c(Array.prototype.slice.call(arguments).join(" "))
                }, l = function (e) {
                    c("WARN: " + Array.prototype.slice.call(arguments).join(" "))
                }, u = function (e) {
                    c("ERROR: " + Array.prototype.slice.call(arguments).join(" "))
                }
            } else console.log ? (s = console.log, h = console.info ? console.info : console.log, l = console.warn ? console.warn : console.log, u = console.error ? console.error : console.log) : s = h = l = u = function () {
            };
            var d = function (e) {
                return [i, r.timestamp()].concat(Array.prototype.slice.call(e))
            }, f = function (t, i) {
                if (o) {
                    var n = Array.prototype.slice.call(t).join(" ");
                    o.captureMessage(n, {level: i, path: e, timestamp: r.timestamp()})
                }
            }, p = function (t, i) {
                if (o) {
                    var n = Array.prototype.slice.call(t).join(" ");
                    o.captureException(new Error(n), {level: i, path: e, timestamp: r.timestamp()})
                }
            };
            return {
                debug: function () {
                    r.level >= r.levels.debug && s.apply(console, d(arguments))
                }, info: function () {
                    r.level >= r.levels.info && h.apply(console, d(arguments))
                }, warn: function () {
                    f(arguments, "warn"), r.level >= r.levels.warn && l.apply(console, d(arguments))
                }, error: function () {
                    p(arguments, "error"), r.level >= r.levels.error && u.apply(console, d(arguments))
                }, v3str: function (e) {
                    return "(" + e.x.toPrecision(2) + ", " + e.y.toPrecision(2) + ", " + e.z.toPrecision(2) + ")"
                }, time: function (e) {
                    r.level >= r.levels.debug && (a[e] = Date.now())
                }, timeEnd: function (e) {
                    if (r.level >= r.levels.debug) {
                        var t = a[e];
                        if (!t)return;
                        var i = (Date.now() - t) / 1e3;
                        this.debug(e, i + "s")
                    }
                }
            }
        }

        var n = e("../settings"), o = window.Raven;
        r.timestamp = function () {
            return r.startTime ? (Date.now() - r.startTime) / 1e3 + "s" : ""
        }, r.levels = {debug: 3, info: 2, warn: 1, error: 0}, r.level = r.levels.info, t.exports = r
    }, {"../settings": 68}],
    79: [function (e, t, i) {
        "use strict";
        var r = e("three");
        t.exports = {
            convertVisionVector: function (e) {
                return new r.Vector3(e.x, e.z, -e.y)
            }, convertVisionQuaternion: function (e) {
                return new r.Quaternion(e.x, e.z, -e.y, e.w).multiply((new r.Quaternion).setFromAxisAngle(new r.Vector3(0, 1, 0), r.Math.degToRad(90)))
            }, convertWorkshopVector: function (e) {
                return new r.Vector3(-e.x, e.y, e.z)
            }, convertWorkshopQuaternion: function (e) {
                return new r.Quaternion(-e.x, e.y, e.z, -e.w).multiply(new r.Quaternion(Math.sqrt(2) / 2, Math.sqrt(2) / 2, 0, 0))
            }
        }
    }, {three: 138}],
    80: [function (e, t, i) {
        "use strict";
        t.exports = {
            captureErrors: function (e, t, i) {
                if ("Raven" in window) {
                    Raven.config(e, t).install(), i && Raven.setTagsContext(i);
                    var r = console.warn, n = console.error;
                    console.warn = function () {
                        var e = Array.prototype.slice.call(arguments);
                        Raven.captureMessage(e.join(" "), {level: "warning"}), r.apply(console, e)
                    }, console.error = function () {
                        var e = Array.prototype.slice.call(arguments);
                        Raven.captureException(new Error(e.join(" ")), {level: "error"}), n.apply(console, e)
                    }
                } else console.error("Raven not found, not capturing errors.")
            }
        }
    }, {}],
    81: [function (e, t, i) {
        "use strict";
        var r = e("./easing");
        t.exports = {
            globalDone: null, funcs: [], counter: 0, start: function (e, t, i, n, o, a) {
                return n = n || 0, this.funcs.push({
                    func: e,
                    current: -n * Math.abs(t),
                    duration: (1 - Math.max(n, 0)) * Math.abs(t),
                    done: i,
                    easing: o || r.linearTween,
                    cycling: 1 > t,
                    running: !0,
                    debug: 0 > n,
                    name: a || "T" + this.counter
                }), e(0, 16), this.counter += 1, e
            }, trigger: function (e) {
                delayRatio = e.delayRatio || 0;
                var t = obgsObj.func || function () {
                    }, i = e.duration || 0, n = e.done || null, o = e.easing || r.linearTween, a = e.name || "R" + this.counter;
                return this.start(t, i, n, delayRatio, o, a)
            }, update: function (e) {
                this.funcs.forEach(function (t) {
                    if (t.current += 1e3 * e, !(t.current < 0))if (t.current >= t.duration && !t.cycling) {
                        var i = t.easing(1, 0, 1, 1);
                        t.func(i, 1e3 * e), t.done && t.done(), t.running = !1
                    } else {
                        var r = t.easing(t.current % t.duration / t.duration, 0, 1, 1), n = t.func(r, 1e3 * e) || !1;
                        n && (t.done && t.done(), t.running = !1)
                    }
                });
                var t = this.funcs.length;
                this.funcs = this.funcs.filter(function (e) {
                    return e.running
                });
                var i = this.funcs.length;
                if (t > 0 && 0 === i && this.globalDone) {
                    var r = this.globalDone;
                    this.globalDone = null, r()
                }
            }, get: function (e) {
                for (var t = 0; t < this.funcs.length; t += 1)if (this.funcs[t].func == e)return this.funcs[t];
                return null
            }, isRunning: function (e) {
                var t = this.get(e);
                return null !== t && t.running
            }, countActive: function () {
                for (var e = 0, t = 0; t < this.funcs.length; t += 1)e += this.funcs[t].running;
                return e
            }, listActive: function () {
                for (var e = [], t = 0; t < this.funcs.length; t += 1)this.funcs[t].running && e.push(this.funcs[t].name);
                return e
            }, done: function (e) {
                this.globalDone = e
            }, cancel: function (e) {
                this.funcs = this.funcs.filter(function (t) {
                    return t.func !== e
                })
            }
        }
    }, {"./easing": 76}],
    82: [function (e, t, i) {
        (function (i, r) {
            "use strict";
            function n(t, n) {
                function o(e) {
                    var t, i;
                    for (t = 0; e[t]; t += 1)if (i = e[t], "." === i)e.splice(t, 1), t -= 1; else if (".." === i) {
                        if (1 === t && (".." === e[2] || ".." === e[0]))break;
                        t > 0 && (e.splice(t - 1, 2), t -= 2)
                    }
                }

                function a(e, t) {
                    var i;
                    return e && "." === e.charAt(0) && t && (i = t.split("/"), i = i.slice(0, i.length - 1), i = i.concat(e.split("/")), o(i), e = i.join("/")), e
                }

                function s(e) {
                    return function (t) {
                        return a(t, e)
                    }
                }

                function h(e) {
                    function t(t) {
                        p[e] = t
                    }

                    return t.fromText = function (e, t) {
                        throw new Error("amdefine does not implement load.fromText")
                    }, t
                }

                function l(e, i, o) {
                    var a, s, h, l;
                    if (e)s = p[e] = {}, h = {id: e, uri: r, exports: s}, a = c(n, s, h, e); else {
                        if (m)throw new Error("amdefine with no module ID cannot be called more than once per file.");
                        m = !0, s = t.exports, h = t, a = c(n, s, h, t.id)
                    }
                    i && (i = i.map(function (e) {
                        return a(e)
                    })), l = "function" == typeof o ? o.apply(h.exports, i) : o, void 0 !== l && (h.exports = l, e && (p[e] = h.exports))
                }

                function u(e, t, i) {
                    Array.isArray(e) ? (i = t, t = e, e = void 0) : "string" != typeof e && (i = e, e = t = void 0), t && !Array.isArray(t) && (i = t, t = void 0), t || (t = ["require", "exports", "module"]), e ? f[e] = [e, t, i] : l(e, t, i)
                }

                var c, d, f = {}, p = {}, m = !1, g = e("path");
                return c = function (e, t, r, n) {
                    function o(o, a) {
                        return "string" == typeof o ? d(e, t, r, o, n) : (o = o.map(function (i) {
                            return d(e, t, r, i, n)
                        }), void(a && i.nextTick(function () {
                            a.apply(null, o)
                        })))
                    }

                    return o.toUrl = function (e) {
                        return 0 === e.indexOf(".") ? a(e, g.dirname(r.filename)) : e
                    }, o
                }, n = n || function () {
                        return t.require.apply(t, arguments)
                    }, d = function (e, t, i, r, n) {
                    var o, u, m = r.indexOf("!"), g = r;
                    if (-1 === m) {
                        if (r = a(r, n), "require" === r)return c(e, t, i, n);
                        if ("exports" === r)return t;
                        if ("module" === r)return i;
                        if (p.hasOwnProperty(r))return p[r];
                        if (f[r])return l.apply(null, f[r]), p[r];
                        if (e)return e(g);
                        throw new Error("No module with ID: " + r)
                    }
                    return o = r.substring(0, m), r = r.substring(m + 1, r.length), u = d(e, t, i, o, n), r = u.normalize ? u.normalize(r, s(n)) : a(r, n), p[r] ? p[r] : (u.load(r, c(e, t, i, n), h(r), {}), p[r])
                }, u.require = function (e) {
                    return p[e] ? p[e] : f[e] ? (l.apply(null, f[e]), p[e]) : void 0
                }, u.amd = {}, u
            }

            t.exports = n
        }).call(this, e("_process"), "/node_modules/amdefine/amdefine.js")
    }, {_process: 90, path: 89}],
    83: [function (e, t, i) {
    }, {}],
    84: [function (e, t, i) {
        (function (t) {
            "use strict";
            function r() {
                function e() {
                }

                try {
                    var t = new Uint8Array(1);
                    return t.foo = function () {
                        return 42
                    }, t.constructor = e, 42 === t.foo() && t.constructor === e && "function" == typeof t.subarray && 0 === t.subarray(1, 1).byteLength
                } catch (i) {
                    return !1
                }
            }

            function n() {
                return o.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823
            }

            function o(e) {
                return this instanceof o ? (o.TYPED_ARRAY_SUPPORT || (this.length = 0, this.parent = void 0), "number" == typeof e ? a(this, e) : "string" == typeof e ? s(this, e, arguments.length > 1 ? arguments[1] : "utf8") : h(this, e)) : arguments.length > 1 ? new o(e, arguments[1]) : new o(e)
            }

            function a(e, t) {
                if (e = m(e, 0 > t ? 0 : 0 | g(t)), !o.TYPED_ARRAY_SUPPORT)for (var i = 0; t > i; i++)e[i] = 0;
                return e
            }

            function s(e, t, i) {
                ("string" != typeof i || "" === i) && (i = "utf8");
                var r = 0 | y(t, i);
                return e = m(e, r), e.write(t, i), e
            }

            function h(e, t) {
                if (o.isBuffer(t))return l(e, t);
                if (K(t))return u(e, t);
                if (null == t)throw new TypeError("must start with number, buffer, array or string");
                if ("undefined" != typeof ArrayBuffer) {
                    if (t.buffer instanceof ArrayBuffer)return c(e, t);
                    if (t instanceof ArrayBuffer)return d(e, t)
                }
                return t.length ? f(e, t) : p(e, t)
            }

            function l(e, t) {
                var i = 0 | g(t.length);
                return e = m(e, i), t.copy(e, 0, 0, i), e
            }

            function u(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var r = 0; i > r; r += 1)e[r] = 255 & t[r];
                return e
            }

            function c(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var r = 0; i > r; r += 1)e[r] = 255 & t[r];
                return e
            }

            function d(e, t) {
                return o.TYPED_ARRAY_SUPPORT ? (t.byteLength, e = o._augment(new Uint8Array(t))) : e = c(e, new Uint8Array(t)), e
            }

            function f(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var r = 0; i > r; r += 1)e[r] = 255 & t[r];
                return e
            }

            function p(e, t) {
                var i, r = 0;
                "Buffer" === t.type && K(t.data) && (i = t.data, r = 0 | g(i.length)), e = m(e, r);
                for (var n = 0; r > n; n += 1)e[n] = 255 & i[n];
                return e
            }

            function m(e, t) {
                o.TYPED_ARRAY_SUPPORT ? (e = o._augment(new Uint8Array(t)), e.__proto__ = o.prototype) : (e.length = t, e._isBuffer = !0);
                var i = 0 !== t && t <= o.poolSize >>> 1;
                return i && (e.parent = Q), e
            }

            function g(e) {
                if (e >= n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + n().toString(16) + " bytes");
                return 0 | e
            }

            function v(e, t) {
                if (!(this instanceof v))return new v(e, t);
                var i = new o(e, t);
                return delete i.parent, i
            }

            function y(e, t) {
                "string" != typeof e && (e = "" + e);
                var i = e.length;
                if (0 === i)return 0;
                for (var r = !1; ;)switch (t) {
                    case"ascii":
                    case"binary":
                    case"raw":
                    case"raws":
                        return i;
                    case"utf8":
                    case"utf-8":
                        return H(e).length;
                    case"ucs2":
                    case"ucs-2":
                    case"utf16le":
                    case"utf-16le":
                        return 2 * i;
                    case"hex":
                        return i >>> 1;
                    case"base64":
                        return Y(e).length;
                    default:
                        if (r)return H(e).length;
                        t = ("" + t).toLowerCase(), r = !0
                }
            }

            function b(e, t, i) {
                var r = !1;
                if (t = 0 | t, i = void 0 === i || i === 1 / 0 ? this.length : 0 | i, e || (e = "utf8"), 0 > t && (t = 0), i > this.length && (i = this.length), t >= i)return "";
                for (; ;)switch (e) {
                    case"hex":
                        return k(this, t, i);
                    case"utf8":
                    case"utf-8":
                        return T(this, t, i);
                    case"ascii":
                        return P(this, t, i);
                    case"binary":
                        return L(this, t, i);
                    case"base64":
                        return A(this, t, i);
                    case"ucs2":
                    case"ucs-2":
                    case"utf16le":
                    case"utf-16le":
                        return B(this, t, i);
                    default:
                        if (r)throw new TypeError("Unknown encoding: " + e);
                        e = (e + "").toLowerCase(), r = !0
                }
            }

            function w(e, t, i, r) {
                i = Number(i) || 0;
                var n = e.length - i;
                r ? (r = Number(r), r > n && (r = n)) : r = n;
                var o = t.length;
                if (o % 2 !== 0)throw new Error("Invalid hex string");
                r > o / 2 && (r = o / 2);
                for (var a = 0; r > a; a++) {
                    var s = parseInt(t.substr(2 * a, 2), 16);
                    if (isNaN(s))throw new Error("Invalid hex string");
                    e[i + a] = s
                }
                return a
            }

            function _(e, t, i, r) {
                return Z(H(t, e.length - i), e, i, r)
            }

            function x(e, t, i, r) {
                return Z(G(t), e, i, r)
            }

            function S(e, t, i, r) {
                return x(e, t, i, r)
            }

            function E(e, t, i, r) {
                return Z(Y(t), e, i, r)
            }

            function M(e, t, i, r) {
                return Z(j(t, e.length - i), e, i, r)
            }

            function A(e, t, i) {
                return 0 === t && i === e.length ? X.fromByteArray(e) : X.fromByteArray(e.slice(t, i))
            }

            function T(e, t, i) {
                i = Math.min(e.length, i);
                for (var r = [], n = t; i > n;) {
                    var o = e[n], a = null, s = o > 239 ? 4 : o > 223 ? 3 : o > 191 ? 2 : 1;
                    if (i >= n + s) {
                        var h, l, u, c;
                        switch (s) {
                            case 1:
                                128 > o && (a = o);
                                break;
                            case 2:
                                h = e[n + 1], 128 === (192 & h) && (c = (31 & o) << 6 | 63 & h, c > 127 && (a = c));
                                break;
                            case 3:
                                h = e[n + 1], l = e[n + 2], 128 === (192 & h) && 128 === (192 & l) && (c = (15 & o) << 12 | (63 & h) << 6 | 63 & l, c > 2047 && (55296 > c || c > 57343) && (a = c));
                                break;
                            case 4:
                                h = e[n + 1], l = e[n + 2], u = e[n + 3], 128 === (192 & h) && 128 === (192 & l) && 128 === (192 & u) && (c = (15 & o) << 18 | (63 & h) << 12 | (63 & l) << 6 | 63 & u, c > 65535 && 1114112 > c && (a = c))
                        }
                    }
                    null === a ? (a = 65533, s = 1) : a > 65535 && (a -= 65536, r.push(a >>> 10 & 1023 | 55296), a = 56320 | 1023 & a), r.push(a), n += s
                }
                return C(r)
            }

            function C(e) {
                var t = e.length;
                if (J >= t)return String.fromCharCode.apply(String, e);
                for (var i = "", r = 0; t > r;)i += String.fromCharCode.apply(String, e.slice(r, r += J));
                return i
            }

            function P(e, t, i) {
                var r = "";
                i = Math.min(e.length, i);
                for (var n = t; i > n; n++)r += String.fromCharCode(127 & e[n]);
                return r
            }

            function L(e, t, i) {
                var r = "";
                i = Math.min(e.length, i);
                for (var n = t; i > n; n++)r += String.fromCharCode(e[n]);
                return r
            }

            function k(e, t, i) {
                var r = e.length;
                (!t || 0 > t) && (t = 0), (!i || 0 > i || i > r) && (i = r);
                for (var n = "", o = t; i > o; o++)n += W(e[o]);
                return n
            }

            function B(e, t, i) {
                for (var r = e.slice(t, i), n = "", o = 0; o < r.length; o += 2)n += String.fromCharCode(r[o] + 256 * r[o + 1]);
                return n
            }

            function R(e, t, i) {
                if (e % 1 !== 0 || 0 > e)throw new RangeError("offset is not uint");
                if (e + t > i)throw new RangeError("Trying to access beyond buffer length")
            }

            function I(e, t, i, r, n, a) {
                if (!o.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");
                if (t > n || a > t)throw new RangeError("value is out of bounds");
                if (i + r > e.length)throw new RangeError("index out of range")
            }

            function F(e, t, i, r) {
                0 > t && (t = 65535 + t + 1);
                for (var n = 0, o = Math.min(e.length - i, 2); o > n; n++)e[i + n] = (t & 255 << 8 * (r ? n : 1 - n)) >>> 8 * (r ? n : 1 - n)
            }

            function D(e, t, i, r) {
                0 > t && (t = 4294967295 + t + 1);
                for (var n = 0, o = Math.min(e.length - i, 4); o > n; n++)e[i + n] = t >>> 8 * (r ? n : 3 - n) & 255
            }

            function O(e, t, i, r, n, o) {
                if (t > n || o > t)throw new RangeError("value is out of bounds");
                if (i + r > e.length)throw new RangeError("index out of range");
                if (0 > i)throw new RangeError("index out of range")
            }

            function N(e, t, i, r, n) {
                return n || O(e, t, i, 4, 3.4028234663852886e38, -3.4028234663852886e38), q.write(e, t, i, r, 23, 4), i + 4
            }

            function U(e, t, i, r, n) {
                return n || O(e, t, i, 8, 1.7976931348623157e308, -1.7976931348623157e308), q.write(e, t, i, r, 52, 8), i + 8
            }

            function z(e) {
                if (e = V(e).replace(ee, ""), e.length < 2)return "";
                for (; e.length % 4 !== 0;)e += "=";
                return e
            }

            function V(e) {
                return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
            }

            function W(e) {
                return 16 > e ? "0" + e.toString(16) : e.toString(16)
            }

            function H(e, t) {
                t = t || 1 / 0;
                for (var i, r = e.length, n = null, o = [], a = 0; r > a; a++) {
                    if (i = e.charCodeAt(a), i > 55295 && 57344 > i) {
                        if (!n) {
                            if (i > 56319) {
                                (t -= 3) > -1 && o.push(239, 191, 189);
                                continue
                            }
                            if (a + 1 === r) {
                                (t -= 3) > -1 && o.push(239, 191, 189);
                                continue
                            }
                            n = i;
                            continue
                        }
                        if (56320 > i) {
                            (t -= 3) > -1 && o.push(239, 191, 189), n = i;
                            continue
                        }
                        i = (n - 55296 << 10 | i - 56320) + 65536
                    } else n && (t -= 3) > -1 && o.push(239, 191, 189);
                    if (n = null, 128 > i) {
                        if ((t -= 1) < 0)break;
                        o.push(i)
                    } else if (2048 > i) {
                        if ((t -= 2) < 0)break;
                        o.push(i >> 6 | 192, 63 & i | 128)
                    } else if (65536 > i) {
                        if ((t -= 3) < 0)break;
                        o.push(i >> 12 | 224, i >> 6 & 63 | 128, 63 & i | 128)
                    } else {
                        if (!(1114112 > i))throw new Error("Invalid code point");
                        if ((t -= 4) < 0)break;
                        o.push(i >> 18 | 240, i >> 12 & 63 | 128, i >> 6 & 63 | 128, 63 & i | 128)
                    }
                }
                return o
            }

            function G(e) {
                for (var t = [], i = 0; i < e.length; i++)t.push(255 & e.charCodeAt(i));
                return t
            }

            function j(e, t) {
                for (var i, r, n, o = [], a = 0; a < e.length && !((t -= 2) < 0); a++)i = e.charCodeAt(a), r = i >> 8, n = i % 256, o.push(n), o.push(r);
                return o
            }

            function Y(e) {
                return X.toByteArray(z(e))
            }

            function Z(e, t, i, r) {
                for (var n = 0; r > n && !(n + i >= t.length || n >= e.length); n++)t[n + i] = e[n];
                return n
            }

            var X = e("base64-js"), q = e("ieee754"), K = e("isarray");
            i.Buffer = o, i.SlowBuffer = v, i.INSPECT_MAX_BYTES = 50, o.poolSize = 8192;
            var Q = {};
            o.TYPED_ARRAY_SUPPORT = void 0 !== t.TYPED_ARRAY_SUPPORT ? t.TYPED_ARRAY_SUPPORT : r(), o.TYPED_ARRAY_SUPPORT ? (o.prototype.__proto__ = Uint8Array.prototype, o.__proto__ = Uint8Array) : (o.prototype.length = void 0, o.prototype.parent = void 0), o.isBuffer = function (e) {
                return !(null == e || !e._isBuffer)
            }, o.compare = function (e, t) {
                if (!o.isBuffer(e) || !o.isBuffer(t))throw new TypeError("Arguments must be Buffers");
                if (e === t)return 0;
                for (var i = e.length, r = t.length, n = 0, a = Math.min(i, r); a > n && e[n] === t[n];)++n;
                return n !== a && (i = e[n], r = t[n]), r > i ? -1 : i > r ? 1 : 0
            }, o.isEncoding = function (e) {
                switch (String(e).toLowerCase()) {
                    case"hex":
                    case"utf8":
                    case"utf-8":
                    case"ascii":
                    case"binary":
                    case"base64":
                    case"raw":
                    case"ucs2":
                    case"ucs-2":
                    case"utf16le":
                    case"utf-16le":
                        return !0;
                    default:
                        return !1
                }
            }, o.concat = function (e, t) {
                if (!K(e))throw new TypeError("list argument must be an Array of Buffers.");
                if (0 === e.length)return new o(0);
                var i;
                if (void 0 === t)for (t = 0, i = 0; i < e.length; i++)t += e[i].length;
                var r = new o(t), n = 0;
                for (i = 0; i < e.length; i++) {
                    var a = e[i];
                    a.copy(r, n), n += a.length
                }
                return r
            }, o.byteLength = y, o.prototype.toString = function () {
                var e = 0 | this.length;
                return 0 === e ? "" : 0 === arguments.length ? T(this, 0, e) : b.apply(this, arguments)
            }, o.prototype.equals = function (e) {
                if (!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");
                return this === e ? !0 : 0 === o.compare(this, e)
            }, o.prototype.inspect = function () {
                var e = "", t = i.INSPECT_MAX_BYTES;
                return this.length > 0 && (e = this.toString("hex", 0, t).match(/.{2}/g).join(" "), this.length > t && (e += " ... ")), "<Buffer " + e + ">"
            }, o.prototype.compare = function (e) {
                if (!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");
                return this === e ? 0 : o.compare(this, e)
            }, o.prototype.indexOf = function (e, t) {
                function i(e, t, i) {
                    for (var r = -1, n = 0; i + n < e.length; n++)if (e[i + n] === t[-1 === r ? 0 : n - r]) {
                        if (-1 === r && (r = n), n - r + 1 === t.length)return i + r
                    } else r = -1;
                    return -1
                }

                if (t > 2147483647 ? t = 2147483647 : -2147483648 > t && (t = -2147483648), t >>= 0, 0 === this.length)return -1;
                if (t >= this.length)return -1;
                if (0 > t && (t = Math.max(this.length + t, 0)), "string" == typeof e)return 0 === e.length ? -1 : String.prototype.indexOf.call(this, e, t);
                if (o.isBuffer(e))return i(this, e, t);
                if ("number" == typeof e)return o.TYPED_ARRAY_SUPPORT && "function" === Uint8Array.prototype.indexOf ? Uint8Array.prototype.indexOf.call(this, e, t) : i(this, [e], t);
                throw new TypeError("val must be string, number or Buffer")
            }, o.prototype.get = function (e) {
                return console.log(".get() is deprecated. Access using array indexes instead."), this.readUInt8(e)
            }, o.prototype.set = function (e, t) {
                return console.log(".set() is deprecated. Access using array indexes instead."), this.writeUInt8(e, t)
            }, o.prototype.write = function (e, t, i, r) {
                if (void 0 === t)r = "utf8", i = this.length, t = 0; else if (void 0 === i && "string" == typeof t)r = t, i = this.length, t = 0; else if (isFinite(t))t = 0 | t, isFinite(i) ? (i = 0 | i, void 0 === r && (r = "utf8")) : (r = i, i = void 0); else {
                    var n = r;
                    r = t, t = 0 | i, i = n
                }
                var o = this.length - t;
                if ((void 0 === i || i > o) && (i = o), e.length > 0 && (0 > i || 0 > t) || t > this.length)throw new RangeError("attempt to write outside buffer bounds");
                r || (r = "utf8");
                for (var a = !1; ;)switch (r) {
                    case"hex":
                        return w(this, e, t, i);
                    case"utf8":
                    case"utf-8":
                        return _(this, e, t, i);
                    case"ascii":
                        return x(this, e, t, i);
                    case"binary":
                        return S(this, e, t, i);
                    case"base64":
                        return E(this, e, t, i);
                    case"ucs2":
                    case"ucs-2":
                    case"utf16le":
                    case"utf-16le":
                        return M(this, e, t, i);
                    default:
                        if (a)throw new TypeError("Unknown encoding: " + r);
                        r = ("" + r).toLowerCase(), a = !0
                }
            }, o.prototype.toJSON = function () {
                return {type: "Buffer", data: Array.prototype.slice.call(this._arr || this, 0)}
            };
            var J = 4096;
            o.prototype.slice = function (e, t) {
                var i = this.length;
                e = ~~e, t = void 0 === t ? i : ~~t, 0 > e ? (e += i, 0 > e && (e = 0)) : e > i && (e = i), 0 > t ? (t += i, 0 > t && (t = 0)) : t > i && (t = i), e > t && (t = e);
                var r;
                if (o.TYPED_ARRAY_SUPPORT)r = o._augment(this.subarray(e, t)); else {
                    var n = t - e;
                    r = new o(n, void 0);
                    for (var a = 0; n > a; a++)r[a] = this[a + e]
                }
                return r.length && (r.parent = this.parent || this), r
            }, o.prototype.readUIntLE = function (e, t, i) {
                e = 0 | e, t = 0 | t, i || R(e, t, this.length);
                for (var r = this[e], n = 1, o = 0; ++o < t && (n *= 256);)r += this[e + o] * n;
                return r
            }, o.prototype.readUIntBE = function (e, t, i) {
                e = 0 | e, t = 0 | t, i || R(e, t, this.length);
                for (var r = this[e + --t], n = 1; t > 0 && (n *= 256);)r += this[e + --t] * n;
                return r
            }, o.prototype.readUInt8 = function (e, t) {
                return t || R(e, 1, this.length), this[e]
            }, o.prototype.readUInt16LE = function (e, t) {
                return t || R(e, 2, this.length), this[e] | this[e + 1] << 8
            }, o.prototype.readUInt16BE = function (e, t) {
                return t || R(e, 2, this.length), this[e] << 8 | this[e + 1]
            }, o.prototype.readUInt32LE = function (e, t) {
                return t || R(e, 4, this.length), (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3]
            }, o.prototype.readUInt32BE = function (e, t) {
                return t || R(e, 4, this.length), 16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3])
            }, o.prototype.readIntLE = function (e, t, i) {
                e = 0 | e, t = 0 | t, i || R(e, t, this.length);
                for (var r = this[e], n = 1, o = 0; ++o < t && (n *= 256);)r += this[e + o] * n;
                return n *= 128, r >= n && (r -= Math.pow(2, 8 * t)), r
            }, o.prototype.readIntBE = function (e, t, i) {
                e = 0 | e, t = 0 | t, i || R(e, t, this.length);
                for (var r = t, n = 1, o = this[e + --r]; r > 0 && (n *= 256);)o += this[e + --r] * n;
                return n *= 128, o >= n && (o -= Math.pow(2, 8 * t)), o
            }, o.prototype.readInt8 = function (e, t) {
                return t || R(e, 1, this.length), 128 & this[e] ? -1 * (255 - this[e] + 1) : this[e]
            }, o.prototype.readInt16LE = function (e, t) {
                t || R(e, 2, this.length);
                var i = this[e] | this[e + 1] << 8;
                return 32768 & i ? 4294901760 | i : i
            }, o.prototype.readInt16BE = function (e, t) {
                t || R(e, 2, this.length);
                var i = this[e + 1] | this[e] << 8;
                return 32768 & i ? 4294901760 | i : i
            }, o.prototype.readInt32LE = function (e, t) {
                return t || R(e, 4, this.length), this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24
            }, o.prototype.readInt32BE = function (e, t) {
                return t || R(e, 4, this.length), this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]
            }, o.prototype.readFloatLE = function (e, t) {
                return t || R(e, 4, this.length), q.read(this, e, !0, 23, 4)
            }, o.prototype.readFloatBE = function (e, t) {
                return t || R(e, 4, this.length), q.read(this, e, !1, 23, 4)
            }, o.prototype.readDoubleLE = function (e, t) {
                return t || R(e, 8, this.length), q.read(this, e, !0, 52, 8)
            }, o.prototype.readDoubleBE = function (e, t) {
                return t || R(e, 8, this.length), q.read(this, e, !1, 52, 8)
            }, o.prototype.writeUIntLE = function (e, t, i, r) {
                e = +e, t = 0 | t, i = 0 | i, r || I(this, e, t, i, Math.pow(2, 8 * i), 0);
                var n = 1, o = 0;
                for (this[t] = 255 & e; ++o < i && (n *= 256);)this[t + o] = e / n & 255;
                return t + i
            }, o.prototype.writeUIntBE = function (e, t, i, r) {
                e = +e, t = 0 | t, i = 0 | i, r || I(this, e, t, i, Math.pow(2, 8 * i), 0);
                var n = i - 1, o = 1;
                for (this[t + n] = 255 & e; --n >= 0 && (o *= 256);)this[t + n] = e / o & 255;
                return t + i
            }, o.prototype.writeUInt8 = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 1, 255, 0), o.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), this[t] = 255 & e, t + 1
            }, o.prototype.writeUInt16LE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 65535, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : F(this, e, t, !0), t + 2
            }, o.prototype.writeUInt16BE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 65535, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : F(this, e, t, !1), t + 2
            }, o.prototype.writeUInt32LE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 4294967295, 0), o.TYPED_ARRAY_SUPPORT ? (this[t + 3] = e >>> 24, this[t + 2] = e >>> 16, this[t + 1] = e >>> 8, this[t] = 255 & e) : D(this, e, t, !0), t + 4
            }, o.prototype.writeUInt32BE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 4294967295, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : D(this, e, t, !1), t + 4
            }, o.prototype.writeIntLE = function (e, t, i, r) {
                if (e = +e, t = 0 | t, !r) {
                    var n = Math.pow(2, 8 * i - 1);
                    I(this, e, t, i, n - 1, -n)
                }
                var o = 0, a = 1, s = 0 > e ? 1 : 0;
                for (this[t] = 255 & e; ++o < i && (a *= 256);)this[t + o] = (e / a >> 0) - s & 255;
                return t + i
            }, o.prototype.writeIntBE = function (e, t, i, r) {
                if (e = +e, t = 0 | t, !r) {
                    var n = Math.pow(2, 8 * i - 1);
                    I(this, e, t, i, n - 1, -n)
                }
                var o = i - 1, a = 1, s = 0 > e ? 1 : 0;
                for (this[t + o] = 255 & e; --o >= 0 && (a *= 256);)this[t + o] = (e / a >> 0) - s & 255;
                return t + i
            }, o.prototype.writeInt8 = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 1, 127, -128), o.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), 0 > e && (e = 255 + e + 1), this[t] = 255 & e, t + 1
            }, o.prototype.writeInt16LE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 32767, -32768), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : F(this, e, t, !0), t + 2
            }, o.prototype.writeInt16BE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 32767, -32768), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : F(this, e, t, !1), t + 2
            }, o.prototype.writeInt32LE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 2147483647, -2147483648), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8, this[t + 2] = e >>> 16, this[t + 3] = e >>> 24) : D(this, e, t, !0), t + 4
            }, o.prototype.writeInt32BE = function (e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 2147483647, -2147483648), 0 > e && (e = 4294967295 + e + 1), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : D(this, e, t, !1), t + 4
            }, o.prototype.writeFloatLE = function (e, t, i) {
                return N(this, e, t, !0, i)
            }, o.prototype.writeFloatBE = function (e, t, i) {
                return N(this, e, t, !1, i)
            }, o.prototype.writeDoubleLE = function (e, t, i) {
                return U(this, e, t, !0, i)
            }, o.prototype.writeDoubleBE = function (e, t, i) {
                return U(this, e, t, !1, i)
            }, o.prototype.copy = function (e, t, i, r) {
                if (i || (i = 0), r || 0 === r || (r = this.length), t >= e.length && (t = e.length), t || (t = 0), r > 0 && i > r && (r = i), r === i)return 0;
                if (0 === e.length || 0 === this.length)return 0;
                if (0 > t)throw new RangeError("targetStart out of bounds");
                if (0 > i || i >= this.length)throw new RangeError("sourceStart out of bounds");
                if (0 > r)throw new RangeError("sourceEnd out of bounds");
                r > this.length && (r = this.length), e.length - t < r - i && (r = e.length - t + i);
                var n, a = r - i;
                if (this === e && t > i && r > t)for (n = a - 1; n >= 0; n--)e[n + t] = this[n + i]; else if (1e3 > a || !o.TYPED_ARRAY_SUPPORT)for (n = 0; a > n; n++)e[n + t] = this[n + i]; else e._set(this.subarray(i, i + a), t);
                return a
            }, o.prototype.fill = function (e, t, i) {
                if (e || (e = 0), t || (t = 0), i || (i = this.length), t > i)throw new RangeError("end < start");
                if (i !== t && 0 !== this.length) {
                    if (0 > t || t >= this.length)throw new RangeError("start out of bounds");
                    if (0 > i || i > this.length)throw new RangeError("end out of bounds");
                    var r;
                    if ("number" == typeof e)for (r = t; i > r; r++)this[r] = e; else {
                        var n = H(e.toString()), o = n.length;
                        for (r = t; i > r; r++)this[r] = n[r % o]
                    }
                    return this
                }
            }, o.prototype.toArrayBuffer = function () {
                if ("undefined" != typeof Uint8Array) {
                    if (o.TYPED_ARRAY_SUPPORT)return new o(this).buffer;
                    for (var e = new Uint8Array(this.length), t = 0, i = e.length; i > t; t += 1)e[t] = this[t];
                    return e.buffer
                }
                throw new TypeError("Buffer.toArrayBuffer not supported in this browser")
            };
            var $ = o.prototype;
            o._augment = function (e) {
                return e.constructor = o, e._isBuffer = !0, e._set = e.set, e.get = $.get, e.set = $.set, e.write = $.write, e.toString = $.toString, e.toLocaleString = $.toString, e.toJSON = $.toJSON, e.equals = $.equals, e.compare = $.compare, e.indexOf = $.indexOf, e.copy = $.copy, e.slice = $.slice, e.readUIntLE = $.readUIntLE, e.readUIntBE = $.readUIntBE, e.readUInt8 = $.readUInt8, e.readUInt16LE = $.readUInt16LE, e.readUInt16BE = $.readUInt16BE, e.readUInt32LE = $.readUInt32LE, e.readUInt32BE = $.readUInt32BE, e.readIntLE = $.readIntLE, e.readIntBE = $.readIntBE, e.readInt8 = $.readInt8, e.readInt16LE = $.readInt16LE, e.readInt16BE = $.readInt16BE, e.readInt32LE = $.readInt32LE, e.readInt32BE = $.readInt32BE, e.readFloatLE = $.readFloatLE, e.readFloatBE = $.readFloatBE, e.readDoubleLE = $.readDoubleLE, e.readDoubleBE = $.readDoubleBE, e.writeUInt8 = $.writeUInt8, e.writeUIntLE = $.writeUIntLE, e.writeUIntBE = $.writeUIntBE, e.writeUInt16LE = $.writeUInt16LE, e.writeUInt16BE = $.writeUInt16BE, e.writeUInt32LE = $.writeUInt32LE, e.writeUInt32BE = $.writeUInt32BE, e.writeIntLE = $.writeIntLE, e.writeIntBE = $.writeIntBE, e.writeInt8 = $.writeInt8, e.writeInt16LE = $.writeInt16LE, e.writeInt16BE = $.writeInt16BE, e.writeInt32LE = $.writeInt32LE, e.writeInt32BE = $.writeInt32BE, e.writeFloatLE = $.writeFloatLE, e.writeFloatBE = $.writeFloatBE, e.writeDoubleLE = $.writeDoubleLE, e.writeDoubleBE = $.writeDoubleBE, e.fill = $.fill, e.inspect = $.inspect, e.toArrayBuffer = $.toArrayBuffer, e
            };
            var ee = /[^+\/0-9A-Za-z-_]/g
        }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {})
    }, {"base64-js": 85, ieee754: 86, isarray: 87}],
    85: [function (e, t, i) {
        var r = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
        !function (e) {
            "use strict";
            function t(e) {
                var t = e.charCodeAt(0);
                return t === a || t === c ? 62 : t === s || t === d ? 63 : h > t ? -1 : h + 10 > t ? t - h + 26 + 26 : u + 26 > t ? t - u : l + 26 > t ? t - l + 26 : void 0
            }

            function i(e) {
                function i(e) {
                    l[c++] = e
                }

                var r, n, a, s, h, l;
                if (e.length % 4 > 0)throw new Error("Invalid string. Length must be a multiple of 4");
                var u = e.length;
                h = "=" === e.charAt(u - 2) ? 2 : "=" === e.charAt(u - 1) ? 1 : 0, l = new o(3 * e.length / 4 - h), a = h > 0 ? e.length - 4 : e.length;
                var c = 0;
                for (r = 0, n = 0; a > r; r += 4, n += 3)s = t(e.charAt(r)) << 18 | t(e.charAt(r + 1)) << 12 | t(e.charAt(r + 2)) << 6 | t(e.charAt(r + 3)), i((16711680 & s) >> 16), i((65280 & s) >> 8), i(255 & s);
                return 2 === h ? (s = t(e.charAt(r)) << 2 | t(e.charAt(r + 1)) >> 4, i(255 & s)) : 1 === h && (s = t(e.charAt(r)) << 10 | t(e.charAt(r + 1)) << 4 | t(e.charAt(r + 2)) >> 2, i(s >> 8 & 255), i(255 & s)), l
            }

            function n(e) {
                function t(e) {
                    return r.charAt(e)
                }

                function i(e) {
                    return t(e >> 18 & 63) + t(e >> 12 & 63) + t(e >> 6 & 63) + t(63 & e)
                }

                var n, o, a, s = e.length % 3, h = "";
                for (n = 0, a = e.length - s; a > n; n += 3)o = (e[n] << 16) + (e[n + 1] << 8) + e[n + 2], h += i(o);
                switch (s) {
                    case 1:
                        o = e[e.length - 1], h += t(o >> 2), h += t(o << 4 & 63), h += "==";
                        break;
                    case 2:
                        o = (e[e.length - 2] << 8) + e[e.length - 1], h += t(o >> 10), h += t(o >> 4 & 63), h += t(o << 2 & 63), h += "="
                }
                return h
            }

            var o = "undefined" != typeof Uint8Array ? Uint8Array : Array, a = "+".charCodeAt(0), s = "/".charCodeAt(0), h = "0".charCodeAt(0), l = "a".charCodeAt(0), u = "A".charCodeAt(0), c = "-".charCodeAt(0), d = "_".charCodeAt(0);
            e.toByteArray = i, e.fromByteArray = n
        }("undefined" == typeof i ? this.base64js = {} : i)
    }, {}],
    86: [function (e, t, i) {
        i.read = function (e, t, i, r, n) {
            var o, a, s = 8 * n - r - 1, h = (1 << s) - 1, l = h >> 1, u = -7, c = i ? n - 1 : 0, d = i ? -1 : 1, f = e[t + c];
            for (c += d, o = f & (1 << -u) - 1, f >>= -u, u += s; u > 0; o = 256 * o + e[t + c], c += d, u -= 8);
            for (a = o & (1 << -u) - 1, o >>= -u, u += r; u > 0; a = 256 * a + e[t + c], c += d, u -= 8);
            if (0 === o)o = 1 - l; else {
                if (o === h)return a ? NaN : (f ? -1 : 1) * (1 / 0);
                a += Math.pow(2, r), o -= l
            }
            return (f ? -1 : 1) * a * Math.pow(2, o - r)
        }, i.write = function (e, t, i, r, n, o) {
            var a, s, h, l = 8 * o - n - 1, u = (1 << l) - 1, c = u >> 1, d = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f = r ? 0 : o - 1, p = r ? 1 : -1, m = 0 > t || 0 === t && 0 > 1 / t ? 1 : 0;
            for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0, a = u) : (a = Math.floor(Math.log(t) / Math.LN2), t * (h = Math.pow(2, -a)) < 1 && (a--, h *= 2), t += a + c >= 1 ? d / h : d * Math.pow(2, 1 - c), t * h >= 2 && (a++, h /= 2), a + c >= u ? (s = 0, a = u) : a + c >= 1 ? (s = (t * h - 1) * Math.pow(2, n), a += c) : (s = t * Math.pow(2, c - 1) * Math.pow(2, n), a = 0)); n >= 8; e[i + f] = 255 & s, f += p, s /= 256, n -= 8);
            for (a = a << n | s, l += n; l > 0; e[i + f] = 255 & a, f += p, a /= 256, l -= 8);
            e[i + f - p] |= 128 * m
        }
    }, {}],
    87: [function (e, t, i) {
        var r = {}.toString;
        t.exports = Array.isArray || function (e) {
                return "[object Array]" == r.call(e)
            }
    }, {}],
    88: [function (e, t, i) {
        function r() {
            this._events = this._events || {}, this._maxListeners = this._maxListeners || void 0
        }

        function n(e) {
            return "function" == typeof e
        }

        function o(e) {
            return "number" == typeof e
        }

        function a(e) {
            return "object" == typeof e && null !== e
        }

        function s(e) {
            return void 0 === e
        }

        t.exports = r, r.EventEmitter = r, r.prototype._events = void 0, r.prototype._maxListeners = void 0, r.defaultMaxListeners = 10, r.prototype.setMaxListeners = function (e) {
            if (!o(e) || 0 > e || isNaN(e))throw TypeError("n must be a positive number");
            return this._maxListeners = e, this
        }, r.prototype.emit = function (e) {
            var t, i, r, o, h, l;
            if (this._events || (this._events = {}), "error" === e && (!this._events.error || a(this._events.error) && !this._events.error.length)) {
                if (t = arguments[1], t instanceof Error)throw t;
                throw TypeError('Uncaught, unspecified "error" event.')
            }
            if (i = this._events[e], s(i))return !1;
            if (n(i))switch (arguments.length) {
                case 1:
                    i.call(this);
                    break;
                case 2:
                    i.call(this, arguments[1]);
                    break;
                case 3:
                    i.call(this, arguments[1], arguments[2]);
                    break;
                default:
                    for (r = arguments.length, o = new Array(r - 1), h = 1; r > h; h++)o[h - 1] = arguments[h];
                    i.apply(this, o)
            } else if (a(i)) {
                for (r = arguments.length, o = new Array(r - 1), h = 1; r > h; h++)o[h - 1] = arguments[h];
                for (l = i.slice(), r = l.length, h = 0; r > h; h++)l[h].apply(this, o)
            }
            return !0
        }, r.prototype.addListener = function (e, t) {
            var i;
            if (!n(t))throw TypeError("listener must be a function");
            if (this._events || (this._events = {}), this._events.newListener && this.emit("newListener", e, n(t.listener) ? t.listener : t), this._events[e] ? a(this._events[e]) ? this._events[e].push(t) : this._events[e] = [this._events[e], t] : this._events[e] = t, a(this._events[e]) && !this._events[e].warned) {
                var i;
                i = s(this._maxListeners) ? r.defaultMaxListeners : this._maxListeners, i && i > 0 && this._events[e].length > i && (this._events[e].warned = !0, console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.", this._events[e].length),
                "function" == typeof console.trace && console.trace())
            }
            return this
        }, r.prototype.on = r.prototype.addListener, r.prototype.once = function (e, t) {
            function i() {
                this.removeListener(e, i), r || (r = !0, t.apply(this, arguments))
            }

            if (!n(t))throw TypeError("listener must be a function");
            var r = !1;
            return i.listener = t, this.on(e, i), this
        }, r.prototype.removeListener = function (e, t) {
            var i, r, o, s;
            if (!n(t))throw TypeError("listener must be a function");
            if (!this._events || !this._events[e])return this;
            if (i = this._events[e], o = i.length, r = -1, i === t || n(i.listener) && i.listener === t)delete this._events[e], this._events.removeListener && this.emit("removeListener", e, t); else if (a(i)) {
                for (s = o; s-- > 0;)if (i[s] === t || i[s].listener && i[s].listener === t) {
                    r = s;
                    break
                }
                if (0 > r)return this;
                1 === i.length ? (i.length = 0, delete this._events[e]) : i.splice(r, 1), this._events.removeListener && this.emit("removeListener", e, t)
            }
            return this
        }, r.prototype.removeAllListeners = function (e) {
            var t, i;
            if (!this._events)return this;
            if (!this._events.removeListener)return 0 === arguments.length ? this._events = {} : this._events[e] && delete this._events[e], this;
            if (0 === arguments.length) {
                for (t in this._events)"removeListener" !== t && this.removeAllListeners(t);
                return this.removeAllListeners("removeListener"), this._events = {}, this
            }
            if (i = this._events[e], n(i))this.removeListener(e, i); else for (; i.length;)this.removeListener(e, i[i.length - 1]);
            return delete this._events[e], this
        }, r.prototype.listeners = function (e) {
            var t;
            return t = this._events && this._events[e] ? n(this._events[e]) ? [this._events[e]] : this._events[e].slice() : []
        }, r.listenerCount = function (e, t) {
            var i;
            return i = e._events && e._events[t] ? n(e._events[t]) ? 1 : e._events[t].length : 0
        }
    }, {}],
    89: [function (e, t, i) {
        (function (e) {
            function t(e, t) {
                for (var i = 0, r = e.length - 1; r >= 0; r--) {
                    var n = e[r];
                    "." === n ? e.splice(r, 1) : ".." === n ? (e.splice(r, 1), i++) : i && (e.splice(r, 1), i--)
                }
                if (t)for (; i--; i)e.unshift("..");
                return e
            }

            function r(e, t) {
                if (e.filter)return e.filter(t);
                for (var i = [], r = 0; r < e.length; r++)t(e[r], r, e) && i.push(e[r]);
                return i
            }

            var n = /^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/, o = function (e) {
                return n.exec(e).slice(1)
            };
            i.resolve = function () {
                for (var i = "", n = !1, o = arguments.length - 1; o >= -1 && !n; o--) {
                    var a = o >= 0 ? arguments[o] : e.cwd();
                    if ("string" != typeof a)throw new TypeError("Arguments to path.resolve must be strings");
                    a && (i = a + "/" + i, n = "/" === a.charAt(0))
                }
                return i = t(r(i.split("/"), function (e) {
                    return !!e
                }), !n).join("/"), (n ? "/" : "") + i || "."
            }, i.normalize = function (e) {
                var n = i.isAbsolute(e), o = "/" === a(e, -1);
                return e = t(r(e.split("/"), function (e) {
                    return !!e
                }), !n).join("/"), e || n || (e = "."), e && o && (e += "/"), (n ? "/" : "") + e
            }, i.isAbsolute = function (e) {
                return "/" === e.charAt(0)
            }, i.join = function () {
                var e = Array.prototype.slice.call(arguments, 0);
                return i.normalize(r(e, function (e, t) {
                    if ("string" != typeof e)throw new TypeError("Arguments to path.join must be strings");
                    return e
                }).join("/"))
            }, i.relative = function (e, t) {
                function r(e) {
                    for (var t = 0; t < e.length && "" === e[t]; t++);
                    for (var i = e.length - 1; i >= 0 && "" === e[i]; i--);
                    return t > i ? [] : e.slice(t, i - t + 1)
                }

                e = i.resolve(e).substr(1), t = i.resolve(t).substr(1);
                for (var n = r(e.split("/")), o = r(t.split("/")), a = Math.min(n.length, o.length), s = a, h = 0; a > h; h++)if (n[h] !== o[h]) {
                    s = h;
                    break
                }
                for (var l = [], h = s; h < n.length; h++)l.push("..");
                return l = l.concat(o.slice(s)), l.join("/")
            }, i.sep = "/", i.delimiter = ":", i.dirname = function (e) {
                var t = o(e), i = t[0], r = t[1];
                return i || r ? (r && (r = r.substr(0, r.length - 1)), i + r) : "."
            }, i.basename = function (e, t) {
                var i = o(e)[2];
                return t && i.substr(-1 * t.length) === t && (i = i.substr(0, i.length - t.length)), i
            }, i.extname = function (e) {
                return o(e)[3]
            };
            var a = "b" === "ab".substr(-1) ? function (e, t, i) {
                return e.substr(t, i)
            } : function (e, t, i) {
                return 0 > t && (t = e.length + t), e.substr(t, i)
            }
        }).call(this, e("_process"))
    }, {_process: 90}],
    90: [function (e, t, i) {
        function r() {
            if (!s) {
                s = !0;
                for (var e, t = a.length; t;) {
                    e = a, a = [];
                    for (var i = -1; ++i < t;)e[i]();
                    t = a.length
                }
                s = !1
            }
        }

        function n() {
        }

        var o = t.exports = {}, a = [], s = !1;
        o.nextTick = function (e) {
            a.push(e), s || setTimeout(r, 0)
        }, o.title = "browser", o.browser = !0, o.env = {}, o.argv = [], o.version = "", o.versions = {}, o.on = n, o.addListener = n, o.once = n, o.off = n, o.removeListener = n, o.removeAllListeners = n, o.emit = n, o.binding = function (e) {
            throw new Error("process.binding is not supported")
        }, o.cwd = function () {
            return "/"
        }, o.chdir = function (e) {
            throw new Error("process.chdir is not supported")
        }, o.umask = function () {
            return 0
        }
    }, {}],
    91: [function (e, t, i) {
        (function (e) {
            !function (r) {
                function n(e) {
                    throw RangeError(R[e])
                }

                function o(e, t) {
                    for (var i = e.length; i--;)e[i] = t(e[i]);
                    return e
                }

                function a(e, t) {
                    return o(e.split(B), t).join(".")
                }

                function s(e) {
                    for (var t, i, r = [], n = 0, o = e.length; o > n;)t = e.charCodeAt(n++), t >= 55296 && 56319 >= t && o > n ? (i = e.charCodeAt(n++), 56320 == (64512 & i) ? r.push(((1023 & t) << 10) + (1023 & i) + 65536) : (r.push(t), n--)) : r.push(t);
                    return r
                }

                function h(e) {
                    return o(e, function (e) {
                        var t = "";
                        return e > 65535 && (e -= 65536, t += D(e >>> 10 & 1023 | 55296), e = 56320 | 1023 & e), t += D(e)
                    }).join("")
                }

                function l(e) {
                    return 10 > e - 48 ? e - 22 : 26 > e - 65 ? e - 65 : 26 > e - 97 ? e - 97 : x
                }

                function u(e, t) {
                    return e + 22 + 75 * (26 > e) - ((0 != t) << 5)
                }

                function c(e, t, i) {
                    var r = 0;
                    for (e = i ? F(e / A) : e >> 1, e += F(e / t); e > I * E >> 1; r += x)e = F(e / I);
                    return F(r + (I + 1) * e / (e + M))
                }

                function d(e) {
                    var t, i, r, o, a, s, u, d, f, p, m = [], g = e.length, v = 0, y = C, b = T;
                    for (i = e.lastIndexOf(P), 0 > i && (i = 0), r = 0; i > r; ++r)e.charCodeAt(r) >= 128 && n("not-basic"), m.push(e.charCodeAt(r));
                    for (o = i > 0 ? i + 1 : 0; g > o;) {
                        for (a = v, s = 1, u = x; o >= g && n("invalid-input"), d = l(e.charCodeAt(o++)), (d >= x || d > F((_ - v) / s)) && n("overflow"), v += d * s, f = b >= u ? S : u >= b + E ? E : u - b, !(f > d); u += x)p = x - f, s > F(_ / p) && n("overflow"), s *= p;
                        t = m.length + 1, b = c(v - a, t, 0 == a), F(v / t) > _ - y && n("overflow"), y += F(v / t), v %= t, m.splice(v++, 0, y)
                    }
                    return h(m)
                }

                function f(e) {
                    var t, i, r, o, a, h, l, d, f, p, m, g, v, y, b, w = [];
                    for (e = s(e), g = e.length, t = C, i = 0, a = T, h = 0; g > h; ++h)m = e[h], 128 > m && w.push(D(m));
                    for (r = o = w.length, o && w.push(P); g > r;) {
                        for (l = _, h = 0; g > h; ++h)m = e[h], m >= t && l > m && (l = m);
                        for (v = r + 1, l - t > F((_ - i) / v) && n("overflow"), i += (l - t) * v, t = l, h = 0; g > h; ++h)if (m = e[h], t > m && ++i > _ && n("overflow"), m == t) {
                            for (d = i, f = x; p = a >= f ? S : f >= a + E ? E : f - a, !(p > d); f += x)b = d - p, y = x - p, w.push(D(u(p + b % y, 0))), d = F(b / y);
                            w.push(D(u(d, 0))), a = c(i, v, r == o), i = 0, ++r
                        }
                        ++i, ++t
                    }
                    return w.join("")
                }

                function p(e) {
                    return a(e, function (e) {
                        return L.test(e) ? d(e.slice(4).toLowerCase()) : e
                    })
                }

                function m(e) {
                    return a(e, function (e) {
                        return k.test(e) ? "xn--" + f(e) : e
                    })
                }

                var g = "object" == typeof i && i, v = "object" == typeof t && t && t.exports == g && t, y = "object" == typeof e && e;
                (y.global === y || y.window === y) && (r = y);
                var b, w, _ = 2147483647, x = 36, S = 1, E = 26, M = 38, A = 700, T = 72, C = 128, P = "-", L = /^xn--/, k = /[^ -~]/, B = /\x2E|\u3002|\uFF0E|\uFF61/g, R = {
                    overflow: "Overflow: input needs wider integers to process",
                    "not-basic": "Illegal input >= 0x80 (not a basic code point)",
                    "invalid-input": "Invalid input"
                }, I = x - S, F = Math.floor, D = String.fromCharCode;
                if (b = {
                        version: "1.2.4",
                        ucs2: {decode: s, encode: h},
                        decode: d,
                        encode: f,
                        toASCII: m,
                        toUnicode: p
                    }, "function" == typeof define && "object" == typeof define.amd && define.amd)define("punycode", function () {
                    return b
                }); else if (g && !g.nodeType)if (v)v.exports = b; else for (w in b)b.hasOwnProperty(w) && (g[w] = b[w]); else r.punycode = b
            }(this)
        }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {})
    }, {}],
    92: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            return Object.prototype.hasOwnProperty.call(e, t)
        }

        t.exports = function (e, t, i, o) {
            t = t || "&", i = i || "=";
            var a = {};
            if ("string" != typeof e || 0 === e.length)return a;
            var s = /\+/g;
            e = e.split(t);
            var h = 1e3;
            o && "number" == typeof o.maxKeys && (h = o.maxKeys);
            var l = e.length;
            h > 0 && l > h && (l = h);
            for (var u = 0; l > u; ++u) {
                var c, d, f, p, m = e[u].replace(s, "%20"), g = m.indexOf(i);
                g >= 0 ? (c = m.substr(0, g), d = m.substr(g + 1)) : (c = m, d = ""), f = decodeURIComponent(c), p = decodeURIComponent(d), r(a, f) ? n(a[f]) ? a[f].push(p) : a[f] = [a[f], p] : a[f] = p
            }
            return a
        };
        var n = Array.isArray || function (e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            }
    }, {}],
    93: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            if (e.map)return e.map(t);
            for (var i = [], r = 0; r < e.length; r++)i.push(t(e[r], r));
            return i
        }

        var n = function (e) {
            switch (typeof e) {
                case"string":
                    return e;
                case"boolean":
                    return e ? "true" : "false";
                case"number":
                    return isFinite(e) ? e : "";
                default:
                    return ""
            }
        };
        t.exports = function (e, t, i, s) {
            return t = t || "&", i = i || "=", null === e && (e = void 0), "object" == typeof e ? r(a(e), function (a) {
                var s = encodeURIComponent(n(a)) + i;
                return o(e[a]) ? r(e[a], function (e) {
                    return s + encodeURIComponent(n(e))
                }).join(t) : s + encodeURIComponent(n(e[a]))
            }).join(t) : s ? encodeURIComponent(n(s)) + i + encodeURIComponent(n(e)) : ""
        };
        var o = Array.isArray || function (e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            }, a = Object.keys || function (e) {
                var t = [];
                for (var i in e)Object.prototype.hasOwnProperty.call(e, i) && t.push(i);
                return t
            }
    }, {}],
    94: [function (e, t, i) {
        "use strict";
        i.decode = i.parse = e("./decode"), i.encode = i.stringify = e("./encode")
    }, {"./decode": 92, "./encode": 93}],
    95: [function (e, t, i) {
        function r() {
            this.protocol = null, this.slashes = null, this.auth = null, this.host = null, this.port = null, this.hostname = null, this.hash = null, this.search = null, this.query = null, this.pathname = null, this.path = null, this.href = null
        }

        function n(e, t, i) {
            if (e && l(e) && e instanceof r)return e;
            var n = new r;
            return n.parse(e, t, i), n
        }

        function o(e) {
            return h(e) && (e = n(e)), e instanceof r ? e.format() : r.prototype.format.call(e)
        }

        function a(e, t) {
            return n(e, !1, !0).resolve(t)
        }

        function s(e, t) {
            return e ? n(e, !1, !0).resolveObject(t) : t
        }

        function h(e) {
            return "string" == typeof e
        }

        function l(e) {
            return "object" == typeof e && null !== e
        }

        function u(e) {
            return null === e
        }

        function c(e) {
            return null == e
        }

        var d = e("punycode");
        i.parse = n, i.resolve = a, i.resolveObject = s, i.format = o, i.Url = r;
        var f = /^([a-z0-9.+-]+:)/i, p = /:[0-9]*$/, m = ["<", ">", '"', "`", " ", "\r", "\n", "	"], g = ["{", "}", "|", "\\", "^", "`"].concat(m), v = ["'"].concat(g), y = ["%", "/", "?", ";", "#"].concat(v), b = ["/", "?", "#"], w = 255, _ = /^[a-z0-9A-Z_-]{0,63}$/, x = /^([a-z0-9A-Z_-]{0,63})(.*)$/, S = {
            javascript: !0,
            "javascript:": !0
        }, E = {javascript: !0, "javascript:": !0}, M = {
            http: !0,
            https: !0,
            ftp: !0,
            gopher: !0,
            file: !0,
            "http:": !0,
            "https:": !0,
            "ftp:": !0,
            "gopher:": !0,
            "file:": !0
        }, A = e("querystring");
        r.prototype.parse = function (e, t, i) {
            if (!h(e))throw new TypeError("Parameter 'url' must be a string, not " + typeof e);
            var r = e;
            r = r.trim();
            var n = f.exec(r);
            if (n) {
                n = n[0];
                var o = n.toLowerCase();
                this.protocol = o, r = r.substr(n.length)
            }
            if (i || n || r.match(/^\/\/[^@\/]+@[^@\/]+/)) {
                var a = "//" === r.substr(0, 2);
                !a || n && E[n] || (r = r.substr(2), this.slashes = !0)
            }
            if (!E[n] && (a || n && !M[n])) {
                for (var s = -1, l = 0; l < b.length; l++) {
                    var u = r.indexOf(b[l]);
                    -1 !== u && (-1 === s || s > u) && (s = u)
                }
                var c, p;
                p = -1 === s ? r.lastIndexOf("@") : r.lastIndexOf("@", s), -1 !== p && (c = r.slice(0, p), r = r.slice(p + 1), this.auth = decodeURIComponent(c)), s = -1;
                for (var l = 0; l < y.length; l++) {
                    var u = r.indexOf(y[l]);
                    -1 !== u && (-1 === s || s > u) && (s = u)
                }
                -1 === s && (s = r.length), this.host = r.slice(0, s), r = r.slice(s), this.parseHost(), this.hostname = this.hostname || "";
                var m = "[" === this.hostname[0] && "]" === this.hostname[this.hostname.length - 1];
                if (!m)for (var g = this.hostname.split(/\./), l = 0, T = g.length; T > l; l++) {
                    var C = g[l];
                    if (C && !C.match(_)) {
                        for (var P = "", L = 0, k = C.length; k > L; L++)P += C.charCodeAt(L) > 127 ? "x" : C[L];
                        if (!P.match(_)) {
                            var B = g.slice(0, l), R = g.slice(l + 1), I = C.match(x);
                            I && (B.push(I[1]), R.unshift(I[2])), R.length && (r = "/" + R.join(".") + r), this.hostname = B.join(".");
                            break
                        }
                    }
                }
                if (this.hostname.length > w ? this.hostname = "" : this.hostname = this.hostname.toLowerCase(), !m) {
                    for (var F = this.hostname.split("."), D = [], l = 0; l < F.length; ++l) {
                        var O = F[l];
                        D.push(O.match(/[^A-Za-z0-9_-]/) ? "xn--" + d.encode(O) : O)
                    }
                    this.hostname = D.join(".")
                }
                var N = this.port ? ":" + this.port : "", U = this.hostname || "";
                this.host = U + N, this.href += this.host, m && (this.hostname = this.hostname.substr(1, this.hostname.length - 2), "/" !== r[0] && (r = "/" + r))
            }
            if (!S[o])for (var l = 0, T = v.length; T > l; l++) {
                var z = v[l], V = encodeURIComponent(z);
                V === z && (V = escape(z)), r = r.split(z).join(V)
            }
            var W = r.indexOf("#");
            -1 !== W && (this.hash = r.substr(W), r = r.slice(0, W));
            var H = r.indexOf("?");
            if (-1 !== H ? (this.search = r.substr(H), this.query = r.substr(H + 1), t && (this.query = A.parse(this.query)), r = r.slice(0, H)) : t && (this.search = "", this.query = {}), r && (this.pathname = r), M[o] && this.hostname && !this.pathname && (this.pathname = "/"), this.pathname || this.search) {
                var N = this.pathname || "", O = this.search || "";
                this.path = N + O
            }
            return this.href = this.format(), this
        }, r.prototype.format = function () {
            var e = this.auth || "";
            e && (e = encodeURIComponent(e), e = e.replace(/%3A/i, ":"), e += "@");
            var t = this.protocol || "", i = this.pathname || "", r = this.hash || "", n = !1, o = "";
            this.host ? n = e + this.host : this.hostname && (n = e + (-1 === this.hostname.indexOf(":") ? this.hostname : "[" + this.hostname + "]"), this.port && (n += ":" + this.port)), this.query && l(this.query) && Object.keys(this.query).length && (o = A.stringify(this.query));
            var a = this.search || o && "?" + o || "";
            return t && ":" !== t.substr(-1) && (t += ":"), this.slashes || (!t || M[t]) && n !== !1 ? (n = "//" + (n || ""), i && "/" !== i.charAt(0) && (i = "/" + i)) : n || (n = ""), r && "#" !== r.charAt(0) && (r = "#" + r), a && "?" !== a.charAt(0) && (a = "?" + a), i = i.replace(/[?#]/g, function (e) {
                return encodeURIComponent(e)
            }), a = a.replace("#", "%23"), t + n + i + a + r
        }, r.prototype.resolve = function (e) {
            return this.resolveObject(n(e, !1, !0)).format()
        }, r.prototype.resolveObject = function (e) {
            if (h(e)) {
                var t = new r;
                t.parse(e, !1, !0), e = t
            }
            var i = new r;
            if (Object.keys(this).forEach(function (e) {
                    i[e] = this[e]
                }, this), i.hash = e.hash, "" === e.href)return i.href = i.format(), i;
            if (e.slashes && !e.protocol)return Object.keys(e).forEach(function (t) {
                "protocol" !== t && (i[t] = e[t])
            }), M[i.protocol] && i.hostname && !i.pathname && (i.path = i.pathname = "/"), i.href = i.format(), i;
            if (e.protocol && e.protocol !== i.protocol) {
                if (!M[e.protocol])return Object.keys(e).forEach(function (t) {
                    i[t] = e[t]
                }), i.href = i.format(), i;
                if (i.protocol = e.protocol, e.host || E[e.protocol])i.pathname = e.pathname; else {
                    for (var n = (e.pathname || "").split("/"); n.length && !(e.host = n.shift()););
                    e.host || (e.host = ""), e.hostname || (e.hostname = ""), "" !== n[0] && n.unshift(""), n.length < 2 && n.unshift(""), i.pathname = n.join("/")
                }
                if (i.search = e.search, i.query = e.query, i.host = e.host || "", i.auth = e.auth, i.hostname = e.hostname || e.host, i.port = e.port, i.pathname || i.search) {
                    var o = i.pathname || "", a = i.search || "";
                    i.path = o + a
                }
                return i.slashes = i.slashes || e.slashes, i.href = i.format(), i
            }
            var s = i.pathname && "/" === i.pathname.charAt(0), l = e.host || e.pathname && "/" === e.pathname.charAt(0), d = l || s || i.host && e.pathname, f = d, p = i.pathname && i.pathname.split("/") || [], n = e.pathname && e.pathname.split("/") || [], m = i.protocol && !M[i.protocol];
            if (m && (i.hostname = "", i.port = null, i.host && ("" === p[0] ? p[0] = i.host : p.unshift(i.host)), i.host = "", e.protocol && (e.hostname = null, e.port = null, e.host && ("" === n[0] ? n[0] = e.host : n.unshift(e.host)), e.host = null), d = d && ("" === n[0] || "" === p[0])), l)i.host = e.host || "" === e.host ? e.host : i.host, i.hostname = e.hostname || "" === e.hostname ? e.hostname : i.hostname, i.search = e.search, i.query = e.query, p = n; else if (n.length)p || (p = []), p.pop(), p = p.concat(n), i.search = e.search, i.query = e.query; else if (!c(e.search)) {
                if (m) {
                    i.hostname = i.host = p.shift();
                    var g = i.host && i.host.indexOf("@") > 0 ? i.host.split("@") : !1;
                    g && (i.auth = g.shift(), i.host = i.hostname = g.shift())
                }
                return i.search = e.search, i.query = e.query, u(i.pathname) && u(i.search) || (i.path = (i.pathname ? i.pathname : "") + (i.search ? i.search : "")), i.href = i.format(), i
            }
            if (!p.length)return i.pathname = null, i.search ? i.path = "/" + i.search : i.path = null, i.href = i.format(), i;
            for (var v = p.slice(-1)[0], y = (i.host || e.host) && ("." === v || ".." === v) || "" === v, b = 0, w = p.length; w >= 0; w--)v = p[w], "." == v ? p.splice(w, 1) : ".." === v ? (p.splice(w, 1), b++) : b && (p.splice(w, 1), b--);
            if (!d && !f)for (; b--; b)p.unshift("..");
            !d || "" === p[0] || p[0] && "/" === p[0].charAt(0) || p.unshift(""), y && "/" !== p.join("/").substr(-1) && p.push("");
            var _ = "" === p[0] || p[0] && "/" === p[0].charAt(0);
            if (m) {
                i.hostname = i.host = _ ? "" : p.length ? p.shift() : "";
                var g = i.host && i.host.indexOf("@") > 0 ? i.host.split("@") : !1;
                g && (i.auth = g.shift(), i.host = i.hostname = g.shift())
            }
            return d = d || i.host && p.length, d && !_ && p.unshift(""), p.length ? i.pathname = p.join("/") : (i.pathname = null, i.path = null), u(i.pathname) && u(i.search) || (i.path = (i.pathname ? i.pathname : "") + (i.search ? i.search : "")), i.auth = e.auth || i.auth, i.slashes = i.slashes || e.slashes, i.href = i.format(), i
        }, r.prototype.parseHost = function () {
            var e = this.host, t = p.exec(e);
            t && (t = t[0], ":" !== t && (this.port = t.substr(1)), e = e.substr(0, e.length - t.length)), e && (this.hostname = e)
        }
    }, {punycode: 91, querystring: 94}],
    96: [function (e, t, i) {
        "use strict";
        var r = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
        i.encode = function (e, t) {
            for (var i, n, o, a, s, h, l, u = "", c = 0; c < e.length;)i = e.charCodeAt(c++), n = e.charCodeAt(c++), o = e.charCodeAt(c++), a = i >> 2, s = (3 & i) << 4 | n >> 4, h = (15 & n) << 2 | o >> 6, l = 63 & o, isNaN(n) ? h = l = 64 : isNaN(o) && (l = 64), u = u + r.charAt(a) + r.charAt(s) + r.charAt(h) + r.charAt(l);
            return u
        }, i.decode = function (e, t) {
            var i, n, o, a, s, h, l, u = "", c = 0;
            for (e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); c < e.length;)a = r.indexOf(e.charAt(c++)), s = r.indexOf(e.charAt(c++)), h = r.indexOf(e.charAt(c++)), l = r.indexOf(e.charAt(c++)), i = a << 2 | s >> 4, n = (15 & s) << 4 | h >> 2, o = (3 & h) << 6 | l, u += String.fromCharCode(i), 64 != h && (u += String.fromCharCode(n)), 64 != l && (u += String.fromCharCode(o));
            return u
        }
    }, {}],
    97: [function (e, t, i) {
        "use strict";
        function r() {
            this.compressedSize = 0, this.uncompressedSize = 0, this.crc32 = 0, this.compressionMethod = null, this.compressedContent = null
        }

        r.prototype = {
            getContent: function () {
                return null
            }, getCompressedContent: function () {
                return null
            }
        }, t.exports = r
    }, {}],
    98: [function (e, t, i) {
        "use strict";
        i.STORE = {
            magic: "\x00\x00", compress: function (e, t) {
                return e
            }, uncompress: function (e) {
                return e
            }, compressInputType: null, uncompressInputType: null
        }, i.DEFLATE = e("./flate")
    }, {"./flate": 103}],
    99: [function (e, t, i) {
        "use strict";
        var r = e("./utils"), n = [0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615, 3915621685, 2657392035, 249268274, 2044508324, 3772115230, 2547177864, 162941995, 2125561021, 3887607047, 2428444049, 498536548, 1789927666, 4089016648, 2227061214, 450548861, 1843258603, 4107580753, 2211677639, 325883990, 1684777152, 4251122042, 2321926636, 335633487, 1661365465, 4195302755, 2366115317, 997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 901097722, 1119000684, 3686517206, 2898065728, 853044451, 1172266101, 3705015759, 2882616665, 651767980, 1373503546, 3369554304, 3218104598, 565507253, 1454621731, 3485111705, 3099436303, 671266974, 1594198024, 3322730930, 2970347812, 795835527, 1483230225, 3244367275, 3060149565, 1994146192, 31158534, 2563907772, 4023717930, 1907459465, 112637215, 2680153253, 3904427059, 2013776290, 251722036, 2517215374, 3775830040, 2137656763, 141376813, 2439277719, 3865271297, 1802195444, 476864866, 2238001368, 4066508878, 1812370925, 453092731, 2181625025, 4111451223, 1706088902, 314042704, 2344532202, 4240017532, 1658658271, 366619977, 2362670323, 4224994405, 1303535960, 984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 879679996, 2909243462, 3663771856, 1141124467, 855842277, 2852801631, 3708648649, 1342533948, 654459306, 3188396048, 3373015174, 1466479909, 544179635, 3110523913, 3462522015, 1591671054, 702138776, 2966460450, 3352799412, 1504918807, 783551873, 3082640443, 3233442989, 3988292384, 2596254646, 62317068, 1957810842, 3939845945, 2647816111, 81470997, 1943803523, 3814918930, 2489596804, 225274430, 2053790376, 3826175755, 2466906013, 167816743, 2097651377, 4027552580, 2265490386, 503444072, 1762050814, 4150417245, 2154129355, 426522225, 1852507879, 4275313526, 2312317920, 282753626, 1742555852, 4189708143, 2394877945, 397917763, 1622183637, 3604390888, 2714866558, 953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 906185462, 1090812512, 3747672003, 2825379669, 829329135, 1181335161, 3412177804, 3160834842, 628085408, 1382605366, 3423369109, 3138078467, 570562233, 1426400815, 3317316542, 2998733608, 733239954, 1555261956, 3268935591, 3050360625, 752459403, 1541320221, 2607071920, 3965973030, 1969922972, 40735498, 2617837225, 3943577151, 1913087877, 83908371, 2512341634, 3803740692, 2075208622, 213261112, 2463272603, 3855990285, 2094854071, 198958881, 2262029012, 4057260610, 1759359992, 534414190, 2176718541, 4139329115, 1873836001, 414664567, 2282248934, 4279200368, 1711684554, 285281116, 2405801727, 4167216745, 1634467795, 376229701, 2685067896, 3608007406, 1308918612, 956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 936918e3, 2847714899, 3736837829, 1202900863, 817233897, 3183342108, 3401237130, 1404277552, 615818150, 3134207493, 3453421203, 1423857449, 601450431, 3009837614, 3294710456, 1567103746, 711928724, 3020668471, 3272380065, 1510334235, 755167117];
        t.exports = function (e, t) {
            if ("undefined" == typeof e || !e.length)return 0;
            var i = "string" !== r.getTypeOf(e);
            "undefined" == typeof t && (t = 0);
            var o = 0, a = 0, s = 0;
            t = -1 ^ t;
            for (var h = 0, l = e.length; l > h; h++)s = i ? e[h] : e.charCodeAt(h), a = 255 & (t ^ s), o = n[a], t = t >>> 8 ^ o;
            return -1 ^ t
        }
    }, {"./utils": 116}],
    100: [function (e, t, i) {
        "use strict";
        function r(e) {
            this.data = null, this.length = 0, this.index = 0
        }

        var n = e("./utils");
        r.prototype = {
            checkOffset: function (e) {
                this.checkIndex(this.index + e)
            }, checkIndex: function (e) {
                if (this.length < e || 0 > e)throw new Error("End of data reached (data length = " + this.length + ", asked index = " + e + "). Corrupted zip ?")
            }, setIndex: function (e) {
                this.checkIndex(e), this.index = e
            }, skip: function (e) {
                this.setIndex(this.index + e)
            }, byteAt: function (e) {
            }, readInt: function (e) {
                var t, i = 0;
                for (this.checkOffset(e), t = this.index + e - 1; t >= this.index; t--)i = (i << 8) + this.byteAt(t);
                return this.index += e, i
            }, readString: function (e) {
                return n.transformTo("string", this.readData(e))
            }, readData: function (e) {
            }, lastIndexOfSignature: function (e) {
            }, readDate: function () {
                var e = this.readInt(4);
                return new Date((e >> 25 & 127) + 1980, (e >> 21 & 15) - 1, e >> 16 & 31, e >> 11 & 31, e >> 5 & 63, (31 & e) << 1)
            }
        }, t.exports = r
    }, {"./utils": 116}],
    101: [function (e, t, i) {
        "use strict";
        i.base64 = !1, i.binary = !1, i.dir = !1, i.createFolders = !1, i.date = null, i.compression = null, i.compressionOptions = null, i.comment = null, i.unixPermissions = null, i.dosPermissions = null
    }, {}],
    102: [function (e, t, i) {
        "use strict";
        var r = e("./utils");
        i.string2binary = function (e) {
            return r.string2binary(e)
        }, i.string2Uint8Array = function (e) {
            return r.transformTo("uint8array", e)
        }, i.uint8Array2String = function (e) {
            return r.transformTo("string", e)
        }, i.string2Blob = function (e) {
            var t = r.transformTo("arraybuffer", e);
            return r.arrayBuffer2Blob(t)
        }, i.arrayBuffer2Blob = function (e) {
            return r.arrayBuffer2Blob(e)
        }, i.transformTo = function (e, t) {
            return r.transformTo(e, t)
        }, i.getTypeOf = function (e) {
            return r.getTypeOf(e)
        }, i.checkSupport = function (e) {
            return r.checkSupport(e)
        }, i.MAX_VALUE_16BITS = r.MAX_VALUE_16BITS, i.MAX_VALUE_32BITS = r.MAX_VALUE_32BITS, i.pretty = function (e) {
            return r.pretty(e)
        }, i.findCompression = function (e) {
            return r.findCompression(e)
        }, i.isRegExp = function (e) {
            return r.isRegExp(e)
        }
    }, {"./utils": 116}],
    103: [function (e, t, i) {
        "use strict";
        var r = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array, n = e("pako");
        i.uncompressInputType = r ? "uint8array" : "array", i.compressInputType = r ? "uint8array" : "array", i.magic = "\b\x00", i.compress = function (e, t) {
            return n.deflateRaw(e, {level: t.level || -1})
        }, i.uncompress = function (e) {
            return n.inflateRaw(e)
        }
    }, {pako: 119}],
    104: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            return this instanceof r ? (this.files = {}, this.comment = null, this.root = "", e && this.load(e, t), void(this.clone = function () {
                var e = new r;
                for (var t in this)"function" != typeof this[t] && (e[t] = this[t]);
                return e
            })) : new r(e, t)
        }

        var n = e("./base64");
        r.prototype = e("./object"), r.prototype.load = e("./load"), r.support = e("./support"), r.defaults = e("./defaults"), r.utils = e("./deprecatedPublicUtils"), r.base64 = {
            encode: function (e) {
                return n.encode(e)
            }, decode: function (e) {
                return n.decode(e)
            }
        }, r.compressions = e("./compressions"), t.exports = r
    }, {
        "./base64": 96,
        "./compressions": 98,
        "./defaults": 101,
        "./deprecatedPublicUtils": 102,
        "./load": 105,
        "./object": 108,
        "./support": 112
    }],
    105: [function (e, t, i) {
        "use strict";
        var r = e("./base64"), n = e("./zipEntries");
        t.exports = function (e, t) {
            var i, o, a, s;
            for (t = t || {}, t.base64 && (e = r.decode(e)), o = new n(e, t), i = o.files, a = 0; a < i.length; a++)s = i[a], this.file(s.fileName, s.decompressed, {
                binary: !0,
                optimizedBinaryString: !0,
                date: s.date,
                dir: s.dir,
                comment: s.fileComment.length ? s.fileComment : null,
                unixPermissions: s.unixPermissions,
                dosPermissions: s.dosPermissions,
                createFolders: t.createFolders
            });
            return o.zipComment.length && (this.comment = o.zipComment), this
        }
    }, {"./base64": 96, "./zipEntries": 117}],
    106: [function (e, t, i) {
        (function (e) {
            "use strict";
            t.exports = function (t, i) {
                return new e(t, i)
            }, t.exports.test = function (t) {
                return e.isBuffer(t)
            }
        }).call(this, e("buffer").Buffer)
    }, {buffer: 84}],
    107: [function (e, t, i) {
        "use strict";
        function r(e) {
            this.data = e, this.length = this.data.length, this.index = 0
        }

        var n = e("./uint8ArrayReader");
        r.prototype = new n, r.prototype.readData = function (e) {
            this.checkOffset(e);
            var t = this.data.slice(this.index, this.index + e);
            return this.index += e, t
        }, t.exports = r
    }, {"./uint8ArrayReader": 113}],
    108: [function (e, t, i) {
        "use strict";
        var r = e("./support"), n = e("./utils"), o = e("./crc32"), a = e("./signature"), s = e("./defaults"), h = e("./base64"), l = e("./compressions"), u = e("./compressedObject"), c = e("./nodeBuffer"), d = e("./utf8"), f = e("./stringWriter"), p = e("./uint8ArrayWriter"), m = function (e) {
            if (e._data instanceof u && (e._data = e._data.getContent(), e.options.binary = !0, e.options.base64 = !1, "uint8array" === n.getTypeOf(e._data))) {
                var t = e._data;
                e._data = new Uint8Array(t.length), 0 !== t.length && e._data.set(t, 0)
            }
            return e._data
        }, g = function (e) {
            var t = m(e), i = n.getTypeOf(t);
            return "string" === i ? !e.options.binary && r.nodebuffer ? c(t, "utf-8") : e.asBinary() : t
        }, v = function (e) {
            var t = m(this);
            return null === t || "undefined" == typeof t ? "" : (this.options.base64 && (t = h.decode(t)), t = e && this.options.binary ? L.utf8decode(t) : n.transformTo("string", t), e || this.options.binary || (t = n.transformTo("string", L.utf8encode(t))), t)
        }, y = function (e, t, i) {
            this.name = e, this.dir = i.dir, this.date = i.date, this.comment = i.comment, this.unixPermissions = i.unixPermissions, this.dosPermissions = i.dosPermissions, this._data = t, this.options = i, this._initialMetadata = {
                dir: i.dir,
                date: i.date
            }
        };
        y.prototype = {
            asText: function () {
                return v.call(this, !0)
            }, asBinary: function () {
                return v.call(this, !1)
            }, asNodeBuffer: function () {
                var e = g(this);
                return n.transformTo("nodebuffer", e)
            }, asUint8Array: function () {
                var e = g(this);
                return n.transformTo("uint8array", e)
            }, asArrayBuffer: function () {
                return this.asUint8Array().buffer
            }
        };
        var b = function (e, t) {
            var i, r = "";
            for (i = 0; t > i; i++)r += String.fromCharCode(255 & e), e >>>= 8;
            return r
        }, w = function () {
            var e, t, i = {};
            for (e = 0; e < arguments.length; e++)for (t in arguments[e])arguments[e].hasOwnProperty(t) && "undefined" == typeof i[t] && (i[t] = arguments[e][t]);
            return i
        }, _ = function (e) {
            return e = e || {}, e.base64 !== !0 || null !== e.binary && void 0 !== e.binary || (e.binary = !0), e = w(e, s), e.date = e.date || new Date, null !== e.compression && (e.compression = e.compression.toUpperCase()), e
        }, x = function (e, t, i) {
            var r, o = n.getTypeOf(t);
            if (i = _(i), "string" == typeof i.unixPermissions && (i.unixPermissions = parseInt(i.unixPermissions, 8)), i.unixPermissions && 16384 & i.unixPermissions && (i.dir = !0), i.dosPermissions && 16 & i.dosPermissions && (i.dir = !0), i.dir && (e = E(e)), i.createFolders && (r = S(e)) && M.call(this, r, !0), i.dir || null === t || "undefined" == typeof t)i.base64 = !1, i.binary = !1, t = null, o = null; else if ("string" === o)i.binary && !i.base64 && i.optimizedBinaryString !== !0 && (t = n.string2binary(t)); else {
                if (i.base64 = !1, i.binary = !0, !(o || t instanceof u))throw new Error("The data of '" + e + "' is in an unsupported format !");
                "arraybuffer" === o && (t = n.transformTo("uint8array", t))
            }
            var a = new y(e, t, i);
            return this.files[e] = a, a
        }, S = function (e) {
            "/" == e.slice(-1) && (e = e.substring(0, e.length - 1));
            var t = e.lastIndexOf("/");
            return t > 0 ? e.substring(0, t) : ""
        }, E = function (e) {
            return "/" != e.slice(-1) && (e += "/"), e
        }, M = function (e, t) {
            return t = "undefined" != typeof t ? t : !1, e = E(e), this.files[e] || x.call(this, e, null, {
                dir: !0,
                createFolders: t
            }), this.files[e]
        }, A = function (e, t, i) {
            var r, a = new u;
            return e._data instanceof u ? (a.uncompressedSize = e._data.uncompressedSize, a.crc32 = e._data.crc32, 0 === a.uncompressedSize || e.dir ? (t = l.STORE, a.compressedContent = "", a.crc32 = 0) : e._data.compressionMethod === t.magic ? a.compressedContent = e._data.getCompressedContent() : (r = e._data.getContent(), a.compressedContent = t.compress(n.transformTo(t.compressInputType, r), i))) : (r = g(e), (!r || 0 === r.length || e.dir) && (t = l.STORE, r = ""), a.uncompressedSize = r.length, a.crc32 = o(r), a.compressedContent = t.compress(n.transformTo(t.compressInputType, r), i)), a.compressedSize = a.compressedContent.length, a.compressionMethod = t.magic, a
        }, T = function (e, t) {
            var i = e;
            return e || (i = t ? 16893 : 33204), (65535 & i) << 16
        }, C = function (e, t) {
            return 63 & (e || 0)
        }, P = function (e, t, i, r, s) {
            var h, l, u, c, f = (i.compressedContent, n.transformTo("string", d.utf8encode(t.name))), p = t.comment || "", m = n.transformTo("string", d.utf8encode(p)), g = f.length !== t.name.length, v = m.length !== p.length, y = t.options, w = "", _ = "", x = "";
            u = t._initialMetadata.dir !== t.dir ? t.dir : y.dir, c = t._initialMetadata.date !== t.date ? t.date : y.date;
            var S = 0, E = 0;
            u && (S |= 16), "UNIX" === s ? (E = 798, S |= T(t.unixPermissions, u)) : (E = 20, S |= C(t.dosPermissions, u)), h = c.getHours(), h <<= 6, h |= c.getMinutes(), h <<= 5, h |= c.getSeconds() / 2, l = c.getFullYear() - 1980, l <<= 4, l |= c.getMonth() + 1, l <<= 5, l |= c.getDate(), g && (_ = b(1, 1) + b(o(f), 4) + f, w += "up" + b(_.length, 2) + _), v && (x = b(1, 1) + b(this.crc32(m), 4) + m, w += "uc" + b(x.length, 2) + x);
            var M = "";
            M += "\n\x00", M += g || v ? "\x00\b" : "\x00\x00", M += i.compressionMethod, M += b(h, 2), M += b(l, 2), M += b(i.crc32, 4), M += b(i.compressedSize, 4), M += b(i.uncompressedSize, 4), M += b(f.length, 2), M += b(w.length, 2);
            var A = a.LOCAL_FILE_HEADER + M + f + w, P = a.CENTRAL_FILE_HEADER + b(E, 2) + M + b(m.length, 2) + "\x00\x00\x00\x00" + b(S, 4) + b(r, 4) + f + w + m;
            return {fileRecord: A, dirRecord: P, compressedObject: i}
        }, L = {
            load: function (e, t) {
                throw new Error("Load method is not defined. Is the file jszip-load.js included ?")
            }, filter: function (e) {
                var t, i, r, n, o = [];
                for (t in this.files)this.files.hasOwnProperty(t) && (r = this.files[t], n = new y(r.name, r._data, w(r.options)), i = t.slice(this.root.length, t.length), t.slice(0, this.root.length) === this.root && e(i, n) && o.push(n));
                return o
            }, file: function (e, t, i) {
                if (1 === arguments.length) {
                    if (n.isRegExp(e)) {
                        var r = e;
                        return this.filter(function (e, t) {
                            return !t.dir && r.test(e)
                        })
                    }
                    return this.filter(function (t, i) {
                            return !i.dir && t === e
                        })[0] || null
                }
                return e = this.root + e, x.call(this, e, t, i), this
            }, folder: function (e) {
                if (!e)return this;
                if (n.isRegExp(e))return this.filter(function (t, i) {
                    return i.dir && e.test(t)
                });
                var t = this.root + e, i = M.call(this, t), r = this.clone();
                return r.root = i.name, r
            }, remove: function (e) {
                e = this.root + e;
                var t = this.files[e];
                if (t || ("/" != e.slice(-1) && (e += "/"), t = this.files[e]), t && !t.dir)delete this.files[e]; else for (var i = this.filter(function (t, i) {
                    return i.name.slice(0, e.length) === e
                }), r = 0; r < i.length; r++)delete this.files[i[r].name];
                return this
            }, generate: function (e) {
                e = w(e || {}, {
                    base64: !0,
                    compression: "STORE",
                    compressionOptions: null,
                    type: "base64",
                    platform: "DOS",
                    comment: null,
                    mimeType: "application/zip"
                }), n.checkSupport(e.type), ("darwin" === e.platform || "freebsd" === e.platform || "linux" === e.platform || "sunos" === e.platform) && (e.platform = "UNIX"), "win32" === e.platform && (e.platform = "DOS");
                var t, i, r = [], o = 0, s = 0, u = n.transformTo("string", this.utf8encode(e.comment || this.comment || ""));
                for (var c in this.files)if (this.files.hasOwnProperty(c)) {
                    var d = this.files[c], m = d.options.compression || e.compression.toUpperCase(), g = l[m];
                    if (!g)throw new Error(m + " is not a valid compression method !");
                    var v = d.options.compressionOptions || e.compressionOptions || {}, y = A.call(this, d, g, v), _ = P.call(this, c, d, y, o, e.platform);
                    o += _.fileRecord.length + y.compressedSize, s += _.dirRecord.length, r.push(_)
                }
                var x = "";
                x = a.CENTRAL_DIRECTORY_END + "\x00\x00\x00\x00" + b(r.length, 2) + b(r.length, 2) + b(s, 4) + b(o, 4) + b(u.length, 2) + u;
                var S = e.type.toLowerCase();
                for (t = "uint8array" === S || "arraybuffer" === S || "blob" === S || "nodebuffer" === S ? new p(o + s + x.length) : new f(o + s + x.length), i = 0; i < r.length; i++)t.append(r[i].fileRecord), t.append(r[i].compressedObject.compressedContent);
                for (i = 0; i < r.length; i++)t.append(r[i].dirRecord);
                t.append(x);
                var E = t.finalize();
                switch (e.type.toLowerCase()) {
                    case"uint8array":
                    case"arraybuffer":
                    case"nodebuffer":
                        return n.transformTo(e.type.toLowerCase(), E);
                    case"blob":
                        return n.arrayBuffer2Blob(n.transformTo("arraybuffer", E), e.mimeType);
                    case"base64":
                        return e.base64 ? h.encode(E) : E;
                    default:
                        return E
                }
            }, crc32: function (e, t) {
                return o(e, t)
            }, utf8encode: function (e) {
                return n.transformTo("string", d.utf8encode(e))
            }, utf8decode: function (e) {
                return d.utf8decode(e)
            }
        };
        t.exports = L
    }, {
        "./base64": 96,
        "./compressedObject": 97,
        "./compressions": 98,
        "./crc32": 99,
        "./defaults": 101,
        "./nodeBuffer": 106,
        "./signature": 109,
        "./stringWriter": 111,
        "./support": 112,
        "./uint8ArrayWriter": 114,
        "./utf8": 115,
        "./utils": 116
    }],
    109: [function (e, t, i) {
        "use strict";
        i.LOCAL_FILE_HEADER = "PK", i.CENTRAL_FILE_HEADER = "PK", i.CENTRAL_DIRECTORY_END = "PK", i.ZIP64_CENTRAL_DIRECTORY_LOCATOR = "PK", i.ZIP64_CENTRAL_DIRECTORY_END = "PK", i.DATA_DESCRIPTOR = "PK\b"
    }, {}],
    110: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            this.data = e, t || (this.data = o.string2binary(this.data)), this.length = this.data.length,
                this.index = 0
        }

        var n = e("./dataReader"), o = e("./utils");
        r.prototype = new n, r.prototype.byteAt = function (e) {
            return this.data.charCodeAt(e)
        }, r.prototype.lastIndexOfSignature = function (e) {
            return this.data.lastIndexOf(e)
        }, r.prototype.readData = function (e) {
            this.checkOffset(e);
            var t = this.data.slice(this.index, this.index + e);
            return this.index += e, t
        }, t.exports = r
    }, {"./dataReader": 100, "./utils": 116}],
    111: [function (e, t, i) {
        "use strict";
        var r = e("./utils"), n = function () {
            this.data = []
        };
        n.prototype = {
            append: function (e) {
                e = r.transformTo("string", e), this.data.push(e)
            }, finalize: function () {
                return this.data.join("")
            }
        }, t.exports = n
    }, {"./utils": 116}],
    112: [function (e, t, i) {
        (function (e) {
            "use strict";
            if (i.base64 = !0, i.array = !0, i.string = !0, i.arraybuffer = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array, i.nodebuffer = "undefined" != typeof e, i.uint8array = "undefined" != typeof Uint8Array, "undefined" == typeof ArrayBuffer)i.blob = !1; else {
                var t = new ArrayBuffer(0);
                try {
                    i.blob = 0 === new Blob([t], {type: "application/zip"}).size
                } catch (r) {
                    try {
                        var n = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, o = new n;
                        o.append(t), i.blob = 0 === o.getBlob("application/zip").size
                    } catch (r) {
                        i.blob = !1
                    }
                }
            }
        }).call(this, e("buffer").Buffer)
    }, {buffer: 84}],
    113: [function (e, t, i) {
        "use strict";
        function r(e) {
            e && (this.data = e, this.length = this.data.length, this.index = 0)
        }

        var n = e("./dataReader");
        r.prototype = new n, r.prototype.byteAt = function (e) {
            return this.data[e]
        }, r.prototype.lastIndexOfSignature = function (e) {
            for (var t = e.charCodeAt(0), i = e.charCodeAt(1), r = e.charCodeAt(2), n = e.charCodeAt(3), o = this.length - 4; o >= 0; --o)if (this.data[o] === t && this.data[o + 1] === i && this.data[o + 2] === r && this.data[o + 3] === n)return o;
            return -1
        }, r.prototype.readData = function (e) {
            if (this.checkOffset(e), 0 === e)return new Uint8Array(0);
            var t = this.data.subarray(this.index, this.index + e);
            return this.index += e, t
        }, t.exports = r
    }, {"./dataReader": 100}],
    114: [function (e, t, i) {
        "use strict";
        var r = e("./utils"), n = function (e) {
            this.data = new Uint8Array(e), this.index = 0
        };
        n.prototype = {
            append: function (e) {
                0 !== e.length && (e = r.transformTo("uint8array", e), this.data.set(e, this.index), this.index += e.length)
            }, finalize: function () {
                return this.data
            }
        }, t.exports = n
    }, {"./utils": 116}],
    115: [function (e, t, i) {
        "use strict";
        for (var r = e("./utils"), n = e("./support"), o = e("./nodeBuffer"), a = new Array(256), s = 0; 256 > s; s++)a[s] = s >= 252 ? 6 : s >= 248 ? 5 : s >= 240 ? 4 : s >= 224 ? 3 : s >= 192 ? 2 : 1;
        a[254] = a[254] = 1;
        var h = function (e) {
            var t, i, r, o, a, s = e.length, h = 0;
            for (o = 0; s > o; o++)i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (r = e.charCodeAt(o + 1), 56320 === (64512 & r) && (i = 65536 + (i - 55296 << 10) + (r - 56320), o++)), h += 128 > i ? 1 : 2048 > i ? 2 : 65536 > i ? 3 : 4;
            for (t = n.uint8array ? new Uint8Array(h) : new Array(h), a = 0, o = 0; h > a; o++)i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (r = e.charCodeAt(o + 1), 56320 === (64512 & r) && (i = 65536 + (i - 55296 << 10) + (r - 56320), o++)), 128 > i ? t[a++] = i : 2048 > i ? (t[a++] = 192 | i >>> 6, t[a++] = 128 | 63 & i) : 65536 > i ? (t[a++] = 224 | i >>> 12, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i) : (t[a++] = 240 | i >>> 18, t[a++] = 128 | i >>> 12 & 63, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i);
            return t
        }, l = function (e, t) {
            var i;
            for (t = t || e.length, t > e.length && (t = e.length), i = t - 1; i >= 0 && 128 === (192 & e[i]);)i--;
            return 0 > i ? t : 0 === i ? t : i + a[e[i]] > t ? i : t
        }, u = function (e) {
            var t, i, n, o, s = e.length, h = new Array(2 * s);
            for (i = 0, t = 0; s > t;)if (n = e[t++], 128 > n)h[i++] = n; else if (o = a[n], o > 4)h[i++] = 65533, t += o - 1; else {
                for (n &= 2 === o ? 31 : 3 === o ? 15 : 7; o > 1 && s > t;)n = n << 6 | 63 & e[t++], o--;
                o > 1 ? h[i++] = 65533 : 65536 > n ? h[i++] = n : (n -= 65536, h[i++] = 55296 | n >> 10 & 1023, h[i++] = 56320 | 1023 & n)
            }
            return h.length !== i && (h.subarray ? h = h.subarray(0, i) : h.length = i), r.applyFromCharCode(h)
        };
        i.utf8encode = function (e) {
            return n.nodebuffer ? o(e, "utf-8") : h(e)
        }, i.utf8decode = function (e) {
            if (n.nodebuffer)return r.transformTo("nodebuffer", e).toString("utf-8");
            e = r.transformTo(n.uint8array ? "uint8array" : "array", e);
            for (var t = [], i = 0, o = e.length, a = 65536; o > i;) {
                var s = l(e, Math.min(i + a, o));
                n.uint8array ? t.push(u(e.subarray(i, s))) : t.push(u(e.slice(i, s))), i = s
            }
            return t.join("")
        }
    }, {"./nodeBuffer": 106, "./support": 112, "./utils": 116}],
    116: [function (e, t, i) {
        "use strict";
        function r(e) {
            return e
        }

        function n(e, t) {
            for (var i = 0; i < e.length; ++i)t[i] = 255 & e.charCodeAt(i);
            return t
        }

        function o(e) {
            var t = 65536, r = [], n = e.length, o = i.getTypeOf(e), a = 0, s = !0;
            try {
                switch (o) {
                    case"uint8array":
                        String.fromCharCode.apply(null, new Uint8Array(0));
                        break;
                    case"nodebuffer":
                        String.fromCharCode.apply(null, l(0))
                }
            } catch (h) {
                s = !1
            }
            if (!s) {
                for (var u = "", c = 0; c < e.length; c++)u += String.fromCharCode(e[c]);
                return u
            }
            for (; n > a && t > 1;)try {
                "array" === o || "nodebuffer" === o ? r.push(String.fromCharCode.apply(null, e.slice(a, Math.min(a + t, n)))) : r.push(String.fromCharCode.apply(null, e.subarray(a, Math.min(a + t, n)))), a += t
            } catch (h) {
                t = Math.floor(t / 2)
            }
            return r.join("")
        }

        function a(e, t) {
            for (var i = 0; i < e.length; i++)t[i] = e[i];
            return t
        }

        var s = e("./support"), h = e("./compressions"), l = e("./nodeBuffer");
        i.string2binary = function (e) {
            for (var t = "", i = 0; i < e.length; i++)t += String.fromCharCode(255 & e.charCodeAt(i));
            return t
        }, i.arrayBuffer2Blob = function (e, t) {
            i.checkSupport("blob"), t = t || "application/zip";
            try {
                return new Blob([e], {type: t})
            } catch (r) {
                try {
                    var n = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, o = new n;
                    return o.append(e), o.getBlob(t)
                } catch (r) {
                    throw new Error("Bug : can't construct the Blob.")
                }
            }
        }, i.applyFromCharCode = o;
        var u = {};
        u.string = {
            string: r, array: function (e) {
                return n(e, new Array(e.length))
            }, arraybuffer: function (e) {
                return u.string.uint8array(e).buffer
            }, uint8array: function (e) {
                return n(e, new Uint8Array(e.length))
            }, nodebuffer: function (e) {
                return n(e, l(e.length))
            }
        }, u.array = {
            string: o, array: r, arraybuffer: function (e) {
                return new Uint8Array(e).buffer
            }, uint8array: function (e) {
                return new Uint8Array(e)
            }, nodebuffer: function (e) {
                return l(e)
            }
        }, u.arraybuffer = {
            string: function (e) {
                return o(new Uint8Array(e))
            }, array: function (e) {
                return a(new Uint8Array(e), new Array(e.byteLength))
            }, arraybuffer: r, uint8array: function (e) {
                return new Uint8Array(e)
            }, nodebuffer: function (e) {
                return l(new Uint8Array(e))
            }
        }, u.uint8array = {
            string: o, array: function (e) {
                return a(e, new Array(e.length))
            }, arraybuffer: function (e) {
                return e.buffer
            }, uint8array: r, nodebuffer: function (e) {
                return l(e)
            }
        }, u.nodebuffer = {
            string: o, array: function (e) {
                return a(e, new Array(e.length))
            }, arraybuffer: function (e) {
                return u.nodebuffer.uint8array(e).buffer
            }, uint8array: function (e) {
                return a(e, new Uint8Array(e.length))
            }, nodebuffer: r
        }, i.transformTo = function (e, t) {
            if (t || (t = ""), !e)return t;
            i.checkSupport(e);
            var r = i.getTypeOf(t), n = u[r][e](t);
            return n
        }, i.getTypeOf = function (e) {
            return "string" == typeof e ? "string" : "[object Array]" === Object.prototype.toString.call(e) ? "array" : s.nodebuffer && l.test(e) ? "nodebuffer" : s.uint8array && e instanceof Uint8Array ? "uint8array" : s.arraybuffer && e instanceof ArrayBuffer ? "arraybuffer" : void 0
        }, i.checkSupport = function (e) {
            var t = s[e.toLowerCase()];
            if (!t)throw new Error(e + " is not supported by this browser")
        }, i.MAX_VALUE_16BITS = 65535, i.MAX_VALUE_32BITS = -1, i.pretty = function (e) {
            var t, i, r = "";
            for (i = 0; i < (e || "").length; i++)t = e.charCodeAt(i), r += "\\x" + (16 > t ? "0" : "") + t.toString(16).toUpperCase();
            return r
        }, i.findCompression = function (e) {
            for (var t in h)if (h.hasOwnProperty(t) && h[t].magic === e)return h[t];
            return null
        }, i.isRegExp = function (e) {
            return "[object RegExp]" === Object.prototype.toString.call(e)
        }
    }, {"./compressions": 98, "./nodeBuffer": 106, "./support": 112}],
    117: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            this.files = [], this.loadOptions = t, e && this.load(e)
        }

        var n = e("./stringReader"), o = e("./nodeBufferReader"), a = e("./uint8ArrayReader"), s = e("./utils"), h = e("./signature"), l = e("./zipEntry"), u = e("./support"), c = e("./object");
        r.prototype = {
            checkSignature: function (e) {
                var t = this.reader.readString(4);
                if (t !== e)throw new Error("Corrupted zip or bug : unexpected signature (" + s.pretty(t) + ", expected " + s.pretty(e) + ")")
            }, readBlockEndOfCentral: function () {
                this.diskNumber = this.reader.readInt(2), this.diskWithCentralDirStart = this.reader.readInt(2), this.centralDirRecordsOnThisDisk = this.reader.readInt(2), this.centralDirRecords = this.reader.readInt(2), this.centralDirSize = this.reader.readInt(4), this.centralDirOffset = this.reader.readInt(4), this.zipCommentLength = this.reader.readInt(2), this.zipComment = this.reader.readString(this.zipCommentLength), this.zipComment = c.utf8decode(this.zipComment)
            }, readBlockZip64EndOfCentral: function () {
                this.zip64EndOfCentralSize = this.reader.readInt(8), this.versionMadeBy = this.reader.readString(2), this.versionNeeded = this.reader.readInt(2), this.diskNumber = this.reader.readInt(4), this.diskWithCentralDirStart = this.reader.readInt(4), this.centralDirRecordsOnThisDisk = this.reader.readInt(8), this.centralDirRecords = this.reader.readInt(8), this.centralDirSize = this.reader.readInt(8), this.centralDirOffset = this.reader.readInt(8), this.zip64ExtensibleData = {};
                for (var e, t, i, r = this.zip64EndOfCentralSize - 44, n = 0; r > n;)e = this.reader.readInt(2), t = this.reader.readInt(4), i = this.reader.readString(t), this.zip64ExtensibleData[e] = {
                    id: e,
                    length: t,
                    value: i
                }
            }, readBlockZip64EndOfCentralLocator: function () {
                if (this.diskWithZip64CentralDirStart = this.reader.readInt(4), this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8), this.disksCount = this.reader.readInt(4), this.disksCount > 1)throw new Error("Multi-volumes zip are not supported")
            }, readLocalFiles: function () {
                var e, t;
                for (e = 0; e < this.files.length; e++)t = this.files[e], this.reader.setIndex(t.localHeaderOffset), this.checkSignature(h.LOCAL_FILE_HEADER), t.readLocalPart(this.reader), t.handleUTF8(), t.processAttributes()
            }, readCentralDir: function () {
                var e;
                for (this.reader.setIndex(this.centralDirOffset); this.reader.readString(4) === h.CENTRAL_FILE_HEADER;)e = new l({zip64: this.zip64}, this.loadOptions), e.readCentralPart(this.reader), this.files.push(e)
            }, readEndOfCentral: function () {
                var e = this.reader.lastIndexOfSignature(h.CENTRAL_DIRECTORY_END);
                if (-1 === e) {
                    var t = !0;
                    try {
                        this.reader.setIndex(0), this.checkSignature(h.LOCAL_FILE_HEADER), t = !1
                    } catch (i) {
                    }
                    throw t ? new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html") : new Error("Corrupted zip : can't find end of central directory")
                }
                if (this.reader.setIndex(e), this.checkSignature(h.CENTRAL_DIRECTORY_END), this.readBlockEndOfCentral(), this.diskNumber === s.MAX_VALUE_16BITS || this.diskWithCentralDirStart === s.MAX_VALUE_16BITS || this.centralDirRecordsOnThisDisk === s.MAX_VALUE_16BITS || this.centralDirRecords === s.MAX_VALUE_16BITS || this.centralDirSize === s.MAX_VALUE_32BITS || this.centralDirOffset === s.MAX_VALUE_32BITS) {
                    if (this.zip64 = !0, e = this.reader.lastIndexOfSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR), -1 === e)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");
                    this.reader.setIndex(e), this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR), this.readBlockZip64EndOfCentralLocator(), this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir), this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_END), this.readBlockZip64EndOfCentral()
                }
            }, prepareReader: function (e) {
                var t = s.getTypeOf(e);
                "string" !== t || u.uint8array ? "nodebuffer" === t ? this.reader = new o(e) : this.reader = new a(s.transformTo("uint8array", e)) : this.reader = new n(e, this.loadOptions.optimizedBinaryString)
            }, load: function (e) {
                this.prepareReader(e), this.readEndOfCentral(), this.readCentralDir(), this.readLocalFiles()
            }
        }, t.exports = r
    }, {
        "./nodeBufferReader": 107,
        "./object": 108,
        "./signature": 109,
        "./stringReader": 110,
        "./support": 112,
        "./uint8ArrayReader": 113,
        "./utils": 116,
        "./zipEntry": 118
    }],
    118: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            this.options = e, this.loadOptions = t
        }

        var n = e("./stringReader"), o = e("./utils"), a = e("./compressedObject"), s = e("./object"), h = 0, l = 3;
        r.prototype = {
            isEncrypted: function () {
                return 1 === (1 & this.bitFlag)
            }, useUTF8: function () {
                return 2048 === (2048 & this.bitFlag)
            }, prepareCompressedContent: function (e, t, i) {
                return function () {
                    var r = e.index;
                    e.setIndex(t);
                    var n = e.readData(i);
                    return e.setIndex(r), n
                }
            }, prepareContent: function (e, t, i, r, n) {
                return function () {
                    var e = o.transformTo(r.uncompressInputType, this.getCompressedContent()), t = r.uncompress(e);
                    if (t.length !== n)throw new Error("Bug : uncompressed data size mismatch");
                    return t
                }
            }, readLocalPart: function (e) {
                var t, i;
                if (e.skip(22), this.fileNameLength = e.readInt(2), i = e.readInt(2), this.fileName = e.readString(this.fileNameLength), e.skip(i), -1 == this.compressedSize || -1 == this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");
                if (t = o.findCompression(this.compressionMethod), null === t)throw new Error("Corrupted zip : compression " + o.pretty(this.compressionMethod) + " unknown (inner file : " + this.fileName + ")");
                if (this.decompressed = new a, this.decompressed.compressedSize = this.compressedSize, this.decompressed.uncompressedSize = this.uncompressedSize, this.decompressed.crc32 = this.crc32, this.decompressed.compressionMethod = this.compressionMethod, this.decompressed.getCompressedContent = this.prepareCompressedContent(e, e.index, this.compressedSize, t), this.decompressed.getContent = this.prepareContent(e, e.index, this.compressedSize, t, this.uncompressedSize), this.loadOptions.checkCRC32 && (this.decompressed = o.transformTo("string", this.decompressed.getContent()), s.crc32(this.decompressed) !== this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")
            }, readCentralPart: function (e) {
                if (this.versionMadeBy = e.readInt(2), this.versionNeeded = e.readInt(2), this.bitFlag = e.readInt(2), this.compressionMethod = e.readString(2), this.date = e.readDate(), this.crc32 = e.readInt(4), this.compressedSize = e.readInt(4), this.uncompressedSize = e.readInt(4), this.fileNameLength = e.readInt(2), this.extraFieldsLength = e.readInt(2), this.fileCommentLength = e.readInt(2), this.diskNumberStart = e.readInt(2), this.internalFileAttributes = e.readInt(2), this.externalFileAttributes = e.readInt(4), this.localHeaderOffset = e.readInt(4), this.isEncrypted())throw new Error("Encrypted zip are not supported");
                this.fileName = e.readString(this.fileNameLength), this.readExtraFields(e), this.parseZIP64ExtraField(e), this.fileComment = e.readString(this.fileCommentLength)
            }, processAttributes: function () {
                this.unixPermissions = null, this.dosPermissions = null;
                var e = this.versionMadeBy >> 8;
                this.dir = 16 & this.externalFileAttributes ? !0 : !1, e === h && (this.dosPermissions = 63 & this.externalFileAttributes), e === l && (this.unixPermissions = this.externalFileAttributes >> 16 & 65535), this.dir || "/" !== this.fileName.slice(-1) || (this.dir = !0)
            }, parseZIP64ExtraField: function (e) {
                if (this.extraFields[1]) {
                    var t = new n(this.extraFields[1].value);
                    this.uncompressedSize === o.MAX_VALUE_32BITS && (this.uncompressedSize = t.readInt(8)), this.compressedSize === o.MAX_VALUE_32BITS && (this.compressedSize = t.readInt(8)), this.localHeaderOffset === o.MAX_VALUE_32BITS && (this.localHeaderOffset = t.readInt(8)), this.diskNumberStart === o.MAX_VALUE_32BITS && (this.diskNumberStart = t.readInt(4))
                }
            }, readExtraFields: function (e) {
                var t, i, r, n = e.index;
                for (this.extraFields = this.extraFields || {}; e.index < n + this.extraFieldsLength;)t = e.readInt(2), i = e.readInt(2), r = e.readString(i), this.extraFields[t] = {
                    id: t,
                    length: i,
                    value: r
                }
            }, handleUTF8: function () {
                if (this.useUTF8())this.fileName = s.utf8decode(this.fileName), this.fileComment = s.utf8decode(this.fileComment); else {
                    var e = this.findExtraFieldUnicodePath();
                    null !== e && (this.fileName = e);
                    var t = this.findExtraFieldUnicodeComment();
                    null !== t && (this.fileComment = t)
                }
            }, findExtraFieldUnicodePath: function () {
                var e = this.extraFields[28789];
                if (e) {
                    var t = new n(e.value);
                    return 1 !== t.readInt(1) ? null : s.crc32(this.fileName) !== t.readInt(4) ? null : s.utf8decode(t.readString(e.length - 5))
                }
                return null
            }, findExtraFieldUnicodeComment: function () {
                var e = this.extraFields[25461];
                if (e) {
                    var t = new n(e.value);
                    return 1 !== t.readInt(1) ? null : s.crc32(this.fileComment) !== t.readInt(4) ? null : s.utf8decode(t.readString(e.length - 5))
                }
                return null
            }
        }, t.exports = r
    }, {"./compressedObject": 97, "./object": 108, "./stringReader": 110, "./utils": 116}],
    119: [function (e, t, i) {
        "use strict";
        var r = e("./lib/utils/common").assign, n = e("./lib/deflate"), o = e("./lib/inflate"), a = e("./lib/zlib/constants"), s = {};
        r(s, n, o, a), t.exports = s
    }, {"./lib/deflate": 120, "./lib/inflate": 121, "./lib/utils/common": 122, "./lib/zlib/constants": 125}],
    120: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            var i = new w(t);
            if (i.push(e, !0), i.err)throw i.msg;
            return i.result
        }

        function n(e, t) {
            return t = t || {}, t.raw = !0, r(e, t)
        }

        function o(e, t) {
            return t = t || {}, t.gzip = !0, r(e, t)
        }

        var a = e("./zlib/deflate.js"), s = e("./utils/common"), h = e("./utils/strings"), l = e("./zlib/messages"), u = e("./zlib/zstream"), c = Object.prototype.toString, d = 0, f = 4, p = 0, m = 1, g = 2, v = -1, y = 0, b = 8, w = function (e) {
            this.options = s.assign({
                level: v,
                method: b,
                chunkSize: 16384,
                windowBits: 15,
                memLevel: 8,
                strategy: y,
                to: ""
            }, e || {});
            var t = this.options;
            t.raw && t.windowBits > 0 ? t.windowBits = -t.windowBits : t.gzip && t.windowBits > 0 && t.windowBits < 16 && (t.windowBits += 16), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new u, this.strm.avail_out = 0;
            var i = a.deflateInit2(this.strm, t.level, t.method, t.windowBits, t.memLevel, t.strategy);
            if (i !== p)throw new Error(l[i]);
            t.header && a.deflateSetHeader(this.strm, t.header)
        };
        w.prototype.push = function (e, t) {
            var i, r, n = this.strm, o = this.options.chunkSize;
            if (this.ended)return !1;
            r = t === ~~t ? t : t === !0 ? f : d, "string" == typeof e ? n.input = h.string2buf(e) : "[object ArrayBuffer]" === c.call(e) ? n.input = new Uint8Array(e) : n.input = e, n.next_in = 0, n.avail_in = n.input.length;
            do {
                if (0 === n.avail_out && (n.output = new s.Buf8(o), n.next_out = 0, n.avail_out = o), i = a.deflate(n, r), i !== m && i !== p)return this.onEnd(i), this.ended = !0, !1;
                (0 === n.avail_out || 0 === n.avail_in && (r === f || r === g)) && ("string" === this.options.to ? this.onData(h.buf2binstring(s.shrinkBuf(n.output, n.next_out))) : this.onData(s.shrinkBuf(n.output, n.next_out)))
            } while ((n.avail_in > 0 || 0 === n.avail_out) && i !== m);
            return r === f ? (i = a.deflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === p) : r === g ? (this.onEnd(p), n.avail_out = 0, !0) : !0
        }, w.prototype.onData = function (e) {
            this.chunks.push(e)
        }, w.prototype.onEnd = function (e) {
            e === p && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = s.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg
        }, i.Deflate = w, i.deflate = r, i.deflateRaw = n, i.gzip = o
    }, {
        "./utils/common": 122,
        "./utils/strings": 123,
        "./zlib/deflate.js": 127,
        "./zlib/messages": 132,
        "./zlib/zstream": 134
    }],
    121: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            var i = new f(t);
            if (i.push(e, !0), i.err)throw i.msg;
            return i.result
        }

        function n(e, t) {
            return t = t || {}, t.raw = !0, r(e, t)
        }

        var o = e("./zlib/inflate.js"), a = e("./utils/common"), s = e("./utils/strings"), h = e("./zlib/constants"), l = e("./zlib/messages"), u = e("./zlib/zstream"), c = e("./zlib/gzheader"), d = Object.prototype.toString, f = function (e) {
            this.options = a.assign({chunkSize: 16384, windowBits: 0, to: ""}, e || {});
            var t = this.options;
            t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)), !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32), t.windowBits > 15 && t.windowBits < 48 && 0 === (15 & t.windowBits) && (t.windowBits |= 15), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new u, this.strm.avail_out = 0;
            var i = o.inflateInit2(this.strm, t.windowBits);
            if (i !== h.Z_OK)throw new Error(l[i]);
            this.header = new c, o.inflateGetHeader(this.strm, this.header)
        };
        f.prototype.push = function (e, t) {
            var i, r, n, l, u, c = this.strm, f = this.options.chunkSize, p = !1;
            if (this.ended)return !1;
            r = t === ~~t ? t : t === !0 ? h.Z_FINISH : h.Z_NO_FLUSH, "string" == typeof e ? c.input = s.binstring2buf(e) : "[object ArrayBuffer]" === d.call(e) ? c.input = new Uint8Array(e) : c.input = e, c.next_in = 0, c.avail_in = c.input.length;
            do {
                if (0 === c.avail_out && (c.output = new a.Buf8(f), c.next_out = 0, c.avail_out = f), i = o.inflate(c, h.Z_NO_FLUSH), i === h.Z_BUF_ERROR && p === !0 && (i = h.Z_OK, p = !1), i !== h.Z_STREAM_END && i !== h.Z_OK)return this.onEnd(i), this.ended = !0, !1;
                c.next_out && (0 === c.avail_out || i === h.Z_STREAM_END || 0 === c.avail_in && (r === h.Z_FINISH || r === h.Z_SYNC_FLUSH)) && ("string" === this.options.to ? (n = s.utf8border(c.output, c.next_out), l = c.next_out - n, u = s.buf2string(c.output, n), c.next_out = l, c.avail_out = f - l, l && a.arraySet(c.output, c.output, n, l, 0), this.onData(u)) : this.onData(a.shrinkBuf(c.output, c.next_out))), 0 === c.avail_in && 0 === c.avail_out && (p = !0)
            } while ((c.avail_in > 0 || 0 === c.avail_out) && i !== h.Z_STREAM_END);
            return i === h.Z_STREAM_END && (r = h.Z_FINISH), r === h.Z_FINISH ? (i = o.inflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === h.Z_OK) : r === h.Z_SYNC_FLUSH ? (this.onEnd(h.Z_OK), c.avail_out = 0, !0) : !0
        }, f.prototype.onData = function (e) {
            this.chunks.push(e)
        }, f.prototype.onEnd = function (e) {
            e === h.Z_OK && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = a.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg
        }, i.Inflate = f, i.inflate = r, i.inflateRaw = n, i.ungzip = r
    }, {
        "./utils/common": 122,
        "./utils/strings": 123,
        "./zlib/constants": 125,
        "./zlib/gzheader": 128,
        "./zlib/inflate.js": 130,
        "./zlib/messages": 132,
        "./zlib/zstream": 134
    }],
    122: [function (e, t, i) {
        "use strict";
        var r = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Int32Array;
        i.assign = function (e) {
            for (var t = Array.prototype.slice.call(arguments, 1); t.length;) {
                var i = t.shift();
                if (i) {
                    if ("object" != typeof i)throw new TypeError(i + "must be non-object");
                    for (var r in i)i.hasOwnProperty(r) && (e[r] = i[r])
                }
            }
            return e
        }, i.shrinkBuf = function (e, t) {
            return e.length === t ? e : e.subarray ? e.subarray(0, t) : (e.length = t, e)
        };
        var n = {
            arraySet: function (e, t, i, r, n) {
                if (t.subarray && e.subarray)return void e.set(t.subarray(i, i + r), n);
                for (var o = 0; r > o; o++)e[n + o] = t[i + o]
            }, flattenChunks: function (e) {
                var t, i, r, n, o, a;
                for (r = 0, t = 0, i = e.length; i > t; t++)r += e[t].length;
                for (a = new Uint8Array(r), n = 0, t = 0, i = e.length; i > t; t++)o = e[t], a.set(o, n), n += o.length;
                return a
            }
        }, o = {
            arraySet: function (e, t, i, r, n) {
                for (var o = 0; r > o; o++)e[n + o] = t[i + o]
            }, flattenChunks: function (e) {
                return [].concat.apply([], e)
            }
        };
        i.setTyped = function (e) {
            e ? (i.Buf8 = Uint8Array, i.Buf16 = Uint16Array, i.Buf32 = Int32Array, i.assign(i, n)) : (i.Buf8 = Array, i.Buf16 = Array, i.Buf32 = Array, i.assign(i, o))
        }, i.setTyped(r)
    }, {}],
    123: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            if (65537 > t && (e.subarray && a || !e.subarray && o))return String.fromCharCode.apply(null, n.shrinkBuf(e, t));
            for (var i = "", r = 0; t > r; r++)i += String.fromCharCode(e[r]);
            return i
        }

        var n = e("./common"), o = !0, a = !0;
        try {
            String.fromCharCode.apply(null, [0])
        } catch (s) {
            o = !1
        }
        try {
            String.fromCharCode.apply(null, new Uint8Array(1))
        } catch (s) {
            a = !1
        }
        for (var h = new n.Buf8(256), l = 0; 256 > l; l++)h[l] = l >= 252 ? 6 : l >= 248 ? 5 : l >= 240 ? 4 : l >= 224 ? 3 : l >= 192 ? 2 : 1;
        h[254] = h[254] = 1, i.string2buf = function (e) {
            var t, i, r, o, a, s = e.length, h = 0;
            for (o = 0; s > o; o++)i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (r = e.charCodeAt(o + 1), 56320 === (64512 & r) && (i = 65536 + (i - 55296 << 10) + (r - 56320), o++)), h += 128 > i ? 1 : 2048 > i ? 2 : 65536 > i ? 3 : 4;
            for (t = new n.Buf8(h), a = 0, o = 0; h > a; o++)i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (r = e.charCodeAt(o + 1), 56320 === (64512 & r) && (i = 65536 + (i - 55296 << 10) + (r - 56320), o++)), 128 > i ? t[a++] = i : 2048 > i ? (t[a++] = 192 | i >>> 6, t[a++] = 128 | 63 & i) : 65536 > i ? (t[a++] = 224 | i >>> 12, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i) : (t[a++] = 240 | i >>> 18, t[a++] = 128 | i >>> 12 & 63, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i);
            return t
        }, i.buf2binstring = function (e) {
            return r(e, e.length)
        }, i.binstring2buf = function (e) {
            for (var t = new n.Buf8(e.length), i = 0, r = t.length; r > i; i++)t[i] = e.charCodeAt(i);
            return t
        }, i.buf2string = function (e, t) {
            var i, n, o, a, s = t || e.length, l = new Array(2 * s);
            for (n = 0, i = 0; s > i;)if (o = e[i++], 128 > o)l[n++] = o; else if (a = h[o], a > 4)l[n++] = 65533, i += a - 1; else {
                for (o &= 2 === a ? 31 : 3 === a ? 15 : 7; a > 1 && s > i;)o = o << 6 | 63 & e[i++], a--;
                a > 1 ? l[n++] = 65533 : 65536 > o ? l[n++] = o : (o -= 65536, l[n++] = 55296 | o >> 10 & 1023, l[n++] = 56320 | 1023 & o)
            }
            return r(l, n)
        }, i.utf8border = function (e, t) {
            var i;
            for (t = t || e.length, t > e.length && (t = e.length), i = t - 1; i >= 0 && 128 === (192 & e[i]);)i--;
            return 0 > i ? t : 0 === i ? t : i + h[e[i]] > t ? i : t
        }
    }, {"./common": 122}],
    124: [function (e, t, i) {
        "use strict";
        function r(e, t, i, r) {
            for (var n = 65535 & e | 0, o = e >>> 16 & 65535 | 0, a = 0; 0 !== i;) {
                a = i > 2e3 ? 2e3 : i, i -= a;
                do n = n + t[r++] | 0, o = o + n | 0; while (--a);
                n %= 65521, o %= 65521
            }
            return n | o << 16 | 0
        }

        t.exports = r
    }, {}],
    125: [function (e, t, i) {
        t.exports = {
            Z_NO_FLUSH: 0,
            Z_PARTIAL_FLUSH: 1,
            Z_SYNC_FLUSH: 2,
            Z_FULL_FLUSH: 3,
            Z_FINISH: 4,
            Z_BLOCK: 5,
            Z_TREES: 6,
            Z_OK: 0,
            Z_STREAM_END: 1,
            Z_NEED_DICT: 2,
            Z_ERRNO: -1,
            Z_STREAM_ERROR: -2,
            Z_DATA_ERROR: -3,
            Z_BUF_ERROR: -5,
            Z_NO_COMPRESSION: 0,
            Z_BEST_SPEED: 1,
            Z_BEST_COMPRESSION: 9,
            Z_DEFAULT_COMPRESSION: -1,
            Z_FILTERED: 1,
            Z_HUFFMAN_ONLY: 2,
            Z_RLE: 3,
            Z_FIXED: 4,
            Z_DEFAULT_STRATEGY: 0,
            Z_BINARY: 0,
            Z_TEXT: 1,
            Z_UNKNOWN: 2,
            Z_DEFLATED: 8
        }
    }, {}],
    126: [function (e, t, i) {
        "use strict";
        function r() {
            for (var e, t = [], i = 0; 256 > i; i++) {
                e = i;
                for (var r = 0; 8 > r; r++)e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
                t[i] = e
            }
            return t
        }

        function n(e, t, i, r) {
            var n = o, a = r + i;
            e = -1 ^ e;
            for (var s = r; a > s; s++)e = e >>> 8 ^ n[255 & (e ^ t[s])];
            return -1 ^ e
        }

        var o = r();
        t.exports = n
    }, {}],
    127: [function (e, t, i) {
        "use strict";
        function r(e, t) {
            return e.msg = B[t], t
        }

        function n(e) {
            return (e << 1) - (e > 4 ? 9 : 0)
        }

        function o(e) {
            for (var t = e.length; --t >= 0;)e[t] = 0
        }

        function a(e) {
            var t = e.state, i = t.pending;
            i > e.avail_out && (i = e.avail_out), 0 !== i && (C.arraySet(e.output, t.pending_buf, t.pending_out, i, e.next_out), e.next_out += i, t.pending_out += i, e.total_out += i, e.avail_out -= i, t.pending -= i, 0 === t.pending && (t.pending_out = 0))
        }

        function s(e, t) {
            P._tr_flush_block(e, e.block_start >= 0 ? e.block_start : -1, e.strstart - e.block_start, t), e.block_start = e.strstart, a(e.strm)
        }

        function h(e, t) {
            e.pending_buf[e.pending++] = t
        }

        function l(e, t) {
            e.pending_buf[e.pending++] = t >>> 8 & 255, e.pending_buf[e.pending++] = 255 & t
        }

        function u(e, t, i, r) {
            var n = e.avail_in;
            return n > r && (n = r), 0 === n ? 0 : (e.avail_in -= n, C.arraySet(t, e.input, e.next_in, n, i), 1 === e.state.wrap ? e.adler = L(e.adler, t, n, i) : 2 === e.state.wrap && (e.adler = k(e.adler, t, n, i)), e.next_in += n, e.total_in += n, n)
        }

        function c(e, t) {
            var i, r, n = e.max_chain_length, o = e.strstart, a = e.prev_length, s = e.nice_match, h = e.strstart > e.w_size - le ? e.strstart - (e.w_size - le) : 0, l = e.window, u = e.w_mask, c = e.prev, d = e.strstart + he, f = l[o + a - 1], p = l[o + a];
            e.prev_length >= e.good_match && (n >>= 2), s > e.lookahead && (s = e.lookahead);
            do if (i = t, l[i + a] === p && l[i + a - 1] === f && l[i] === l[o] && l[++i] === l[o + 1]) {
                o += 2, i++;
                do; while (l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && l[++o] === l[++i] && d > o);
                if (r = he - (d - o), o = d - he, r > a) {
                    if (e.match_start = t, a = r, r >= s)break;
                    f = l[o + a - 1], p = l[o + a]
                }
            } while ((t = c[t & u]) > h && 0 !== --n);
            return a <= e.lookahead ? a : e.lookahead
        }

        function d(e) {
            var t, i, r, n, o, a = e.w_size;
            do {
                if (n = e.window_size - e.lookahead - e.strstart, e.strstart >= a + (a - le)) {
                    C.arraySet(e.window, e.window, a, a, 0), e.match_start -= a, e.strstart -= a, e.block_start -= a, i = e.hash_size, t = i;
                    do r = e.head[--t], e.head[t] = r >= a ? r - a : 0; while (--i);
                    i = a, t = i;
                    do r = e.prev[--t], e.prev[t] = r >= a ? r - a : 0; while (--i);
                    n += a
                }
                if (0 === e.strm.avail_in)break;
                if (i = u(e.strm, e.window, e.strstart + e.lookahead, n), e.lookahead += i, e.lookahead + e.insert >= se)for (o = e.strstart - e.insert, e.ins_h = e.window[o], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[o + 1]) & e.hash_mask; e.insert && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[o + se - 1]) & e.hash_mask, e.prev[o & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = o, o++, e.insert--, !(e.lookahead + e.insert < se)););
            } while (e.lookahead < le && 0 !== e.strm.avail_in)
        }

        function f(e, t) {
            var i = 65535;
            for (i > e.pending_buf_size - 5 && (i = e.pending_buf_size - 5); ;) {
                if (e.lookahead <= 1) {
                    if (d(e), 0 === e.lookahead && t === R)return ye;
                    if (0 === e.lookahead)break
                }
                e.strstart += e.lookahead, e.lookahead = 0;
                var r = e.block_start + i;
                if ((0 === e.strstart || e.strstart >= r) && (e.lookahead = e.strstart - r, e.strstart = r, s(e, !1), 0 === e.strm.avail_out))return ye;
                if (e.strstart - e.block_start >= e.w_size - le && (s(e, !1), 0 === e.strm.avail_out))return ye
            }
            return e.insert = 0, t === D ? (s(e, !0), 0 === e.strm.avail_out ? we : _e) : e.strstart > e.block_start && (s(e, !1), 0 === e.strm.avail_out) ? ye : ye
        }

        function p(e, t) {
            for (var i, r; ;) {
                if (e.lookahead < le) {
                    if (d(e), e.lookahead < le && t === R)return ye;
                    if (0 === e.lookahead)break
                }
                if (i = 0, e.lookahead >= se && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + se - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), 0 !== i && e.strstart - i <= e.w_size - le && (e.match_length = c(e, i)), e.match_length >= se)if (r = P._tr_tally(e, e.strstart - e.match_start, e.match_length - se), e.lookahead -= e.match_length, e.match_length <= e.max_lazy_match && e.lookahead >= se) {
                    e.match_length--;
                    do e.strstart++, e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + se - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart; while (0 !== --e.match_length);
                    e.strstart++
                } else e.strstart += e.match_length, e.match_length = 0, e.ins_h = e.window[e.strstart], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 1]) & e.hash_mask; else r = P._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++;
                if (r && (s(e, !1), 0 === e.strm.avail_out))return ye
            }
            return e.insert = e.strstart < se - 1 ? e.strstart : se - 1, t === D ? (s(e, !0), 0 === e.strm.avail_out ? we : _e) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? ye : be
        }

        function m(e, t) {
            for (var i, r, n; ;) {
                if (e.lookahead < le) {
                    if (d(e), e.lookahead < le && t === R)return ye;
                    if (0 === e.lookahead)break
                }
                if (i = 0, e.lookahead >= se && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + se - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), e.prev_length = e.match_length, e.prev_match = e.match_start, e.match_length = se - 1, 0 !== i && e.prev_length < e.max_lazy_match && e.strstart - i <= e.w_size - le && (e.match_length = c(e, i), e.match_length <= 5 && (e.strategy === G || e.match_length === se && e.strstart - e.match_start > 4096) && (e.match_length = se - 1)), e.prev_length >= se && e.match_length <= e.prev_length) {
                    n = e.strstart + e.lookahead - se, r = P._tr_tally(e, e.strstart - 1 - e.prev_match, e.prev_length - se), e.lookahead -= e.prev_length - 1, e.prev_length -= 2;
                    do++e.strstart <= n && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + se - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart); while (0 !== --e.prev_length);
                    if (e.match_available = 0, e.match_length = se - 1, e.strstart++, r && (s(e, !1), 0 === e.strm.avail_out))return ye
                } else if (e.match_available) {
                    if (r = P._tr_tally(e, 0, e.window[e.strstart - 1]), r && s(e, !1), e.strstart++, e.lookahead--, 0 === e.strm.avail_out)return ye
                } else e.match_available = 1, e.strstart++, e.lookahead--
            }
            return e.match_available && (r = P._tr_tally(e, 0, e.window[e.strstart - 1]), e.match_available = 0), e.insert = e.strstart < se - 1 ? e.strstart : se - 1, t === D ? (s(e, !0), 0 === e.strm.avail_out ? we : _e) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? ye : be
        }

        function g(e, t) {
            for (var i, r, n, o, a = e.window; ;) {
                if (e.lookahead <= he) {
                    if (d(e), e.lookahead <= he && t === R)return ye;
                    if (0 === e.lookahead)break
                }
                if (e.match_length = 0, e.lookahead >= se && e.strstart > 0 && (n = e.strstart - 1, r = a[n], r === a[++n] && r === a[++n] && r === a[++n])) {
                    o = e.strstart + he;
                    do; while (r === a[++n] && r === a[++n] && r === a[++n] && r === a[++n] && r === a[++n] && r === a[++n] && r === a[++n] && r === a[++n] && o > n);
                    e.match_length = he - (o - n), e.match_length > e.lookahead && (e.match_length = e.lookahead)
                }
                if (e.match_length >= se ? (i = P._tr_tally(e, 1, e.match_length - se), e.lookahead -= e.match_length, e.strstart += e.match_length, e.match_length = 0) : (i = P._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++), i && (s(e, !1), 0 === e.strm.avail_out))return ye
            }
            return e.insert = 0, t === D ? (s(e, !0), 0 === e.strm.avail_out ? we : _e) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? ye : be
        }

        function v(e, t) {
            for (var i; ;) {
                if (0 === e.lookahead && (d(e), 0 === e.lookahead)) {
                    if (t === R)return ye;
                    break
                }
                if (e.match_length = 0, i = P._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++, i && (s(e, !1), 0 === e.strm.avail_out))return ye
            }
            return e.insert = 0, t === D ? (s(e, !0), 0 === e.strm.avail_out ? we : _e) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? ye : be
        }

        function y(e) {
            e.window_size = 2 * e.w_size, o(e.head), e.max_lazy_match = T[e.level].max_lazy, e.good_match = T[e.level].good_length, e.nice_match = T[e.level].nice_length, e.max_chain_length = T[e.level].max_chain, e.strstart = 0, e.block_start = 0, e.lookahead = 0, e.insert = 0, e.match_length = e.prev_length = se - 1, e.match_available = 0, e.ins_h = 0
        }

        function b() {
            this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = K, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new C.Buf16(2 * oe), this.dyn_dtree = new C.Buf16(2 * (2 * re + 1)), this.bl_tree = new C.Buf16(2 * (2 * ne + 1)), o(this.dyn_ltree), o(this.dyn_dtree), o(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = new C.Buf16(ae + 1), this.heap = new C.Buf16(2 * ie + 1), o(this.heap),
                this.heap_len = 0, this.heap_max = 0, this.depth = new C.Buf16(2 * ie + 1), o(this.depth), this.l_buf = 0, this.lit_bufsize = 0, this.last_lit = 0, this.d_buf = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0
        }

        function w(e) {
            var t;
            return e && e.state ? (e.total_in = e.total_out = 0, e.data_type = q, t = e.state, t.pending = 0, t.pending_out = 0, t.wrap < 0 && (t.wrap = -t.wrap), t.status = t.wrap ? ce : ge, e.adler = 2 === t.wrap ? 0 : 1, t.last_flush = R, P._tr_init(t), N) : r(e, z)
        }

        function _(e) {
            var t = w(e);
            return t === N && y(e.state), t
        }

        function x(e, t) {
            return e && e.state ? 2 !== e.state.wrap ? z : (e.state.gzhead = t, N) : z
        }

        function S(e, t, i, n, o, a) {
            if (!e)return z;
            var s = 1;
            if (t === H && (t = 6), 0 > n ? (s = 0, n = -n) : n > 15 && (s = 2, n -= 16), 1 > o || o > Q || i !== K || 8 > n || n > 15 || 0 > t || t > 9 || 0 > a || a > Z)return r(e, z);
            8 === n && (n = 9);
            var h = new b;
            return e.state = h, h.strm = e, h.wrap = s, h.gzhead = null, h.w_bits = n, h.w_size = 1 << h.w_bits, h.w_mask = h.w_size - 1, h.hash_bits = o + 7, h.hash_size = 1 << h.hash_bits, h.hash_mask = h.hash_size - 1, h.hash_shift = ~~((h.hash_bits + se - 1) / se), h.window = new C.Buf8(2 * h.w_size), h.head = new C.Buf16(h.hash_size), h.prev = new C.Buf16(h.w_size), h.lit_bufsize = 1 << o + 6, h.pending_buf_size = 4 * h.lit_bufsize, h.pending_buf = new C.Buf8(h.pending_buf_size), h.d_buf = h.lit_bufsize >> 1, h.l_buf = 3 * h.lit_bufsize, h.level = t, h.strategy = a, h.method = i, _(e)
        }

        function E(e, t) {
            return S(e, t, K, J, $, X)
        }

        function M(e, t) {
            var i, s, u, c;
            if (!e || !e.state || t > O || 0 > t)return e ? r(e, z) : z;
            if (s = e.state, !e.output || !e.input && 0 !== e.avail_in || s.status === ve && t !== D)return r(e, 0 === e.avail_out ? W : z);
            if (s.strm = e, i = s.last_flush, s.last_flush = t, s.status === ce)if (2 === s.wrap)e.adler = 0, h(s, 31), h(s, 139), h(s, 8), s.gzhead ? (h(s, (s.gzhead.text ? 1 : 0) + (s.gzhead.hcrc ? 2 : 0) + (s.gzhead.extra ? 4 : 0) + (s.gzhead.name ? 8 : 0) + (s.gzhead.comment ? 16 : 0)), h(s, 255 & s.gzhead.time), h(s, s.gzhead.time >> 8 & 255), h(s, s.gzhead.time >> 16 & 255), h(s, s.gzhead.time >> 24 & 255), h(s, 9 === s.level ? 2 : s.strategy >= j || s.level < 2 ? 4 : 0), h(s, 255 & s.gzhead.os), s.gzhead.extra && s.gzhead.extra.length && (h(s, 255 & s.gzhead.extra.length), h(s, s.gzhead.extra.length >> 8 & 255)), s.gzhead.hcrc && (e.adler = k(e.adler, s.pending_buf, s.pending, 0)), s.gzindex = 0, s.status = de) : (h(s, 0), h(s, 0), h(s, 0), h(s, 0), h(s, 0), h(s, 9 === s.level ? 2 : s.strategy >= j || s.level < 2 ? 4 : 0), h(s, xe), s.status = ge); else {
                var d = K + (s.w_bits - 8 << 4) << 8, f = -1;
                f = s.strategy >= j || s.level < 2 ? 0 : s.level < 6 ? 1 : 6 === s.level ? 2 : 3, d |= f << 6, 0 !== s.strstart && (d |= ue), d += 31 - d % 31, s.status = ge, l(s, d), 0 !== s.strstart && (l(s, e.adler >>> 16), l(s, 65535 & e.adler)), e.adler = 1
            }
            if (s.status === de)if (s.gzhead.extra) {
                for (u = s.pending; s.gzindex < (65535 & s.gzhead.extra.length) && (s.pending !== s.pending_buf_size || (s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending !== s.pending_buf_size));)h(s, 255 & s.gzhead.extra[s.gzindex]), s.gzindex++;
                s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), s.gzindex === s.gzhead.extra.length && (s.gzindex = 0, s.status = fe)
            } else s.status = fe;
            if (s.status === fe)if (s.gzhead.name) {
                u = s.pending;
                do {
                    if (s.pending === s.pending_buf_size && (s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending === s.pending_buf_size)) {
                        c = 1;
                        break
                    }
                    c = s.gzindex < s.gzhead.name.length ? 255 & s.gzhead.name.charCodeAt(s.gzindex++) : 0, h(s, c)
                } while (0 !== c);
                s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), 0 === c && (s.gzindex = 0, s.status = pe)
            } else s.status = pe;
            if (s.status === pe)if (s.gzhead.comment) {
                u = s.pending;
                do {
                    if (s.pending === s.pending_buf_size && (s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending === s.pending_buf_size)) {
                        c = 1;
                        break
                    }
                    c = s.gzindex < s.gzhead.comment.length ? 255 & s.gzhead.comment.charCodeAt(s.gzindex++) : 0, h(s, c)
                } while (0 !== c);
                s.gzhead.hcrc && s.pending > u && (e.adler = k(e.adler, s.pending_buf, s.pending - u, u)), 0 === c && (s.status = me)
            } else s.status = me;
            if (s.status === me && (s.gzhead.hcrc ? (s.pending + 2 > s.pending_buf_size && a(e), s.pending + 2 <= s.pending_buf_size && (h(s, 255 & e.adler), h(s, e.adler >> 8 & 255), e.adler = 0, s.status = ge)) : s.status = ge), 0 !== s.pending) {
                if (a(e), 0 === e.avail_out)return s.last_flush = -1, N
            } else if (0 === e.avail_in && n(t) <= n(i) && t !== D)return r(e, W);
            if (s.status === ve && 0 !== e.avail_in)return r(e, W);
            if (0 !== e.avail_in || 0 !== s.lookahead || t !== R && s.status !== ve) {
                var p = s.strategy === j ? v(s, t) : s.strategy === Y ? g(s, t) : T[s.level].func(s, t);
                if ((p === we || p === _e) && (s.status = ve), p === ye || p === we)return 0 === e.avail_out && (s.last_flush = -1), N;
                if (p === be && (t === I ? P._tr_align(s) : t !== O && (P._tr_stored_block(s, 0, 0, !1), t === F && (o(s.head), 0 === s.lookahead && (s.strstart = 0, s.block_start = 0, s.insert = 0))), a(e), 0 === e.avail_out))return s.last_flush = -1, N
            }
            return t !== D ? N : s.wrap <= 0 ? U : (2 === s.wrap ? (h(s, 255 & e.adler), h(s, e.adler >> 8 & 255), h(s, e.adler >> 16 & 255), h(s, e.adler >> 24 & 255), h(s, 255 & e.total_in), h(s, e.total_in >> 8 & 255), h(s, e.total_in >> 16 & 255), h(s, e.total_in >> 24 & 255)) : (l(s, e.adler >>> 16), l(s, 65535 & e.adler)), a(e), s.wrap > 0 && (s.wrap = -s.wrap), 0 !== s.pending ? N : U)
        }

        function A(e) {
            var t;
            return e && e.state ? (t = e.state.status, t !== ce && t !== de && t !== fe && t !== pe && t !== me && t !== ge && t !== ve ? r(e, z) : (e.state = null, t === ge ? r(e, V) : N)) : z
        }

        var T, C = e("../utils/common"), P = e("./trees"), L = e("./adler32"), k = e("./crc32"), B = e("./messages"), R = 0, I = 1, F = 3, D = 4, O = 5, N = 0, U = 1, z = -2, V = -3, W = -5, H = -1, G = 1, j = 2, Y = 3, Z = 4, X = 0, q = 2, K = 8, Q = 9, J = 15, $ = 8, ee = 29, te = 256, ie = te + 1 + ee, re = 30, ne = 19, oe = 2 * ie + 1, ae = 15, se = 3, he = 258, le = he + se + 1, ue = 32, ce = 42, de = 69, fe = 73, pe = 91, me = 103, ge = 113, ve = 666, ye = 1, be = 2, we = 3, _e = 4, xe = 3, Se = function (e, t, i, r, n) {
            this.good_length = e, this.max_lazy = t, this.nice_length = i, this.max_chain = r, this.func = n
        };
        T = [new Se(0, 0, 0, 0, f), new Se(4, 4, 8, 4, p), new Se(4, 5, 16, 8, p), new Se(4, 6, 32, 32, p), new Se(4, 4, 16, 16, m), new Se(8, 16, 32, 32, m), new Se(8, 16, 128, 128, m), new Se(8, 32, 128, 256, m), new Se(32, 128, 258, 1024, m), new Se(32, 258, 258, 4096, m)], i.deflateInit = E, i.deflateInit2 = S, i.deflateReset = _, i.deflateResetKeep = w, i.deflateSetHeader = x, i.deflate = M, i.deflateEnd = A, i.deflateInfo = "pako deflate (from Nodeca project)"
    }, {"../utils/common": 122, "./adler32": 124, "./crc32": 126, "./messages": 132, "./trees": 133}],
    128: [function (e, t, i) {
        "use strict";
        function r() {
            this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1
        }

        t.exports = r
    }, {}],
    129: [function (e, t, i) {
        "use strict";
        var r = 30, n = 12;
        t.exports = function (e, t) {
            var i, o, a, s, h, l, u, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C;
            i = e.state, o = e.next_in, T = e.input, a = o + (e.avail_in - 5), s = e.next_out, C = e.output, h = s - (t - e.avail_out), l = s + (e.avail_out - 257), u = i.dmax, c = i.wsize, d = i.whave, f = i.wnext, p = i.window, m = i.hold, g = i.bits, v = i.lencode, y = i.distcode, b = (1 << i.lenbits) - 1, w = (1 << i.distbits) - 1;
            e:do {
                15 > g && (m += T[o++] << g, g += 8, m += T[o++] << g, g += 8), _ = v[m & b];
                t:for (; ;) {
                    if (x = _ >>> 24, m >>>= x, g -= x, x = _ >>> 16 & 255, 0 === x)C[s++] = 65535 & _; else {
                        if (!(16 & x)) {
                            if (0 === (64 & x)) {
                                _ = v[(65535 & _) + (m & (1 << x) - 1)];
                                continue t
                            }
                            if (32 & x) {
                                i.mode = n;
                                break e
                            }
                            e.msg = "invalid literal/length code", i.mode = r;
                            break e
                        }
                        S = 65535 & _, x &= 15, x && (x > g && (m += T[o++] << g, g += 8), S += m & (1 << x) - 1, m >>>= x, g -= x), 15 > g && (m += T[o++] << g, g += 8, m += T[o++] << g, g += 8), _ = y[m & w];
                        i:for (; ;) {
                            if (x = _ >>> 24, m >>>= x, g -= x, x = _ >>> 16 & 255, !(16 & x)) {
                                if (0 === (64 & x)) {
                                    _ = y[(65535 & _) + (m & (1 << x) - 1)];
                                    continue i
                                }
                                e.msg = "invalid distance code", i.mode = r;
                                break e
                            }
                            if (E = 65535 & _, x &= 15, x > g && (m += T[o++] << g, g += 8, x > g && (m += T[o++] << g, g += 8)), E += m & (1 << x) - 1, E > u) {
                                e.msg = "invalid distance too far back", i.mode = r;
                                break e
                            }
                            if (m >>>= x, g -= x, x = s - h, E > x) {
                                if (x = E - x, x > d && i.sane) {
                                    e.msg = "invalid distance too far back", i.mode = r;
                                    break e
                                }
                                if (M = 0, A = p, 0 === f) {
                                    if (M += c - x, S > x) {
                                        S -= x;
                                        do C[s++] = p[M++]; while (--x);
                                        M = s - E, A = C
                                    }
                                } else if (x > f) {
                                    if (M += c + f - x, x -= f, S > x) {
                                        S -= x;
                                        do C[s++] = p[M++]; while (--x);
                                        if (M = 0, S > f) {
                                            x = f, S -= x;
                                            do C[s++] = p[M++]; while (--x);
                                            M = s - E, A = C
                                        }
                                    }
                                } else if (M += f - x, S > x) {
                                    S -= x;
                                    do C[s++] = p[M++]; while (--x);
                                    M = s - E, A = C
                                }
                                for (; S > 2;)C[s++] = A[M++], C[s++] = A[M++], C[s++] = A[M++], S -= 3;
                                S && (C[s++] = A[M++], S > 1 && (C[s++] = A[M++]))
                            } else {
                                M = s - E;
                                do C[s++] = C[M++], C[s++] = C[M++], C[s++] = C[M++], S -= 3; while (S > 2);
                                S && (C[s++] = C[M++], S > 1 && (C[s++] = C[M++]))
                            }
                            break
                        }
                    }
                    break
                }
            } while (a > o && l > s);
            S = g >> 3, o -= S, g -= S << 3, m &= (1 << g) - 1, e.next_in = o, e.next_out = s, e.avail_in = a > o ? 5 + (a - o) : 5 - (o - a), e.avail_out = l > s ? 257 + (l - s) : 257 - (s - l), i.hold = m, i.bits = g
        }
    }, {}],
    130: [function (e, t, i) {
        "use strict";
        function r(e) {
            return (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24)
        }

        function n() {
            this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new v.Buf16(320), this.work = new v.Buf16(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0
        }

        function o(e) {
            var t;
            return e && e.state ? (t = e.state, e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = D, t.last = 0, t.havedict = 0, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new v.Buf32(pe), t.distcode = t.distdyn = new v.Buf32(me), t.sane = 1, t.back = -1, C) : k
        }

        function a(e) {
            var t;
            return e && e.state ? (t = e.state, t.wsize = 0, t.whave = 0, t.wnext = 0, o(e)) : k
        }

        function s(e, t) {
            var i, r;
            return e && e.state ? (r = e.state, 0 > t ? (i = 0, t = -t) : (i = (t >> 4) + 1, 48 > t && (t &= 15)), t && (8 > t || t > 15) ? k : (null !== r.window && r.wbits !== t && (r.window = null), r.wrap = i, r.wbits = t, a(e))) : k
        }

        function h(e, t) {
            var i, r;
            return e ? (r = new n, e.state = r, r.window = null, i = s(e, t), i !== C && (e.state = null), i) : k
        }

        function l(e) {
            return h(e, ve)
        }

        function u(e) {
            if (ye) {
                var t;
                for (m = new v.Buf32(512), g = new v.Buf32(32), t = 0; 144 > t;)e.lens[t++] = 8;
                for (; 256 > t;)e.lens[t++] = 9;
                for (; 280 > t;)e.lens[t++] = 7;
                for (; 288 > t;)e.lens[t++] = 8;
                for (_(S, e.lens, 0, 288, m, 0, e.work, {bits: 9}), t = 0; 32 > t;)e.lens[t++] = 5;
                _(E, e.lens, 0, 32, g, 0, e.work, {bits: 5}), ye = !1
            }
            e.lencode = m, e.lenbits = 9, e.distcode = g, e.distbits = 5
        }

        function c(e, t, i, r) {
            var n, o = e.state;
            return null === o.window && (o.wsize = 1 << o.wbits, o.wnext = 0, o.whave = 0, o.window = new v.Buf8(o.wsize)), r >= o.wsize ? (v.arraySet(o.window, t, i - o.wsize, o.wsize, 0), o.wnext = 0, o.whave = o.wsize) : (n = o.wsize - o.wnext, n > r && (n = r), v.arraySet(o.window, t, i - r, n, o.wnext), r -= n, r ? (v.arraySet(o.window, t, i - r, r, 0), o.wnext = r, o.whave = o.wsize) : (o.wnext += n, o.wnext === o.wsize && (o.wnext = 0), o.whave < o.wsize && (o.whave += n))), 0
        }

        function d(e, t) {
            var i, n, o, a, s, h, l, d, f, p, m, g, pe, me, ge, ve, ye, be, we, _e, xe, Se, Ee, Me, Ae = 0, Te = new v.Buf8(4), Ce = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
            if (!e || !e.state || !e.output || !e.input && 0 !== e.avail_in)return k;
            i = e.state, i.mode === Z && (i.mode = X), s = e.next_out, o = e.output, l = e.avail_out, a = e.next_in, n = e.input, h = e.avail_in, d = i.hold, f = i.bits, p = h, m = l, Se = C;
            e:for (; ;)switch (i.mode) {
                case D:
                    if (0 === i.wrap) {
                        i.mode = X;
                        break
                    }
                    for (; 16 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if (2 & i.wrap && 35615 === d) {
                        i.check = 0, Te[0] = 255 & d, Te[1] = d >>> 8 & 255, i.check = b(i.check, Te, 2, 0), d = 0, f = 0, i.mode = O;
                        break
                    }
                    if (i.flags = 0, i.head && (i.head.done = !1), !(1 & i.wrap) || (((255 & d) << 8) + (d >> 8)) % 31) {
                        e.msg = "incorrect header check", i.mode = ce;
                        break
                    }
                    if ((15 & d) !== F) {
                        e.msg = "unknown compression method", i.mode = ce;
                        break
                    }
                    if (d >>>= 4, f -= 4, xe = (15 & d) + 8, 0 === i.wbits)i.wbits = xe; else if (xe > i.wbits) {
                        e.msg = "invalid window size", i.mode = ce;
                        break
                    }
                    i.dmax = 1 << xe, e.adler = i.check = 1, i.mode = 512 & d ? j : Z, d = 0, f = 0;
                    break;
                case O:
                    for (; 16 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if (i.flags = d, (255 & i.flags) !== F) {
                        e.msg = "unknown compression method", i.mode = ce;
                        break
                    }
                    if (57344 & i.flags) {
                        e.msg = "unknown header flags set", i.mode = ce;
                        break
                    }
                    i.head && (i.head.text = d >> 8 & 1), 512 & i.flags && (Te[0] = 255 & d, Te[1] = d >>> 8 & 255, i.check = b(i.check, Te, 2, 0)), d = 0, f = 0, i.mode = N;
                case N:
                    for (; 32 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    i.head && (i.head.time = d), 512 & i.flags && (Te[0] = 255 & d, Te[1] = d >>> 8 & 255, Te[2] = d >>> 16 & 255, Te[3] = d >>> 24 & 255, i.check = b(i.check, Te, 4, 0)), d = 0, f = 0, i.mode = U;
                case U:
                    for (; 16 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    i.head && (i.head.xflags = 255 & d, i.head.os = d >> 8), 512 & i.flags && (Te[0] = 255 & d, Te[1] = d >>> 8 & 255, i.check = b(i.check, Te, 2, 0)), d = 0, f = 0, i.mode = z;
                case z:
                    if (1024 & i.flags) {
                        for (; 16 > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        i.length = d, i.head && (i.head.extra_len = d), 512 & i.flags && (Te[0] = 255 & d, Te[1] = d >>> 8 & 255, i.check = b(i.check, Te, 2, 0)), d = 0, f = 0
                    } else i.head && (i.head.extra = null);
                    i.mode = V;
                case V:
                    if (1024 & i.flags && (g = i.length, g > h && (g = h), g && (i.head && (xe = i.head.extra_len - i.length, i.head.extra || (i.head.extra = new Array(i.head.extra_len)), v.arraySet(i.head.extra, n, a, g, xe)), 512 & i.flags && (i.check = b(i.check, n, g, a)), h -= g, a += g, i.length -= g), i.length))break e;
                    i.length = 0, i.mode = W;
                case W:
                    if (2048 & i.flags) {
                        if (0 === h)break e;
                        g = 0;
                        do xe = n[a + g++], i.head && xe && i.length < 65536 && (i.head.name += String.fromCharCode(xe)); while (xe && h > g);
                        if (512 & i.flags && (i.check = b(i.check, n, g, a)), h -= g, a += g, xe)break e
                    } else i.head && (i.head.name = null);
                    i.length = 0, i.mode = H;
                case H:
                    if (4096 & i.flags) {
                        if (0 === h)break e;
                        g = 0;
                        do xe = n[a + g++], i.head && xe && i.length < 65536 && (i.head.comment += String.fromCharCode(xe)); while (xe && h > g);
                        if (512 & i.flags && (i.check = b(i.check, n, g, a)), h -= g, a += g, xe)break e
                    } else i.head && (i.head.comment = null);
                    i.mode = G;
                case G:
                    if (512 & i.flags) {
                        for (; 16 > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        if (d !== (65535 & i.check)) {
                            e.msg = "header crc mismatch", i.mode = ce;
                            break
                        }
                        d = 0, f = 0
                    }
                    i.head && (i.head.hcrc = i.flags >> 9 & 1, i.head.done = !0), e.adler = i.check = 0, i.mode = Z;
                    break;
                case j:
                    for (; 32 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    e.adler = i.check = r(d), d = 0, f = 0, i.mode = Y;
                case Y:
                    if (0 === i.havedict)return e.next_out = s, e.avail_out = l, e.next_in = a, e.avail_in = h, i.hold = d, i.bits = f, L;
                    e.adler = i.check = 1, i.mode = Z;
                case Z:
                    if (t === A || t === T)break e;
                case X:
                    if (i.last) {
                        d >>>= 7 & f, f -= 7 & f, i.mode = he;
                        break
                    }
                    for (; 3 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    switch (i.last = 1 & d, d >>>= 1, f -= 1, 3 & d) {
                        case 0:
                            i.mode = q;
                            break;
                        case 1:
                            if (u(i), i.mode = te, t === T) {
                                d >>>= 2, f -= 2;
                                break e
                            }
                            break;
                        case 2:
                            i.mode = J;
                            break;
                        case 3:
                            e.msg = "invalid block type", i.mode = ce
                    }
                    d >>>= 2, f -= 2;
                    break;
                case q:
                    for (d >>>= 7 & f, f -= 7 & f; 32 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if ((65535 & d) !== (d >>> 16 ^ 65535)) {
                        e.msg = "invalid stored block lengths", i.mode = ce;
                        break
                    }
                    if (i.length = 65535 & d, d = 0, f = 0, i.mode = K, t === T)break e;
                case K:
                    i.mode = Q;
                case Q:
                    if (g = i.length) {
                        if (g > h && (g = h), g > l && (g = l), 0 === g)break e;
                        v.arraySet(o, n, a, g, s), h -= g, a += g, l -= g, s += g, i.length -= g;
                        break
                    }
                    i.mode = Z;
                    break;
                case J:
                    for (; 14 > f;) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if (i.nlen = (31 & d) + 257, d >>>= 5, f -= 5, i.ndist = (31 & d) + 1, d >>>= 5, f -= 5, i.ncode = (15 & d) + 4, d >>>= 4, f -= 4, i.nlen > 286 || i.ndist > 30) {
                        e.msg = "too many length or distance symbols", i.mode = ce;
                        break
                    }
                    i.have = 0, i.mode = $;
                case $:
                    for (; i.have < i.ncode;) {
                        for (; 3 > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        i.lens[Ce[i.have++]] = 7 & d, d >>>= 3, f -= 3
                    }
                    for (; i.have < 19;)i.lens[Ce[i.have++]] = 0;
                    if (i.lencode = i.lendyn, i.lenbits = 7, Ee = {bits: i.lenbits}, Se = _(x, i.lens, 0, 19, i.lencode, 0, i.work, Ee), i.lenbits = Ee.bits, Se) {
                        e.msg = "invalid code lengths set", i.mode = ce;
                        break
                    }
                    i.have = 0, i.mode = ee;
                case ee:
                    for (; i.have < i.nlen + i.ndist;) {
                        for (; Ae = i.lencode[d & (1 << i.lenbits) - 1], ge = Ae >>> 24, ve = Ae >>> 16 & 255, ye = 65535 & Ae, !(f >= ge);) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        if (16 > ye)d >>>= ge, f -= ge, i.lens[i.have++] = ye; else {
                            if (16 === ye) {
                                for (Me = ge + 2; Me > f;) {
                                    if (0 === h)break e;
                                    h--, d += n[a++] << f, f += 8
                                }
                                if (d >>>= ge, f -= ge, 0 === i.have) {
                                    e.msg = "invalid bit length repeat", i.mode = ce;
                                    break
                                }
                                xe = i.lens[i.have - 1], g = 3 + (3 & d), d >>>= 2, f -= 2
                            } else if (17 === ye) {
                                for (Me = ge + 3; Me > f;) {
                                    if (0 === h)break e;
                                    h--, d += n[a++] << f, f += 8
                                }
                                d >>>= ge, f -= ge, xe = 0, g = 3 + (7 & d), d >>>= 3, f -= 3
                            } else {
                                for (Me = ge + 7; Me > f;) {
                                    if (0 === h)break e;
                                    h--, d += n[a++] << f, f += 8
                                }
                                d >>>= ge, f -= ge, xe = 0, g = 11 + (127 & d), d >>>= 7, f -= 7
                            }
                            if (i.have + g > i.nlen + i.ndist) {
                                e.msg = "invalid bit length repeat", i.mode = ce;
                                break
                            }
                            for (; g--;)i.lens[i.have++] = xe
                        }
                    }
                    if (i.mode === ce)break;
                    if (0 === i.lens[256]) {
                        e.msg = "invalid code -- missing end-of-block", i.mode = ce;
                        break
                    }
                    if (i.lenbits = 9, Ee = {bits: i.lenbits}, Se = _(S, i.lens, 0, i.nlen, i.lencode, 0, i.work, Ee), i.lenbits = Ee.bits, Se) {
                        e.msg = "invalid literal/lengths set", i.mode = ce;
                        break
                    }
                    if (i.distbits = 6, i.distcode = i.distdyn, Ee = {bits: i.distbits}, Se = _(E, i.lens, i.nlen, i.ndist, i.distcode, 0, i.work, Ee), i.distbits = Ee.bits, Se) {
                        e.msg = "invalid distances set", i.mode = ce;
                        break
                    }
                    if (i.mode = te, t === T)break e;
                case te:
                    i.mode = ie;
                case ie:
                    if (h >= 6 && l >= 258) {
                        e.next_out = s, e.avail_out = l, e.next_in = a, e.avail_in = h, i.hold = d, i.bits = f, w(e, m), s = e.next_out, o = e.output, l = e.avail_out, a = e.next_in, n = e.input, h = e.avail_in, d = i.hold, f = i.bits, i.mode === Z && (i.back = -1);
                        break
                    }
                    for (i.back = 0; Ae = i.lencode[d & (1 << i.lenbits) - 1], ge = Ae >>> 24, ve = Ae >>> 16 & 255, ye = 65535 & Ae, !(f >= ge);) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if (ve && 0 === (240 & ve)) {
                        for (be = ge, we = ve, _e = ye; Ae = i.lencode[_e + ((d & (1 << be + we) - 1) >> be)], ge = Ae >>> 24, ve = Ae >>> 16 & 255, ye = 65535 & Ae, !(f >= be + ge);) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        d >>>= be, f -= be, i.back += be
                    }
                    if (d >>>= ge, f -= ge, i.back += ge, i.length = ye, 0 === ve) {
                        i.mode = se;
                        break
                    }
                    if (32 & ve) {
                        i.back = -1, i.mode = Z;
                        break
                    }
                    if (64 & ve) {
                        e.msg = "invalid literal/length code", i.mode = ce;
                        break
                    }
                    i.extra = 15 & ve, i.mode = re;
                case re:
                    if (i.extra) {
                        for (Me = i.extra; Me > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        i.length += d & (1 << i.extra) - 1, d >>>= i.extra, f -= i.extra, i.back += i.extra
                    }
                    i.was = i.length, i.mode = ne;
                case ne:
                    for (; Ae = i.distcode[d & (1 << i.distbits) - 1], ge = Ae >>> 24, ve = Ae >>> 16 & 255, ye = 65535 & Ae, !(f >= ge);) {
                        if (0 === h)break e;
                        h--, d += n[a++] << f, f += 8
                    }
                    if (0 === (240 & ve)) {
                        for (be = ge, we = ve, _e = ye; Ae = i.distcode[_e + ((d & (1 << be + we) - 1) >> be)], ge = Ae >>> 24, ve = Ae >>> 16 & 255, ye = 65535 & Ae, !(f >= be + ge);) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        d >>>= be, f -= be, i.back += be
                    }
                    if (d >>>= ge, f -= ge, i.back += ge, 64 & ve) {
                        e.msg = "invalid distance code", i.mode = ce;
                        break
                    }
                    i.offset = ye, i.extra = 15 & ve, i.mode = oe;
                case oe:
                    if (i.extra) {
                        for (Me = i.extra; Me > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        i.offset += d & (1 << i.extra) - 1, d >>>= i.extra, f -= i.extra, i.back += i.extra
                    }
                    if (i.offset > i.dmax) {
                        e.msg = "invalid distance too far back", i.mode = ce;
                        break
                    }
                    i.mode = ae;
                case ae:
                    if (0 === l)break e;
                    if (g = m - l, i.offset > g) {
                        if (g = i.offset - g, g > i.whave && i.sane) {
                            e.msg = "invalid distance too far back", i.mode = ce;
                            break
                        }
                        g > i.wnext ? (g -= i.wnext, pe = i.wsize - g) : pe = i.wnext - g, g > i.length && (g = i.length), me = i.window
                    } else me = o, pe = s - i.offset, g = i.length;
                    g > l && (g = l), l -= g, i.length -= g;
                    do o[s++] = me[pe++]; while (--g);
                    0 === i.length && (i.mode = ie);
                    break;
                case se:
                    if (0 === l)break e;
                    o[s++] = i.length, l--, i.mode = ie;
                    break;
                case he:
                    if (i.wrap) {
                        for (; 32 > f;) {
                            if (0 === h)break e;
                            h--, d |= n[a++] << f, f += 8
                        }
                        if (m -= l, e.total_out += m, i.total += m, m && (e.adler = i.check = i.flags ? b(i.check, o, m, s - m) : y(i.check, o, m, s - m)), m = l, (i.flags ? d : r(d)) !== i.check) {
                            e.msg = "incorrect data check", i.mode = ce;
                            break
                        }
                        d = 0, f = 0
                    }
                    i.mode = le;
                case le:
                    if (i.wrap && i.flags) {
                        for (; 32 > f;) {
                            if (0 === h)break e;
                            h--, d += n[a++] << f, f += 8
                        }
                        if (d !== (4294967295 & i.total)) {
                            e.msg = "incorrect length check", i.mode = ce;
                            break
                        }
                        d = 0, f = 0
                    }
                    i.mode = ue;
                case ue:
                    Se = P;
                    break e;
                case ce:
                    Se = B;
                    break e;
                case de:
                    return R;
                case fe:
                default:
                    return k
            }
            return e.next_out = s, e.avail_out = l, e.next_in = a, e.avail_in = h, i.hold = d, i.bits = f, (i.wsize || m !== e.avail_out && i.mode < ce && (i.mode < he || t !== M)) && c(e, e.output, e.next_out, m - e.avail_out) ? (i.mode = de, R) : (p -= e.avail_in, m -= e.avail_out, e.total_in += p, e.total_out += m, i.total += m, i.wrap && m && (e.adler = i.check = i.flags ? b(i.check, o, m, e.next_out - m) : y(i.check, o, m, e.next_out - m)), e.data_type = i.bits + (i.last ? 64 : 0) + (i.mode === Z ? 128 : 0) + (i.mode === te || i.mode === K ? 256 : 0), (0 === p && 0 === m || t === M) && Se === C && (Se = I), Se)
        }

        function f(e) {
            if (!e || !e.state)return k;
            var t = e.state;
            return t.window && (t.window = null), e.state = null, C
        }

        function p(e, t) {
            var i;
            return e && e.state ? (i = e.state, 0 === (2 & i.wrap) ? k : (i.head = t, t.done = !1, C)) : k
        }

        var m, g, v = e("../utils/common"), y = e("./adler32"), b = e("./crc32"), w = e("./inffast"), _ = e("./inftrees"), x = 0, S = 1, E = 2, M = 4, A = 5, T = 6, C = 0, P = 1, L = 2, k = -2, B = -3, R = -4, I = -5, F = 8, D = 1, O = 2, N = 3, U = 4, z = 5, V = 6, W = 7, H = 8, G = 9, j = 10, Y = 11, Z = 12, X = 13, q = 14, K = 15, Q = 16, J = 17, $ = 18, ee = 19, te = 20, ie = 21, re = 22, ne = 23, oe = 24, ae = 25, se = 26, he = 27, le = 28, ue = 29, ce = 30, de = 31, fe = 32, pe = 852, me = 592, ge = 15, ve = ge, ye = !0;
        i.inflateReset = a, i.inflateReset2 = s, i.inflateResetKeep = o, i.inflateInit = l, i.inflateInit2 = h, i.inflate = d, i.inflateEnd = f, i.inflateGetHeader = p, i.inflateInfo = "pako inflate (from Nodeca project)"
    }, {"../utils/common": 122, "./adler32": 124, "./crc32": 126, "./inffast": 129, "./inftrees": 131}],
    131: [function (e, t, i) {
        "use strict";
        var r = e("../utils/common"), n = 15, o = 852, a = 592, s = 0, h = 1, l = 2, u = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0], c = [16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78], d = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0], f = [16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64];
        t.exports = function (e, t, i, p, m, g, v, y) {
            var b, w, _, x, S, E, M, A, T, C = y.bits, P = 0, L = 0, k = 0, B = 0, R = 0, I = 0, F = 0, D = 0, O = 0, N = 0, U = null, z = 0, V = new r.Buf16(n + 1), W = new r.Buf16(n + 1), H = null, G = 0;
            for (P = 0; n >= P; P++)V[P] = 0;
            for (L = 0; p > L; L++)V[t[i + L]]++;
            for (R = C, B = n; B >= 1 && 0 === V[B]; B--);
            if (R > B && (R = B), 0 === B)return m[g++] = 20971520, m[g++] = 20971520, y.bits = 1, 0;
            for (k = 1; B > k && 0 === V[k]; k++);
            for (k > R && (R = k), D = 1, P = 1; n >= P; P++)if (D <<= 1, D -= V[P], 0 > D)return -1;
            if (D > 0 && (e === s || 1 !== B))return -1;
            for (W[1] = 0, P = 1; n > P; P++)W[P + 1] = W[P] + V[P];
            for (L = 0; p > L; L++)0 !== t[i + L] && (v[W[t[i + L]]++] = L);
            if (e === s ? (U = H = v, E = 19) : e === h ? (U = u, z -= 257, H = c, G -= 257, E = 256) : (U = d, H = f, E = -1), N = 0, L = 0, P = k, S = g, I = R, F = 0, _ = -1, O = 1 << R, x = O - 1, e === h && O > o || e === l && O > a)return 1;
            for (var j = 0; ;) {
                j++, M = P - F, v[L] < E ? (A = 0, T = v[L]) : v[L] > E ? (A = H[G + v[L]], T = U[z + v[L]]) : (A = 96, T = 0), b = 1 << P - F, w = 1 << I, k = w;
                do w -= b, m[S + (N >> F) + w] = M << 24 | A << 16 | T | 0; while (0 !== w);
                for (b = 1 << P - 1; N & b;)b >>= 1;
                if (0 !== b ? (N &= b - 1, N += b) : N = 0, L++, 0 === --V[P]) {
                    if (P === B)break;
                    P = t[i + v[L]]
                }
                if (P > R && (N & x) !== _) {
                    for (0 === F && (F = R), S += k, I = P - F, D = 1 << I; B > I + F && (D -= V[I + F], !(0 >= D));)I++, D <<= 1;
                    if (O += 1 << I, e === h && O > o || e === l && O > a)return 1;
                    _ = N & x, m[_] = R << 24 | I << 16 | S - g | 0
                }
            }
            return 0 !== N && (m[S + N] = P - F << 24 | 64 << 16 | 0), y.bits = R, 0
        }
    }, {"../utils/common": 122}],
    132: [function (e, t, i) {
        "use strict";
        t.exports = {
            2: "need dictionary",
            1: "stream end",
            0: "",
            "-1": "file error",
            "-2": "stream error",
            "-3": "data error",
            "-4": "insufficient memory",
            "-5": "buffer error",
            "-6": "incompatible version"
        }
    }, {}],
    133: [function (e, t, i) {
        "use strict";
        function r(e) {
            for (var t = e.length; --t >= 0;)e[t] = 0
        }

        function n(e) {
            return 256 > e ? ae[e] : ae[256 + (e >>> 7)]
        }

        function o(e, t) {
            e.pending_buf[e.pending++] = 255 & t, e.pending_buf[e.pending++] = t >>> 8 & 255
        }

        function a(e, t, i) {
            e.bi_valid > Z - i ? (e.bi_buf |= t << e.bi_valid & 65535, o(e, e.bi_buf), e.bi_buf = t >> Z - e.bi_valid, e.bi_valid += i - Z) : (e.bi_buf |= t << e.bi_valid & 65535, e.bi_valid += i)
        }

        function s(e, t, i) {
            a(e, i[2 * t], i[2 * t + 1])
        }

        function h(e, t) {
            var i = 0;
            do i |= 1 & e, e >>>= 1, i <<= 1; while (--t > 0);
            return i >>> 1
        }

        function l(e) {
            16 === e.bi_valid ? (o(e, e.bi_buf), e.bi_buf = 0, e.bi_valid = 0) : e.bi_valid >= 8 && (e.pending_buf[e.pending++] = 255 & e.bi_buf, e.bi_buf >>= 8, e.bi_valid -= 8)
        }

        function u(e, t) {
            var i, r, n, o, a, s, h = t.dyn_tree, l = t.max_code, u = t.stat_desc.static_tree, c = t.stat_desc.has_stree, d = t.stat_desc.extra_bits, f = t.stat_desc.extra_base, p = t.stat_desc.max_length, m = 0;
            for (o = 0; Y >= o; o++)e.bl_count[o] = 0;
            for (h[2 * e.heap[e.heap_max] + 1] = 0, i = e.heap_max + 1; j > i; i++)r = e.heap[i], o = h[2 * h[2 * r + 1] + 1] + 1, o > p && (o = p, m++), h[2 * r + 1] = o, r > l || (e.bl_count[o]++, a = 0, r >= f && (a = d[r - f]), s = h[2 * r], e.opt_len += s * (o + a), c && (e.static_len += s * (u[2 * r + 1] + a)));
            if (0 !== m) {
                do {
                    for (o = p - 1; 0 === e.bl_count[o];)o--;
                    e.bl_count[o]--, e.bl_count[o + 1] += 2, e.bl_count[p]--, m -= 2
                } while (m > 0);
                for (o = p; 0 !== o; o--)for (r = e.bl_count[o]; 0 !== r;)n = e.heap[--i], n > l || (h[2 * n + 1] !== o && (e.opt_len += (o - h[2 * n + 1]) * h[2 * n], h[2 * n + 1] = o), r--)
            }
        }

        function c(e, t, i) {
            var r, n, o = new Array(Y + 1), a = 0;
            for (r = 1; Y >= r; r++)o[r] = a = a + i[r - 1] << 1;
            for (n = 0; t >= n; n++) {
                var s = e[2 * n + 1];
                0 !== s && (e[2 * n] = h(o[s]++, s))
            }
        }

        function d() {
            var e, t, i, r, n, o = new Array(Y + 1);
            for (i = 0, r = 0; z - 1 > r; r++)for (he[r] = i, e = 0; e < 1 << $[r]; e++)se[i++] = r;
            for (se[i - 1] = r, n = 0, r = 0; 16 > r; r++)for (le[r] = n, e = 0; e < 1 << ee[r]; e++)ae[n++] = r;
            for (n >>= 7; H > r; r++)for (le[r] = n << 7, e = 0; e < 1 << ee[r] - 7; e++)ae[256 + n++] = r;
            for (t = 0; Y >= t; t++)o[t] = 0;
            for (e = 0; 143 >= e;)ne[2 * e + 1] = 8, e++, o[8]++;
            for (; 255 >= e;)ne[2 * e + 1] = 9, e++, o[9]++;
            for (; 279 >= e;)ne[2 * e + 1] = 7, e++, o[7]++;
            for (; 287 >= e;)ne[2 * e + 1] = 8, e++, o[8]++;
            for (c(ne, W + 1, o), e = 0; H > e; e++)oe[2 * e + 1] = 5, oe[2 * e] = h(e, 5);
            ue = new fe(ne, $, V + 1, W, Y), ce = new fe(oe, ee, 0, H, Y), de = new fe(new Array(0), te, 0, G, X)
        }

        function f(e) {
            var t;
            for (t = 0; W > t; t++)e.dyn_ltree[2 * t] = 0;
            for (t = 0; H > t; t++)e.dyn_dtree[2 * t] = 0;
            for (t = 0; G > t; t++)e.bl_tree[2 * t] = 0;
            e.dyn_ltree[2 * q] = 1, e.opt_len = e.static_len = 0, e.last_lit = e.matches = 0
        }

        function p(e) {
            e.bi_valid > 8 ? o(e, e.bi_buf) : e.bi_valid > 0 && (e.pending_buf[e.pending++] = e.bi_buf), e.bi_buf = 0, e.bi_valid = 0
        }

        function m(e, t, i, r) {
            p(e), r && (o(e, i), o(e, ~i)), L.arraySet(e.pending_buf, e.window, t, i, e.pending), e.pending += i
        }

        function g(e, t, i, r) {
            var n = 2 * t, o = 2 * i;
            return e[n] < e[o] || e[n] === e[o] && r[t] <= r[i]
        }

        function v(e, t, i) {
            for (var r = e.heap[i], n = i << 1; n <= e.heap_len && (n < e.heap_len && g(t, e.heap[n + 1], e.heap[n], e.depth) && n++, !g(t, r, e.heap[n], e.depth));)e.heap[i] = e.heap[n], i = n, n <<= 1;
            e.heap[i] = r
        }

        function y(e, t, i) {
            var r, o, h, l, u = 0;
            if (0 !== e.last_lit)do r = e.pending_buf[e.d_buf + 2 * u] << 8 | e.pending_buf[e.d_buf + 2 * u + 1], o = e.pending_buf[e.l_buf + u], u++, 0 === r ? s(e, o, t) : (h = se[o], s(e, h + V + 1, t), l = $[h], 0 !== l && (o -= he[h], a(e, o, l)), r--, h = n(r), s(e, h, i), l = ee[h], 0 !== l && (r -= le[h], a(e, r, l))); while (u < e.last_lit);
            s(e, q, t)
        }

        function b(e, t) {
            var i, r, n, o = t.dyn_tree, a = t.stat_desc.static_tree, s = t.stat_desc.has_stree, h = t.stat_desc.elems, l = -1;
            for (e.heap_len = 0, e.heap_max = j, i = 0; h > i; i++)0 !== o[2 * i] ? (e.heap[++e.heap_len] = l = i, e.depth[i] = 0) : o[2 * i + 1] = 0;
            for (; e.heap_len < 2;)n = e.heap[++e.heap_len] = 2 > l ? ++l : 0, o[2 * n] = 1, e.depth[n] = 0, e.opt_len--, s && (e.static_len -= a[2 * n + 1]);
            for (t.max_code = l, i = e.heap_len >> 1; i >= 1; i--)v(e, o, i);
            n = h;
            do i = e.heap[1], e.heap[1] = e.heap[e.heap_len--], v(e, o, 1), r = e.heap[1], e.heap[--e.heap_max] = i, e.heap[--e.heap_max] = r, o[2 * n] = o[2 * i] + o[2 * r], e.depth[n] = (e.depth[i] >= e.depth[r] ? e.depth[i] : e.depth[r]) + 1, o[2 * i + 1] = o[2 * r + 1] = n, e.heap[1] = n++, v(e, o, 1); while (e.heap_len >= 2);
            e.heap[--e.heap_max] = e.heap[1], u(e, t), c(o, l, e.bl_count)
        }

        function w(e, t, i) {
            var r, n, o = -1, a = t[1], s = 0, h = 7, l = 4;
            for (0 === a && (h = 138, l = 3), t[2 * (i + 1) + 1] = 65535, r = 0; i >= r; r++)n = a, a = t[2 * (r + 1) + 1], ++s < h && n === a || (l > s ? e.bl_tree[2 * n] += s : 0 !== n ? (n !== o && e.bl_tree[2 * n]++, e.bl_tree[2 * K]++) : 10 >= s ? e.bl_tree[2 * Q]++ : e.bl_tree[2 * J]++, s = 0, o = n, 0 === a ? (h = 138, l = 3) : n === a ? (h = 6, l = 3) : (h = 7, l = 4))
        }

        function _(e, t, i) {
            var r, n, o = -1, h = t[1], l = 0, u = 7, c = 4;
            for (0 === h && (u = 138, c = 3), r = 0; i >= r; r++)if (n = h, h = t[2 * (r + 1) + 1], !(++l < u && n === h)) {
                if (c > l) {
                    do s(e, n, e.bl_tree); while (0 !== --l)
                } else 0 !== n ? (n !== o && (s(e, n, e.bl_tree), l--), s(e, K, e.bl_tree), a(e, l - 3, 2)) : 10 >= l ? (s(e, Q, e.bl_tree), a(e, l - 3, 3)) : (s(e, J, e.bl_tree), a(e, l - 11, 7));
                l = 0, o = n, 0 === h ? (u = 138, c = 3) : n === h ? (u = 6, c = 3) : (u = 7, c = 4)
            }
        }

        function x(e) {
            var t;
            for (w(e, e.dyn_ltree, e.l_desc.max_code), w(e, e.dyn_dtree, e.d_desc.max_code), b(e, e.bl_desc), t = G - 1; t >= 3 && 0 === e.bl_tree[2 * ie[t] + 1]; t--);
            return e.opt_len += 3 * (t + 1) + 5 + 5 + 4, t
        }

        function S(e, t, i, r) {
            var n;
            for (a(e, t - 257, 5), a(e, i - 1, 5), a(e, r - 4, 4), n = 0; r > n; n++)a(e, e.bl_tree[2 * ie[n] + 1], 3);
            _(e, e.dyn_ltree, t - 1), _(e, e.dyn_dtree, i - 1)
        }

        function E(e) {
            var t, i = 4093624447;
            for (t = 0; 31 >= t; t++, i >>>= 1)if (1 & i && 0 !== e.dyn_ltree[2 * t])return B;
            if (0 !== e.dyn_ltree[18] || 0 !== e.dyn_ltree[20] || 0 !== e.dyn_ltree[26])return R;
            for (t = 32; V > t; t++)if (0 !== e.dyn_ltree[2 * t])return R;
            return B
        }

        function M(e) {
            me || (d(), me = !0), e.l_desc = new pe(e.dyn_ltree, ue), e.d_desc = new pe(e.dyn_dtree, ce), e.bl_desc = new pe(e.bl_tree, de), e.bi_buf = 0, e.bi_valid = 0, f(e)
        }

        function A(e, t, i, r) {
            a(e, (F << 1) + (r ? 1 : 0), 3), m(e, t, i, !0)
        }

        function T(e) {
            a(e, D << 1, 3), s(e, q, ne), l(e)
        }

        function C(e, t, i, r) {
            var n, o, s = 0;
            e.level > 0 ? (e.strm.data_type === I && (e.strm.data_type = E(e)), b(e, e.l_desc), b(e, e.d_desc), s = x(e), n = e.opt_len + 3 + 7 >>> 3, o = e.static_len + 3 + 7 >>> 3, n >= o && (n = o)) : n = o = i + 5, n >= i + 4 && -1 !== t ? A(e, t, i, r) : e.strategy === k || o === n ? (a(e, (D << 1) + (r ? 1 : 0), 3), y(e, ne, oe)) : (a(e, (O << 1) + (r ? 1 : 0), 3), S(e, e.l_desc.max_code + 1, e.d_desc.max_code + 1, s + 1), y(e, e.dyn_ltree, e.dyn_dtree)), f(e), r && p(e)
        }

        function P(e, t, i) {
            return e.pending_buf[e.d_buf + 2 * e.last_lit] = t >>> 8 & 255, e.pending_buf[e.d_buf + 2 * e.last_lit + 1] = 255 & t, e.pending_buf[e.l_buf + e.last_lit] = 255 & i, e.last_lit++, 0 === t ? e.dyn_ltree[2 * i]++ : (e.matches++, t--, e.dyn_ltree[2 * (se[i] + V + 1)]++, e.dyn_dtree[2 * n(t)]++), e.last_lit === e.lit_bufsize - 1
        }

        var L = e("../utils/common"), k = 4, B = 0, R = 1, I = 2, F = 0, D = 1, O = 2, N = 3, U = 258, z = 29, V = 256, W = V + 1 + z, H = 30, G = 19, j = 2 * W + 1, Y = 15, Z = 16, X = 7, q = 256, K = 16, Q = 17, J = 18, $ = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0], ee = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13], te = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7], ie = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15], re = 512, ne = new Array(2 * (W + 2));
        r(ne);
        var oe = new Array(2 * H);
        r(oe);
        var ae = new Array(re);
        r(ae);
        var se = new Array(U - N + 1);
        r(se);
        var he = new Array(z);
        r(he);
        var le = new Array(H);
        r(le);
        var ue, ce, de, fe = function (e, t, i, r, n) {
            this.static_tree = e, this.extra_bits = t, this.extra_base = i, this.elems = r, this.max_length = n, this.has_stree = e && e.length
        }, pe = function (e, t) {
            this.dyn_tree = e, this.max_code = 0, this.stat_desc = t
        }, me = !1;
        i._tr_init = M, i._tr_stored_block = A, i._tr_flush_block = C, i._tr_tally = P, i._tr_align = T
    }, {"../utils/common": 122}],
    134: [function (e, t, i) {
        "use strict";
        function r() {
            this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0
        }

        t.exports = r
    }, {}],
    135: [function (e, t, i) {
        (function (i) {
            !function (i, r) {
                "function" == typeof define && define.amd ? define(["bytebuffer"], r) : "function" == typeof e && "object" == typeof t && t && t.exports ? t.exports = r(e("bytebuffer"), !0) : (i.dcodeIO = i.dcodeIO || {}).ProtoBuf = r(i.dcodeIO.ByteBuffer)
            }(this, function (t, r) {
                "use strict";
                var n = {};
                return n.ByteBuffer = t, n.Long = t.Long || null, n.VERSION = "5.0.1", n.WIRE_TYPES = {}, n.WIRE_TYPES.VARINT = 0, n.WIRE_TYPES.BITS64 = 1, n.WIRE_TYPES.LDELIM = 2, n.WIRE_TYPES.STARTGROUP = 3, n.WIRE_TYPES.ENDGROUP = 4, n.WIRE_TYPES.BITS32 = 5, n.PACKABLE_WIRE_TYPES = [n.WIRE_TYPES.VARINT, n.WIRE_TYPES.BITS64, n.WIRE_TYPES.BITS32], n.TYPES = {
                    int32: {
                        name: "int32",
                        wireType: n.WIRE_TYPES.VARINT,
                        defaultValue: 0
                    },
                    uint32: {name: "uint32", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0},
                    sint32: {name: "sint32", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0},
                    int64: {name: "int64", wireType: n.WIRE_TYPES.VARINT, defaultValue: n.Long ? n.Long.ZERO : void 0},
                    uint64: {
                        name: "uint64",
                        wireType: n.WIRE_TYPES.VARINT,
                        defaultValue: n.Long ? n.Long.UZERO : void 0
                    },
                    sint64: {
                        name: "sint64",
                        wireType: n.WIRE_TYPES.VARINT,
                        defaultValue: n.Long ? n.Long.ZERO : void 0
                    },
                    bool: {name: "bool", wireType: n.WIRE_TYPES.VARINT, defaultValue: !1},
                    "double": {name: "double", wireType: n.WIRE_TYPES.BITS64, defaultValue: 0},
                    string: {name: "string", wireType: n.WIRE_TYPES.LDELIM, defaultValue: ""},
                    bytes: {name: "bytes", wireType: n.WIRE_TYPES.LDELIM, defaultValue: null},
                    fixed32: {name: "fixed32", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0},
                    sfixed32: {name: "sfixed32", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0},
                    fixed64: {
                        name: "fixed64",
                        wireType: n.WIRE_TYPES.BITS64,
                        defaultValue: n.Long ? n.Long.UZERO : void 0
                    },
                    sfixed64: {
                        name: "sfixed64",
                        wireType: n.WIRE_TYPES.BITS64,
                        defaultValue: n.Long ? n.Long.ZERO : void 0
                    },
                    "float": {name: "float", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0},
                    "enum": {name: "enum", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0},
                    message: {name: "message", wireType: n.WIRE_TYPES.LDELIM, defaultValue: null},
                    group: {name: "group", wireType: n.WIRE_TYPES.STARTGROUP, defaultValue: null}
                }, n.MAP_KEY_TYPES = [n.TYPES.int32, n.TYPES.sint32, n.TYPES.sfixed32, n.TYPES.uint32, n.TYPES.fixed32, n.TYPES.int64, n.TYPES.sint64, n.TYPES.sfixed64, n.TYPES.uint64, n.TYPES.fixed64, n.TYPES.bool, n.TYPES.string, n.TYPES.bytes], n.ID_MIN = 1, n.ID_MAX = 536870911, n.convertFieldsToCamelCase = !1, n.populateAccessors = !0, n.populateDefaults = !0, n.Util = function () {
                    var t = {};
                    return t.IS_NODE = !("object" != typeof i || i + "" != "[object process]" || i.browser), t.XHR = function () {
                        for (var e = [function () {
                            return new XMLHttpRequest
                        }, function () {
                            return new ActiveXObject("Msxml2.XMLHTTP")
                        }, function () {
                            return new ActiveXObject("Msxml3.XMLHTTP")
                        }, function () {
                            return new ActiveXObject("Microsoft.XMLHTTP")
                        }], t = null, i = 0; i < e.length; i++) {
                            try {
                                t = e[i]()
                            } catch (r) {
                                continue
                            }
                            break
                        }
                        if (!t)throw Error("XMLHttpRequest is not supported");
                        return t
                    }, t.fetch = function (i, r) {
                        if (r && "function" != typeof r && (r = null), t.IS_NODE) {
                            var n = e("fs");
                            if (r)n.readFile(i, function (e, t) {
                                r(e ? null : "" + t)
                            }); else try {
                                return n.readFileSync(i)
                            } catch (o) {
                                return null
                            }
                        } else {
                            var a = t.XHR();
                            if (a.open("GET", i, r ? !0 : !1), a.setRequestHeader("Accept", "text/plain"), "function" == typeof a.overrideMimeType && a.overrideMimeType("text/plain"), !r)return a.send(null), 200 == a.status || 0 == a.status && "string" == typeof a.responseText ? a.responseText : null;
                            if (a.onreadystatechange = function () {
                                    4 == a.readyState && r(200 == a.status || 0 == a.status && "string" == typeof a.responseText ? a.responseText : null)
                                }, 4 == a.readyState)return;
                            a.send(null)
                        }
                    }, t.toCamelCase = function (e) {
                        return e.replace(/_([a-zA-Z])/g, function (e, t) {
                            return t.toUpperCase()
                        })
                    }, t
                }(), n.Lang = {
                    DELIM: /[\s\{\}=;:\[\],'"\(\)<>]/g,
                    RULE: /^(?:required|optional|repeated|map)$/,
                    TYPE: /^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,
                    NAME: /^[a-zA-Z_][a-zA-Z_0-9]*$/,
                    TYPEDEF: /^[a-zA-Z][a-zA-Z_0-9]*$/,
                    TYPEREF: /^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,
                    FQTYPEREF: /^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,
                    NUMBER: /^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,
                    NUMBER_DEC: /^(?:[1-9][0-9]*|0)$/,
                    NUMBER_HEX: /^0[xX][0-9a-fA-F]+$/,
                    NUMBER_OCT: /^0[0-7]+$/,
                    NUMBER_FLT: /^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,
                    BOOL: /^(?:true|false)$/i,
                    ID: /^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,
                    NEGID: /^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,
                    WHITESPACE: /\s/,
                    STRING: /(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,
                    STRING_DQ: /(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,
                    STRING_SQ: /(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g
                }, n.DotProto = function (e, t) {
                    function i(e, i) {
                        var r = -1, n = 1;
                        if ("-" == e.charAt(0) && (n = -1, e = e.substring(1)), t.NUMBER_DEC.test(e))r = parseInt(e); else if (t.NUMBER_HEX.test(e))r = parseInt(e.substring(2), 16); else {
                            if (!t.NUMBER_OCT.test(e))throw Error("illegal id value: " + (0 > n ? "-" : "") + e);
                            r = parseInt(e.substring(1), 8)
                        }
                        if (r = n * r | 0, !i && 0 > r)throw Error("illegal id value: " + (0 > n ? "-" : "") + e);
                        return r
                    }

                    function r(e) {
                        var i = 1;
                        if ("-" == e.charAt(0) && (i = -1, e = e.substring(1)), t.NUMBER_DEC.test(e))return i * parseInt(e, 10);
                        if (t.NUMBER_HEX.test(e))return i * parseInt(e.substring(2), 16);
                        if (t.NUMBER_OCT.test(e))return i * parseInt(e.substring(1), 8);
                        if ("inf" === e)return i * (1 / 0);
                        if ("nan" === e)return NaN;
                        if (t.NUMBER_FLT.test(e))return i * parseFloat(e);
                        throw Error("illegal number value: " + (0 > i ? "-" : "") + e)
                    }

                    function n(e, t, i) {
                        "undefined" == typeof e[t] ? e[t] = i : (Array.isArray(e[t]) || (e[t] = [e[t]]), e[t].push(i))
                    }

                    var o = {}, a = function (e) {
                        this.source = e + "", this.index = 0, this.line = 1, this.stack = [], this._stringOpen = null
                    }, s = a.prototype;
                    s._readString = function () {
                        var e = '"' === this._stringOpen ? t.STRING_DQ : t.STRING_SQ;
                        e.lastIndex = this.index - 1;
                        var i = e.exec(this.source);
                        if (!i)throw Error("unterminated string");
                        return this.index = e.lastIndex, this.stack.push(this._stringOpen), this._stringOpen = null, i[1]
                    }, s.next = function () {
                        if (this.stack.length > 0)return this.stack.shift();
                        if (this.index >= this.source.length)return null;
                        if (null !== this._stringOpen)return this._readString();
                        var e, i, r;
                        do {
                            for (e = !1; t.WHITESPACE.test(r = this.source.charAt(this.index));)if ("\n" === r && ++this.line, ++this.index === this.source.length)return null;
                            if ("/" === this.source.charAt(this.index))if (++this.index, "/" === this.source.charAt(this.index)) {
                                for (; "\n" !== this.source.charAt(++this.index);)if (this.index == this.source.length)return null;
                                ++this.index, ++this.line, e = !0
                            } else {
                                if ("*" !== (r = this.source.charAt(this.index)))return "/";
                                do {
                                    if ("\n" === r && ++this.line, ++this.index === this.source.length)return null;
                                    i = r, r = this.source.charAt(this.index)
                                } while ("*" !== i || "/" !== r);
                                ++this.index, e = !0
                            }
                        } while (e);
                        if (this.index === this.source.length)return null;
                        var n = this.index;
                        t.DELIM.lastIndex = 0;
                        var o = t.DELIM.test(this.source.charAt(n++));
                        if (!o)for (; n < this.source.length && !t.DELIM.test(this.source.charAt(n));)++n;
                        var a = this.source.substring(this.index, this.index = n);
                        return ('"' === a || "'" === a) && (this._stringOpen = a), a
                    }, s.peek = function () {
                        if (0 === this.stack.length) {
                            var e = this.next();
                            if (null === e)return null;
                            this.stack.push(e)
                        }
                        return this.stack[0]
                    }, s.skip = function (e) {
                        var t = this.next();
                        if (t !== e)throw Error("illegal '" + t + "', '" + e + "' expected")
                    }, s.omit = function (e) {
                        return this.peek() === e ? (this.next(), !0) : !1
                    }, s.toString = function () {
                        return "Tokenizer (" + this.index + "/" + this.source.length + " at line " + this.line + ")"
                    }, o.Tokenizer = a;
                    var h = function (e) {
                        this.tn = new a(e), this.proto3 = !1
                    }, l = h.prototype;
                    return l.parse = function () {
                        var e, i, r = {
                            name: "[ROOT]",
                            "package": null,
                            messages: [],
                            enums: [],
                            imports: [],
                            options: {},
                            services: []
                        }, n = !0;
                        try {
                            for (; e = this.tn.next();)switch (e) {
                                case"package":
                                    if (!n || null !== r["package"])throw Error("unexpected 'package'");
                                    if (e = this.tn.next(), !t.TYPEREF.test(e))throw Error("illegal package name: " + e);
                                    this.tn.skip(";"), r["package"] = e;
                                    break;
                                case"import":
                                    if (!n)throw Error("unexpected 'import'");
                                    e = this.tn.peek(), ("public" === e || (i = "weak" === e)) && this.tn.next(), e = this._readString(), this.tn.skip(";"), i || r.imports.push(e);
                                    break;
                                case"syntax":
                                    if (!n)throw Error("unexpected 'syntax'");
                                    this.tn.skip("="), "proto3" === (r.syntax = this._readString()) && (this.proto3 = !0), this.tn.skip(";");
                                    break;
                                case"message":
                                    this._parseMessage(r, null), n = !1;
                                    break;
                                case"enum":
                                    this._parseEnum(r), n = !1;
                                    break;
                                case"option":
                                    this._parseOption(r);
                                    break;
                                case"service":
                                    this._parseService(r);
                                    break;
                                case"extend":
                                    this._parseExtend(r);
                                    break;
                                default:
                                    throw Error("unexpected '" + e + "'")
                            }
                        } catch (o) {
                            throw o.message = "Parse error at line " + this.tn.line + ": " + o.message, o
                        }
                        return delete r.name, r
                    }, h.parse = function (e) {
                        return new h(e).parse()
                    }, l._readString = function () {
                        var e, t, i = "";
                        do {
                            if (t = this.tn.next(), "'" !== t && '"' !== t)throw Error("illegal string delimiter: " + t);
                            i += this.tn.next(), this.tn.skip(t), e = this.tn.peek()
                        } while ('"' === e || '"' === e);
                        return i
                    }, l._readValue = function (e) {
                        var i = this.tn.peek();
                        if ('"' === i || "'" === i)return this._readString();
                        if (this.tn.next(), t.NUMBER.test(i))return r(i);
                        if (t.BOOL.test(i))return "true" === i.toLowerCase();
                        if (e && t.TYPEREF.test(i))return i;
                        throw Error("illegal value: " + i)
                    }, l._parseOption = function (e, i) {
                        var r = this.tn.next(), n = !1;
                        if ("(" === r && (n = !0, r = this.tn.next()), !t.TYPEREF.test(r))throw Error("illegal option name: " + r);
                        var o = r;
                        n && (this.tn.skip(")"), o = "(" + o + ")", r = this.tn.peek(), t.FQTYPEREF.test(r) && (o += r, this.tn.next())), this.tn.skip("="), this._parseOptionValue(e, o), i || this.tn.skip(";")
                    }, l._parseOptionValue = function (e, i) {
                        var r = this.tn.peek();
                        if ("{" !== r)n(e.options, i, this._readValue(!0)); else for (this.tn.skip("{"); "}" !== (r = this.tn.next());) {
                            if (!t.NAME.test(r))throw Error("illegal option name: " + i + "." + r);
                            this.tn.omit(":") ? n(e.options, i + "." + r, this._readValue(!0)) : this._parseOptionValue(e, i + "." + r)
                        }
                    }, l._parseService = function (e) {
                        var i = this.tn.next();
                        if (!t.NAME.test(i))throw Error("illegal service name at line " + this.tn.line + ": " + i);
                        var r = i, n = {name: r, rpc: {}, options: {}};
                        for (this.tn.skip("{"); "}" !== (i = this.tn.next());)if ("option" === i)this._parseOption(n); else {
                            if ("rpc" !== i)throw Error("illegal service token: " + i);
                            this._parseServiceRPC(n)
                        }
                        this.tn.omit(";"), e.services.push(n)
                    }, l._parseServiceRPC = function (e) {
                        var i = "rpc", r = this.tn.next();
                        if (!t.NAME.test(r))throw Error("illegal rpc service method name: " + r);
                        var n = r, o = {
                            request: null,
                            response: null,
                            request_stream: !1,
                            response_stream: !1,
                            options: {}
                        };
                        if (this.tn.skip("("), r = this.tn.next(), "stream" === r.toLowerCase() && (o.request_stream = !0, r = this.tn.next()), !t.TYPEREF.test(r))throw Error("illegal rpc service request type: " + r);
                        if (o.request = r, this.tn.skip(")"), r = this.tn.next(), "returns" !== r.toLowerCase())throw Error("illegal rpc service request type delimiter: " + r);
                        if (this.tn.skip("("), r = this.tn.next(), "stream" === r.toLowerCase() && (o.response_stream = !0, r = this.tn.next()), o.response = r, this.tn.skip(")"), r = this.tn.peek(), "{" === r) {
                            for (this.tn.next(); "}" !== (r = this.tn.next());) {
                                if ("option" !== r)throw Error("illegal rpc service token: " + r);
                                this._parseOption(o)
                            }
                            this.tn.omit(";")
                        } else this.tn.skip(";");
                        "undefined" == typeof e[i] && (e[i] = {}), e[i][n] = o
                    }, l._parseMessage = function (e, r) {
                        var n = !!r, o = this.tn.next(), a = {
                            name: "",
                            fields: [],
                            enums: [],
                            messages: [],
                            options: {},
                            services: [],
                            oneofs: {}
                        };
                        if (!t.NAME.test(o))throw Error("illegal " + (n ? "group" : "message") + " name: " + o);
                        for (a.name = o, n && (this.tn.skip("="), r.id = i(this.tn.next()), a.isGroup = !0), o = this.tn.peek(), "[" === o && r && this._parseFieldOptions(r), this.tn.skip("{"); "}" !== (o = this.tn.next());)if (t.RULE.test(o))this._parseMessageField(a, o); else if ("oneof" === o)this._parseMessageOneOf(a); else if ("enum" === o)this._parseEnum(a); else if ("message" === o)this._parseMessage(a); else if ("option" === o)this._parseOption(a); else if ("service" === o)this._parseService(a); else if ("extensions" === o)a.extensions = this._parseExtensionRanges(); else if ("reserved" === o)this._parseIgnored(); else if ("extend" === o)this._parseExtend(a); else {
                            if (!t.TYPEREF.test(o))throw Error("illegal message token: " + o);
                            if (!this.proto3)throw Error("illegal field rule: " + o);
                            this._parseMessageField(a, "optional", o)
                        }
                        return this.tn.omit(";"), e.messages.push(a), a
                    }, l._parseIgnored = function () {
                        for (; ";" !== this.tn.peek();)this.tn.next();
                        this.tn.skip(";")
                    }, l._parseMessageField = function (e, r, n) {
                        if (!t.RULE.test(r))throw Error("illegal message field rule: " + r);
                        var o, a = {rule: r, type: "", name: "", options: {}, id: 0};
                        if ("map" === r) {
                            if (n)throw Error("illegal type: " + n);
                            if (this.tn.skip("<"), o = this.tn.next(), !t.TYPE.test(o) && !t.TYPEREF.test(o))throw Error("illegal message field type: " + o);
                            if (a.keytype = o, this.tn.skip(","), o = this.tn.next(), !t.TYPE.test(o) && !t.TYPEREF.test(o))throw Error("illegal message field: " + o);
                            if (a.type = o, this.tn.skip(">"), o = this.tn.next(), !t.NAME.test(o))throw Error("illegal message field name: " + o);
                            a.name = o, this.tn.skip("="), a.id = i(this.tn.next()), o = this.tn.peek(), "[" === o && this._parseFieldOptions(a), this.tn.skip(";")
                        } else if (n = "undefined" != typeof n ? n : this.tn.next(), "group" === n) {
                            var s = this._parseMessage(e, a);
                            if (!/^[A-Z]/.test(s.name))throw Error("illegal group name: " + s.name);
                            a.type = s.name, a.name = s.name.toLowerCase(), this.tn.omit(";")
                        } else {
                            if (!t.TYPE.test(n) && !t.TYPEREF.test(n))throw Error("illegal message field type: " + n);
                            if (a.type = n, o = this.tn.next(), !t.NAME.test(o))throw Error("illegal message field name: " + o);
                            a.name = o, this.tn.skip("="), a.id = i(this.tn.next()), o = this.tn.peek(), "[" === o && this._parseFieldOptions(a), this.tn.skip(";")
                        }
                        return e.fields.push(a), a
                    }, l._parseMessageOneOf = function (e) {
                        var i = this.tn.next();
                        if (!t.NAME.test(i))throw Error("illegal oneof name: " + i);
                        var r, n = i, o = [];
                        for (this.tn.skip("{"); "}" !== (i = this.tn.next());)r = this._parseMessageField(e, "optional", i), r.oneof = n, o.push(r.id);
                        this.tn.omit(";"), e.oneofs[n] = o
                    }, l._parseFieldOptions = function (e) {
                        this.tn.skip("[");
                        for (var t, i = !0; "]" !== (t = this.tn.peek());)i || this.tn.skip(","), this._parseOption(e, !0), i = !1;
                        this.tn.next()
                    }, l._parseEnum = function (e) {
                        var r = {name: "", values: [], options: {}}, n = this.tn.next();
                        if (!t.NAME.test(n))throw Error("illegal name: " + n);
                        for (r.name = n, this.tn.skip("{"); "}" !== (n = this.tn.next());)if ("option" === n)this._parseOption(r); else {
                            if (!t.NAME.test(n))throw Error("illegal name: " + n);
                            this.tn.skip("=");
                            var o = {name: n, id: i(this.tn.next(), !0)};
                            n = this.tn.peek(), "[" === n && this._parseFieldOptions({options: {}}), this.tn.skip(";"), r.values.push(o)
                        }
                        this.tn.omit(";"), e.enums.push(r)
                    }, l._parseExtensionRanges = function () {
                        var t, i, n, o = [];
                        do {
                            for (i = []; ;) {
                                switch (t = this.tn.next()) {
                                    case"min":
                                        n = e.ID_MIN;
                                        break;
                                    case"max":
                                        n = e.ID_MAX;
                                        break;
                                    default:
                                        n = r(t)
                                }
                                if (i.push(n), 2 === i.length)break;
                                if ("to" !== this.tn.peek()) {
                                    i.push(n);
                                    break
                                }
                                this.tn.next()
                            }
                            o.push(i)
                        } while (this.tn.omit(","));
                        return this.tn.skip(";"), o
                    }, l._parseExtend = function (e) {
                        var i = this.tn.next();
                        if (!t.TYPEREF.test(i))throw Error("illegal extend reference: " + i);
                        var r = {ref: i, fields: []};
                        for (this.tn.skip("{"); "}" !== (i = this.tn.next());)if (t.RULE.test(i))this._parseMessageField(r, i); else {
                            if (!t.TYPEREF.test(i))throw Error("illegal extend token: " + i);
                            if (!this.proto3)throw Error("illegal field rule: " + i);
                            this._parseMessageField(r, "optional", i)
                        }
                        return this.tn.omit(";"), e.messages.push(r), r
                    }, l.toString = function () {
                        return "Parser at line " + this.tn.line
                    }, o.Parser = h, o
                }(n, n.Lang), n.Reflect = function (e) {
                    function i(i) {
                        if ("string" == typeof i && (i = e.TYPES[i]), "undefined" == typeof i.defaultValue)throw Error("default value for type " + i.name + " is not supported");
                        return i == e.TYPES.bytes ? new t(0) : i.defaultValue
                    }

                    function r(t, i) {
                        if (t && "number" == typeof t.low && "number" == typeof t.high && "boolean" == typeof t.unsigned && t.low === t.low && t.high === t.high)return new e.Long(t.low, t.high, "undefined" == typeof i ? t.unsigned : i);
                        if ("string" == typeof t)return e.Long.fromString(t, i || !1, 10);
                        if ("number" == typeof t)return e.Long.fromNumber(t, i || !1);
                        throw Error("not convertible to Long")
                    }

                    function n(t, i) {
                        var r = i.readVarint32(), o = 7 & r, a = r >>> 3;
                        switch (o) {
                            case e.WIRE_TYPES.VARINT:
                                do r = i.readUint8(); while (128 === (128 & r));
                                break;
                            case e.WIRE_TYPES.BITS64:
                                i.offset += 8;
                                break;
                            case e.WIRE_TYPES.LDELIM:
                                r = i.readVarint32(), i.offset += r;
                                break;
                            case e.WIRE_TYPES.STARTGROUP:
                                n(a, i);
                                break;
                            case e.WIRE_TYPES.ENDGROUP:
                                if (a === t)return !1;
                                throw Error("Illegal GROUPEND after unknown group: " + a + " (" + t + " expected)");
                            case e.WIRE_TYPES.BITS32:
                                i.offset += 4;
                                break;
                            default:
                                throw Error("Illegal wire type in unknown group " + t + ": " + o)
                        }
                        return !0
                    }

                    var o = {}, a = function (e, t, i) {
                        this.builder = e, this.parent = t, this.name = i, this.className
                    }, s = a.prototype;
                    s.fqn = function () {
                        for (var e = this.name, t = this; ;) {
                            if (t = t.parent, null == t)break;
                            e = t.name + "." + e
                        }
                        return e
                    }, s.toString = function (e) {
                        return (e ? this.className + " " : "") + this.fqn()
                    }, s.build = function () {
                        throw Error(this.toString(!0) + " cannot be built directly")
                    }, o.T = a;
                    var h = function (e, t, i, r, n) {
                        a.call(this, e, t, i), this.className = "Namespace", this.children = [], this.options = r || {}, this.syntax = n || "proto2"
                    }, l = h.prototype = Object.create(a.prototype);
                    l.getChildren = function (e) {
                        if (e = e || null, null == e)return this.children.slice();
                        for (var t = [], i = 0, r = this.children.length; r > i; ++i)this.children[i] instanceof e && t.push(this.children[i]);
                        return t
                    }, l.addChild = function (e) {
                        var t;
                        if (t = this.getChild(e.name))if (t instanceof d.Field && t.name !== t.originalName && null === this.getChild(t.originalName))t.name = t.originalName; else {
                            if (!(e instanceof d.Field && e.name !== e.originalName && null === this.getChild(e.originalName)))throw Error("Duplicate name in namespace " + this.toString(!0) + ": " + e.name);
                            e.name = e.originalName
                        }
                        this.children.push(e)
                    }, l.getChild = function (e) {
                        for (var t = "number" == typeof e ? "id" : "name", i = 0, r = this.children.length; r > i; ++i)if (this.children[i][t] === e)return this.children[i];
                        return null
                    }, l.resolve = function (e, t) {
                        var i = "string" == typeof e ? e.split(".") : e, r = this, n = 0;
                        if ("" === i[n]) {
                            for (; null !== r.parent;)r = r.parent;
                            n++
                        }
                        var a;
                        do {
                            do {
                                if (!(r instanceof o.Namespace)) {
                                    r = null;
                                    break
                                }
                                if (a = r.getChild(i[n]), !a || !(a instanceof o.T) || t && !(a instanceof o.Namespace)) {
                                    r = null;
                                    break
                                }
                                r = a, n++
                            } while (n < i.length);
                            if (null != r)break;
                            if (null !== this.parent)return this.parent.resolve(e, t)
                        } while (null != r);
                        return r
                    }, l.qn = function (e) {
                        var t = [], i = e;
                        do t.unshift(i.name), i = i.parent; while (null !== i);
                        for (var r = 1; r <= t.length; r++) {
                            var n = t.slice(t.length - r);
                            if (e === this.resolve(n, e instanceof o.Namespace))return n.join(".")
                        }
                        return e.fqn()
                    }, l.build = function () {
                        for (var e, t = {}, i = this.children, r = 0, n = i.length; n > r; ++r)e = i[r], e instanceof h && (t[e.name] = e.build());
                        return Object.defineProperty && Object.defineProperty(t, "$options", {value: this.buildOpt()}), t
                    }, l.buildOpt = function () {
                        for (var e = {}, t = Object.keys(this.options), i = 0, r = t.length; r > i; ++i) {
                            var n = t[i], o = this.options[t[i]];
                            e[n] = o
                        }
                        return e
                    }, l.getOption = function (e) {
                        return "undefined" == typeof e ? this.options : "undefined" != typeof this.options[e] ? this.options[e] : null
                    }, o.Namespace = h;
                    var u = function (t, i, r, n) {
                        if (this.type = t, this.resolvedType = i, this.isMapKey = r, this.syntax = n, r && e.MAP_KEY_TYPES.indexOf(t) < 0)throw Error("Invalid map key type: " + t.name)
                    }, c = u.prototype;
                    u.defaultFieldValue = i, c.verifyValue = function (i) {
                        function n(e, t) {
                            throw Error("Illegal value for " + o.toString(!0) + " of type " + o.type.name + ": " + e + " (" + t + ")")
                        }

                        var o = this;
                        switch (this.type) {
                            case e.TYPES.int32:
                            case e.TYPES.sint32:
                            case e.TYPES.sfixed32:
                                return ("number" != typeof i || i === i && i % 1 !== 0) && n(typeof i, "not an integer"), i > 4294967295 ? 0 | i : i;
                            case e.TYPES.uint32:
                            case e.TYPES.fixed32:
                                return ("number" != typeof i || i === i && i % 1 !== 0) && n(typeof i, "not an integer"), 0 > i ? i >>> 0 : i;
                            case e.TYPES.int64:
                            case e.TYPES.sint64:
                            case e.TYPES.sfixed64:
                                if (e.Long)try {
                                    return r(i, !1)
                                } catch (a) {
                                    n(typeof i, a.message)
                                } else n(typeof i, "requires Long.js");
                            case e.TYPES.uint64:
                            case e.TYPES.fixed64:
                                if (e.Long)try {
                                    return r(i, !0)
                                } catch (a) {
                                    n(typeof i, a.message)
                                } else n(typeof i, "requires Long.js");
                            case e.TYPES.bool:
                                return "boolean" != typeof i && n(typeof i, "not a boolean"), i;
                            case e.TYPES["float"]:
                            case e.TYPES["double"]:
                                return "number" != typeof i && n(typeof i, "not a number"), i;
                            case e.TYPES.string:
                                return "string" == typeof i || i && i instanceof String || n(typeof i, "not a string"), "" + i;
                            case e.TYPES.bytes:
                                return t.isByteBuffer(i) ? i : t.wrap(i, "base64");
                            case e.TYPES["enum"]:
                                var s = this.resolvedType.getChildren(e.Reflect.Enum.Value);
                                for (l = 0; l < s.length; l++) {
                                    if (s[l].name == i)return s[l].id;
                                    if (s[l].id == i)return s[l].id
                                }
                                if ("proto3" === this.syntax)return ("number" != typeof i || i === i && i % 1 !== 0) && n(typeof i, "not an integer"), (i > 4294967295 || 0 > i) && n(typeof i, "not in range for uint32"), i;
                                n(i, "not a valid enum value");
                            case e.TYPES.group:
                            case e.TYPES.message:
                                if (i && "object" == typeof i || n(typeof i, "object expected"), i instanceof this.resolvedType.clazz)return i;
                                if (i instanceof e.Builder.Message) {
                                    var h = {};
                                    for (var l in i)i.hasOwnProperty(l) && (h[l] = i[l]);
                                    i = h
                                }
                                return new this.resolvedType.clazz(i)
                        }
                        throw Error("[INTERNAL] Illegal value for " + this.toString(!0) + ": " + i + " (undefined type " + this.type + ")")
                    }, c.calculateLength = function (i, r) {
                        if (null === r)return 0;
                        var n;
                        switch (this.type) {
                            case e.TYPES.int32:
                                return 0 > r ? t.calculateVarint64(r) : t.calculateVarint32(r);
                            case e.TYPES.uint32:
                                return t.calculateVarint32(r);
                            case e.TYPES.sint32:
                                return t.calculateVarint32(t.zigZagEncode32(r));
                            case e.TYPES.fixed32:
                            case e.TYPES.sfixed32:
                            case e.TYPES["float"]:
                                return 4;
                            case e.TYPES.int64:
                            case e.TYPES.uint64:
                                return t.calculateVarint64(r);
                            case e.TYPES.sint64:
                                return t.calculateVarint64(t.zigZagEncode64(r));
                            case e.TYPES.fixed64:
                            case e.TYPES.sfixed64:
                                return 8;
                            case e.TYPES.bool:
                                return 1;
                            case e.TYPES["enum"]:
                                return t.calculateVarint32(r);
                            case e.TYPES["double"]:
                                return 8;
                            case e.TYPES.string:
                                return n = t.calculateUTF8Bytes(r), t.calculateVarint32(n) + n;
                            case e.TYPES.bytes:
                                if (r.remaining() < 0)throw Error("Illegal value for " + this.toString(!0) + ": " + r.remaining() + " bytes remaining");
                                return t.calculateVarint32(r.remaining()) + r.remaining();
                            case e.TYPES.message:
                                return n = this.resolvedType.calculate(r), t.calculateVarint32(n) + n;
                            case e.TYPES.group:
                                return n = this.resolvedType.calculate(r), n + t.calculateVarint32(i << 3 | e.WIRE_TYPES.ENDGROUP)
                        }
                        throw Error("[INTERNAL] Illegal value to encode in " + this.toString(!0) + ": " + r + " (unknown type)")
                    }, c.encodeValue = function (i, r, n) {
                        if (null === r)return n;
                        switch (this.type) {
                            case e.TYPES.int32:
                                0 > r ? n.writeVarint64(r) : n.writeVarint32(r);
                                break;
                            case e.TYPES.uint32:
                                n.writeVarint32(r);
                                break;
                            case e.TYPES.sint32:
                                n.writeVarint32ZigZag(r);
                                break;
                            case e.TYPES.fixed32:
                                n.writeUint32(r);
                                break;
                            case e.TYPES.sfixed32:
                                n.writeInt32(r);
                                break;
                            case e.TYPES.int64:
                            case e.TYPES.uint64:
                                n.writeVarint64(r);
                                break;
                            case e.TYPES.sint64:
                                n.writeVarint64ZigZag(r);
                                break;
                            case e.TYPES.fixed64:
                                n.writeUint64(r);
                                break;
                            case e.TYPES.sfixed64:
                                n.writeInt64(r);
                                break;
                            case e.TYPES.bool:
                                "string" == typeof r ? n.writeVarint32("false" === r.toLowerCase() ? 0 : !!r) : n.writeVarint32(r ? 1 : 0);
                                break;
                            case e.TYPES["enum"]:
                                n.writeVarint32(r);
                                break;
                            case e.TYPES["float"]:
                                n.writeFloat32(r);
                                break;
                            case e.TYPES["double"]:
                                n.writeFloat64(r);
                                break;
                            case e.TYPES.string:
                                n.writeVString(r);
                                break;
                            case e.TYPES.bytes:
                                if (r.remaining() < 0)throw Error("Illegal value for " + this.toString(!0) + ": " + r.remaining() + " bytes remaining");
                                var o = r.offset;
                                n.writeVarint32(r.remaining()), n.append(r), r.offset = o;
                                break;
                            case e.TYPES.message:
                                var a = (new t).LE();
                                this.resolvedType.encode(r, a), n.writeVarint32(a.offset), n.append(a.flip());
                                break;
                            case e.TYPES.group:
                                this.resolvedType.encode(r, n), n.writeVarint32(i << 3 | e.WIRE_TYPES.ENDGROUP);
                                break;
                            default:
                                throw Error("[INTERNAL] Illegal value to encode in " + this.toString(!0) + ": " + r + " (unknown type)")
                        }
                        return n
                    }, c.decode = function (t, i, r) {
                        if (i != this.type.wireType)throw Error("Unexpected wire type for element");
                        var n, o;
                        switch (this.type) {
                            case e.TYPES.int32:
                                return 0 | t.readVarint32();
                            case e.TYPES.uint32:
                                return t.readVarint32() >>> 0;
                            case e.TYPES.sint32:
                                return 0 | t.readVarint32ZigZag();
                            case e.TYPES.fixed32:
                                return t.readUint32() >>> 0;
                            case e.TYPES.sfixed32:
                                return 0 | t.readInt32();
                            case e.TYPES.int64:
                                return t.readVarint64();
                            case e.TYPES.uint64:
                                return t.readVarint64().toUnsigned();
                            case e.TYPES.sint64:
                                return t.readVarint64ZigZag();
                            case e.TYPES.fixed64:
                                return t.readUint64();
                            case e.TYPES.sfixed64:
                                return t.readInt64();
                            case e.TYPES.bool:
                                return !!t.readVarint32();
                            case e.TYPES["enum"]:
                                return t.readVarint32();
                            case e.TYPES["float"]:
                                return t.readFloat();
                            case e.TYPES["double"]:
                                return t.readDouble();
                            case e.TYPES.string:
                                return t.readVString();
                            case e.TYPES.bytes:
                                if (o = t.readVarint32(), t.remaining() < o)throw Error("Illegal number of bytes for " + this.toString(!0) + ": " + o + " required but got only " + t.remaining());
                                return n = t.clone(), n.limit = n.offset + o, t.offset += o, n;
                            case e.TYPES.message:
                                return o = t.readVarint32(), this.resolvedType.decode(t, o);
                            case e.TYPES.group:
                                return this.resolvedType.decode(t, -1, r)
                        }
                        throw Error("[INTERNAL] Illegal decode type")
                    }, c.valueFromString = function (i) {
                        if (!this.isMapKey)throw Error("valueFromString() called on non-map-key element");
                        switch (this.type) {
                            case e.TYPES.int32:
                            case e.TYPES.sint32:
                            case e.TYPES.sfixed32:
                            case e.TYPES.uint32:
                            case e.TYPES.fixed32:
                                return this.verifyValue(parseInt(i));
                            case e.TYPES.int64:
                            case e.TYPES.sint64:
                            case e.TYPES.sfixed64:
                            case e.TYPES.uint64:
                            case e.TYPES.fixed64:
                                return this.verifyValue(i);
                            case e.TYPES.bool:
                                return "true" === i;
                            case e.TYPES.string:
                                return this.verifyValue(i);
                            case e.TYPES.bytes:
                                return t.fromBinary(i)
                        }
                    }, c.valueToString = function (t) {
                        if (!this.isMapKey)throw Error("valueToString() called on non-map-key element");
                        return this.type === e.TYPES.bytes ? t.toString("binary") : t.toString()
                    }, o.Element = u;
                    var d = function (e, t, i, r, n, o) {
                        h.call(this, e, t, i, r, o), this.className = "Message", this.extensions = void 0, this.clazz = null, this.isGroup = !!n, this._fields = null, this._fieldsById = null, this._fieldsByName = null
                    }, f = d.prototype = Object.create(h.prototype);
                    f.build = function (i) {
                        if (this.clazz && !i)return this.clazz;
                        var r = function (e, i) {
                            function r(i, n, o, a) {
                                if (null === i || "object" != typeof i) {
                                    if (a && a instanceof e.Reflect.Enum) {
                                        var s = e.Reflect.Enum.getName(a.object, i);
                                        if (null !== s)return s
                                    }
                                    return i
                                }
                                if (t.isByteBuffer(i))return n ? i.toBase64() : i.toBuffer();
                                if (e.Long.isLong(i))return o ? i.toString() : e.Long.fromValue(i);
                                var h;
                                if (Array.isArray(i))return h = [], i.forEach(function (e, t) {
                                    h[t] = r(e, n, o, a)
                                }), h;
                                if (h = {}, i instanceof e.Map) {
                                    for (var l = i.entries(), u = l.next(); !u.done; u = l.next())h[i.keyElem.valueToString(u.value[0])] = r(u.value[1], n, o, i.valueElem.resolvedType);
                                    return h
                                }
                                var c = i.$type, d = void 0;
                                for (var f in i)i.hasOwnProperty(f) && (c && (d = c.getChild(f)) ? h[f] = r(i[f], n, o, d.resolvedType) : h[f] = r(i[f], n, o));
                                return h
                            }

                            var n = i.getChildren(e.Reflect.Message.Field), o = i.getChildren(e.Reflect.Message.OneOf), a = function (r, s) {
                                e.Builder.Message.call(this);
                                for (var h = 0, l = o.length; l > h; ++h)this[o[h].name] = null;
                                for (h = 0, l = n.length; l > h; ++h) {
                                    var u = n[h];
                                    this[u.name] = u.repeated ? [] : u.map ? new e.Map(u) : null, !u.required && "proto3" !== i.syntax || null === u.defaultValue || (this[u.name] = u.defaultValue)
                                }
                                if (arguments.length > 0) {
                                    var c;
                                    if (1 !== arguments.length || null === r || "object" != typeof r || !("function" != typeof r.encode || r instanceof a) || Array.isArray(r) || r instanceof e.Map || t.isByteBuffer(r) || r instanceof ArrayBuffer || e.Long && r instanceof e.Long)for (h = 0, l = arguments.length; l > h; ++h)"undefined" != typeof(c = arguments[h]) && this.$set(n[h].name, c); else this.$set(r)
                                }
                            }, s = a.prototype = Object.create(e.Builder.Message.prototype);
                            s.add = function (t, r, n) {
                                var o = i._fieldsByName[t];
                                if (!n) {
                                    if (!o)throw Error(this + "#" + t + " is undefined");
                                    if (!(o instanceof e.Reflect.Message.Field))throw Error(this + "#" + t + " is not a field: " + o.toString(!0));
                                    if (!o.repeated)throw Error(this + "#" + t + " is not a repeated field");
                                    r = o.verifyValue(r, !0)
                                }
                                return null === this[t] && (this[t] = []), this[t].push(r), this
                            }, s.$add = s.add, s.set = function (t, r, n) {
                                if (t && "object" == typeof t) {
                                    n = r;
                                    for (var o in t)t.hasOwnProperty(o) && "undefined" != typeof(r = t[o]) && this.$set(o, r, n);
                                    return this
                                }
                                var a = i._fieldsByName[t];
                                if (n)this[t] = r; else {
                                    if (!a)throw Error(this + "#" + t + " is not a field: undefined");
                                    if (!(a instanceof e.Reflect.Message.Field))throw Error(this + "#" + t + " is not a field: " + a.toString(!0));
                                    this[a.name] = r = a.verifyValue(r)
                                }
                                if (a && a.oneof) {
                                    var s = this[a.oneof.name];
                                    null !== r ? (null !== s && s !== a.name && (this[s] = null), this[a.oneof.name] = a.name) : s === t && (this[a.oneof.name] = null)
                                }
                                return this
                            }, s.$set = s.set, s.get = function (t, r) {
                                if (r)return this[t];
                                var n = i._fieldsByName[t];
                                if (!(n && n instanceof e.Reflect.Message.Field))throw Error(this + "#" + t + " is not a field: undefined");
                                if (!(n instanceof e.Reflect.Message.Field))throw Error(this + "#" + t + " is not a field: " + n.toString(!0));
                                return this[n.name]
                            }, s.$get = s.get;
                            for (var h = 0; h < n.length; h++) {
                                var l = n[h];
                                l instanceof e.Reflect.Message.ExtensionField || i.builder.options.populateAccessors && function (e) {
                                    var t = e.originalName.replace(/(_[a-zA-Z])/g, function (e) {
                                        return e.toUpperCase().replace("_", "")
                                    });
                                    t = t.substring(0, 1).toUpperCase() + t.substring(1);
                                    var r = e.originalName.replace(/([A-Z])/g, function (e) {
                                        return "_" + e
                                    }), n = function (t, i) {
                                        return this[e.name] = i ? t : e.verifyValue(t), this
                                    }, o = function () {
                                        return this[e.name]
                                    };
                                    null === i.getChild("set" + t) && (s["set" + t] = n), null === i.getChild("set_" + r) && (s["set_" + r] = n), null === i.getChild("get" + t) && (s["get" + t] = o), null === i.getChild("get_" + r) && (s["get_" + r] = o)
                                }(l)
                            }
                            s.encode = function (e, r) {
                                "boolean" == typeof e && (r = e, e = void 0);
                                var n = !1;
                                e || (e = new t, n = !0);
                                var o = e.littleEndian;
                                try {
                                    return i.encode(this, e.LE(), r), (n ? e.flip() : e).LE(o)
                                } catch (a) {
                                    throw e.LE(o), a
                                }
                            }, a.encode = function (e, t, i) {
                                return new a(e).encode(t, i)
                            }, s.calculate = function () {
                                return i.calculate(this)
                            }, s.encodeDelimited = function (e, r) {
                                var n = !1;
                                e || (e = new t, n = !0);
                                var o = (new t).LE();
                                return i.encode(this, o, r).flip(), e.writeVarint32(o.remaining()), e.append(o), n ? e.flip() : e
                            }, s.encodeAB = function () {
                                try {
                                    return this.encode().toArrayBuffer()
                                } catch (e) {
                                    throw e.encoded && (e.encoded = e.encoded.toArrayBuffer()), e
                                }
                            }, s.toArrayBuffer = s.encodeAB, s.encodeNB = function () {
                                try {
                                    return this.encode().toBuffer()
                                } catch (e) {
                                    throw e.encoded && (e.encoded = e.encoded.toBuffer()), e
                                }
                            }, s.toBuffer = s.encodeNB, s.encode64 = function () {
                                try {
                                    return this.encode().toBase64()
                                } catch (e) {
                                    throw e.encoded && (e.encoded = e.encoded.toBase64()), e
                                }
                            }, s.toBase64 = s.encode64, s.encodeHex = function () {
                                try {
                                    return this.encode().toHex()
                                } catch (e) {
                                    throw e.encoded && (e.encoded = e.encoded.toHex()), e
                                }
                            }, s.toHex = s.encodeHex, s.toRaw = function (e, t) {
                                return r(this, !!e, !!t, this.$type)
                            }, s.encodeJSON = function () {
                                return JSON.stringify(r(this, !0, !0, this.$type))
                            }, a.decode = function (e, r, n) {
                                "string" == typeof r && (n = r, r = -1), "string" == typeof e && (e = t.wrap(e, n ? n : "base64")), e = t.isByteBuffer(e) ? e : t.wrap(e);
                                var o = e.littleEndian;
                                try {
                                    var a = i.decode(e.LE());
                                    return e.LE(o), a
                                } catch (s) {
                                    throw e.LE(o), s
                                }
                            }, a.decodeDelimited = function (e, r) {
                                if ("string" == typeof e && (e = t.wrap(e, r ? r : "base64")), e = t.isByteBuffer(e) ? e : t.wrap(e), e.remaining() < 1)return null;
                                var n = e.offset, o = e.readVarint32();
                                if (e.remaining() < o)return e.offset = n, null;
                                try {
                                    var a = i.decode(e.slice(e.offset, e.offset + o).LE());
                                    return e.offset += o, a
                                } catch (s) {
                                    throw e.offset += o, s
                                }
                            }, a.decode64 = function (e) {
                                return a.decode(e, "base64")
                            }, a.decodeHex = function (e) {
                                return a.decode(e, "hex")
                            }, a.decodeJSON = function (e) {
                                return new a(JSON.parse(e))
                            }, s.toString = function () {
                                return i.toString()
                            };
                            return Object.defineProperty && (Object.defineProperty(a, "$options", {value: i.buildOpt()}), Object.defineProperty(s, "$options", {value: a.$options}), Object.defineProperty(a, "$type", {value: i}), Object.defineProperty(s, "$type", {value: i})), a
                        }(e, this);
                        this._fields = [], this._fieldsById = {}, this._fieldsByName = {};
                        for (var n, o = 0, a = this.children.length; a > o; o++)if (n = this.children[o], n instanceof y || n instanceof d || n instanceof x) {
                            if (r.hasOwnProperty(n.name))throw Error("Illegal reflect child of " + this.toString(!0) + ": " + n.toString(!0) + " cannot override static property '" + n.name + "'");
                            r[n.name] = n.build()
                        } else if (n instanceof d.Field)n.build(), this._fields.push(n), this._fieldsById[n.id] = n, this._fieldsByName[n.name] = n; else if (!(n instanceof d.OneOf || n instanceof _))throw Error("Illegal reflect child of " + this.toString(!0) + ": " + this.children[o].toString(!0));
                        return this.clazz = r
                    }, f.encode = function (e, t, i) {
                        for (var r, n, o = null, a = 0, s = this._fields.length; s > a; ++a)r = this._fields[a], n = e[r.name], r.required && null === n ? null === o && (o = r) : r.encode(i ? n : r.verifyValue(n), t, e);
                        if (null !== o) {
                            var h = Error("Missing at least one required field for " + this.toString(!0) + ": " + o);
                            throw h.encoded = t, h
                        }
                        return t
                    }, f.calculate = function (e) {
                        for (var t, i, r = 0, n = 0, o = this._fields.length; o > n; ++n) {
                            if (t = this._fields[n], i = e[t.name], t.required && null === i)throw Error("Missing at least one required field for " + this.toString(!0) + ": " + t);
                            r += t.calculate(i, e)
                        }
                        return r
                    }, f.decode = function (t, i, r) {
                        i = "number" == typeof i ? i : -1;
                        for (var o, a, s, h, l = t.offset, u = new this.clazz; t.offset < l + i || -1 === i && t.remaining() > 0;) {
                            if (o = t.readVarint32(), a = 7 & o, s = o >>> 3, a === e.WIRE_TYPES.ENDGROUP) {
                                if (s !== r)throw Error("Illegal group end indicator for " + this.toString(!0) + ": " + s + " (" + (r ? r + " expected" : "not a group") + ")");
                                break
                            }
                            if (h = this._fieldsById[s]) {
                                if (h.repeated && !h.options.packed)u[h.name].push(h.decode(a, t)); else if (h.map) {
                                    var c = h.decode(a, t);
                                    u[h.name].set(c[0], c[1])
                                } else if (u[h.name] = h.decode(a, t), h.oneof) {
                                    var d = u[h.oneof.name];
                                    null !== d && d !== h.name && (u[d] = null), u[h.oneof.name] = h.name
                                }
                            } else switch (a) {
                                case e.WIRE_TYPES.VARINT:
                                    t.readVarint32();
                                    break;
                                case e.WIRE_TYPES.BITS32:
                                    t.offset += 4;
                                    break;
                                case e.WIRE_TYPES.BITS64:
                                    t.offset += 8;
                                    break;
                                case e.WIRE_TYPES.LDELIM:
                                    var f = t.readVarint32();
                                    t.offset += f;
                                    break;
                                case e.WIRE_TYPES.STARTGROUP:
                                    for (; n(s, t););
                                    break;
                                default:
                                    throw Error("Illegal wire type for unknown field " + s + " in " + this.toString(!0) + "#decode: " + a)
                            }
                        }
                        for (var p = 0, m = this._fields.length; m > p; ++p)if (h = this._fields[p], null === u[h.name])if ("proto3" === this.syntax)u[h.name] = h.defaultValue; else {
                            if (h.required) {
                                var g = Error("Missing at least one required field for " + this.toString(!0) + ": " + h.name);
                                throw g.decoded = u, g
                            }
                            e.populateDefaults && null !== h.defaultValue && (u[h.name] = h.defaultValue)
                        }
                        return u
                    }, o.Message = d;
                    var p = function (t, i, r, n, o, s, h, l, u, c) {
                        a.call(this, t, i, s), this.className = "Message.Field", this.required = "required" === r, this.repeated = "repeated" === r, this.map = "map" === r, this.keyType = n || null, this.type = o, this.resolvedType = null, this.id = h, this.options = l || {}, this.defaultValue = null, this.oneof = u || null, this.syntax = c || "proto2", this.originalName = this.name, this.element = null, this.keyElement = null, !this.builder.options.convertFieldsToCamelCase || this instanceof d.ExtensionField || (this.name = e.Util.toCamelCase(this.name))
                    }, m = p.prototype = Object.create(a.prototype);
                    m.build = function () {
                        this.element = new u(this.type, this.resolvedType, !1, this.syntax), this.map && (this.keyElement = new u(this.keyType, void 0, !0, this.syntax)), "proto3" !== this.syntax || this.repeated || this.map ? "undefined" != typeof this.options["default"] && (this.defaultValue = this.verifyValue(this.options["default"])) : this.defaultValue = u.defaultFieldValue(this.type)
                    }, m.verifyValue = function (t, i) {
                        function r(e, t) {
                            throw Error("Illegal value for " + n.toString(!0) + " of type " + n.type.name + ": " + e + " (" + t + ")")
                        }

                        i = i || !1;
                        var n = this;
                        if (null === t)return this.required && r(typeof t, "required"), "proto3" === this.syntax && this.type !== e.TYPES.message && r(typeof t, "proto3 field without field presence cannot be null"), null;
                        var o;
                        if (this.repeated && !i) {
                            Array.isArray(t) || (t = [t]);
                            var a = [];
                            for (o = 0; o < t.length; o++)a.push(this.element.verifyValue(t[o]));
                            return a
                        }
                        return this.map && !i ? t instanceof e.Map ? t : (t instanceof Object || r(typeof t, "expected ProtoBuf.Map or raw object for map field"), new e.Map(this, t)) : (!this.repeated && Array.isArray(t) && r(typeof t, "no array expected"), this.element.verifyValue(t))
                    }, m.hasWirePresence = function (t, i) {
                        if ("proto3" !== this.syntax)return null !== t;
                        if (this.oneof && i[this.oneof.name] === this.name)return !0;
                        switch (this.type) {
                            case e.TYPES.int32:
                            case e.TYPES.sint32:
                            case e.TYPES.sfixed32:
                            case e.TYPES.uint32:
                            case e.TYPES.fixed32:
                                return 0 !== t;
                            case e.TYPES.int64:
                            case e.TYPES.sint64:
                            case e.TYPES.sfixed64:
                            case e.TYPES.uint64:
                            case e.TYPES.fixed64:
                                return 0 !== t.low || 0 !== t.high;
                            case e.TYPES.bool:
                                return t;
                            case e.TYPES["float"]:
                            case e.TYPES["double"]:
                                return 0 !== t;
                            case e.TYPES.string:
                                return t.length > 0;
                            case e.TYPES.bytes:
                                return t.remaining() > 0;
                            case e.TYPES["enum"]:
                                return 0 !== t;
                            case e.TYPES.message:
                                return null !== t;
                            default:
                                return !0
                        }
                    }, m.encode = function (i, r, n) {
                        if (null === this.type || "object" != typeof this.type)throw Error("[INTERNAL] Unresolved type in " + this.toString(!0) + ": " + this.type);
                        if (null === i || this.repeated && 0 == i.length)return r;
                        try {
                            if (this.repeated) {
                                var o;
                                if (this.options.packed && e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0) {
                                    r.writeVarint32(this.id << 3 | e.WIRE_TYPES.LDELIM), r.ensureCapacity(r.offset += 1);
                                    var a = r.offset;
                                    for (o = 0; o < i.length; o++)this.element.encodeValue(this.id, i[o], r);
                                    var s = r.offset - a, h = t.calculateVarint32(s);
                                    if (h > 1) {
                                        var l = r.slice(a, r.offset);
                                        a += h - 1, r.offset = a,
                                            r.append(l)
                                    }
                                    r.writeVarint32(s, a - h)
                                } else for (o = 0; o < i.length; o++)r.writeVarint32(this.id << 3 | this.type.wireType), this.element.encodeValue(this.id, i[o], r)
                            } else this.map ? i.forEach(function (i, n, o) {
                                var a = t.calculateVarint32(8 | this.keyType.wireType) + this.keyElement.calculateLength(1, n) + t.calculateVarint32(16 | this.type.wireType) + this.element.calculateLength(2, i);
                                r.writeVarint32(this.id << 3 | e.WIRE_TYPES.LDELIM), r.writeVarint32(a), r.writeVarint32(8 | this.keyType.wireType), this.keyElement.encodeValue(1, n, r), r.writeVarint32(16 | this.type.wireType), this.element.encodeValue(2, i, r)
                            }, this) : this.hasWirePresence(i, n) && (r.writeVarint32(this.id << 3 | this.type.wireType), this.element.encodeValue(this.id, i, r))
                        } catch (u) {
                            throw Error("Illegal value for " + this.toString(!0) + ": " + i + " (" + u + ")")
                        }
                        return r
                    }, m.calculate = function (i, r) {
                        if (i = this.verifyValue(i), null === this.type || "object" != typeof this.type)throw Error("[INTERNAL] Unresolved type in " + this.toString(!0) + ": " + this.type);
                        if (null === i || this.repeated && 0 == i.length)return 0;
                        var n = 0;
                        try {
                            if (this.repeated) {
                                var o, a;
                                if (this.options.packed && e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0) {
                                    for (n += t.calculateVarint32(this.id << 3 | e.WIRE_TYPES.LDELIM), a = 0, o = 0; o < i.length; o++)a += this.element.calculateLength(this.id, i[o]);
                                    n += t.calculateVarint32(a), n += a
                                } else for (o = 0; o < i.length; o++)n += t.calculateVarint32(this.id << 3 | this.type.wireType), n += this.element.calculateLength(this.id, i[o])
                            } else this.map ? i.forEach(function (i, r, o) {
                                var a = t.calculateVarint32(8 | this.keyType.wireType) + this.keyElement.calculateLength(1, r) + t.calculateVarint32(16 | this.type.wireType) + this.element.calculateLength(2, i);
                                n += t.calculateVarint32(this.id << 3 | e.WIRE_TYPES.LDELIM), n += t.calculateVarint32(a), n += a
                            }, this) : this.hasWirePresence(i, r) && (n += t.calculateVarint32(this.id << 3 | this.type.wireType), n += this.element.calculateLength(this.id, i))
                        } catch (s) {
                            throw Error("Illegal value for " + this.toString(!0) + ": " + i + " (" + s + ")")
                        }
                        return n
                    }, m.decode = function (t, i, r) {
                        var n, o, a = !this.map && t == this.type.wireType || !r && this.repeated && this.options.packed && t == e.WIRE_TYPES.LDELIM || this.map && t == e.WIRE_TYPES.LDELIM;
                        if (!a)throw Error("Illegal wire type for field " + this.toString(!0) + ": " + t + " (" + this.type.wireType + " expected)");
                        if (t == e.WIRE_TYPES.LDELIM && this.repeated && this.options.packed && e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0 && !r) {
                            o = i.readVarint32(), o = i.offset + o;
                            for (var s = []; i.offset < o;)s.push(this.decode(this.type.wireType, i, !0));
                            return s
                        }
                        if (this.map) {
                            var h = u.defaultFieldValue(this.keyType);
                            if (n = u.defaultFieldValue(this.type), o = i.readVarint32(), i.remaining() < o)throw Error("Illegal number of bytes for " + this.toString(!0) + ": " + o + " required but got only " + i.remaining());
                            var l = i.clone();
                            for (l.limit = l.offset + o, i.offset += o; l.remaining() > 0;) {
                                var c = l.readVarint32();
                                t = 7 & c;
                                var d = c >>> 3;
                                if (1 === d)h = this.keyElement.decode(l, t, d); else {
                                    if (2 !== d)throw Error("Unexpected tag in map field key/value submessage");
                                    n = this.element.decode(l, t, d)
                                }
                            }
                            return [h, n]
                        }
                        return this.element.decode(i, t, this.id)
                    }, o.Message.Field = p;
                    var g = function (e, t, i, r, n, o, a) {
                        p.call(this, e, t, i, null, r, n, o, a), this.extension
                    };
                    g.prototype = Object.create(p.prototype), o.Message.ExtensionField = g;
                    var v = function (e, t, i) {
                        a.call(this, e, t, i), this.fields = []
                    };
                    o.Message.OneOf = v;
                    var y = function (e, t, i, r, n) {
                        h.call(this, e, t, i, r, n), this.className = "Enum", this.object = null
                    };
                    y.getName = function (e, t) {
                        for (var i, r = Object.keys(e), n = 0; n < r.length; ++n)if (e[i = r[n]] === t)return i;
                        return null
                    };
                    var b = y.prototype = Object.create(h.prototype);
                    b.build = function (t) {
                        if (this.object && !t)return this.object;
                        for (var i = new e.Builder.Enum, r = this.getChildren(y.Value), n = 0, o = r.length; o > n; ++n)i[r[n].name] = r[n].id;
                        return Object.defineProperty && Object.defineProperty(i, "$options", {
                            value: this.buildOpt(),
                            enumerable: !1
                        }), this.object = i
                    }, o.Enum = y;
                    var w = function (e, t, i, r) {
                        a.call(this, e, t, i), this.className = "Enum.Value", this.id = r
                    };
                    w.prototype = Object.create(a.prototype), o.Enum.Value = w;
                    var _ = function (e, t, i, r) {
                        a.call(this, e, t, i), this.field = r
                    };
                    _.prototype = Object.create(a.prototype), o.Extension = _;
                    var x = function (e, t, i, r) {
                        h.call(this, e, t, i, r), this.className = "Service", this.clazz = null
                    }, S = x.prototype = Object.create(h.prototype);
                    S.build = function (i) {
                        return this.clazz && !i ? this.clazz : this.clazz = function (e, i) {
                            for (var r = function (t) {
                                e.Builder.Service.call(this), this.rpcImpl = t || function (e, t, i) {
                                        setTimeout(i.bind(this, Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")), 0)
                                    }
                            }, n = r.prototype = Object.create(e.Builder.Service.prototype), o = i.getChildren(e.Reflect.Service.RPCMethod), a = 0; a < o.length; a++)!function (e) {
                                n[e.name] = function (r, n) {
                                    try {
                                        try {
                                            r = e.resolvedRequestType.clazz.decode(t.wrap(r))
                                        } catch (o) {
                                            if (!(o instanceof TypeError))throw o
                                        }
                                        if (null === r || "object" != typeof r)throw Error("Illegal arguments");
                                        r instanceof e.resolvedRequestType.clazz || (r = new e.resolvedRequestType.clazz(r)), this.rpcImpl(e.fqn(), r, function (t, r) {
                                            if (t)return void n(t);
                                            null === r && (r = "");
                                            try {
                                                r = e.resolvedResponseType.clazz.decode(r)
                                            } catch (o) {
                                            }
                                            return r && r instanceof e.resolvedResponseType.clazz ? void n(null, r) : void n(Error("Illegal response type received in service method " + i.name + "#" + e.name))
                                        })
                                    } catch (o) {
                                        setTimeout(n.bind(this, o), 0)
                                    }
                                }, r[e.name] = function (t, i, n) {
                                    new r(t)[e.name](i, n)
                                }, Object.defineProperty && (Object.defineProperty(r[e.name], "$options", {value: e.buildOpt()}), Object.defineProperty(n[e.name], "$options", {value: r[e.name].$options}))
                            }(o[a]);
                            return Object.defineProperty && (Object.defineProperty(r, "$options", {value: i.buildOpt()}), Object.defineProperty(n, "$options", {value: r.$options}), Object.defineProperty(r, "$type", {value: i}), Object.defineProperty(n, "$type", {value: i})), r
                        }(e, this)
                    }, o.Service = x;
                    var E = function (e, t, i, r) {
                        a.call(this, e, t, i), this.className = "Service.Method", this.options = r || {}
                    }, M = E.prototype = Object.create(a.prototype);
                    M.buildOpt = l.buildOpt, o.Service.Method = E;
                    var A = function (e, t, i, r, n, o, a, s) {
                        E.call(this, e, t, i, s), this.className = "Service.RPCMethod", this.requestName = r, this.responseName = n, this.requestStream = o, this.responseStream = a, this.resolvedRequestType = null, this.resolvedResponseType = null
                    };
                    return A.prototype = Object.create(E.prototype), o.Service.RPCMethod = A, o
                }(n), n.Builder = function (t, i, r) {
                    function n(e) {
                        e.messages && e.messages.forEach(function (t) {
                            t.syntax = e.syntax, n(t)
                        }), e.enums && e.enums.forEach(function (t) {
                            t.syntax = e.syntax
                        })
                    }

                    var o = function (e) {
                        this.ns = new r.Namespace(this, null, ""), this.ptr = this.ns, this.resolved = !1, this.result = null, this.files = {}, this.importRoot = null, this.options = e || {}
                    }, a = o.prototype;
                    return o.isMessage = function (e) {
                        return "string" != typeof e.name ? !1 : "undefined" != typeof e.values || "undefined" != typeof e.rpc ? !1 : !0
                    }, o.isMessageField = function (e) {
                        return "string" != typeof e.rule || "string" != typeof e.name || "string" != typeof e.type || "undefined" == typeof e.id ? !1 : !0
                    }, o.isEnum = function (e) {
                        return "string" != typeof e.name ? !1 : "undefined" != typeof e.values && Array.isArray(e.values) && 0 !== e.values.length ? !0 : !1
                    }, o.isService = function (e) {
                        return "string" == typeof e.name && "object" == typeof e.rpc && e.rpc ? !0 : !1
                    }, o.isExtend = function (e) {
                        return "string" != typeof e.ref ? !1 : !0
                    }, a.reset = function () {
                        return this.ptr = this.ns, this
                    }, a.define = function (e) {
                        if ("string" != typeof e || !i.TYPEREF.test(e))throw Error("illegal namespace: " + e);
                        return e.split(".").forEach(function (e) {
                            var t = this.ptr.getChild(e);
                            null === t && this.ptr.addChild(t = new r.Namespace(this, this.ptr, e)), this.ptr = t
                        }, this), this
                    }, a.create = function (e) {
                        if (!e)return this;
                        if (Array.isArray(e)) {
                            if (0 === e.length)return this;
                            e = e.slice()
                        } else e = [e];
                        for (var i = [e]; i.length > 0;) {
                            if (e = i.pop(), !Array.isArray(e))throw Error("not a valid namespace: " + JSON.stringify(e));
                            for (; e.length > 0;) {
                                var n = e.shift();
                                if (o.isMessage(n)) {
                                    var a = new r.Message(this, this.ptr, n.name, n.options, n.isGroup, n.syntax), s = {};
                                    n.oneofs && Object.keys(n.oneofs).forEach(function (e) {
                                        a.addChild(s[e] = new r.Message.OneOf(this, a, e))
                                    }, this), n.fields && n.fields.forEach(function (e) {
                                        if (null !== a.getChild(0 | e.id))throw Error("duplicate or invalid field id in " + a.name + ": " + e.id);
                                        if (e.options && "object" != typeof e.options)throw Error("illegal field options in " + a.name + "#" + e.name);
                                        var t = null;
                                        if ("string" == typeof e.oneof && !(t = s[e.oneof]))throw Error("illegal oneof in " + a.name + "#" + e.name + ": " + e.oneof);
                                        e = new r.Message.Field(this, a, e.rule, e.keytype, e.type, e.name, e.id, e.options, t, n.syntax), t && t.fields.push(e), a.addChild(e)
                                    }, this);
                                    var h = [];
                                    if (n.enums && n.enums.forEach(function (e) {
                                            h.push(e)
                                        }), n.messages && n.messages.forEach(function (e) {
                                            h.push(e)
                                        }), n.services && n.services.forEach(function (e) {
                                            h.push(e)
                                        }), n.extensions && ("number" == typeof n.extensions[0] ? a.extensions = [n.extensions] : a.extensions = n.extensions), this.ptr.addChild(a), h.length > 0) {
                                        i.push(e), e = h, h = null, this.ptr = a, a = null;
                                        continue
                                    }
                                    h = null
                                } else if (o.isEnum(n))a = new r.Enum(this, this.ptr, n.name, n.options, n.syntax), n.values.forEach(function (e) {
                                    a.addChild(new r.Enum.Value(this, a, e.name, e.id))
                                }, this), this.ptr.addChild(a); else if (o.isService(n))a = new r.Service(this, this.ptr, n.name, n.options), Object.keys(n.rpc).forEach(function (e) {
                                    var t = n.rpc[e];
                                    a.addChild(new r.Service.RPCMethod(this, a, e, t.request, t.response, !!t.request_stream, !!t.response_stream, t.options))
                                }, this), this.ptr.addChild(a); else {
                                    if (!o.isExtend(n))throw Error("not a valid definition: " + JSON.stringify(n));
                                    if (a = this.ptr.resolve(n.ref, !0))n.fields.forEach(function (e) {
                                        if (null !== a.getChild(0 | e.id))throw Error("duplicate extended field id in " + a.name + ": " + e.id);
                                        if (a.extensions) {
                                            var i = !1;
                                            if (a.extensions.forEach(function (t) {
                                                    e.id >= t[0] && e.id <= t[1] && (i = !0)
                                                }), !i)throw Error("illegal extended field id in " + a.name + ": " + e.id + " (not within valid ranges)")
                                        }
                                        var n = e.name;
                                        this.options.convertFieldsToCamelCase && (n = t.Util.toCamelCase(n));
                                        var o = new r.Message.ExtensionField(this, a, e.rule, e.type, this.ptr.fqn() + "." + n, e.id, e.options), s = new r.Extension(this, this.ptr, e.name, o);
                                        o.extension = s, this.ptr.addChild(s), a.addChild(o)
                                    }, this); else if (!/\.?google\.protobuf\./.test(n.ref))throw Error("extended message " + n.ref + " is not defined")
                                }
                                n = null, a = null
                            }
                            e = null, this.ptr = this.ptr.parent
                        }
                        return this.resolved = !1, this.result = null, this
                    }, a["import"] = function (i, r) {
                        var o = "/";
                        if ("string" == typeof r) {
                            if (t.Util.IS_NODE && (r = e("path").resolve(r)), this.files[r] === !0)return this.reset();
                            this.files[r] = !0
                        } else if ("object" == typeof r) {
                            var a = r.root;
                            t.Util.IS_NODE && (a = e("path").resolve(a)), (a.indexOf("\\") >= 0 || r.file.indexOf("\\") >= 0) && (o = "\\");
                            var s = a + o + r.file;
                            if (this.files[s] === !0)return this.reset();
                            this.files[s] = !0
                        }
                        if (i.imports && i.imports.length > 0) {
                            var h, l = !1;
                            "object" == typeof r ? (this.importRoot = r.root, l = !0, h = this.importRoot, r = r.file, (h.indexOf("\\") >= 0 || r.indexOf("\\") >= 0) && (o = "\\")) : "string" == typeof r ? this.importRoot ? h = this.importRoot : r.indexOf("/") >= 0 ? (h = r.replace(/\/[^\/]*$/, ""), "" === h && (h = "/")) : r.indexOf("\\") >= 0 ? (h = r.replace(/\\[^\\]*$/, ""), o = "\\") : h = "." : h = null;
                            for (var u = 0; u < i.imports.length; u++)if ("string" == typeof i.imports[u]) {
                                if (!h)throw Error("cannot determine import root");
                                var c = i.imports[u];
                                if ("google/protobuf/descriptor.proto" === c)continue;
                                if (c = h + o + c, this.files[c] === !0)continue;
                                /\.proto$/i.test(c) && !t.DotProto && (c = c.replace(/\.proto$/, ".json"));
                                var d = t.Util.fetch(c);
                                if (null === d)throw Error("failed to import '" + c + "' in '" + r + "': file not found");
                                /\.json$/i.test(c) ? this["import"](JSON.parse(d + ""), c) : this["import"](t.DotProto.Parser.parse(d), c)
                            } else r ? /\.(\w+)$/.test(r) ? this["import"](i.imports[u], r.replace(/^(.+)\.(\w+)$/, function (e, t, i) {
                                return t + "_import" + u + "." + i
                            })) : this["import"](i.imports[u], r + "_import" + u) : this["import"](i.imports[u]);
                            l && (this.importRoot = null)
                        }
                        i["package"] && this.define(i["package"]), i.syntax && n(i);
                        var f = this.ptr;
                        return i.options && Object.keys(i.options).forEach(function (e) {
                            f.options[e] = i.options[e]
                        }), i.messages && (this.create(i.messages), this.ptr = f), i.enums && (this.create(i.enums), this.ptr = f), i.services && (this.create(i.services), this.ptr = f), i["extends"] && this.create(i["extends"]), this.reset()
                    }, a.resolveAll = function () {
                        var e;
                        if (null == this.ptr || "object" == typeof this.ptr.type)return this;
                        if (this.ptr instanceof r.Namespace)this.ptr.children.forEach(function (e) {
                            this.ptr = e, this.resolveAll()
                        }, this); else if (this.ptr instanceof r.Message.Field) {
                            if (i.TYPE.test(this.ptr.type))this.ptr.type = t.TYPES[this.ptr.type]; else {
                                if (!i.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type);
                                if (e = (this.ptr instanceof r.Message.ExtensionField ? this.ptr.extension.parent : this.ptr.parent).resolve(this.ptr.type, !0), !e)throw Error("unresolvable type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type);
                                if (this.ptr.resolvedType = e, e instanceof r.Enum) {
                                    if (this.ptr.type = t.TYPES["enum"], "proto3" === this.ptr.syntax && "proto3" !== e.syntax)throw Error("proto3 message cannot reference proto2 enum")
                                } else {
                                    if (!(e instanceof r.Message))throw Error("illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type);
                                    this.ptr.type = e.isGroup ? t.TYPES.group : t.TYPES.message
                                }
                            }
                            if (this.ptr.map) {
                                if (!i.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in " + this.ptr.toString(!0) + ": " + this.ptr.keyType);
                                this.ptr.keyType = t.TYPES[this.ptr.keyType]
                            }
                        } else if (this.ptr instanceof t.Reflect.Service.Method) {
                            if (!(this.ptr instanceof t.Reflect.Service.RPCMethod))throw Error("illegal service type in " + this.ptr.toString(!0));
                            if (e = this.ptr.parent.resolve(this.ptr.requestName, !0), !(e && e instanceof t.Reflect.Message))throw Error("Illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.requestName);
                            if (this.ptr.resolvedRequestType = e, e = this.ptr.parent.resolve(this.ptr.responseName, !0), !(e && e instanceof t.Reflect.Message))throw Error("Illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.responseName);
                            this.ptr.resolvedResponseType = e
                        } else if (!(this.ptr instanceof t.Reflect.Message.OneOf || this.ptr instanceof t.Reflect.Extension || this.ptr instanceof t.Reflect.Enum.Value))throw Error("illegal object in namespace: " + typeof this.ptr + ": " + this.ptr);
                        return this.reset()
                    }, a.build = function (e) {
                        if (this.reset(), this.resolved || (this.resolveAll(), this.resolved = !0, this.result = null), null === this.result && (this.result = this.ns.build()), !e)return this.result;
                        for (var t = "string" == typeof e ? e.split(".") : e, i = this.result, r = 0; r < t.length; r++) {
                            if (!i[t[r]]) {
                                i = null;
                                break
                            }
                            i = i[t[r]]
                        }
                        return i
                    }, a.lookup = function (e, t) {
                        return e ? this.ns.resolve(e, t) : this.ns
                    }, a.toString = function () {
                        return "Builder"
                    }, o.Message = function () {
                    }, o.Enum = function () {
                    }, o.Service = function () {
                    }, o
                }(n, n.Lang, n.Reflect), n.Map = function (e, t) {
                    function i(e) {
                        var t = 0;
                        return {
                            next: function () {
                                return t < e.length ? {done: !1, value: e[t++]} : {done: !0}
                            }
                        }
                    }

                    var r = function (e, i) {
                        if (!e.map)throw Error("field is not a map");
                        if (this.field = e, this.keyElem = new t.Element(e.keyType, null, !0, e.syntax), this.valueElem = new t.Element(e.type, e.resolvedType, !1, e.syntax), this.map = {}, Object.defineProperty(this, "size", {
                                get: function () {
                                    return Object.keys(this.map).length
                                }
                            }), i)for (var r = Object.keys(i), n = 0; n < r.length; n++) {
                            var o = this.keyElem.valueFromString(r[n]), a = this.valueElem.verifyValue(i[r[n]]);
                            this.map[this.keyElem.valueToString(o)] = {key: o, value: a}
                        }
                    }, n = r.prototype;
                    return n.clear = function () {
                        this.map = {}
                    }, n["delete"] = function (e) {
                        var t = this.keyElem.valueToString(this.keyElem.verifyValue(e)), i = t in this.map;
                        return delete this.map[t], i
                    }, n.entries = function () {
                        for (var e, t = [], r = Object.keys(this.map), n = 0; n < r.length; n++)t.push([(e = this.map[r[n]]).key, e.value]);
                        return i(t)
                    }, n.keys = function () {
                        for (var e = [], t = Object.keys(this.map), r = 0; r < t.length; r++)e.push(this.map[t[r]].key);
                        return i(e)
                    }, n.values = function () {
                        for (var e = [], t = Object.keys(this.map), r = 0; r < t.length; r++)e.push(this.map[t[r]].value);
                        return i(e)
                    }, n.forEach = function (e, t) {
                        for (var i, r = Object.keys(this.map), n = 0; n < r.length; n++)e.call(t, (i = this.map[r[n]]).value, i.key, this)
                    }, n.set = function (e, t) {
                        var i = this.keyElem.verifyValue(e), r = this.valueElem.verifyValue(t);
                        return this.map[this.keyElem.valueToString(i)] = {key: i, value: r}, this
                    }, n.get = function (e) {
                        var t = this.keyElem.valueToString(this.keyElem.verifyValue(e));
                        if (t in this.map)return this.map[t].value
                    }, n.has = function (e) {
                        var t = this.keyElem.valueToString(this.keyElem.verifyValue(e));
                        return t in this.map
                    }, r
                }(n, n.Reflect), n.loadProto = function (e, t, i) {
                    return ("string" == typeof t || t && "string" == typeof t.file && "string" == typeof t.root) && (i = t, t = void 0), n.loadJson(n.DotProto.Parser.parse(e), t, i)
                }, n.protoFromString = n.loadProto, n.loadProtoFile = function (e, t, i) {
                    if (t && "object" == typeof t ? (i = t, t = null) : t && "function" == typeof t || (t = null), t)return n.Util.fetch("string" == typeof e ? e : e.root + "/" + e.file, function (r) {
                        if (null === r)return void t(Error("Failed to fetch file"));
                        try {
                            t(null, n.loadProto(r, i, e))
                        } catch (o) {
                            t(o)
                        }
                    });
                    var r = n.Util.fetch("object" == typeof e ? e.root + "/" + e.file : e);
                    return null === r ? null : n.loadProto(r, i, e)
                }, n.protoFromFile = n.loadProtoFile, n.newBuilder = function (e) {
                    return e = e || {}, "undefined" == typeof e.convertFieldsToCamelCase && (e.convertFieldsToCamelCase = n.convertFieldsToCamelCase), "undefined" == typeof e.populateAccessors && (e.populateAccessors = n.populateAccessors), new n.Builder(e)
                }, n.loadJson = function (e, t, i) {
                    return ("string" == typeof t || t && "string" == typeof t.file && "string" == typeof t.root) && (i = t, t = null), t && "object" == typeof t || (t = n.newBuilder()), "string" == typeof e && (e = JSON.parse(e)), t["import"](e, i), t.resolveAll(), t
                }, n.loadJsonFile = function (e, t, i) {
                    if (t && "object" == typeof t ? (i = t, t = null) : t && "function" == typeof t || (t = null), t)return n.Util.fetch("string" == typeof e ? e : e.root + "/" + e.file, function (r) {
                        if (null === r)return void t(Error("Failed to fetch file"));
                        try {
                            t(null, n.loadJson(JSON.parse(r), i, e))
                        } catch (o) {
                            t(o)
                        }
                    });
                    var r = n.Util.fetch("object" == typeof e ? e.root + "/" + e.file : e);
                    return null === r ? null : n.loadJson(JSON.parse(r), i, e)
                }, n
            })
        }).call(this, e("_process"))
    }, {_process: 90, bytebuffer: 136, fs: 83, path: 83}],
    136: [function (e, t, i) {
        !function (i, r) {
            "function" == typeof define && define.amd ? define(["long"], r) : "function" == typeof e && "object" == typeof t && t && t.exports ? t.exports = function () {
                var t;
                try {
                    t = e("long")
                } catch (i) {
                }
                return r(t)
            }() : (i.dcodeIO = i.dcodeIO || {}).ByteBuffer = r(i.dcodeIO.Long)
        }(this, function (e) {
            "use strict";
            function t(e) {
                var t = 0;
                return function () {
                    return t < e.length ? e.charCodeAt(t++) : null
                }
            }

            function i() {
                var e = [], t = [];
                return function () {
                    return 0 === arguments.length ? t.join("") + h.apply(String, e) : (e.length + arguments.length > 1024 && (t.push(h.apply(String, e)), e.length = 0), void Array.prototype.push.apply(e, arguments))
                }
            }

            function r(e, t, i, r, n) {
                var o, a, s = 8 * n - r - 1, h = (1 << s) - 1, l = h >> 1, u = -7, c = i ? n - 1 : 0, d = i ? -1 : 1, f = e[t + c];
                for (c += d, o = f & (1 << -u) - 1, f >>= -u, u += s; u > 0; o = 256 * o + e[t + c], c += d, u -= 8);
                for (a = o & (1 << -u) - 1, o >>= -u, u += r; u > 0; a = 256 * a + e[t + c], c += d, u -= 8);
                if (0 === o)o = 1 - l; else {
                    if (o === h)return a ? NaN : (f ? -1 : 1) * (1 / 0);
                    a += Math.pow(2, r), o -= l
                }
                return (f ? -1 : 1) * a * Math.pow(2, o - r)
            }

            function n(e, t, i, r, n, o) {
                var a, s, h, l = 8 * o - n - 1, u = (1 << l) - 1, c = u >> 1, d = 23 === n ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f = r ? 0 : o - 1, p = r ? 1 : -1, m = 0 > t || 0 === t && 0 > 1 / t ? 1 : 0;
                for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0, a = u) : (a = Math.floor(Math.log(t) / Math.LN2), t * (h = Math.pow(2, -a)) < 1 && (a--, h *= 2), t += a + c >= 1 ? d / h : d * Math.pow(2, 1 - c), t * h >= 2 && (a++, h /= 2), a + c >= u ? (s = 0, a = u) : a + c >= 1 ? (s = (t * h - 1) * Math.pow(2, n), a += c) : (s = t * Math.pow(2, c - 1) * Math.pow(2, n), a = 0)); n >= 8; e[i + f] = 255 & s, f += p, s /= 256, n -= 8);
                for (a = a << n | s, l += n; l > 0; e[i + f] = 255 & a, f += p, a /= 256, l -= 8);
                e[i + f - p] |= 128 * m
            }

            var o = function (e, t, i) {
                if ("undefined" == typeof e && (e = o.DEFAULT_CAPACITY), "undefined" == typeof t && (t = o.DEFAULT_ENDIAN), "undefined" == typeof i && (i = o.DEFAULT_NOASSERT), !i) {
                    if (e = 0 | e, 0 > e)throw RangeError("Illegal capacity");
                    t = !!t, i = !!i
                }
                this.buffer = 0 === e ? s : new ArrayBuffer(e), this.view = 0 === e ? null : new Uint8Array(this.buffer), this.offset = 0, this.markedOffset = -1, this.limit = e, this.littleEndian = "undefined" != typeof t ? !!t : !1, this.noAssert = !!i
            };
            o.VERSION = "5.0.0", o.LITTLE_ENDIAN = !0, o.BIG_ENDIAN = !1, o.DEFAULT_CAPACITY = 16, o.DEFAULT_ENDIAN = o.BIG_ENDIAN, o.DEFAULT_NOASSERT = !1, o.Long = e || null;
            var a = o.prototype;
            a.__isByteBuffer__, Object.defineProperty(a, "__isByteBuffer__", {
                value: !0,
                enumerable: !1,
                configurable: !1
            });
            var s = new ArrayBuffer(0), h = String.fromCharCode;
            o.accessor = function () {
                return Uint8Array
            }, o.allocate = function (e, t, i) {
                return new o(e, t, i)
            }, o.concat = function (e, t, i, r) {
                ("boolean" == typeof t || "string" != typeof t) && (r = i, i = t, t = void 0);
                for (var n, a = 0, s = 0, h = e.length; h > s; ++s)o.isByteBuffer(e[s]) || (e[s] = o.wrap(e[s], t)), n = e[s].limit - e[s].offset, n > 0 && (a += n);
                if (0 === a)return new o(0, i, r);
                var l, u = new o(a, i, r);
                for (s = 0; h > s;)l = e[s++], n = l.limit - l.offset, 0 >= n || (u.view.set(l.view.subarray(l.offset, l.limit), u.offset), u.offset += n);
                return u.limit = u.offset, u.offset = 0, u
            }, o.isByteBuffer = function (e) {
                return (e && e.__isByteBuffer__) === !0
            }, o.type = function () {
                return ArrayBuffer
            }, o.wrap = function (e, t, i, r) {
                if ("string" != typeof t && (r = i, i = t, t = void 0), "string" == typeof e)switch ("undefined" == typeof t && (t = "utf8"), t) {
                    case"base64":
                        return o.fromBase64(e, i);
                    case"hex":
                        return o.fromHex(e, i);
                    case"binary":
                        return o.fromBinary(e, i);
                    case"utf8":
                        return o.fromUTF8(e, i);
                    case"debug":
                        return o.fromDebug(e, i);
                    default:
                        throw Error("Unsupported encoding: " + t)
                }
                if (null === e || "object" != typeof e)throw TypeError("Illegal buffer");
                var n;
                if (o.isByteBuffer(e))return n = a.clone.call(e), n.markedOffset = -1, n;
                if (e instanceof Uint8Array)n = new o(0, i, r), e.length > 0 && (n.buffer = e.buffer, n.offset = e.byteOffset, n.limit = e.byteOffset + e.byteLength, n.view = new Uint8Array(e.buffer)); else if (e instanceof ArrayBuffer)n = new o(0, i, r), e.byteLength > 0 && (n.buffer = e, n.offset = 0, n.limit = e.byteLength, n.view = e.byteLength > 0 ? new Uint8Array(e) : null); else {
                    if ("[object Array]" !== Object.prototype.toString.call(e))throw TypeError("Illegal buffer");
                    n = new o(e.length, i, r), n.limit = e.length;
                    for (var s = 0; s < e.length; ++s)n.view[s] = e[s]
                }
                return n
            }, a.readBytes = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + e > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+" + e + ") <= " + this.buffer.byteLength)
                }
                var r = this.slice(t, t + e);
                return i && (this.offset += e), r
            }, a.writeBytes = a.append, a.writeInt8 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 1;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view[t] = e, i && (this.offset += 1), this
            }, a.writeByte = a.writeInt8, a.readInt8 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                }
                var i = this.view[e];
                return 128 === (128 & i) && (i = -(255 - i + 1)), t && (this.offset += 1), i
            }, a.readByte = a.readInt8, a.writeUint8 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 1;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view[t] = e, i && (this.offset += 1), this
            }, a.writeUInt8 = a.writeUint8, a.readUint8 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                }
                var i = this.view[e];
                return t && (this.offset += 1), i
            }, a.readUInt8 = a.readUint8, a.writeInt16 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 2;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.littleEndian ? (this.view[t + 1] = (65280 & e) >>> 8, this.view[t] = 255 & e) : (this.view[t] = (65280 & e) >>> 8, this.view[t + 1] = 255 & e), i && (this.offset += 2), this
            }, a.writeShort = a.writeInt16, a.readInt16 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 2 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength)
                }
                var i = 0;
                return this.littleEndian ? (i = this.view[e], i |= this.view[e + 1] << 8) : (i = this.view[e] << 8, i |= this.view[e + 1]), 32768 === (32768 & i) && (i = -(65535 - i + 1)), t && (this.offset += 2), i
            }, a.readShort = a.readInt16, a.writeUint16 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 2;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.littleEndian ? (this.view[t + 1] = (65280 & e) >>> 8, this.view[t] = 255 & e) : (this.view[t] = (65280 & e) >>> 8, this.view[t + 1] = 255 & e), i && (this.offset += 2), this
            }, a.writeUInt16 = a.writeUint16, a.readUint16 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 2 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength)
                }
                var i = 0;
                return this.littleEndian ? (i = this.view[e], i |= this.view[e + 1] << 8) : (i = this.view[e] << 8, i |= this.view[e + 1]), t && (this.offset += 2), i
            }, a.readUInt16 = a.readUint16, a.writeInt32 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 4;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.littleEndian ? (this.view[t + 3] = e >>> 24 & 255, this.view[t + 2] = e >>> 16 & 255, this.view[t + 1] = e >>> 8 & 255, this.view[t] = 255 & e) : (this.view[t] = e >>> 24 & 255, this.view[t + 1] = e >>> 16 & 255, this.view[t + 2] = e >>> 8 & 255, this.view[t + 3] = 255 & e), i && (this.offset += 4), this
            }, a.writeInt = a.writeInt32, a.readInt32 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                }
                var i = 0;
                return this.littleEndian ? (i = this.view[e + 2] << 16, i |= this.view[e + 1] << 8, i |= this.view[e], i += this.view[e + 3] << 24 >>> 0) : (i = this.view[e + 1] << 16, i |= this.view[e + 2] << 8, i |= this.view[e + 3], i += this.view[e] << 24 >>> 0), i |= 0, t && (this.offset += 4), i
            }, a.readInt = a.readInt32, a.writeUint32 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 4;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.littleEndian ? (this.view[t + 3] = e >>> 24 & 255, this.view[t + 2] = e >>> 16 & 255, this.view[t + 1] = e >>> 8 & 255, this.view[t] = 255 & e) : (this.view[t] = e >>> 24 & 255, this.view[t + 1] = e >>> 16 & 255, this.view[t + 2] = e >>> 8 & 255, this.view[t + 3] = 255 & e), i && (this.offset += 4), this
            }, a.writeUInt32 = a.writeUint32, a.readUint32 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                }
                var i = 0;
                return this.littleEndian ? (i = this.view[e + 2] << 16, i |= this.view[e + 1] << 8, i |= this.view[e], i += this.view[e + 3] << 24 >>> 0) : (i = this.view[e + 1] << 16, i |= this.view[e + 2] << 8, i |= this.view[e + 3], i += this.view[e] << 24 >>> 0), t && (this.offset += 4), i
            }, a.readUInt32 = a.readUint32, e && (a.writeInt64 = function (t, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" == typeof t)t = e.fromNumber(t); else if ("string" == typeof t)t = e.fromString(t); else if (!(t && t instanceof e))throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t)), i += 8;
                var n = this.buffer.byteLength;
                i > n && this.resize((n *= 2) > i ? n : i), i -= 8;
                var o = t.low, a = t.high;
                return this.littleEndian ? (this.view[i + 3] = o >>> 24 & 255, this.view[i + 2] = o >>> 16 & 255, this.view[i + 1] = o >>> 8 & 255, this.view[i] = 255 & o, i += 4, this.view[i + 3] = a >>> 24 & 255, this.view[i + 2] = a >>> 16 & 255, this.view[i + 1] = a >>> 8 & 255, this.view[i] = 255 & a) : (this.view[i] = a >>> 24 & 255, this.view[i + 1] = a >>> 16 & 255, this.view[i + 2] = a >>> 8 & 255, this.view[i + 3] = 255 & a, i += 4, this.view[i] = o >>> 24 & 255, this.view[i + 1] = o >>> 16 & 255, this.view[i + 2] = o >>> 8 & 255, this.view[i + 3] = 255 & o), r && (this.offset += 8), this
            }, a.writeLong = a.writeInt64, a.readInt64 = function (t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 8 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
                }
                var r = 0, n = 0;
                this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, n = this.view[t + 2] << 16, n |= this.view[t + 1] << 8, n |= this.view[t], n += this.view[t + 3] << 24 >>> 0) : (n = this.view[t + 1] << 16, n |= this.view[t + 2] << 8, n |= this.view[t + 3], n += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0);
                var o = new e(r, n, !1);
                return i && (this.offset += 8), o
            }, a.readLong = a.readInt64, a.writeUint64 = function (t, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" == typeof t)t = e.fromNumber(t); else if ("string" == typeof t)t = e.fromString(t); else if (!(t && t instanceof e))throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t)), i += 8;
                var n = this.buffer.byteLength;
                i > n && this.resize((n *= 2) > i ? n : i), i -= 8;
                var o = t.low, a = t.high;
                return this.littleEndian ? (this.view[i + 3] = o >>> 24 & 255, this.view[i + 2] = o >>> 16 & 255, this.view[i + 1] = o >>> 8 & 255, this.view[i] = 255 & o, i += 4, this.view[i + 3] = a >>> 24 & 255, this.view[i + 2] = a >>> 16 & 255, this.view[i + 1] = a >>> 8 & 255, this.view[i] = 255 & a) : (this.view[i] = a >>> 24 & 255, this.view[i + 1] = a >>> 16 & 255, this.view[i + 2] = a >>> 8 & 255, this.view[i + 3] = 255 & a, i += 4, this.view[i] = o >>> 24 & 255, this.view[i + 1] = o >>> 16 & 255, this.view[i + 2] = o >>> 8 & 255, this.view[i + 3] = 255 & o), r && (this.offset += 8), this
            }, a.writeUInt64 = a.writeUint64, a.readUint64 = function (t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 8 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength)
                }
                var r = 0, n = 0;
                this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, n = this.view[t + 2] << 16, n |= this.view[t + 1] << 8, n |= this.view[t], n += this.view[t + 3] << 24 >>> 0) : (n = this.view[t + 1] << 16, n |= this.view[t + 2] << 8, n |= this.view[t + 3], n += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3],
                    r += this.view[t] << 24 >>> 0);
                var o = new e(r, n, !0);
                return i && (this.offset += 8), o
            }, a.readUInt64 = a.readUint64), a.writeFloat32 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e)throw TypeError("Illegal value: " + e + " (not a number)");
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 4;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, n(this.view, e, t, this.littleEndian, 23, 4), i && (this.offset += 4), this
            }, a.writeFloat = a.writeFloat32, a.readFloat32 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                }
                var i = r(this.view, e, this.littleEndian, 23, 4);
                return t && (this.offset += 4), i
            }, a.readFloat = a.readFloat32, a.writeFloat64 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e)throw TypeError("Illegal value: " + e + " (not a number)");
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                t += 8;
                var r = this.buffer.byteLength;
                return t > r && this.resize((r *= 2) > t ? r : t), t -= 8, n(this.view, e, t, this.littleEndian, 52, 8), i && (this.offset += 8), this
            }, a.writeDouble = a.writeFloat64, a.readFloat64 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 8 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+8) <= " + this.buffer.byteLength)
                }
                var i = r(this.view, e, this.littleEndian, 52, 8);
                return t && (this.offset += 8), i
            }, a.readDouble = a.readFloat64, o.MAX_VARINT32_BYTES = 5, o.calculateVarint32 = function (e) {
                return e >>>= 0, 128 > e ? 1 : 16384 > e ? 2 : 1 << 21 > e ? 3 : 1 << 28 > e ? 4 : 5
            }, o.zigZagEncode32 = function (e) {
                return ((e |= 0) << 1 ^ e >> 31) >>> 0
            }, o.zigZagDecode32 = function (e) {
                return e >>> 1 ^ -(1 & e) | 0
            }, a.writeVarint32 = function (e, t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength)
                }
                var r, n = o.calculateVarint32(e);
                t += n;
                var a = this.buffer.byteLength;
                for (t > a && this.resize((a *= 2) > t ? a : t), t -= n, e >>>= 0; e >= 128;)r = 127 & e | 128, this.view[t++] = r, e >>>= 7;
                return this.view[t++] = e, i ? (this.offset = t, this) : n
            }, a.writeVarint32ZigZag = function (e, t) {
                return this.writeVarint32(o.zigZagEncode32(e), t)
            }, a.readVarint32 = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                }
                var i, r = 0, n = 0;
                do {
                    if (!this.noAssert && e > this.limit) {
                        var o = Error("Truncated");
                        throw o.truncated = !0, o
                    }
                    i = this.view[e++], 5 > r && (n |= (127 & i) << 7 * r), ++r
                } while (0 !== (128 & i));
                return n |= 0, t ? (this.offset = e, n) : {value: n, length: r}
            }, a.readVarint32ZigZag = function (e) {
                var t = this.readVarint32(e);
                return "object" == typeof t ? t.value = o.zigZagDecode32(t.value) : t = o.zigZagDecode32(t), t
            }, e && (o.MAX_VARINT64_BYTES = 10, o.calculateVarint64 = function (t) {
                "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t));
                var i = t.toInt() >>> 0, r = t.shiftRightUnsigned(28).toInt() >>> 0, n = t.shiftRightUnsigned(56).toInt() >>> 0;
                return 0 == n ? 0 == r ? 16384 > i ? 128 > i ? 1 : 2 : 1 << 21 > i ? 3 : 4 : 16384 > r ? 128 > r ? 5 : 6 : 1 << 21 > r ? 7 : 8 : 128 > n ? 9 : 10
            }, o.zigZagEncode64 = function (t) {
                return "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : t.unsigned !== !1 && (t = t.toSigned()), t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()
            }, o.zigZagDecode64 = function (t) {
                return "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : t.unsigned !== !1 && (t = t.toSigned()), t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()
            }, a.writeVarint64 = function (t, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" == typeof t)t = e.fromNumber(t); else if ("string" == typeof t)t = e.fromString(t); else if (!(t && t instanceof e))throw TypeError("Illegal value: " + t + " (not an integer or Long)");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : t.unsigned !== !1 && (t = t.toSigned());
                var n = o.calculateVarint64(t), a = t.toInt() >>> 0, s = t.shiftRightUnsigned(28).toInt() >>> 0, h = t.shiftRightUnsigned(56).toInt() >>> 0;
                i += n;
                var l = this.buffer.byteLength;
                switch (i > l && this.resize((l *= 2) > i ? l : i), i -= n, n) {
                    case 10:
                        this.view[i + 9] = h >>> 7 & 1;
                    case 9:
                        this.view[i + 8] = 9 !== n ? 128 | h : 127 & h;
                    case 8:
                        this.view[i + 7] = 8 !== n ? s >>> 21 | 128 : s >>> 21 & 127;
                    case 7:
                        this.view[i + 6] = 7 !== n ? s >>> 14 | 128 : s >>> 14 & 127;
                    case 6:
                        this.view[i + 5] = 6 !== n ? s >>> 7 | 128 : s >>> 7 & 127;
                    case 5:
                        this.view[i + 4] = 5 !== n ? 128 | s : 127 & s;
                    case 4:
                        this.view[i + 3] = 4 !== n ? a >>> 21 | 128 : a >>> 21 & 127;
                    case 3:
                        this.view[i + 2] = 3 !== n ? a >>> 14 | 128 : a >>> 14 & 127;
                    case 2:
                        this.view[i + 1] = 2 !== n ? a >>> 7 | 128 : a >>> 7 & 127;
                    case 1:
                        this.view[i] = 1 !== n ? 128 | a : 127 & a
                }
                return r ? (this.offset += n, this) : n
            }, a.writeVarint64ZigZag = function (e, t) {
                return this.writeVarint64(o.zigZagEncode64(e), t)
            }, a.readVarint64 = function (t) {
                var i = "undefined" == typeof t;
                if (i && (t = this.offset), !this.noAssert) {
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: " + t + " (not an integer)");
                    if (t >>>= 0, 0 > t || t + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength)
                }
                var r = t, n = 0, o = 0, a = 0, s = 0;
                if (s = this.view[t++], n = 127 & s, 128 & s && (s = this.view[t++], n |= (127 & s) << 7, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], n |= (127 & s) << 14, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], n |= (127 & s) << 21, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], o = 127 & s, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], o |= (127 & s) << 7, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], o |= (127 & s) << 14, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], o |= (127 & s) << 21, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], a = 127 & s, (128 & s || this.noAssert && "undefined" == typeof s) && (s = this.view[t++], a |= (127 & s) << 7, 128 & s || this.noAssert && "undefined" == typeof s))))))))))throw Error("Buffer overrun");
                var h = e.fromBits(n | o << 28, o >>> 4 | a << 24, !1);
                return i ? (this.offset = t, h) : {value: h, length: t - r}
            }, a.readVarint64ZigZag = function (t) {
                var i = this.readVarint64(t);
                return i && i.value instanceof e ? i.value = o.zigZagDecode64(i.value) : i = o.zigZagDecode64(i), i
            }), a.writeCString = function (e, i) {
                var r = "undefined" == typeof i;
                r && (i = this.offset);
                var n, o = e.length;
                if (!this.noAssert) {
                    if ("string" != typeof e)throw TypeError("Illegal str: Not a string");
                    for (n = 0; o > n; ++n)if (0 === e.charCodeAt(n))throw RangeError("Illegal str: Contains NULL-characters");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                o = u.calculateUTF16asUTF8(t(e))[1], i += o + 1;
                var a = this.buffer.byteLength;
                return i > a && this.resize((a *= 2) > i ? a : i), i -= o + 1, u.encodeUTF16toUTF8(t(e), function (e) {
                    this.view[i++] = e
                }.bind(this)), this.view[i++] = 0, r ? (this.offset = i, this) : o
            }, a.readCString = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                }
                var r, n = e, o = -1;
                return u.decodeUTF8toUTF16(function () {
                    if (0 === o)return null;
                    if (e >= this.limit)throw RangeError("Illegal range: Truncated data, " + e + " < " + this.limit);
                    return o = this.view[e++], 0 === o ? null : o
                }.bind(this), r = i(), !0), t ? (this.offset = e, r()) : {string: r(), length: e - n}
            }, a.writeIString = function (e, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("string" != typeof e)throw TypeError("Illegal str: Not a string");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                var n, o = i;
                n = u.calculateUTF16asUTF8(t(e), this.noAssert)[1], i += 4 + n;
                var a = this.buffer.byteLength;
                if (i > a && this.resize((a *= 2) > i ? a : i), i -= 4 + n, this.littleEndian ? (this.view[i + 3] = n >>> 24 & 255, this.view[i + 2] = n >>> 16 & 255, this.view[i + 1] = n >>> 8 & 255, this.view[i] = 255 & n) : (this.view[i] = n >>> 24 & 255, this.view[i + 1] = n >>> 16 & 255, this.view[i + 2] = n >>> 8 & 255, this.view[i + 3] = 255 & n), i += 4, u.encodeUTF16toUTF8(t(e), function (e) {
                        this.view[i++] = e
                    }.bind(this)), i !== o + 4 + n)throw RangeError("Illegal range: Truncated data, " + i + " == " + (i + 4 + n));
                return r ? (this.offset = i, this) : i - o
            }, a.readIString = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 4 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength)
                }
                var i = e, r = this.readUint32(e), n = this.readUTF8String(r, o.METRICS_BYTES, e += 4);
                return e += n.length, t ? (this.offset = e, n.string) : {string: n.string, length: e - i}
            }, o.METRICS_CHARS = "c", o.METRICS_BYTES = "b", a.writeUTF8String = function (e, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                var n, o = i;
                n = u.calculateUTF16asUTF8(t(e))[1], i += n;
                var a = this.buffer.byteLength;
                return i > a && this.resize((a *= 2) > i ? a : i), i -= n, u.encodeUTF16toUTF8(t(e), function (e) {
                    this.view[i++] = e
                }.bind(this)), r ? (this.offset = i, this) : i - o
            }, a.writeString = a.writeUTF8String, o.calculateUTF8Chars = function (e) {
                return u.calculateUTF16asUTF8(t(e))[0]
            }, o.calculateUTF8Bytes = function (e) {
                return u.calculateUTF16asUTF8(t(e))[1]
            }, o.calculateString = o.calculateUTF8Bytes, a.readUTF8String = function (e, t, r) {
                "number" == typeof t && (r = t, t = void 0);
                var n = "undefined" == typeof r;
                if (n && (r = this.offset), "undefined" == typeof t && (t = o.METRICS_CHARS), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal length: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof r || r % 1 !== 0)throw TypeError("Illegal offset: " + r + " (not an integer)");
                    if (r >>>= 0, 0 > r || r + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength)
                }
                var a, s = 0, h = r;
                if (t === o.METRICS_CHARS) {
                    if (a = i(), u.decodeUTF8(function () {
                            return e > s && r < this.limit ? this.view[r++] : null
                        }.bind(this), function (e) {
                            ++s, u.UTF8toUTF16(e, a)
                        }), s !== e)throw RangeError("Illegal range: Truncated data, " + s + " == " + e);
                    return n ? (this.offset = r, a()) : {string: a(), length: r - h}
                }
                if (t === o.METRICS_BYTES) {
                    if (!this.noAssert) {
                        if ("number" != typeof r || r % 1 !== 0)throw TypeError("Illegal offset: " + r + " (not an integer)");
                        if (r >>>= 0, 0 > r || r + e > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + r + " (+" + e + ") <= " + this.buffer.byteLength)
                    }
                    var l = r + e;
                    if (u.decodeUTF8toUTF16(function () {
                            return l > r ? this.view[r++] : null
                        }.bind(this), a = i(), this.noAssert), r !== l)throw RangeError("Illegal range: Truncated data, " + r + " == " + l);
                    return n ? (this.offset = r, a()) : {string: a(), length: r - h}
                }
                throw TypeError("Unsupported metrics: " + t)
            }, a.readString = a.readUTF8String, a.writeVString = function (e, i) {
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("string" != typeof e)throw TypeError("Illegal str: Not a string");
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                var n, a, s = i;
                n = u.calculateUTF16asUTF8(t(e), this.noAssert)[1], a = o.calculateVarint32(n), i += a + n;
                var h = this.buffer.byteLength;
                if (i > h && this.resize((h *= 2) > i ? h : i), i -= a + n, i += this.writeVarint32(n, i), u.encodeUTF16toUTF8(t(e), function (e) {
                        this.view[i++] = e
                    }.bind(this)), i !== s + n + a)throw RangeError("Illegal range: Truncated data, " + i + " == " + (i + n + a));
                return r ? (this.offset = i, this) : i - s
            }, a.readVString = function (e) {
                var t = "undefined" == typeof e;
                if (t && (e = this.offset), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 1 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength)
                }
                var i = e, r = this.readVarint32(e), n = this.readUTF8String(r.value, o.METRICS_BYTES, e += r.length);
                return e += n.length, t ? (this.offset = e, n.string) : {string: n.string, length: e - i}
            }, a.append = function (e, t, i) {
                ("number" == typeof t || "string" != typeof t) && (i = t, t = void 0);
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                e instanceof o || (e = o.wrap(e, t));
                var n = e.limit - e.offset;
                if (0 >= n)return this;
                i += n;
                var a = this.buffer.byteLength;
                return i > a && this.resize((a *= 2) > i ? a : i), i -= n, this.view.set(e.view.subarray(e.offset, e.limit), i), e.offset += n, r && (this.offset += n), this
            }, a.appendTo = function (e, t) {
                return e.append(this, t), this
            }, a.assert = function (e) {
                return this.noAssert = !e, this
            }, a.capacity = function () {
                return this.buffer.byteLength
            }, a.clear = function () {
                return this.offset = 0, this.limit = this.buffer.byteLength, this.markedOffset = -1, this
            }, a.clone = function (e) {
                var t = new o(0, this.littleEndian, this.noAssert);
                return e ? (t.buffer = new ArrayBuffer(this.buffer.byteLength), t.view = new Uint8Array(t.buffer)) : (t.buffer = this.buffer, t.view = this.view), t.offset = this.offset, t.markedOffset = this.markedOffset, t.limit = this.limit, t
            }, a.compact = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                if (0 === e && t === this.buffer.byteLength)return this;
                var i = t - e;
                if (0 === i)return this.buffer = s, this.view = null, this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = 0, this;
                var r = new ArrayBuffer(i), n = new Uint8Array(r);
                return n.set(this.view.subarray(e, t)), this.buffer = r, this.view = n, this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = i, this
            }, a.copy = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                if (e === t)return new o(0, this.littleEndian, this.noAssert);
                var i = t - e, r = new o(i, this.littleEndian, this.noAssert);
                return r.offset = 0, r.limit = i, r.markedOffset >= 0 && (r.markedOffset -= e), this.copyTo(r, 0, e, t), r
            }, a.copyTo = function (e, t, i, r) {
                var n, a;
                if (!this.noAssert && !o.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");
                if (t = (a = "undefined" == typeof t) ? e.offset : 0 | t, i = (n = "undefined" == typeof i) ? this.offset : 0 | i, r = "undefined" == typeof r ? this.limit : 0 | r, 0 > t || t > e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= " + t + " <= " + e.buffer.byteLength);
                if (0 > i || r > this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= " + i + " <= " + this.buffer.byteLength);
                var s = r - i;
                return 0 === s ? e : (e.ensureCapacity(t + s), e.view.set(this.view.subarray(i, r), t), n && (this.offset += s), a && (e.offset += s), this)
            }, a.ensureCapacity = function (e) {
                var t = this.buffer.byteLength;
                return e > t ? this.resize((t *= 2) > e ? t : e) : this
            }, a.fill = function (e, t, i) {
                var r = "undefined" == typeof t;
                if (r && (t = this.offset), "string" == typeof e && e.length > 0 && (e = e.charCodeAt(0)), "undefined" == typeof t && (t = this.offset), "undefined" == typeof i && (i = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal value: " + e + " (not an integer)");
                    if (e |= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (t >>>= 0, "number" != typeof i || i % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (i >>>= 0, 0 > t || t > i || i > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + t + " <= " + i + " <= " + this.buffer.byteLength)
                }
                if (t >= i)return this;
                for (; i > t;)this.view[t++] = e;
                return r && (this.offset = t), this
            }, a.flip = function () {
                return this.limit = this.offset, this.offset = 0, this
            }, a.mark = function (e) {
                if (e = "undefined" == typeof e ? this.offset : e, !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal offset: " + e + " (not an integer)");
                    if (e >>>= 0, 0 > e || e + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength)
                }
                return this.markedOffset = e, this
            }, a.order = function (e) {
                if (!this.noAssert && "boolean" != typeof e)throw TypeError("Illegal littleEndian: Not a boolean");
                return this.littleEndian = !!e, this
            }, a.LE = function (e) {
                return this.littleEndian = "undefined" != typeof e ? !!e : !0, this
            }, a.BE = function (e) {
                return this.littleEndian = "undefined" != typeof e ? !e : !1, this
            }, a.prepend = function (e, t, i) {
                ("number" == typeof t || "string" != typeof t) && (i = t, t = void 0);
                var r = "undefined" == typeof i;
                if (r && (i = this.offset), !this.noAssert) {
                    if ("number" != typeof i || i % 1 !== 0)throw TypeError("Illegal offset: " + i + " (not an integer)");
                    if (i >>>= 0, 0 > i || i + 0 > this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= " + i + " (+0) <= " + this.buffer.byteLength)
                }
                e instanceof o || (e = o.wrap(e, t));
                var n = e.limit - e.offset;
                if (0 >= n)return this;
                var a = n - i;
                if (a > 0) {
                    var s = new ArrayBuffer(this.buffer.byteLength + a), h = new Uint8Array(s);
                    h.set(this.view.subarray(i, this.buffer.byteLength), n), this.buffer = s, this.view = h, this.offset += a, this.markedOffset >= 0 && (this.markedOffset += a), this.limit += a, i += a
                } else {
                    new Uint8Array(this.buffer)
                }
                return this.view.set(e.view.subarray(e.offset, e.limit), i - n), e.offset = e.limit, r && (this.offset -= n), this
            }, a.prependTo = function (e, t) {
                return e.prepend(this, t), this
            }, a.printDebug = function (e) {
                "function" != typeof e && (e = console.log.bind(console)), e(this.toString() + "\n-------------------------------------------------------------------\n" + this.toDebug(!0))
            }, a.remaining = function () {
                return this.limit - this.offset
            }, a.reset = function () {
                return this.markedOffset >= 0 ? (this.offset = this.markedOffset, this.markedOffset = -1) : this.offset = 0, this
            }, a.resize = function (e) {
                if (!this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal capacity: " + e + " (not an integer)");
                    if (e |= 0, 0 > e)throw RangeError("Illegal capacity: 0 <= " + e)
                }
                if (this.buffer.byteLength < e) {
                    var t = new ArrayBuffer(e), i = new Uint8Array(t);
                    i.set(this.view), this.buffer = t, this.view = i
                }
                return this
            }, a.reverse = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                return e === t ? this : (Array.prototype.reverse.call(this.view.subarray(e, t)), this)
            }, a.skip = function (e) {
                if (!this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal length: " + e + " (not an integer)");
                    e |= 0
                }
                var t = this.offset + e;
                if (!this.noAssert && (0 > t || t > this.buffer.byteLength))throw RangeError("Illegal length: 0 <= " + this.offset + " + " + e + " <= " + this.buffer.byteLength);
                return this.offset = t, this
            }, a.slice = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                var i = this.clone();
                return i.offset = e, i.limit = t, i
            }, a.toBuffer = function (e) {
                var t = this.offset, i = this.limit;
                if (!this.noAssert) {
                    if ("number" != typeof t || t % 1 !== 0)throw TypeError("Illegal offset: Not an integer");
                    if (t >>>= 0, "number" != typeof i || i % 1 !== 0)throw TypeError("Illegal limit: Not an integer");
                    if (i >>>= 0, 0 > t || t > i || i > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + t + " <= " + i + " <= " + this.buffer.byteLength)
                }
                if (!e && 0 === t && i === this.buffer.byteLength)return this.buffer;
                if (t === i)return s;
                var r = new ArrayBuffer(i - t);
                return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(t, i), 0), r
            }, a.toArrayBuffer = a.toBuffer, a.toString = function (e, t, i) {
                if ("undefined" == typeof e)return "ByteBufferAB(offset=" + this.offset + ",markedOffset=" + this.markedOffset + ",limit=" + this.limit + ",capacity=" + this.capacity() + ")";
                switch ("number" == typeof e && (e = "utf8", t = e, i = t), e) {
                    case"utf8":
                        return this.toUTF8(t, i);
                    case"base64":
                        return this.toBase64(t, i);
                    case"hex":
                        return this.toHex(t, i);
                    case"binary":
                        return this.toBinary(t, i);
                    case"debug":
                        return this.toDebug();
                    case"columns":
                        return this.toColumns();
                    default:
                        throw Error("Unsupported encoding: " + e)
                }
            };
            var l = function () {
                for (var e = {}, t = [65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 43, 47], i = [], r = 0, n = t.length; n > r; ++r)i[t[r]] = r;
                return e.encode = function (e, i) {
                    for (var r, n; null !== (r = e());)i(t[r >> 2 & 63]), n = (3 & r) << 4, null !== (r = e()) ? (n |= r >> 4 & 15, i(t[63 & (n | r >> 4 & 15)]), n = (15 & r) << 2, null !== (r = e()) ? (i(t[63 & (n | r >> 6 & 3)]), i(t[63 & r])) : (i(t[63 & n]), i(61))) : (i(t[63 & n]), i(61), i(61))
                }, e.decode = function (e, t) {
                    function r(e) {
                        throw Error("Illegal character code: " + e)
                    }

                    for (var n, o, a; null !== (n = e());)if (o = i[n], "undefined" == typeof o && r(n), null !== (n = e()) && (a = i[n], "undefined" == typeof a && r(n), t(o << 2 >>> 0 | (48 & a) >> 4), null !== (n = e()))) {
                        if (o = i[n], "undefined" == typeof o) {
                            if (61 === n)break;
                            r(n)
                        }
                        if (t((15 & a) << 4 >>> 0 | (60 & o) >> 2), null !== (n = e())) {
                            if (a = i[n], "undefined" == typeof a) {
                                if (61 === n)break;
                                r(n)
                            }
                            t((3 & o) << 6 >>> 0 | a)
                        }
                    }
                }, e.test = function (e) {
                    return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)
                }, e
            }();
            a.toBase64 = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), e = 0 | e, t = 0 | t, 0 > e || t > this.capacity || e > t)throw RangeError("begin, end");
                var r;
                return l.encode(function () {
                    return t > e ? this.view[e++] : null
                }.bind(this), r = i()), r()
            }, o.fromBase64 = function (e, i) {
                if ("string" != typeof e)throw TypeError("str");
                var r = new o(e.length / 4 * 3, i), n = 0;
                return l.decode(t(e), function (e) {
                    r.view[n++] = e
                }), r.limit = n, r
            }, o.btoa = function (e) {
                return o.fromBinary(e).toBase64()
            }, o.atob = function (e) {
                return o.fromBase64(e).toBinary()
            }, a.toBinary = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), e |= 0, t |= 0, 0 > e || t > this.capacity() || e > t)throw RangeError("begin, end");
                if (e === t)return "";
                for (var i = [], r = []; t > e;)i.push(this.view[e++]), i.length >= 1024 && (r.push(String.fromCharCode.apply(String, i)), i = []);
                return r.join("") + String.fromCharCode.apply(String, i)
            }, o.fromBinary = function (e, t) {
                if ("string" != typeof e)throw TypeError("str");
                for (var i, r = 0, n = e.length, a = new o(n, t); n > r;) {
                    if (i = e.charCodeAt(r), i > 255)throw RangeError("illegal char code: " + i);
                    a.view[r++] = i
                }
                return a.limit = n, a
            }, a.toDebug = function (e) {
                for (var t, i = -1, r = this.buffer.byteLength, n = "", o = "", a = ""; r > i;) {
                    if (-1 !== i && (t = this.view[i], n += 16 > t ? "0" + t.toString(16).toUpperCase() : t.toString(16).toUpperCase(), e && (o += t > 32 && 127 > t ? String.fromCharCode(t) : ".")), ++i, e && i > 0 && i % 16 === 0 && i !== r) {
                        for (; n.length < 51;)n += " ";
                        a += n + o + "\n", n = o = ""
                    }
                    n += i === this.offset && i === this.limit ? i === this.markedOffset ? "!" : "|" : i === this.offset ? i === this.markedOffset ? "[" : "<" : i === this.limit ? i === this.markedOffset ? "]" : ">" : i === this.markedOffset ? "'" : e || 0 !== i && i !== r ? " " : ""
                }
                if (e && " " !== n) {
                    for (; n.length < 51;)n += " ";
                    a += n + o + "\n"
                }
                return e ? a : n
            }, o.fromDebug = function (e, t, i) {
                for (var r, n, a = e.length, s = new o((a + 1) / 3 | 0, t, i), h = 0, l = 0, u = !1, c = !1, d = !1, f = !1, p = !1; a > h;) {
                    switch (r = e.charAt(h++)) {
                        case"!":
                            if (!i) {
                                if (c || d || f) {
                                    p = !0;
                                    break
                                }
                                c = d = f = !0
                            }
                            s.offset = s.markedOffset = s.limit = l, u = !1;
                            break;
                        case"|":
                            if (!i) {
                                if (c || f) {
                                    p = !0;
                                    break
                                }
                                c = f = !0
                            }
                            s.offset = s.limit = l, u = !1;
                            break;
                        case"[":
                            if (!i) {
                                if (c || d) {
                                    p = !0;
                                    break
                                }
                                c = d = !0
                            }
                            s.offset = s.markedOffset = l, u = !1;
                            break;
                        case"<":
                            if (!i) {
                                if (c) {
                                    p = !0;
                                    break
                                }
                                c = !0
                            }
                            s.offset = l, u = !1;
                            break;
                        case"]":
                            if (!i) {
                                if (f || d) {
                                    p = !0;
                                    break
                                }
                                f = d = !0
                            }
                            s.limit = s.markedOffset = l, u = !1;
                            break;
                        case">":
                            if (!i) {
                                if (f) {
                                    p = !0;
                                    break
                                }
                                f = !0
                            }
                            s.limit = l, u = !1;
                            break;
                        case"'":
                            if (!i) {
                                if (d) {
                                    p = !0;
                                    break
                                }
                                d = !0
                            }
                            s.markedOffset = l, u = !1;
                            break;
                        case" ":
                            u = !1;
                            break;
                        default:
                            if (!i && u) {
                                p = !0;
                                break
                            }
                            if (n = parseInt(r + e.charAt(h++), 16), !i && (isNaN(n) || 0 > n || n > 255))throw TypeError("Illegal str: Not a debug encoded string");
                            s.view[l++] = n, u = !0
                    }
                    if (p)throw TypeError("Illegal str: Invalid symbol at " + h)
                }
                if (!i) {
                    if (!c || !f)throw TypeError("Illegal str: Missing offset or limit");
                    if (l < s.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) " + l + " < " + a)
                }
                return s
            }, a.toHex = function (e, t) {
                if (e = "undefined" == typeof e ? this.offset : e, t = "undefined" == typeof t ? this.limit : t, !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                for (var i, r = new Array(t - e); t > e;)i = this.view[e++], 16 > i ? r.push("0", i.toString(16)) : r.push(i.toString(16));
                return r.join("")
            }, o.fromHex = function (e, t, i) {
                if (!i) {
                    if ("string" != typeof e)throw TypeError("Illegal str: Not a string");
                    if (e.length % 2 !== 0)throw TypeError("Illegal str: Length not a multiple of 2")
                }
                for (var r, n = e.length, a = new o(n / 2 | 0, t), s = 0, h = 0; n > s; s += 2) {
                    if (r = parseInt(e.substring(s, s + 2), 16), !i && (!isFinite(r) || 0 > r || r > 255))throw TypeError("Illegal str: Contains non-hex characters");
                    a.view[h++] = r
                }
                return a.limit = h, a
            };
            var u = function () {
                var e = {};
                return e.MAX_CODEPOINT = 1114111, e.encodeUTF8 = function (e, t) {
                    var i = null;
                    for ("number" == typeof e && (i = e, e = function () {
                        return null
                    }); null !== i || null !== (i = e());)128 > i ? t(127 & i) : 2048 > i ? (t(i >> 6 & 31 | 192), t(63 & i | 128)) : 65536 > i ? (t(i >> 12 & 15 | 224), t(i >> 6 & 63 | 128), t(63 & i | 128)) : (t(i >> 18 & 7 | 240), t(i >> 12 & 63 | 128), t(i >> 6 & 63 | 128), t(63 & i | 128)), i = null
                }, e.decodeUTF8 = function (e, t) {
                    for (var i, r, n, o, a = function (e) {
                        e = e.slice(0, e.indexOf(null));
                        var t = Error(e.toString());
                        throw t.name = "TruncatedError", t.bytes = e, t
                    }; null !== (i = e());)if (0 === (128 & i))t(i); else if (192 === (224 & i))null === (r = e()) && a([i, r]), t((31 & i) << 6 | 63 & r); else if (224 === (240 & i))(null === (r = e()) || null === (n = e())) && a([i, r, n]), t((15 & i) << 12 | (63 & r) << 6 | 63 & n); else {
                        if (240 !== (248 & i))throw RangeError("Illegal starting byte: " + i);
                        (null === (r = e()) || null === (n = e()) || null === (o = e())) && a([i, r, n, o]), t((7 & i) << 18 | (63 & r) << 12 | (63 & n) << 6 | 63 & o)
                    }
                }, e.UTF16toUTF8 = function (e, t) {
                    for (var i, r = null; ;) {
                        if (null === (i = null !== r ? r : e()))break;
                        i >= 55296 && 57343 >= i && null !== (r = e()) && r >= 56320 && 57343 >= r ? (t(1024 * (i - 55296) + r - 56320 + 65536), r = null) : t(i)
                    }
                    null !== r && t(r)
                }, e.UTF8toUTF16 = function (e, t) {
                    var i = null;
                    for ("number" == typeof e && (i = e, e = function () {
                        return null
                    }); null !== i || null !== (i = e());)65535 >= i ? t(i) : (i -= 65536, t((i >> 10) + 55296), t(i % 1024 + 56320)), i = null
                }, e.encodeUTF16toUTF8 = function (t, i) {
                    e.UTF16toUTF8(t, function (t) {
                        e.encodeUTF8(t, i)
                    })
                }, e.decodeUTF8toUTF16 = function (t, i) {
                    e.decodeUTF8(t, function (t) {
                        e.UTF8toUTF16(t, i)
                    })
                }, e.calculateCodePoint = function (e) {
                    return 128 > e ? 1 : 2048 > e ? 2 : 65536 > e ? 3 : 4
                }, e.calculateUTF8 = function (e) {
                    for (var t, i = 0; null !== (t = e());)i += 128 > t ? 1 : 2048 > t ? 2 : 65536 > t ? 3 : 4;
                    return i
                }, e.calculateUTF16asUTF8 = function (t) {
                    var i = 0, r = 0;
                    return e.UTF16toUTF8(t, function (e) {
                        ++i, r += 128 > e ? 1 : 2048 > e ? 2 : 65536 > e ? 3 : 4
                    }), [i, r]
                }, e
            }();
            return a.toUTF8 = function (e, t) {
                if ("undefined" == typeof e && (e = this.offset), "undefined" == typeof t && (t = this.limit), !this.noAssert) {
                    if ("number" != typeof e || e % 1 !== 0)throw TypeError("Illegal begin: Not an integer");
                    if (e >>>= 0, "number" != typeof t || t % 1 !== 0)throw TypeError("Illegal end: Not an integer");
                    if (t >>>= 0, 0 > e || e > t || t > this.buffer.byteLength)throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength)
                }
                var r;
                try {
                    u.decodeUTF8toUTF16(function () {
                        return t > e ? this.view[e++] : null
                    }.bind(this), r = i())
                } catch (n) {
                    if (e !== t)throw RangeError("Illegal range: Truncated data, " + e + " != " + t)
                }
                return r()
            }, o.fromUTF8 = function (e, i, r) {
                if (!r && "string" != typeof e)throw TypeError("Illegal str: Not a string");
                var n = new o(u.calculateUTF16asUTF8(t(e), !0)[1], i, r), a = 0;
                return u.encodeUTF16toUTF8(t(e), function (e) {
                    n.view[a++] = e
                }), n.limit = a, n
            }, o
        })
    }, {"long": 137}],
    137: [function (e, t, i) {
        !function (i, r) {
            "function" == typeof define && define.amd ? define([], r) : "function" == typeof e && "object" == typeof t && t && t.exports ? t.exports = r() : (i.dcodeIO = i.dcodeIO || {}).Long = r()
        }(this, function () {
            "use strict";
            function e(e, t, i) {
                this.low = 0 | e, this.high = 0 | t, this.unsigned = !!i
            }

            function t(e) {
                return (e && e.__isLong__) === !0
            }

            function i(e, t) {
                var i, r, o;
                return t ? (e >>>= 0, (o = e >= 0 && 256 > e) && (r = h[e]) ? r : (i = n(e, 0 > (0 | e) ? -1 : 0, !0), o && (h[e] = i), i)) : (e |= 0, (o = e >= -128 && 128 > e) && (r = s[e]) ? r : (i = n(e, 0 > e ? -1 : 0, !1), o && (s[e] = i), i))
            }

            function r(e, t) {
                if (isNaN(e) || !isFinite(e))return t ? v : g;
                if (t) {
                    if (0 > e)return v;
                    if (e >= f)return x
                } else {
                    if (-p >= e)return S;
                    if (e + 1 >= p)return _
                }
                return 0 > e ? r(-e, t).neg() : n(e % d | 0, e / d | 0, t)
            }

            function n(t, i, r) {
                return new e(t, i, r)
            }

            function o(e, t, i) {
                if (0 === e.length)throw Error("empty string");
                if ("NaN" === e || "Infinity" === e || "+Infinity" === e || "-Infinity" === e)return g;
                if ("number" == typeof t && (i = t, t = !1), i = i || 10, 2 > i || i > 36)throw RangeError("radix");
                var n;
                if ((n = e.indexOf("-")) > 0)throw Error("interior hyphen");
                if (0 === n)return o(e.substring(1), t, i).neg();
                for (var a = r(l(i, 8)), s = g, h = 0; h < e.length; h += 8) {
                    var u = Math.min(8, e.length - h), c = parseInt(e.substring(h, h + u), i);
                    if (8 > u) {
                        var d = r(l(i, u));
                        s = s.mul(d).add(r(c))
                    } else s = s.mul(a), s = s.add(r(c))
                }
                return s.unsigned = t, s
            }

            function a(t) {
                return t instanceof e ? t : "number" == typeof t ? r(t) : "string" == typeof t ? o(t) : n(t.low, t.high, t.unsigned)
            }

            e.__isLong__, Object.defineProperty(e.prototype, "__isLong__", {
                value: !0,
                enumerable: !1,
                configurable: !1
            }), e.isLong = t;
            var s = {}, h = {};
            e.fromInt = i, e.fromNumber = r, e.fromBits = n;
            var l = Math.pow;
            e.fromString = o, e.fromValue = a;
            var u = 65536, c = 1 << 24, d = u * u, f = d * d, p = f / 2, m = i(c), g = i(0);
            e.ZERO = g;
            var v = i(0, !0);
            e.UZERO = v;
            var y = i(1);
            e.ONE = y;
            var b = i(1, !0);
            e.UONE = b;
            var w = i(-1);
            e.NEG_ONE = w;
            var _ = n(-1, 2147483647, !1);
            e.MAX_VALUE = _;
            var x = n(-1, -1, !0);
            e.MAX_UNSIGNED_VALUE = x;
            var S = n(0, -2147483648, !1);
            e.MIN_VALUE = S;
            var E = e.prototype;
            return E.toInt = function () {
                return this.unsigned ? this.low >>> 0 : this.low
            }, E.toNumber = function () {
                return this.unsigned ? (this.high >>> 0) * d + (this.low >>> 0) : this.high * d + (this.low >>> 0)
            }, E.toString = function (e) {
                if (e = e || 10, 2 > e || e > 36)throw RangeError("radix");
                if (this.isZero())return "0";
                if (this.isNegative()) {
                    if (this.eq(S)) {
                        var t = r(e), i = this.div(t), n = i.mul(t).sub(this);
                        return i.toString(e) + n.toInt().toString(e)
                    }
                    return "-" + this.neg().toString(e)
                }
                for (var o = r(l(e, 6), this.unsigned), a = this, s = ""; ;) {
                    var h = a.div(o), u = a.sub(h.mul(o)).toInt() >>> 0, c = u.toString(e);
                    if (a = h, a.isZero())return c + s;
                    for (; c.length < 6;)c = "0" + c;
                    s = "" + c + s
                }
            }, E.getHighBits = function () {
                return this.high
            }, E.getHighBitsUnsigned = function () {
                return this.high >>> 0
            }, E.getLowBits = function () {
                return this.low
            }, E.getLowBitsUnsigned = function () {
                return this.low >>> 0
            }, E.getNumBitsAbs = function () {
                if (this.isNegative())return this.eq(S) ? 64 : this.neg().getNumBitsAbs();
                for (var e = 0 != this.high ? this.high : this.low, t = 31; t > 0 && 0 == (e & 1 << t); t--);
                return 0 != this.high ? t + 33 : t + 1
            }, E.isZero = function () {
                return 0 === this.high && 0 === this.low
            }, E.isNegative = function () {
                return !this.unsigned && this.high < 0
            }, E.isPositive = function () {
                return this.unsigned || this.high >= 0
            }, E.isOdd = function () {
                return 1 === (1 & this.low)
            }, E.isEven = function () {
                return 0 === (1 & this.low)
            }, E.equals = function (e) {
                return t(e) || (e = a(e)), this.unsigned !== e.unsigned && this.high >>> 31 === 1 && e.high >>> 31 === 1 ? !1 : this.high === e.high && this.low === e.low;
            }, E.eq = E.equals, E.notEquals = function (e) {
                return !this.eq(e)
            }, E.neq = E.notEquals, E.lessThan = function (e) {
                return this.comp(e) < 0
            }, E.lt = E.lessThan, E.lessThanOrEqual = function (e) {
                return this.comp(e) <= 0
            }, E.lte = E.lessThanOrEqual, E.greaterThan = function (e) {
                return this.comp(e) > 0
            }, E.gt = E.greaterThan, E.greaterThanOrEqual = function (e) {
                return this.comp(e) >= 0
            }, E.gte = E.greaterThanOrEqual, E.compare = function (e) {
                if (t(e) || (e = a(e)), this.eq(e))return 0;
                var i = this.isNegative(), r = e.isNegative();
                return i && !r ? -1 : !i && r ? 1 : this.unsigned ? e.high >>> 0 > this.high >>> 0 || e.high === this.high && e.low >>> 0 > this.low >>> 0 ? -1 : 1 : this.sub(e).isNegative() ? -1 : 1
            }, E.comp = E.compare, E.negate = function () {
                return !this.unsigned && this.eq(S) ? S : this.not().add(y)
            }, E.neg = E.negate, E.add = function (e) {
                t(e) || (e = a(e));
                var i = this.high >>> 16, r = 65535 & this.high, o = this.low >>> 16, s = 65535 & this.low, h = e.high >>> 16, l = 65535 & e.high, u = e.low >>> 16, c = 65535 & e.low, d = 0, f = 0, p = 0, m = 0;
                return m += s + c, p += m >>> 16, m &= 65535, p += o + u, f += p >>> 16, p &= 65535, f += r + l, d += f >>> 16, f &= 65535, d += i + h, d &= 65535, n(p << 16 | m, d << 16 | f, this.unsigned)
            }, E.subtract = function (e) {
                return t(e) || (e = a(e)), this.add(e.neg())
            }, E.sub = E.subtract, E.multiply = function (e) {
                if (this.isZero())return g;
                if (t(e) || (e = a(e)), e.isZero())return g;
                if (this.eq(S))return e.isOdd() ? S : g;
                if (e.eq(S))return this.isOdd() ? S : g;
                if (this.isNegative())return e.isNegative() ? this.neg().mul(e.neg()) : this.neg().mul(e).neg();
                if (e.isNegative())return this.mul(e.neg()).neg();
                if (this.lt(m) && e.lt(m))return r(this.toNumber() * e.toNumber(), this.unsigned);
                var i = this.high >>> 16, o = 65535 & this.high, s = this.low >>> 16, h = 65535 & this.low, l = e.high >>> 16, u = 65535 & e.high, c = e.low >>> 16, d = 65535 & e.low, f = 0, p = 0, v = 0, y = 0;
                return y += h * d, v += y >>> 16, y &= 65535, v += s * d, p += v >>> 16, v &= 65535, v += h * c, p += v >>> 16, v &= 65535, p += o * d, f += p >>> 16, p &= 65535, p += s * c, f += p >>> 16, p &= 65535, p += h * u, f += p >>> 16, p &= 65535, f += i * d + o * c + s * u + h * l, f &= 65535, n(v << 16 | y, f << 16 | p, this.unsigned)
            }, E.mul = E.multiply, E.divide = function (e) {
                if (t(e) || (e = a(e)), e.isZero())throw Error("division by zero");
                if (this.isZero())return this.unsigned ? v : g;
                var i, n, o;
                if (this.eq(S)) {
                    if (e.eq(y) || e.eq(w))return S;
                    if (e.eq(S))return y;
                    var s = this.shr(1);
                    return i = s.div(e).shl(1), i.eq(g) ? e.isNegative() ? y : w : (n = this.sub(e.mul(i)), o = i.add(n.div(e)))
                }
                if (e.eq(S))return this.unsigned ? v : g;
                if (this.isNegative())return e.isNegative() ? this.neg().div(e.neg()) : this.neg().div(e).neg();
                if (e.isNegative())return this.div(e.neg()).neg();
                for (o = g, n = this; n.gte(e);) {
                    i = Math.max(1, Math.floor(n.toNumber() / e.toNumber()));
                    for (var h = Math.ceil(Math.log(i) / Math.LN2), u = 48 >= h ? 1 : l(2, h - 48), c = r(i), d = c.mul(e); d.isNegative() || d.gt(n);)i -= u, c = r(i, this.unsigned), d = c.mul(e);
                    c.isZero() && (c = y), o = o.add(c), n = n.sub(d)
                }
                return o
            }, E.div = E.divide, E.modulo = function (e) {
                return t(e) || (e = a(e)), this.sub(this.div(e).mul(e))
            }, E.mod = E.modulo, E.not = function () {
                return n(~this.low, ~this.high, this.unsigned)
            }, E.and = function (e) {
                return t(e) || (e = a(e)), n(this.low & e.low, this.high & e.high, this.unsigned)
            }, E.or = function (e) {
                return t(e) || (e = a(e)), n(this.low | e.low, this.high | e.high, this.unsigned)
            }, E.xor = function (e) {
                return t(e) || (e = a(e)), n(this.low ^ e.low, this.high ^ e.high, this.unsigned)
            }, E.shiftLeft = function (e) {
                return t(e) && (e = e.toInt()), 0 === (e &= 63) ? this : 32 > e ? n(this.low << e, this.high << e | this.low >>> 32 - e, this.unsigned) : n(0, this.low << e - 32, this.unsigned)
            }, E.shl = E.shiftLeft, E.shiftRight = function (e) {
                return t(e) && (e = e.toInt()), 0 === (e &= 63) ? this : 32 > e ? n(this.low >>> e | this.high << 32 - e, this.high >> e, this.unsigned) : n(this.high >> e - 32, this.high >= 0 ? 0 : -1, this.unsigned)
            }, E.shr = E.shiftRight, E.shiftRightUnsigned = function (e) {
                if (t(e) && (e = e.toInt()), e &= 63, 0 === e)return this;
                var i = this.high;
                if (32 > e) {
                    var r = this.low;
                    return n(r >>> e | i << 32 - e, i >>> e, this.unsigned)
                }
                return 32 === e ? n(i, 0, this.unsigned) : n(i >>> e - 32, 0, this.unsigned)
            }, E.shru = E.shiftRightUnsigned, E.toSigned = function () {
                return this.unsigned ? n(this.low, this.high, !1) : this
            }, E.toUnsigned = function () {
                return this.unsigned ? this : n(this.low, this.high, !0)
            }, e
        })
    }, {}],
    138: [function (e, t, i) {
        var r = r || {}, n = {REVISION: "71"};
        "object" == typeof t && (t.exports = n), void 0 === Math.sign && (Math.sign = function (e) {
            return 0 > e ? -1 : e > 0 ? 1 : +e
        }), n.log = function () {
            console.log.apply(console, arguments)
        }, n.warn = function () {
            console.warn.apply(console, arguments)
        }, n.error = function () {
            console.error.apply(console, arguments)
        }, n.MOUSE = {
            LEFT: 0,
            MIDDLE: 1,
            RIGHT: 2
        }, n.CullFaceNone = 0, n.CullFaceBack = 1, n.CullFaceFront = 2, n.CullFaceFrontBack = 3, n.FrontFaceDirectionCW = 0, n.FrontFaceDirectionCCW = 1, n.BasicShadowMap = 0, n.PCFShadowMap = 1, n.PCFSoftShadowMap = 2, n.FrontSide = 0, n.BackSide = 1, n.DoubleSide = 2, n.NoShading = 0, n.FlatShading = 1, n.SmoothShading = 2, n.NoColors = 0, n.FaceColors = 1, n.VertexColors = 2, n.NoBlending = 0, n.NormalBlending = 1, n.AdditiveBlending = 2, n.SubtractiveBlending = 3, n.MultiplyBlending = 4, n.CustomBlending = 5, n.AddEquation = 100, n.SubtractEquation = 101, n.ReverseSubtractEquation = 102, n.MinEquation = 103, n.MaxEquation = 104, n.ZeroFactor = 200, n.OneFactor = 201, n.SrcColorFactor = 202, n.OneMinusSrcColorFactor = 203, n.SrcAlphaFactor = 204, n.OneMinusSrcAlphaFactor = 205, n.DstAlphaFactor = 206, n.OneMinusDstAlphaFactor = 207, n.DstColorFactor = 208, n.OneMinusDstColorFactor = 209, n.SrcAlphaSaturateFactor = 210, n.MultiplyOperation = 0, n.MixOperation = 1, n.AddOperation = 2, n.UVMapping = 300, n.CubeReflectionMapping = 301, n.CubeRefractionMapping = 302, n.EquirectangularReflectionMapping = 303, n.EquirectangularRefractionMapping = 304, n.SphericalReflectionMapping = 305, n.RepeatWrapping = 1e3, n.ClampToEdgeWrapping = 1001, n.MirroredRepeatWrapping = 1002, n.NearestFilter = 1003, n.NearestMipMapNearestFilter = 1004, n.NearestMipMapLinearFilter = 1005, n.LinearFilter = 1006, n.LinearMipMapNearestFilter = 1007, n.LinearMipMapLinearFilter = 1008, n.UnsignedByteType = 1009, n.ByteType = 1010, n.ShortType = 1011, n.UnsignedShortType = 1012, n.IntType = 1013, n.UnsignedIntType = 1014, n.FloatType = 1015, n.HalfFloatType = 1025, n.UnsignedShort4444Type = 1016, n.UnsignedShort5551Type = 1017, n.UnsignedShort565Type = 1018, n.AlphaFormat = 1019, n.RGBFormat = 1020, n.RGBAFormat = 1021, n.LuminanceFormat = 1022, n.LuminanceAlphaFormat = 1023, n.RGBEFormat = n.RGBAFormat, n.RGB_S3TC_DXT1_Format = 2001, n.RGBA_S3TC_DXT1_Format = 2002, n.RGBA_S3TC_DXT3_Format = 2003, n.RGBA_S3TC_DXT5_Format = 2004, n.RGB_PVRTC_4BPPV1_Format = 2100, n.RGB_PVRTC_2BPPV1_Format = 2101, n.RGBA_PVRTC_4BPPV1_Format = 2102, n.RGBA_PVRTC_2BPPV1_Format = 2103, n.Projector = function () {
            n.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."), this.projectVector = function (e, t) {
                n.warn("THREE.Projector: .projectVector() is now vector.project()."), e.project(t)
            }, this.unprojectVector = function (e, t) {
                n.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."), e.unproject(t)
            }, this.pickingRay = function (e, t) {
                n.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")
            }
        }, n.CanvasRenderer = function () {
            n.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"), this.domElement = document.createElement("canvas"), this.clear = function () {
            }, this.render = function () {
            }, this.setClearColor = function () {
            }, this.setSize = function () {
            }
        }, n.Color = function (e) {
            return 3 === arguments.length ? this.setRGB(arguments[0], arguments[1], arguments[2]) : this.set(e)
        }, n.Color.prototype = {
            constructor: n.Color, r: 1, g: 1, b: 1, set: function (e) {
                return e instanceof n.Color ? this.copy(e) : "number" == typeof e ? this.setHex(e) : "string" == typeof e && this.setStyle(e), this
            }, setHex: function (e) {
                return e = Math.floor(e), this.r = (e >> 16 & 255) / 255, this.g = (e >> 8 & 255) / 255, this.b = (255 & e) / 255, this
            }, setRGB: function (e, t, i) {
                return this.r = e, this.g = t, this.b = i, this
            }, setHSL: function (e, t, i) {
                if (0 === t)this.r = this.g = this.b = i; else {
                    var r = function (e, t, i) {
                        return 0 > i && (i += 1), i > 1 && (i -= 1), 1 / 6 > i ? e + 6 * (t - e) * i : .5 > i ? t : 2 / 3 > i ? e + 6 * (t - e) * (2 / 3 - i) : e
                    }, n = .5 >= i ? i * (1 + t) : i + t - i * t, o = 2 * i - n;
                    this.r = r(o, n, e + 1 / 3), this.g = r(o, n, e), this.b = r(o, n, e - 1 / 3)
                }
                return this
            }, setStyle: function (e) {
                if (/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)) {
                    var t = /^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);
                    return this.r = Math.min(255, parseInt(t[1], 10)) / 255, this.g = Math.min(255, parseInt(t[2], 10)) / 255, this.b = Math.min(255, parseInt(t[3], 10)) / 255, this
                }
                if (/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)) {
                    var t = /^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);
                    return this.r = Math.min(100, parseInt(t[1], 10)) / 100, this.g = Math.min(100, parseInt(t[2], 10)) / 100, this.b = Math.min(100, parseInt(t[3], 10)) / 100, this
                }
                if (/^\#([0-9a-f]{6})$/i.test(e)) {
                    var t = /^\#([0-9a-f]{6})$/i.exec(e);
                    return this.setHex(parseInt(t[1], 16)), this
                }
                if (/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)) {
                    var t = /^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);
                    return this.setHex(parseInt(t[1] + t[1] + t[2] + t[2] + t[3] + t[3], 16)), this
                }
                return /^(\w+)$/i.test(e) ? (this.setHex(n.ColorKeywords[e]), this) : void 0
            }, copy: function (e) {
                return this.r = e.r, this.g = e.g, this.b = e.b, this
            }, copyGammaToLinear: function (e, t) {
                return void 0 === t && (t = 2), this.r = Math.pow(e.r, t), this.g = Math.pow(e.g, t), this.b = Math.pow(e.b, t), this
            }, copyLinearToGamma: function (e, t) {
                void 0 === t && (t = 2);
                var i = t > 0 ? 1 / t : 1;
                return this.r = Math.pow(e.r, i), this.g = Math.pow(e.g, i), this.b = Math.pow(e.b, i), this
            }, convertGammaToLinear: function () {
                var e = this.r, t = this.g, i = this.b;
                return this.r = e * e, this.g = t * t, this.b = i * i, this
            }, convertLinearToGamma: function () {
                return this.r = Math.sqrt(this.r), this.g = Math.sqrt(this.g), this.b = Math.sqrt(this.b), this
            }, getHex: function () {
                return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0
            }, getHexString: function () {
                return ("000000" + this.getHex().toString(16)).slice(-6)
            }, getHSL: function (e) {
                var t, i, r = e || {
                        h: 0,
                        s: 0,
                        l: 0
                    }, n = this.r, o = this.g, a = this.b, s = Math.max(n, o, a), h = Math.min(n, o, a), l = (h + s) / 2;
                if (h === s)t = 0, i = 0; else {
                    var u = s - h;
                    switch (i = .5 >= l ? u / (s + h) : u / (2 - s - h), s) {
                        case n:
                            t = (o - a) / u + (a > o ? 6 : 0);
                            break;
                        case o:
                            t = (a - n) / u + 2;
                            break;
                        case a:
                            t = (n - o) / u + 4
                    }
                    t /= 6
                }
                return r.h = t, r.s = i, r.l = l, r
            }, getStyle: function () {
                return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")"
            }, offsetHSL: function (e, t, i) {
                var r = this.getHSL();
                return r.h += e, r.s += t, r.l += i, this.setHSL(r.h, r.s, r.l), this
            }, add: function (e) {
                return this.r += e.r, this.g += e.g, this.b += e.b, this
            }, addColors: function (e, t) {
                return this.r = e.r + t.r, this.g = e.g + t.g, this.b = e.b + t.b, this
            }, addScalar: function (e) {
                return this.r += e, this.g += e, this.b += e, this
            }, multiply: function (e) {
                return this.r *= e.r, this.g *= e.g, this.b *= e.b, this
            }, multiplyScalar: function (e) {
                return this.r *= e, this.g *= e, this.b *= e, this
            }, lerp: function (e, t) {
                return this.r += (e.r - this.r) * t, this.g += (e.g - this.g) * t, this.b += (e.b - this.b) * t, this
            }, equals: function (e) {
                return e.r === this.r && e.g === this.g && e.b === this.b
            }, fromArray: function (e) {
                return this.r = e[0], this.g = e[1], this.b = e[2], this
            }, toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this.r, e[t + 1] = this.g, e[t + 2] = this.b, e
            }, clone: function () {
                return (new n.Color).setRGB(this.r, this.g, this.b)
            }
        }, n.ColorKeywords = {
            aliceblue: 15792383,
            antiquewhite: 16444375,
            aqua: 65535,
            aquamarine: 8388564,
            azure: 15794175,
            beige: 16119260,
            bisque: 16770244,
            black: 0,
            blanchedalmond: 16772045,
            blue: 255,
            blueviolet: 9055202,
            brown: 10824234,
            burlywood: 14596231,
            cadetblue: 6266528,
            chartreuse: 8388352,
            chocolate: 13789470,
            coral: 16744272,
            cornflowerblue: 6591981,
            cornsilk: 16775388,
            crimson: 14423100,
            cyan: 65535,
            darkblue: 139,
            darkcyan: 35723,
            darkgoldenrod: 12092939,
            darkgray: 11119017,
            darkgreen: 25600,
            darkgrey: 11119017,
            darkkhaki: 12433259,
            darkmagenta: 9109643,
            darkolivegreen: 5597999,
            darkorange: 16747520,
            darkorchid: 10040012,
            darkred: 9109504,
            darksalmon: 15308410,
            darkseagreen: 9419919,
            darkslateblue: 4734347,
            darkslategray: 3100495,
            darkslategrey: 3100495,
            darkturquoise: 52945,
            darkviolet: 9699539,
            deeppink: 16716947,
            deepskyblue: 49151,
            dimgray: 6908265,
            dimgrey: 6908265,
            dodgerblue: 2003199,
            firebrick: 11674146,
            floralwhite: 16775920,
            forestgreen: 2263842,
            fuchsia: 16711935,
            gainsboro: 14474460,
            ghostwhite: 16316671,
            gold: 16766720,
            goldenrod: 14329120,
            gray: 8421504,
            green: 32768,
            greenyellow: 11403055,
            grey: 8421504,
            honeydew: 15794160,
            hotpink: 16738740,
            indianred: 13458524,
            indigo: 4915330,
            ivory: 16777200,
            khaki: 15787660,
            lavender: 15132410,
            lavenderblush: 16773365,
            lawngreen: 8190976,
            lemonchiffon: 16775885,
            lightblue: 11393254,
            lightcoral: 15761536,
            lightcyan: 14745599,
            lightgoldenrodyellow: 16448210,
            lightgray: 13882323,
            lightgreen: 9498256,
            lightgrey: 13882323,
            lightpink: 16758465,
            lightsalmon: 16752762,
            lightseagreen: 2142890,
            lightskyblue: 8900346,
            lightslategray: 7833753,
            lightslategrey: 7833753,
            lightsteelblue: 11584734,
            lightyellow: 16777184,
            lime: 65280,
            limegreen: 3329330,
            linen: 16445670,
            magenta: 16711935,
            maroon: 8388608,
            mediumaquamarine: 6737322,
            mediumblue: 205,
            mediumorchid: 12211667,
            mediumpurple: 9662683,
            mediumseagreen: 3978097,
            mediumslateblue: 8087790,
            mediumspringgreen: 64154,
            mediumturquoise: 4772300,
            mediumvioletred: 13047173,
            midnightblue: 1644912,
            mintcream: 16121850,
            mistyrose: 16770273,
            moccasin: 16770229,
            navajowhite: 16768685,
            navy: 128,
            oldlace: 16643558,
            olive: 8421376,
            olivedrab: 7048739,
            orange: 16753920,
            orangered: 16729344,
            orchid: 14315734,
            palegoldenrod: 15657130,
            palegreen: 10025880,
            paleturquoise: 11529966,
            palevioletred: 14381203,
            papayawhip: 16773077,
            peachpuff: 16767673,
            peru: 13468991,
            pink: 16761035,
            plum: 14524637,
            powderblue: 11591910,
            purple: 8388736,
            red: 16711680,
            rosybrown: 12357519,
            royalblue: 4286945,
            saddlebrown: 9127187,
            salmon: 16416882,
            sandybrown: 16032864,
            seagreen: 3050327,
            seashell: 16774638,
            sienna: 10506797,
            silver: 12632256,
            skyblue: 8900331,
            slateblue: 6970061,
            slategray: 7372944,
            slategrey: 7372944,
            snow: 16775930,
            springgreen: 65407,
            steelblue: 4620980,
            tan: 13808780,
            teal: 32896,
            thistle: 14204888,
            tomato: 16737095,
            turquoise: 4251856,
            violet: 15631086,
            wheat: 16113331,
            white: 16777215,
            whitesmoke: 16119285,
            yellow: 16776960,
            yellowgreen: 10145074
        }, n.Quaternion = function (e, t, i, r) {
            this._x = e || 0, this._y = t || 0, this._z = i || 0, this._w = void 0 !== r ? r : 1
        }, n.Quaternion.prototype = {
            constructor: n.Quaternion, _x: 0, _y: 0, _z: 0, _w: 0, get x() {
                return this._x
            }, set x(e) {
                this._x = e, this.onChangeCallback()
            }, get y() {
                return this._y
            }, set y(e) {
                this._y = e, this.onChangeCallback()
            }, get z() {
                return this._z
            }, set z(e) {
                this._z = e, this.onChangeCallback()
            }, get w() {
                return this._w
            }, set w(e) {
                this._w = e, this.onChangeCallback()
            }, set: function (e, t, i, r) {
                return this._x = e, this._y = t, this._z = i, this._w = r, this.onChangeCallback(), this
            }, copy: function (e) {
                return this._x = e.x, this._y = e.y, this._z = e.z, this._w = e.w, this.onChangeCallback(), this
            }, setFromEuler: function (e, t) {
                if (e instanceof n.Euler == !1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
                var i = Math.cos(e._x / 2), r = Math.cos(e._y / 2), o = Math.cos(e._z / 2), a = Math.sin(e._x / 2), s = Math.sin(e._y / 2), h = Math.sin(e._z / 2);
                return "XYZ" === e.order ? (this._x = a * r * o + i * s * h, this._y = i * s * o - a * r * h, this._z = i * r * h + a * s * o, this._w = i * r * o - a * s * h) : "YXZ" === e.order ? (this._x = a * r * o + i * s * h, this._y = i * s * o - a * r * h, this._z = i * r * h - a * s * o, this._w = i * r * o + a * s * h) : "ZXY" === e.order ? (this._x = a * r * o - i * s * h, this._y = i * s * o + a * r * h, this._z = i * r * h + a * s * o, this._w = i * r * o - a * s * h) : "ZYX" === e.order ? (this._x = a * r * o - i * s * h, this._y = i * s * o + a * r * h, this._z = i * r * h - a * s * o, this._w = i * r * o + a * s * h) : "YZX" === e.order ? (this._x = a * r * o + i * s * h, this._y = i * s * o + a * r * h, this._z = i * r * h - a * s * o, this._w = i * r * o - a * s * h) : "XZY" === e.order && (this._x = a * r * o - i * s * h, this._y = i * s * o - a * r * h, this._z = i * r * h + a * s * o, this._w = i * r * o + a * s * h), t !== !1 && this.onChangeCallback(), this
            }, setFromAxisAngle: function (e, t) {
                var i = t / 2, r = Math.sin(i);
                return this._x = e.x * r, this._y = e.y * r, this._z = e.z * r, this._w = Math.cos(i), this.onChangeCallback(), this
            }, setFromRotationMatrix: function (e) {
                var t, i = e.elements, r = i[0], n = i[4], o = i[8], a = i[1], s = i[5], h = i[9], l = i[2], u = i[6], c = i[10], d = r + s + c;
                return d > 0 ? (t = .5 / Math.sqrt(d + 1), this._w = .25 / t, this._x = (u - h) * t, this._y = (o - l) * t, this._z = (a - n) * t) : r > s && r > c ? (t = 2 * Math.sqrt(1 + r - s - c), this._w = (u - h) / t, this._x = .25 * t, this._y = (n + a) / t, this._z = (o + l) / t) : s > c ? (t = 2 * Math.sqrt(1 + s - r - c), this._w = (o - l) / t, this._x = (n + a) / t, this._y = .25 * t, this._z = (h + u) / t) : (t = 2 * Math.sqrt(1 + c - r - s), this._w = (a - n) / t, this._x = (o + l) / t, this._y = (h + u) / t, this._z = .25 * t), this.onChangeCallback(), this
            }, setFromUnitVectors: function () {
                var e, t, i = 1e-6;
                return function (r, o) {
                    return void 0 === e && (e = new n.Vector3), t = r.dot(o) + 1, i > t ? (t = 0, Math.abs(r.x) > Math.abs(r.z) ? e.set(-r.y, r.x, 0) : e.set(0, -r.z, r.y)) : e.crossVectors(r, o), this._x = e.x, this._y = e.y, this._z = e.z, this._w = t, this.normalize(), this
                }
            }(), inverse: function () {
                return this.conjugate().normalize(), this
            }, conjugate: function () {
                return this._x *= -1, this._y *= -1, this._z *= -1, this.onChangeCallback(), this
            }, dot: function (e) {
                return this._x * e._x + this._y * e._y + this._z * e._z + this._w * e._w
            }, lengthSq: function () {
                return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
            }, length: function () {
                return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
            }, normalize: function () {
                var e = this.length();
                return 0 === e ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (e = 1 / e, this._x = this._x * e, this._y = this._y * e, this._z = this._z * e, this._w = this._w * e), this.onChangeCallback(), this
            }, multiply: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."), this.multiplyQuaternions(e, t)) : this.multiplyQuaternions(this, e)
            }, multiplyQuaternions: function (e, t) {
                var i = e._x, r = e._y, n = e._z, o = e._w, a = t._x, s = t._y, h = t._z, l = t._w;
                return this._x = i * l + o * a + r * h - n * s, this._y = r * l + o * s + n * a - i * h, this._z = n * l + o * h + i * s - r * a, this._w = o * l - i * a - r * s - n * h, this.onChangeCallback(), this
            }, multiplyVector3: function (e) {
                return n.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."), e.applyQuaternion(this)
            }, slerp: function (e, t) {
                if (0 === t)return this;
                if (1 === t)return this.copy(e);
                var i = this._x, r = this._y, n = this._z, o = this._w, a = o * e._w + i * e._x + r * e._y + n * e._z;
                if (0 > a ? (this._w = -e._w, this._x = -e._x, this._y = -e._y, this._z = -e._z, a = -a) : this.copy(e), a >= 1)return this._w = o, this._x = i, this._y = r, this._z = n, this;
                var s = Math.acos(a), h = Math.sqrt(1 - a * a);
                if (Math.abs(h) < .001)return this._w = .5 * (o + this._w), this._x = .5 * (i + this._x), this._y = .5 * (r + this._y), this._z = .5 * (n + this._z), this;
                var l = Math.sin((1 - t) * s) / h, u = Math.sin(t * s) / h;
                return this._w = o * l + this._w * u, this._x = i * l + this._x * u, this._y = r * l + this._y * u, this._z = n * l + this._z * u, this.onChangeCallback(), this
            }, equals: function (e) {
                return e._x === this._x && e._y === this._y && e._z === this._z && e._w === this._w
            }, fromArray: function (e, t) {
                return void 0 === t && (t = 0), this._x = e[t], this._y = e[t + 1], this._z = e[t + 2], this._w = e[t + 3], this.onChangeCallback(), this
            }, toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this._x, e[t + 1] = this._y, e[t + 2] = this._z, e[t + 3] = this._w, e
            }, onChange: function (e) {
                return this.onChangeCallback = e, this
            }, onChangeCallback: function () {
            }, clone: function () {
                return new n.Quaternion(this._x, this._y, this._z, this._w)
            }
        }, n.Quaternion.slerp = function (e, t, i, r) {
            return i.copy(e).slerp(t, r)
        }, n.Vector2 = function (e, t) {
            this.x = e || 0, this.y = t || 0
        }, n.Vector2.prototype = {
            constructor: n.Vector2, set: function (e, t) {
                return this.x = e, this.y = t, this
            }, setX: function (e) {
                return this.x = e, this
            }, setY: function (e) {
                return this.y = e, this
            }, setComponent: function (e, t) {
                switch (e) {
                    case 0:
                        this.x = t;
                        break;
                    case 1:
                        this.y = t;
                        break;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, getComponent: function (e) {
                switch (e) {
                    case 0:
                        return this.x;
                    case 1:
                        return this.y;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, copy: function (e) {
                return this.x = e.x, this.y = e.y, this
            }, add: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this)
            }, addScalar: function (e) {
                return this.x += e, this.y += e, this
            }, addVectors: function (e, t) {
                return this.x = e.x + t.x, this.y = e.y + t.y, this
            }, sub: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this)
            }, subScalar: function (e) {
                return this.x -= e, this.y -= e, this
            }, subVectors: function (e, t) {
                return this.x = e.x - t.x, this.y = e.y - t.y, this
            }, multiply: function (e) {
                return this.x *= e.x, this.y *= e.y, this
            }, multiplyScalar: function (e) {
                return this.x *= e, this.y *= e, this
            }, divide: function (e) {
                return this.x /= e.x, this.y /= e.y, this
            }, divideScalar: function (e) {
                if (0 !== e) {
                    var t = 1 / e;
                    this.x *= t, this.y *= t
                } else this.x = 0, this.y = 0;
                return this
            }, min: function (e) {
                return this.x > e.x && (this.x = e.x), this.y > e.y && (this.y = e.y), this
            }, max: function (e) {
                return this.x < e.x && (this.x = e.x), this.y < e.y && (this.y = e.y), this
            }, clamp: function (e, t) {
                return this.x < e.x ? this.x = e.x : this.x > t.x && (this.x = t.x), this.y < e.y ? this.y = e.y : this.y > t.y && (this.y = t.y), this
            }, clampScalar: function () {
                var e, t;
                return function (i, r) {
                    return void 0 === e && (e = new n.Vector2, t = new n.Vector2), e.set(i, i), t.set(r, r), this.clamp(e, t)
                }
            }(), floor: function () {
                return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
            }, ceil: function () {
                return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this
            }, round: function () {
                return this.x = Math.round(this.x), this.y = Math.round(this.y), this
            }, roundToZero: function () {
                return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this
            }, negate: function () {
                return this.x = -this.x, this.y = -this.y, this
            }, dot: function (e) {
                return this.x * e.x + this.y * e.y
            }, lengthSq: function () {
                return this.x * this.x + this.y * this.y
            }, length: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y)
            }, normalize: function () {
                return this.divideScalar(this.length())
            }, distanceTo: function (e) {
                return Math.sqrt(this.distanceToSquared(e))
            }, distanceToSquared: function (e) {
                var t = this.x - e.x, i = this.y - e.y;
                return t * t + i * i
            }, setLength: function (e) {
                var t = this.length();
                return 0 !== t && e !== t && this.multiplyScalar(e / t), this
            }, lerp: function (e, t) {
                return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this
            }, lerpVectors: function (e, t, i) {
                return this.subVectors(t, e).multiplyScalar(i).add(e), this
            }, equals: function (e) {
                return e.x === this.x && e.y === this.y
            }, fromArray: function (e, t) {
                return void 0 === t && (t = 0), this.x = e[t], this.y = e[t + 1], this
            }, toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, e
            }, fromAttribute: function (e, t, i) {
                return void 0 === i && (i = 0), t = t * e.itemSize + i, this.x = e.array[t], this.y = e.array[t + 1], this
            }, clone: function () {
                return new n.Vector2(this.x, this.y)
            }
        }, n.Vector3 = function (e, t, i) {
            this.x = e || 0, this.y = t || 0, this.z = i || 0
        }, n.Vector3.prototype = {
            constructor: n.Vector3, set: function (e, t, i) {
                return this.x = e, this.y = t, this.z = i, this
            }, setX: function (e) {
                return this.x = e, this
            }, setY: function (e) {
                return this.y = e, this
            }, setZ: function (e) {
                return this.z = e, this
            }, setComponent: function (e, t) {
                switch (e) {
                    case 0:
                        this.x = t;
                        break;
                    case 1:
                        this.y = t;
                        break;
                    case 2:
                        this.z = t;
                        break;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, getComponent: function (e) {
                switch (e) {
                    case 0:
                        return this.x;
                    case 1:
                        return this.y;
                    case 2:
                        return this.z;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, copy: function (e) {
                return this.x = e.x, this.y = e.y, this.z = e.z, this
            }, add: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this.z += e.z, this)
            }, addScalar: function (e) {
                return this.x += e, this.y += e, this.z += e, this
            }, addVectors: function (e, t) {
                return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this
            }, sub: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this.z -= e.z, this)
            }, subScalar: function (e) {
                return this.x -= e, this.y -= e, this.z -= e, this
            }, subVectors: function (e, t) {
                return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this
            }, multiply: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(e, t)) : (this.x *= e.x, this.y *= e.y, this.z *= e.z, this)
            }, multiplyScalar: function (e) {
                return this.x *= e, this.y *= e, this.z *= e, this
            }, multiplyVectors: function (e, t) {
                return this.x = e.x * t.x, this.y = e.y * t.y, this.z = e.z * t.z, this
            }, applyEuler: function () {
                var e;
                return function (t) {
                    return t instanceof n.Euler == !1 && n.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."), void 0 === e && (e = new n.Quaternion), this.applyQuaternion(e.setFromEuler(t)), this
                }
            }(), applyAxisAngle: function () {
                var e;
                return function (t, i) {
                    return void 0 === e && (e = new n.Quaternion), this.applyQuaternion(e.setFromAxisAngle(t, i)), this
                }
            }(), applyMatrix3: function (e) {
                var t = this.x, i = this.y, r = this.z, n = e.elements;
                return this.x = n[0] * t + n[3] * i + n[6] * r, this.y = n[1] * t + n[4] * i + n[7] * r, this.z = n[2] * t + n[5] * i + n[8] * r, this
            }, applyMatrix4: function (e) {
                var t = this.x, i = this.y, r = this.z, n = e.elements;
                return this.x = n[0] * t + n[4] * i + n[8] * r + n[12], this.y = n[1] * t + n[5] * i + n[9] * r + n[13], this.z = n[2] * t + n[6] * i + n[10] * r + n[14], this
            }, applyProjection: function (e) {
                var t = this.x, i = this.y, r = this.z, n = e.elements, o = 1 / (n[3] * t + n[7] * i + n[11] * r + n[15]);
                return this.x = (n[0] * t + n[4] * i + n[8] * r + n[12]) * o, this.y = (n[1] * t + n[5] * i + n[9] * r + n[13]) * o, this.z = (n[2] * t + n[6] * i + n[10] * r + n[14]) * o, this
            }, applyQuaternion: function (e) {
                var t = this.x, i = this.y, r = this.z, n = e.x, o = e.y, a = e.z, s = e.w, h = s * t + o * r - a * i, l = s * i + a * t - n * r, u = s * r + n * i - o * t, c = -n * t - o * i - a * r;
                return this.x = h * s + c * -n + l * -a - u * -o, this.y = l * s + c * -o + u * -n - h * -a, this.z = u * s + c * -a + h * -o - l * -n, this
            }, project: function () {
                var e;
                return function (t) {
                    return void 0 === e && (e = new n.Matrix4), e.multiplyMatrices(t.projectionMatrix, e.getInverse(t.matrixWorld)), this.applyProjection(e)
                }
            }(), unproject: function () {
                var e;
                return function (t) {
                    return void 0 === e && (e = new n.Matrix4), e.multiplyMatrices(t.matrixWorld, e.getInverse(t.projectionMatrix)), this.applyProjection(e)
                }
            }(), transformDirection: function (e) {
                var t = this.x, i = this.y, r = this.z, n = e.elements;
                return this.x = n[0] * t + n[4] * i + n[8] * r, this.y = n[1] * t + n[5] * i + n[9] * r, this.z = n[2] * t + n[6] * i + n[10] * r, this.normalize(), this
            }, divide: function (e) {
                return this.x /= e.x, this.y /= e.y, this.z /= e.z, this
            }, divideScalar: function (e) {
                if (0 !== e) {
                    var t = 1 / e;
                    this.x *= t, this.y *= t, this.z *= t
                } else this.x = 0, this.y = 0, this.z = 0;
                return this
            }, min: function (e) {
                return this.x > e.x && (this.x = e.x), this.y > e.y && (this.y = e.y), this.z > e.z && (this.z = e.z), this
            }, max: function (e) {
                return this.x < e.x && (this.x = e.x), this.y < e.y && (this.y = e.y), this.z < e.z && (this.z = e.z), this
            }, clamp: function (e, t) {
                return this.x < e.x ? this.x = e.x : this.x > t.x && (this.x = t.x), this.y < e.y ? this.y = e.y : this.y > t.y && (this.y = t.y), this.z < e.z ? this.z = e.z : this.z > t.z && (this.z = t.z), this
            }, clampScalar: function () {
                var e, t;
                return function (i, r) {
                    return void 0 === e && (e = new n.Vector3, t = new n.Vector3), e.set(i, i, i), t.set(r, r, r), this.clamp(e, t)
                }
            }(), floor: function () {
                return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this
            }, ceil: function () {
                return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this
            }, round: function () {
                return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this
            }, roundToZero: function () {
                return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this
            }, negate: function () {
                return this.x = -this.x, this.y = -this.y, this.z = -this.z, this
            }, dot: function (e) {
                return this.x * e.x + this.y * e.y + this.z * e.z
            }, lengthSq: function () {
                return this.x * this.x + this.y * this.y + this.z * this.z
            }, length: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
            }, lengthManhattan: function () {
                return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
            }, normalize: function () {
                return this.divideScalar(this.length())
            }, setLength: function (e) {
                var t = this.length();
                return 0 !== t && e !== t && this.multiplyScalar(e / t), this
            }, lerp: function (e, t) {
                return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this
            }, lerpVectors: function (e, t, i) {
                return this.subVectors(t, e).multiplyScalar(i).add(e), this
            }, cross: function (e, t) {
                if (void 0 !== t)return n.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(e, t);
                var i = this.x, r = this.y, o = this.z;
                return this.x = r * e.z - o * e.y, this.y = o * e.x - i * e.z, this.z = i * e.y - r * e.x, this
            }, crossVectors: function (e, t) {
                var i = e.x, r = e.y, n = e.z, o = t.x, a = t.y, s = t.z;
                return this.x = r * s - n * a, this.y = n * o - i * s, this.z = i * a - r * o, this
            }, projectOnVector: function () {
                var e, t;
                return function (i) {
                    return void 0 === e && (e = new n.Vector3), e.copy(i).normalize(), t = this.dot(e), this.copy(e).multiplyScalar(t)
                }
            }(), projectOnPlane: function () {
                var e;
                return function (t) {
                    return void 0 === e && (e = new n.Vector3), e.copy(this).projectOnVector(t), this.sub(e)
                }
            }(), reflect: function () {
                var e;
                return function (t) {
                    return void 0 === e && (e = new n.Vector3), this.sub(e.copy(t).multiplyScalar(2 * this.dot(t)))
                }
            }(), angleTo: function (e) {
                var t = this.dot(e) / (this.length() * e.length());
                return Math.acos(n.Math.clamp(t, -1, 1))
            }, distanceTo: function (e) {
                return Math.sqrt(this.distanceToSquared(e))
            }, distanceToSquared: function (e) {
                var t = this.x - e.x, i = this.y - e.y, r = this.z - e.z;
                return t * t + i * i + r * r
            }, setEulerFromRotationMatrix: function (e, t) {
                n.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")
            }, setEulerFromQuaternion: function (e, t) {
                n.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")
            }, getPositionFromMatrix: function (e) {
                return n.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."), this.setFromMatrixPosition(e)
            }, getScaleFromMatrix: function (e) {
                return n.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."), this.setFromMatrixScale(e)
            }, getColumnFromMatrix: function (e, t) {
                return n.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."), this.setFromMatrixColumn(e, t)
            }, setFromMatrixPosition: function (e) {
                return this.x = e.elements[12], this.y = e.elements[13], this.z = e.elements[14], this
            }, setFromMatrixScale: function (e) {
                var t = this.set(e.elements[0], e.elements[1], e.elements[2]).length(), i = this.set(e.elements[4], e.elements[5], e.elements[6]).length(), r = this.set(e.elements[8], e.elements[9], e.elements[10]).length();
                return this.x = t, this.y = i, this.z = r, this
            }, setFromMatrixColumn: function (e, t) {
                var i = 4 * e, r = t.elements;
                return this.x = r[i], this.y = r[i + 1], this.z = r[i + 2], this
            }, equals: function (e) {
                return e.x === this.x && e.y === this.y && e.z === this.z
            }, fromArray: function (e, t) {
                return void 0 === t && (t = 0), this.x = e[t], this.y = e[t + 1], this.z = e[t + 2], this
            }, toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, e
            }, fromAttribute: function (e, t, i) {
                return void 0 === i && (i = 0), t = t * e.itemSize + i, this.x = e.array[t], this.y = e.array[t + 1], this.z = e.array[t + 2], this
            }, clone: function () {
                return new n.Vector3(this.x, this.y, this.z)
            }
        },n.Vector4 = function (e, t, i, r) {
            this.x = e || 0, this.y = t || 0, this.z = i || 0, this.w = void 0 !== r ? r : 1
        },n.Vector4.prototype = {
            constructor: n.Vector4, set: function (e, t, i, r) {
                return this.x = e, this.y = t, this.z = i, this.w = r, this
            }, setX: function (e) {
                return this.x = e, this
            }, setY: function (e) {
                return this.y = e, this
            }, setZ: function (e) {
                return this.z = e, this
            }, setW: function (e) {
                return this.w = e, this
            }, setComponent: function (e, t) {
                switch (e) {
                    case 0:
                        this.x = t;
                        break;
                    case 1:
                        this.y = t;
                        break;
                    case 2:
                        this.z = t;
                        break;
                    case 3:
                        this.w = t;
                        break;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, getComponent: function (e) {
                switch (e) {
                    case 0:
                        return this.x;
                    case 1:
                        return this.y;
                    case 2:
                        return this.z;
                    case 3:
                        return this.w;
                    default:
                        throw new Error("index is out of range: " + e)
                }
            }, copy: function (e) {
                return this.x = e.x, this.y = e.y, this.z = e.z, this.w = void 0 !== e.w ? e.w : 1, this
            }, add: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this.z += e.z, this.w += e.w, this)
            }, addScalar: function (e) {
                return this.x += e, this.y += e, this.z += e, this.w += e, this
            }, addVectors: function (e, t) {
                return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this.w = e.w + t.w, this
            }, sub: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this.z -= e.z, this.w -= e.w, this)
            }, subScalar: function (e) {
                return this.x -= e, this.y -= e, this.z -= e, this.w -= e, this
            }, subVectors: function (e, t) {
                return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this.w = e.w - t.w, this
            }, multiplyScalar: function (e) {
                return this.x *= e, this.y *= e, this.z *= e, this.w *= e, this
            }, applyMatrix4: function (e) {
                var t = this.x, i = this.y, r = this.z, n = this.w, o = e.elements;
                return this.x = o[0] * t + o[4] * i + o[8] * r + o[12] * n, this.y = o[1] * t + o[5] * i + o[9] * r + o[13] * n, this.z = o[2] * t + o[6] * i + o[10] * r + o[14] * n, this.w = o[3] * t + o[7] * i + o[11] * r + o[15] * n, this
            }, divideScalar: function (e) {
                if (0 !== e) {
                    var t = 1 / e;
                    this.x *= t, this.y *= t, this.z *= t, this.w *= t
                } else this.x = 0, this.y = 0, this.z = 0, this.w = 1;
                return this
            }, setAxisAngleFromQuaternion: function (e) {
                this.w = 2 * Math.acos(e.w);
                var t = Math.sqrt(1 - e.w * e.w);
                return 1e-4 > t ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = e.x / t, this.y = e.y / t, this.z = e.z / t), this
            }, setAxisAngleFromRotationMatrix: function (e) {
                var t, i, r, n, o = .01, a = .1, s = e.elements, h = s[0], l = s[4], u = s[8], c = s[1], d = s[5], f = s[9], p = s[2], m = s[6], g = s[10];
                if (Math.abs(l - c) < o && Math.abs(u - p) < o && Math.abs(f - m) < o) {
                    if (Math.abs(l + c) < a && Math.abs(u + p) < a && Math.abs(f + m) < a && Math.abs(h + d + g - 3) < a)return this.set(1, 0, 0, 0), this;
                    t = Math.PI;
                    var v = (h + 1) / 2, y = (d + 1) / 2, b = (g + 1) / 2, w = (l + c) / 4, _ = (u + p) / 4, x = (f + m) / 4;
                    return v > y && v > b ? o > v ? (i = 0, r = .707106781, n = .707106781) : (i = Math.sqrt(v), r = w / i, n = _ / i) : y > b ? o > y ? (i = .707106781, r = 0, n = .707106781) : (r = Math.sqrt(y), i = w / r, n = x / r) : o > b ? (i = .707106781, r = .707106781, n = 0) : (n = Math.sqrt(b), i = _ / n, r = x / n), this.set(i, r, n, t), this
                }
                var S = Math.sqrt((m - f) * (m - f) + (u - p) * (u - p) + (c - l) * (c - l));
                return Math.abs(S) < .001 && (S = 1), this.x = (m - f) / S, this.y = (u - p) / S, this.z = (c - l) / S, this.w = Math.acos((h + d + g - 1) / 2), this
            }, min: function (e) {
                return this.x > e.x && (this.x = e.x), this.y > e.y && (this.y = e.y), this.z > e.z && (this.z = e.z), this.w > e.w && (this.w = e.w), this
            }, max: function (e) {
                return this.x < e.x && (this.x = e.x), this.y < e.y && (this.y = e.y), this.z < e.z && (this.z = e.z), this.w < e.w && (this.w = e.w), this
            }, clamp: function (e, t) {
                return this.x < e.x ? this.x = e.x : this.x > t.x && (this.x = t.x), this.y < e.y ? this.y = e.y : this.y > t.y && (this.y = t.y), this.z < e.z ? this.z = e.z : this.z > t.z && (this.z = t.z), this.w < e.w ? this.w = e.w : this.w > t.w && (this.w = t.w), this
            }, clampScalar: function () {
                var e, t;
                return function (i, r) {
                    return void 0 === e && (e = new n.Vector4, t = new n.Vector4), e.set(i, i, i, i), t.set(r, r, r, r), this.clamp(e, t)
                }
            }(), floor: function () {
                return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this
            }, ceil: function () {
                return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this
            }, round: function () {
                return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this
            }, roundToZero: function () {
                return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this
            }, negate: function () {
                return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this
            }, dot: function (e) {
                return this.x * e.x + this.y * e.y + this.z * e.z + this.w * e.w
            }, lengthSq: function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
            }, length: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
            }, lengthManhattan: function () {
                return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
            }, normalize: function () {
                return this.divideScalar(this.length())
            }, setLength: function (e) {
                var t = this.length();
                return 0 !== t && e !== t && this.multiplyScalar(e / t), this
            }, lerp: function (e, t) {
                return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this.w += (e.w - this.w) * t, this
            }, lerpVectors: function (e, t, i) {
                return this.subVectors(t, e).multiplyScalar(i).add(e), this
            }, equals: function (e) {
                return e.x === this.x && e.y === this.y && e.z === this.z && e.w === this.w
            }, fromArray: function (e, t) {
                return void 0 === t && (t = 0), this.x = e[t], this.y = e[t + 1], this.z = e[t + 2], this.w = e[t + 3], this
            }, toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, e[t + 3] = this.w, e
            }, fromAttribute: function (e, t, i) {
                return void 0 === i && (i = 0), t = t * e.itemSize + i, this.x = e.array[t], this.y = e.array[t + 1], this.z = e.array[t + 2], this.w = e.array[t + 3], this
            }, clone: function () {
                return new n.Vector4(this.x, this.y, this.z, this.w)
            }
        },n.Euler = function (e, t, i, r) {
            this._x = e || 0, this._y = t || 0, this._z = i || 0, this._order = r || n.Euler.DefaultOrder
        },n.Euler.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"],n.Euler.DefaultOrder = "XYZ",n.Euler.prototype = {
            constructor: n.Euler,
            _x: 0,
            _y: 0,
            _z: 0,
            _order: n.Euler.DefaultOrder,
            get x() {
                return this._x
            },
            set x(e) {
                this._x = e, this.onChangeCallback()
            },
            get y() {
                return this._y
            },
            set y(e) {
                this._y = e, this.onChangeCallback()
            },
            get z() {
                return this._z
            },
            set z(e) {
                this._z = e, this.onChangeCallback()
            },
            get order() {
                return this._order
            },
            set order(e) {
                this._order = e, this.onChangeCallback()
            },
            set: function (e, t, i, r) {
                return this._x = e, this._y = t, this._z = i, this._order = r || this._order, this.onChangeCallback(), this
            },
            copy: function (e) {
                return this._x = e._x, this._y = e._y, this._z = e._z, this._order = e._order, this.onChangeCallback(), this
            },
            setFromRotationMatrix: function (e, t, i) {
                var r = n.Math.clamp, o = e.elements, a = o[0], s = o[4], h = o[8], l = o[1], u = o[5], c = o[9], d = o[2], f = o[6], p = o[10];
                return t = t || this._order, "XYZ" === t ? (this._y = Math.asin(r(h, -1, 1)), Math.abs(h) < .99999 ? (this._x = Math.atan2(-c, p), this._z = Math.atan2(-s, a)) : (this._x = Math.atan2(f, u), this._z = 0)) : "YXZ" === t ? (this._x = Math.asin(-r(c, -1, 1)), Math.abs(c) < .99999 ? (this._y = Math.atan2(h, p), this._z = Math.atan2(l, u)) : (this._y = Math.atan2(-d, a), this._z = 0)) : "ZXY" === t ? (this._x = Math.asin(r(f, -1, 1)), Math.abs(f) < .99999 ? (this._y = Math.atan2(-d, p), this._z = Math.atan2(-s, u)) : (this._y = 0, this._z = Math.atan2(l, a))) : "ZYX" === t ? (this._y = Math.asin(-r(d, -1, 1)), Math.abs(d) < .99999 ? (this._x = Math.atan2(f, p), this._z = Math.atan2(l, a)) : (this._x = 0, this._z = Math.atan2(-s, u))) : "YZX" === t ? (this._z = Math.asin(r(l, -1, 1)), Math.abs(l) < .99999 ? (this._x = Math.atan2(-c, u), this._y = Math.atan2(-d, a)) : (this._x = 0, this._y = Math.atan2(h, p))) : "XZY" === t ? (this._z = Math.asin(-r(s, -1, 1)), Math.abs(s) < .99999 ? (this._x = Math.atan2(f, u), this._y = Math.atan2(h, a)) : (this._x = Math.atan2(-c, p), this._y = 0)) : n.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: " + t), this._order = t, i !== !1 && this.onChangeCallback(), this
            },
            setFromQuaternion: function () {
                var e;
                return function (t, i, r) {
                    return void 0 === e && (e = new n.Matrix4), e.makeRotationFromQuaternion(t), this.setFromRotationMatrix(e, i, r), this
                }
            }(),
            setFromVector3: function (e, t) {
                return this.set(e.x, e.y, e.z, t || this._order)
            },
            reorder: function () {
                var e = new n.Quaternion;
                return function (t) {
                    e.setFromEuler(this), this.setFromQuaternion(e, t)
                }
            }(),
            equals: function (e) {
                return e._x === this._x && e._y === this._y && e._z === this._z && e._order === this._order
            },
            fromArray: function (e) {
                return this._x = e[0], this._y = e[1], this._z = e[2], void 0 !== e[3] && (this._order = e[3]), this.onChangeCallback(), this
            },
            toArray: function (e, t) {
                return void 0 === e && (e = []), void 0 === t && (t = 0), e[t] = this._x, e[t + 1] = this._y, e[t + 2] = this._z, e[t + 3] = this._order, e
            },
            toVector3: function (e) {
                return e ? e.set(this._x, this._y, this._z) : new n.Vector3(this._x, this._y, this._z)
            },
            onChange: function (e) {
                return this.onChangeCallback = e, this
            },
            onChangeCallback: function () {
            },
            clone: function () {
                return new n.Euler(this._x, this._y, this._z, this._order)
            }
        },n.Line3 = function (e, t) {
            this.start = void 0 !== e ? e : new n.Vector3, this.end = void 0 !== t ? t : new n.Vector3
        },n.Line3.prototype = {
            constructor: n.Line3, set: function (e, t) {
                return this.start.copy(e), this.end.copy(t), this
            }, copy: function (e) {
                return this.start.copy(e.start), this.end.copy(e.end), this
            }, center: function (e) {
                var t = e || new n.Vector3;
                return t.addVectors(this.start, this.end).multiplyScalar(.5)
            }, delta: function (e) {
                var t = e || new n.Vector3;
                return t.subVectors(this.end, this.start)
            }, distanceSq: function () {
                return this.start.distanceToSquared(this.end)
            }, distance: function () {
                return this.start.distanceTo(this.end)
            }, at: function (e, t) {
                var i = t || new n.Vector3;
                return this.delta(i).multiplyScalar(e).add(this.start)
            }, closestPointToPointParameter: function () {
                var e = new n.Vector3, t = new n.Vector3;
                return function (i, r) {
                    e.subVectors(i, this.start), t.subVectors(this.end, this.start);
                    var o = t.dot(t), a = t.dot(e), s = a / o;
                    return r && (s = n.Math.clamp(s, 0, 1)), s
                }
            }(), closestPointToPoint: function (e, t, i) {
                var r = this.closestPointToPointParameter(e, t), o = i || new n.Vector3;
                return this.delta(o).multiplyScalar(r).add(this.start)
            }, applyMatrix4: function (e) {
                return this.start.applyMatrix4(e), this.end.applyMatrix4(e), this
            }, equals: function (e) {
                return e.start.equals(this.start) && e.end.equals(this.end)
            }, clone: function () {
                return (new n.Line3).copy(this)
            }
        },n.Box2 = function (e, t) {
            this.min = void 0 !== e ? e : new n.Vector2(1 / 0, 1 / 0), this.max = void 0 !== t ? t : new n.Vector2(-(1 / 0), -(1 / 0))
        },n.Box2.prototype = {
            constructor: n.Box2, set: function (e, t) {
                return this.min.copy(e), this.max.copy(t), this
            }, setFromPoints: function (e) {
                this.makeEmpty();
                for (var t = 0, i = e.length; i > t; t++)this.expandByPoint(e[t]);
                return this
            }, setFromCenterAndSize: function () {
                var e = new n.Vector2;
                return function (t, i) {
                    var r = e.copy(i).multiplyScalar(.5);
                    return this.min.copy(t).sub(r), this.max.copy(t).add(r), this
                }
            }(), copy: function (e) {
                return this.min.copy(e.min), this.max.copy(e.max), this
            }, makeEmpty: function () {
                return this.min.x = this.min.y = 1 / 0, this.max.x = this.max.y = -(1 / 0), this
            }, empty: function () {
                return this.max.x < this.min.x || this.max.y < this.min.y
            }, center: function (e) {
                var t = e || new n.Vector2;
                return t.addVectors(this.min, this.max).multiplyScalar(.5)
            }, size: function (e) {
                var t = e || new n.Vector2;
                return t.subVectors(this.max, this.min)
            }, expandByPoint: function (e) {
                return this.min.min(e), this.max.max(e), this
            }, expandByVector: function (e) {
                return this.min.sub(e), this.max.add(e), this
            }, expandByScalar: function (e) {
                return this.min.addScalar(-e), this.max.addScalar(e), this
            }, containsPoint: function (e) {
                return e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y ? !1 : !0
            }, containsBox: function (e) {
                return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y ? !0 : !1
            }, getParameter: function (e, t) {
                var i = t || new n.Vector2;
                return i.set((e.x - this.min.x) / (this.max.x - this.min.x), (e.y - this.min.y) / (this.max.y - this.min.y))
            }, isIntersectionBox: function (e) {
                return e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y ? !1 : !0
            }, clampPoint: function (e, t) {
                var i = t || new n.Vector2;
                return i.copy(e).clamp(this.min, this.max)
            }, distanceToPoint: function () {
                var e = new n.Vector2;
                return function (t) {
                    var i = e.copy(t).clamp(this.min, this.max);
                    return i.sub(t).length()
                }
            }(), intersect: function (e) {
                return this.min.max(e.min), this.max.min(e.max), this
            }, union: function (e) {
                return this.min.min(e.min), this.max.max(e.max), this
            }, translate: function (e) {
                return this.min.add(e), this.max.add(e), this
            }, equals: function (e) {
                return e.min.equals(this.min) && e.max.equals(this.max)
            }, clone: function () {
                return (new n.Box2).copy(this)
            }
        },n.Box3 = function (e, t) {
            this.min = void 0 !== e ? e : new n.Vector3(1 / 0, 1 / 0, 1 / 0), this.max = void 0 !== t ? t : new n.Vector3(-(1 / 0), -(1 / 0), -(1 / 0))
        },n.Box3.prototype = {
            constructor: n.Box3, set: function (e, t) {
                return this.min.copy(e), this.max.copy(t), this
            }, setFromPoints: function (e) {
                this.makeEmpty();
                for (var t = 0, i = e.length; i > t; t++)this.expandByPoint(e[t]);
                return this
            }, setFromCenterAndSize: function () {
                var e = new n.Vector3;
                return function (t, i) {
                    var r = e.copy(i).multiplyScalar(.5);
                    return this.min.copy(t).sub(r), this.max.copy(t).add(r), this
                }
            }(), setFromObject: function () {
                var e = new n.Vector3;
                return function (t) {
                    var i = this;
                    return t.updateMatrixWorld(!0), this.makeEmpty(), t.traverse(function (t) {
                        var r = t.geometry;
                        if (void 0 !== r)if (r instanceof n.Geometry)for (var o = r.vertices, a = 0, s = o.length; s > a; a++)e.copy(o[a]), e.applyMatrix4(t.matrixWorld), i.expandByPoint(e); else if (r instanceof n.BufferGeometry && void 0 !== r.attributes.position)for (var h = r.attributes.position.array, a = 0, s = h.length; s > a; a += 3)e.set(h[a], h[a + 1], h[a + 2]), e.applyMatrix4(t.matrixWorld), i.expandByPoint(e)
                    }), this
                }
            }(), copy: function (e) {
                return this.min.copy(e.min), this.max.copy(e.max), this
            }, makeEmpty: function () {
                return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -(1 / 0), this
            }, empty: function () {
                return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
            }, center: function (e) {
                var t = e || new n.Vector3;
                return t.addVectors(this.min, this.max).multiplyScalar(.5)
            }, size: function (e) {
                var t = e || new n.Vector3;
                return t.subVectors(this.max, this.min)
            }, expandByPoint: function (e) {
                return this.min.min(e), this.max.max(e), this
            }, expandByVector: function (e) {
                return this.min.sub(e), this.max.add(e), this
            }, expandByScalar: function (e) {
                return this.min.addScalar(-e), this.max.addScalar(e), this
            }, containsPoint: function (e) {
                return e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y || e.z < this.min.z || e.z > this.max.z ? !1 : !0
            }, containsBox: function (e) {
                return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y && this.min.z <= e.min.z && e.max.z <= this.max.z ? !0 : !1
            }, getParameter: function (e, t) {
                var i = t || new n.Vector3;
                return i.set((e.x - this.min.x) / (this.max.x - this.min.x), (e.y - this.min.y) / (this.max.y - this.min.y), (e.z - this.min.z) / (this.max.z - this.min.z))
            }, isIntersectionBox: function (e) {
                return e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y || e.max.z < this.min.z || e.min.z > this.max.z ? !1 : !0
            }, clampPoint: function (e, t) {
                var i = t || new n.Vector3;
                return i.copy(e).clamp(this.min, this.max)
            }, distanceToPoint: function () {
                var e = new n.Vector3;
                return function (t) {
                    var i = e.copy(t).clamp(this.min, this.max);
                    return i.sub(t).length()
                }
            }(), getBoundingSphere: function () {
                var e = new n.Vector3;
                return function (t) {
                    var i = t || new n.Sphere;
                    return i.center = this.center(), i.radius = .5 * this.size(e).length(), i
                }
            }(), intersect: function (e) {
                return this.min.max(e.min), this.max.min(e.max), this
            }, union: function (e) {
                return this.min.min(e.min), this.max.max(e.max), this
            }, applyMatrix4: function () {
                var e = [new n.Vector3, new n.Vector3, new n.Vector3, new n.Vector3, new n.Vector3, new n.Vector3, new n.Vector3, new n.Vector3];
                return function (t) {
                    return e[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(t), e[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(t), e[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(t), e[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(t), e[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(t), e[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(t), e[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(t), e[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(t), this.makeEmpty(), this.setFromPoints(e), this
                }
            }(), translate: function (e) {
                return this.min.add(e), this.max.add(e), this
            }, equals: function (e) {
                return e.min.equals(this.min) && e.max.equals(this.max)
            }, clone: function () {
                return (new n.Box3).copy(this)
            }
        },n.Matrix3 = function () {
            this.elements = new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]), arguments.length > 0 && n.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")
        },n.Matrix3.prototype = {
            constructor: n.Matrix3, set: function (e, t, i, r, n, o, a, s, h) {
                var l = this.elements;
                return l[0] = e, l[3] = t, l[6] = i, l[1] = r, l[4] = n, l[7] = o, l[2] = a, l[5] = s, l[8] = h, this
            }, identity: function () {
                return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this
            }, copy: function (e) {
                var t = e.elements;
                return this.set(t[0], t[3], t[6], t[1], t[4], t[7], t[2], t[5], t[8]), this
            }, multiplyVector3: function (e) {
                return n.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."), e.applyMatrix3(this)
            }, multiplyVector3Array: function (e) {
                return n.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."), this.applyToVector3Array(e)
            }, applyToVector3Array: function () {
                var e = new n.Vector3;
                return function (t, i, r) {
                    void 0 === i && (i = 0), void 0 === r && (r = t.length);
                    for (var n = 0, o = i; r > n; n += 3, o += 3)e.x = t[o], e.y = t[o + 1], e.z = t[o + 2], e.applyMatrix3(this), t[o] = e.x, t[o + 1] = e.y, t[o + 2] = e.z;
                    return t
                }
            }(), multiplyScalar: function (e) {
                var t = this.elements;
                return t[0] *= e, t[3] *= e, t[6] *= e, t[1] *= e, t[4] *= e, t[7] *= e, t[2] *= e, t[5] *= e, t[8] *= e, this
            }, determinant: function () {
                var e = this.elements, t = e[0], i = e[1], r = e[2], n = e[3], o = e[4], a = e[5], s = e[6], h = e[7], l = e[8];
                return t * o * l - t * a * h - i * n * l + i * a * s + r * n * h - r * o * s
            }, getInverse: function (e, t) {
                var i = e.elements, r = this.elements;
                r[0] = i[10] * i[5] - i[6] * i[9], r[1] = -i[10] * i[1] + i[2] * i[9], r[2] = i[6] * i[1] - i[2] * i[5], r[3] = -i[10] * i[4] + i[6] * i[8], r[4] = i[10] * i[0] - i[2] * i[8], r[5] = -i[6] * i[0] + i[2] * i[4], r[6] = i[9] * i[4] - i[5] * i[8], r[7] = -i[9] * i[0] + i[1] * i[8], r[8] = i[5] * i[0] - i[1] * i[4];
                var o = i[0] * r[0] + i[1] * r[3] + i[2] * r[6];
                if (0 === o) {
                    var a = "Matrix3.getInverse(): can't invert matrix, determinant is 0";
                    if (t)throw new Error(a);
                    return n.warn(a), this.identity(), this
                }
                return this.multiplyScalar(1 / o), this
            }, transpose: function () {
                var e, t = this.elements;
                return e = t[1], t[1] = t[3], t[3] = e, e = t[2], t[2] = t[6], t[6] = e, e = t[5], t[5] = t[7], t[7] = e, this
            }, flattenToArrayOffset: function (e, t) {
                var i = this.elements;
                return e[t] = i[0], e[t + 1] = i[1], e[t + 2] = i[2], e[t + 3] = i[3], e[t + 4] = i[4], e[t + 5] = i[5], e[t + 6] = i[6], e[t + 7] = i[7], e[t + 8] = i[8], e
            }, getNormalMatrix: function (e) {
                return this.getInverse(e).transpose(), this
            }, transposeIntoArray: function (e) {
                var t = this.elements;
                return e[0] = t[0], e[1] = t[3], e[2] = t[6], e[3] = t[1], e[4] = t[4], e[5] = t[7], e[6] = t[2], e[7] = t[5], e[8] = t[8], this
            }, fromArray: function (e) {
                return this.elements.set(e), this
            }, toArray: function () {
                var e = this.elements;
                return [e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8]]
            }, clone: function () {
                return (new n.Matrix3).fromArray(this.elements)
            }
        },n.Matrix4 = function () {
            this.elements = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]), arguments.length > 0 && n.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")
        },n.Matrix4.prototype = {
            constructor: n.Matrix4,
            set: function (e, t, i, r, n, o, a, s, h, l, u, c, d, f, p, m) {
                var g = this.elements;
                return g[0] = e, g[4] = t, g[8] = i, g[12] = r, g[1] = n, g[5] = o, g[9] = a, g[13] = s, g[2] = h, g[6] = l, g[10] = u, g[14] = c, g[3] = d, g[7] = f, g[11] = p, g[15] = m, this
            },
            identity: function () {
                return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            },
            copy: function (e) {
                return this.elements.set(e.elements), this
            },
            extractPosition: function (e) {
                return n.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."), this.copyPosition(e)
            },
            copyPosition: function (e) {
                var t = this.elements, i = e.elements;
                return t[12] = i[12], t[13] = i[13], t[14] = i[14], this
            },
            extractBasis: function (e, t, i) {
                var r = this.elements;
                return e.set(r[0], r[1], r[2]), t.set(r[4], r[5], r[6]), i.set(r[8], r[9], r[10]), this
            },
            makeBasis: function (e, t, i) {
                return this.set(e.x, t.x, i.x, 0, e.y, t.y, i.y, 0, e.z, t.z, i.z, 0, 0, 0, 0, 1), this
            },
            extractRotation: function () {
                var e = new n.Vector3;
                return function (t) {
                    var i = this.elements, r = t.elements, n = 1 / e.set(r[0], r[1], r[2]).length(), o = 1 / e.set(r[4], r[5], r[6]).length(), a = 1 / e.set(r[8], r[9], r[10]).length();
                    return i[0] = r[0] * n, i[1] = r[1] * n, i[2] = r[2] * n, i[4] = r[4] * o, i[5] = r[5] * o, i[6] = r[6] * o, i[8] = r[8] * a, i[9] = r[9] * a, i[10] = r[10] * a, this
                }
            }(),
            makeRotationFromEuler: function (e) {
                e instanceof n.Euler == !1 && n.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
                var t = this.elements, i = e.x, r = e.y, o = e.z, a = Math.cos(i), s = Math.sin(i), h = Math.cos(r), l = Math.sin(r), u = Math.cos(o), c = Math.sin(o);
                if ("XYZ" === e.order) {
                    var d = a * u, f = a * c, p = s * u, m = s * c;
                    t[0] = h * u, t[4] = -h * c, t[8] = l, t[1] = f + p * l, t[5] = d - m * l, t[9] = -s * h, t[2] = m - d * l, t[6] = p + f * l, t[10] = a * h
                } else if ("YXZ" === e.order) {
                    var g = h * u, v = h * c, y = l * u, b = l * c;
                    t[0] = g + b * s, t[4] = y * s - v, t[8] = a * l, t[1] = a * c, t[5] = a * u, t[9] = -s, t[2] = v * s - y, t[6] = b + g * s, t[10] = a * h
                } else if ("ZXY" === e.order) {
                    var g = h * u, v = h * c, y = l * u, b = l * c;
                    t[0] = g - b * s, t[4] = -a * c, t[8] = y + v * s, t[1] = v + y * s, t[5] = a * u, t[9] = b - g * s, t[2] = -a * l, t[6] = s, t[10] = a * h
                } else if ("ZYX" === e.order) {
                    var d = a * u, f = a * c, p = s * u, m = s * c;
                    t[0] = h * u, t[4] = p * l - f, t[8] = d * l + m, t[1] = h * c, t[5] = m * l + d, t[9] = f * l - p, t[2] = -l, t[6] = s * h, t[10] = a * h
                } else if ("YZX" === e.order) {
                    var w = a * h, _ = a * l, x = s * h, S = s * l;
                    t[0] = h * u, t[4] = S - w * c, t[8] = x * c + _, t[1] = c, t[5] = a * u, t[9] = -s * u, t[2] = -l * u, t[6] = _ * c + x, t[10] = w - S * c
                } else if ("XZY" === e.order) {
                    var w = a * h, _ = a * l, x = s * h, S = s * l;
                    t[0] = h * u, t[4] = -c, t[8] = l * u, t[1] = w * c + S, t[5] = a * u, t[9] = _ * c - x, t[2] = x * c - _, t[6] = s * u, t[10] = S * c + w
                }
                return t[3] = 0, t[7] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, this
            },
            setRotationFromQuaternion: function (e) {
                return n.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."), this.makeRotationFromQuaternion(e)
            },
            makeRotationFromQuaternion: function (e) {
                var t = this.elements, i = e.x, r = e.y, n = e.z, o = e.w, a = i + i, s = r + r, h = n + n, l = i * a, u = i * s, c = i * h, d = r * s, f = r * h, p = n * h, m = o * a, g = o * s, v = o * h;
                return t[0] = 1 - (d + p), t[4] = u - v, t[8] = c + g, t[1] = u + v, t[5] = 1 - (l + p), t[9] = f - m, t[2] = c - g, t[6] = f + m, t[10] = 1 - (l + d), t[3] = 0, t[7] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, this
            },
            lookAt: function () {
                var e = new n.Vector3, t = new n.Vector3, i = new n.Vector3;
                return function (r, n, o) {
                    var a = this.elements;
                    return i.subVectors(r, n).normalize(), 0 === i.length() && (i.z = 1), e.crossVectors(o, i).normalize(), 0 === e.length() && (i.x += 1e-4, e.crossVectors(o, i).normalize()), t.crossVectors(i, e), a[0] = e.x, a[4] = t.x, a[8] = i.x, a[1] = e.y, a[5] = t.y, a[9] = i.y, a[2] = e.z, a[6] = t.z, a[10] = i.z, this
                }
            }(),
            multiply: function (e, t) {
                return void 0 !== t ? (n.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(e, t)) : this.multiplyMatrices(this, e)
            },
            multiplyMatrices: function (e, t) {
                var i = e.elements, r = t.elements, n = this.elements, o = i[0], a = i[4], s = i[8], h = i[12], l = i[1], u = i[5], c = i[9], d = i[13], f = i[2], p = i[6], m = i[10], g = i[14], v = i[3], y = i[7], b = i[11], w = i[15], _ = r[0], x = r[4], S = r[8], E = r[12], M = r[1], A = r[5], T = r[9], C = r[13], P = r[2], L = r[6], k = r[10], B = r[14], R = r[3], I = r[7], F = r[11], D = r[15];
                return n[0] = o * _ + a * M + s * P + h * R, n[4] = o * x + a * A + s * L + h * I, n[8] = o * S + a * T + s * k + h * F, n[12] = o * E + a * C + s * B + h * D, n[1] = l * _ + u * M + c * P + d * R, n[5] = l * x + u * A + c * L + d * I, n[9] = l * S + u * T + c * k + d * F, n[13] = l * E + u * C + c * B + d * D, n[2] = f * _ + p * M + m * P + g * R, n[6] = f * x + p * A + m * L + g * I, n[10] = f * S + p * T + m * k + g * F, n[14] = f * E + p * C + m * B + g * D, n[3] = v * _ + y * M + b * P + w * R, n[7] = v * x + y * A + b * L + w * I, n[11] = v * S + y * T + b * k + w * F, n[15] = v * E + y * C + b * B + w * D, this
            },
            multiplyToArray: function (e, t, i) {
                var r = this.elements;
                return this.multiplyMatrices(e, t), i[0] = r[0], i[1] = r[1], i[2] = r[2], i[3] = r[3], i[4] = r[4], i[5] = r[5], i[6] = r[6], i[7] = r[7], i[8] = r[8], i[9] = r[9], i[10] = r[10], i[11] = r[11], i[12] = r[12], i[13] = r[13], i[14] = r[14], i[15] = r[15], this
            },
            multiplyScalar: function (e) {
                var t = this.elements;
                return t[0] *= e, t[4] *= e, t[8] *= e, t[12] *= e, t[1] *= e, t[5] *= e, t[9] *= e, t[13] *= e, t[2] *= e, t[6] *= e, t[10] *= e, t[14] *= e, t[3] *= e, t[7] *= e, t[11] *= e, t[15] *= e, this
            },
            multiplyVector3: function (e) {
                return n.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."), e.applyProjection(this)
            },
            multiplyVector4: function (e) {
                return n.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."), e.applyMatrix4(this)
            },
            multiplyVector3Array: function (e) {
                return n.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."), this.applyToVector3Array(e)
            },
            applyToVector3Array: function () {
                var e = new n.Vector3;
                return function (t, i, r) {
                    void 0 === i && (i = 0), void 0 === r && (r = t.length);
                    for (var n = 0, o = i; r > n; n += 3, o += 3)e.x = t[o], e.y = t[o + 1], e.z = t[o + 2], e.applyMatrix4(this), t[o] = e.x, t[o + 1] = e.y, t[o + 2] = e.z;
                    return t
                }
            }(),
            rotateAxis: function (e) {
                n.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."), e.transformDirection(this)
            },
            crossVector: function (e) {
                return n.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."), e.applyMatrix4(this)
            },
            determinant: function () {
                var e = this.elements, t = e[0], i = e[4], r = e[8], n = e[12], o = e[1], a = e[5], s = e[9], h = e[13], l = e[2], u = e[6], c = e[10], d = e[14], f = e[3], p = e[7], m = e[11], g = e[15];
                return f * (+n * s * u - r * h * u - n * a * c + i * h * c + r * a * d - i * s * d) + p * (+t * s * d - t * h * c + n * o * c - r * o * d + r * h * l - n * s * l) + m * (+t * h * u - t * a * d - n * o * u + i * o * d + n * a * l - i * h * l) + g * (-r * a * l - t * s * u + t * a * c + r * o * u - i * o * c + i * s * l)
            },
            transpose: function () {
                var e, t = this.elements;
                return e = t[1], t[1] = t[4], t[4] = e, e = t[2], t[2] = t[8], t[8] = e, e = t[6], t[6] = t[9], t[9] = e, e = t[3], t[3] = t[12], t[12] = e, e = t[7], t[7] = t[13], t[13] = e, e = t[11], t[11] = t[14], t[14] = e, this
            },
            flattenToArrayOffset: function (e, t) {
                var i = this.elements;
                return e[t] = i[0], e[t + 1] = i[1], e[t + 2] = i[2], e[t + 3] = i[3], e[t + 4] = i[4], e[t + 5] = i[5], e[t + 6] = i[6], e[t + 7] = i[7], e[t + 8] = i[8], e[t + 9] = i[9], e[t + 10] = i[10], e[t + 11] = i[11], e[t + 12] = i[12], e[t + 13] = i[13], e[t + 14] = i[14], e[t + 15] = i[15], e
            },
            getPosition: function () {
                var e = new n.Vector3;
                return function () {
                    n.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");
                    var t = this.elements;
                    return e.set(t[12], t[13], t[14])
                }
            }(),
            setPosition: function (e) {
                var t = this.elements;
                return t[12] = e.x, t[13] = e.y, t[14] = e.z, this
            },
            getInverse: function (e, t) {
                var i = this.elements, r = e.elements, o = r[0], a = r[4], s = r[8], h = r[12], l = r[1], u = r[5], c = r[9], d = r[13], f = r[2], p = r[6], m = r[10], g = r[14], v = r[3], y = r[7], b = r[11], w = r[15];
                i[0] = c * g * y - d * m * y + d * p * b - u * g * b - c * p * w + u * m * w, i[4] = h * m * y - s * g * y - h * p * b + a * g * b + s * p * w - a * m * w, i[8] = s * d * y - h * c * y + h * u * b - a * d * b - s * u * w + a * c * w, i[12] = h * c * p - s * d * p - h * u * m + a * d * m + s * u * g - a * c * g, i[1] = d * m * v - c * g * v - d * f * b + l * g * b + c * f * w - l * m * w, i[5] = s * g * v - h * m * v + h * f * b - o * g * b - s * f * w + o * m * w, i[9] = h * c * v - s * d * v - h * l * b + o * d * b + s * l * w - o * c * w, i[13] = s * d * f - h * c * f + h * l * m - o * d * m - s * l * g + o * c * g, i[2] = u * g * v - d * p * v + d * f * y - l * g * y - u * f * w + l * p * w, i[6] = h * p * v - a * g * v - h * f * y + o * g * y + a * f * w - o * p * w, i[10] = a * d * v - h * u * v + h * l * y - o * d * y - a * l * w + o * u * w, i[14] = h * u * f - a * d * f - h * l * p + o * d * p + a * l * g - o * u * g, i[3] = c * p * v - u * m * v - c * f * y + l * m * y + u * f * b - l * p * b, i[7] = a * m * v - s * p * v + s * f * y - o * m * y - a * f * b + o * p * b, i[11] = s * u * v - a * c * v - s * l * y + o * c * y + a * l * b - o * u * b, i[15] = a * c * f - s * u * f + s * l * p - o * c * p - a * l * m + o * u * m;
                var _ = o * i[0] + l * i[4] + f * i[8] + v * i[12];
                if (0 == _) {
                    var x = "THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";
                    if (t)throw new Error(x);
                    return n.warn(x), this.identity(), this
                }
                return this.multiplyScalar(1 / _), this
            },
            translate: function (e) {
                n.error("THREE.Matrix4: .translate() has been removed.")
            },
            rotateX: function (e) {
                n.error("THREE.Matrix4: .rotateX() has been removed.")
            },
            rotateY: function (e) {
                n.error("THREE.Matrix4: .rotateY() has been removed.")
            },
            rotateZ: function (e) {
                n.error("THREE.Matrix4: .rotateZ() has been removed.")
            },
            rotateByAxis: function (e, t) {
                n.error("THREE.Matrix4: .rotateByAxis() has been removed.")
            },
            scale: function (e) {
                var t = this.elements, i = e.x, r = e.y, n = e.z;
                return t[0] *= i, t[4] *= r, t[8] *= n, t[1] *= i, t[5] *= r, t[9] *= n, t[2] *= i, t[6] *= r, t[10] *= n, t[3] *= i, t[7] *= r, t[11] *= n, this
            },
            getMaxScaleOnAxis: function () {
                var e = this.elements, t = e[0] * e[0] + e[1] * e[1] + e[2] * e[2], i = e[4] * e[4] + e[5] * e[5] + e[6] * e[6], r = e[8] * e[8] + e[9] * e[9] + e[10] * e[10];
                return Math.sqrt(Math.max(t, Math.max(i, r)))
            },
            makeTranslation: function (e, t, i) {
                return this.set(1, 0, 0, e, 0, 1, 0, t, 0, 0, 1, i, 0, 0, 0, 1), this
            },
            makeRotationX: function (e) {
                var t = Math.cos(e), i = Math.sin(e);
                return this.set(1, 0, 0, 0, 0, t, -i, 0, 0, i, t, 0, 0, 0, 0, 1), this
            },
            makeRotationY: function (e) {
                var t = Math.cos(e), i = Math.sin(e);
                return this.set(t, 0, i, 0, 0, 1, 0, 0, -i, 0, t, 0, 0, 0, 0, 1), this
            },
            makeRotationZ: function (e) {
                var t = Math.cos(e), i = Math.sin(e);
                return this.set(t, -i, 0, 0, i, t, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            },
            makeRotationAxis: function (e, t) {
                var i = Math.cos(t), r = Math.sin(t), n = 1 - i, o = e.x, a = e.y, s = e.z, h = n * o, l = n * a;
                return this.set(h * o + i, h * a - r * s, h * s + r * a, 0, h * a + r * s, l * a + i, l * s - r * o, 0, h * s - r * a, l * s + r * o, n * s * s + i, 0, 0, 0, 0, 1), this
            },
            makeScale: function (e, t, i) {
                return this.set(e, 0, 0, 0, 0, t, 0, 0, 0, 0, i, 0, 0, 0, 0, 1), this
            },
            compose: function (e, t, i) {
                return this.makeRotationFromQuaternion(t), this.scale(i), this.setPosition(e), this
            },
            decompose: function () {
                var e = new n.Vector3, t = new n.Matrix4;
                return function (i, r, n) {
                    var o = this.elements, a = e.set(o[0], o[1], o[2]).length(), s = e.set(o[4], o[5], o[6]).length(), h = e.set(o[8], o[9], o[10]).length(), l = this.determinant();
                    0 > l && (a = -a), i.x = o[12], i.y = o[13], i.z = o[14], t.elements.set(this.elements);
                    var u = 1 / a, c = 1 / s, d = 1 / h;
                    return t.elements[0] *= u, t.elements[1] *= u, t.elements[2] *= u, t.elements[4] *= c, t.elements[5] *= c, t.elements[6] *= c, t.elements[8] *= d, t.elements[9] *= d, t.elements[10] *= d, r.setFromRotationMatrix(t), n.x = a, n.y = s, n.z = h, this
                }
            }(),
            makeFrustum: function (e, t, i, r, n, o) {
                var a = this.elements, s = 2 * n / (t - e), h = 2 * n / (r - i), l = (t + e) / (t - e), u = (r + i) / (r - i), c = -(o + n) / (o - n), d = -2 * o * n / (o - n);
                return a[0] = s, a[4] = 0, a[8] = l, a[12] = 0, a[1] = 0, a[5] = h, a[9] = u, a[13] = 0, a[2] = 0, a[6] = 0, a[10] = c, a[14] = d, a[3] = 0, a[7] = 0, a[11] = -1, a[15] = 0, this
            },
            makePerspective: function (e, t, i, r) {
                var o = i * Math.tan(n.Math.degToRad(.5 * e)), a = -o, s = a * t, h = o * t;
                return this.makeFrustum(s, h, a, o, i, r)
            },
            makeOrthographic: function (e, t, i, r, n, o) {
                var a = this.elements, s = t - e, h = i - r, l = o - n, u = (t + e) / s, c = (i + r) / h, d = (o + n) / l;
                return a[0] = 2 / s, a[4] = 0, a[8] = 0, a[12] = -u, a[1] = 0, a[5] = 2 / h, a[9] = 0, a[13] = -c, a[2] = 0, a[6] = 0, a[10] = -2 / l, a[14] = -d, a[3] = 0, a[7] = 0, a[11] = 0, a[15] = 1, this
            },
            fromArray: function (e) {
                return this.elements.set(e), this
            },
            toArray: function () {
                var e = this.elements;
                return [e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11], e[12], e[13], e[14], e[15]]
            },
            clone: function () {
                return (new n.Matrix4).fromArray(this.elements)
            }
        },n.Ray = function (e, t) {
            this.origin = void 0 !== e ? e : new n.Vector3, this.direction = void 0 !== t ? t : new n.Vector3
        },n.Ray.prototype = {
            constructor: n.Ray, set: function (e, t) {
                return this.origin.copy(e), this.direction.copy(t), this
            }, copy: function (e) {
                return this.origin.copy(e.origin), this.direction.copy(e.direction), this
            }, at: function (e, t) {
                var i = t || new n.Vector3;
                return i.copy(this.direction).multiplyScalar(e).add(this.origin)
            }, recast: function () {
                var e = new n.Vector3;
                return function (t) {
                    return this.origin.copy(this.at(t, e)), this
                }
            }(), closestPointToPoint: function (e, t) {
                var i = t || new n.Vector3;
                i.subVectors(e, this.origin);
                var r = i.dot(this.direction);
                return 0 > r ? i.copy(this.origin) : i.copy(this.direction).multiplyScalar(r).add(this.origin)
            }, distanceToPoint: function () {
                var e = new n.Vector3;
                return function (t) {
                    var i = e.subVectors(t, this.origin).dot(this.direction);
                    return 0 > i ? this.origin.distanceTo(t) : (e.copy(this.direction).multiplyScalar(i).add(this.origin), e.distanceTo(t))
                }
            }(), distanceSqToSegment: function () {
                var e = new n.Vector3, t = new n.Vector3, i = new n.Vector3;
                return function (r, n, o, a) {
                    e.copy(r).add(n).multiplyScalar(.5), t.copy(n).sub(r).normalize(), i.copy(this.origin).sub(e);
                    var s, h, l, u, c = .5 * r.distanceTo(n), d = -this.direction.dot(t), f = i.dot(this.direction), p = -i.dot(t), m = i.lengthSq(), g = Math.abs(1 - d * d);
                    if (g > 0)if (s = d * p - f, h = d * f - p, u = c * g, s >= 0)if (h >= -u)if (u >= h) {
                        var v = 1 / g;
                        s *= v, h *= v, l = s * (s + d * h + 2 * f) + h * (d * s + h + 2 * p) + m
                    } else h = c, s = Math.max(0, -(d * h + f)), l = -s * s + h * (h + 2 * p) + m; else h = -c, s = Math.max(0, -(d * h + f)), l = -s * s + h * (h + 2 * p) + m; else-u >= h ? (s = Math.max(0, -(-d * c + f)), h = s > 0 ? -c : Math.min(Math.max(-c, -p), c), l = -s * s + h * (h + 2 * p) + m) : u >= h ? (s = 0, h = Math.min(Math.max(-c, -p), c), l = h * (h + 2 * p) + m) : (s = Math.max(0, -(d * c + f)), h = s > 0 ? c : Math.min(Math.max(-c, -p), c), l = -s * s + h * (h + 2 * p) + m); else h = d > 0 ? -c : c, s = Math.max(0, -(d * h + f)), l = -s * s + h * (h + 2 * p) + m;
                    return o && o.copy(this.direction).multiplyScalar(s).add(this.origin), a && a.copy(t).multiplyScalar(h).add(e), l
                }
            }(), isIntersectionSphere: function (e) {
                return this.distanceToPoint(e.center) <= e.radius
            }, intersectSphere: function () {
                var e = new n.Vector3;
                return function (t, i) {
                    e.subVectors(t.center, this.origin);
                    var r = e.dot(this.direction), n = e.dot(e) - r * r, o = t.radius * t.radius;
                    if (n > o)return null;
                    var a = Math.sqrt(o - n), s = r - a, h = r + a;
                    return 0 > s && 0 > h ? null : 0 > s ? this.at(h, i) : this.at(s, i)
                }
            }(), isIntersectionPlane: function (e) {
                var t = e.distanceToPoint(this.origin);
                if (0 === t)return !0;
                var i = e.normal.dot(this.direction);
                return 0 > i * t ? !0 : !1
            }, distanceToPlane: function (e) {
                var t = e.normal.dot(this.direction);
                if (0 == t)return 0 == e.distanceToPoint(this.origin) ? 0 : null;
                var i = -(this.origin.dot(e.normal) + e.constant) / t;
                return i >= 0 ? i : null
            }, intersectPlane: function (e, t) {
                var i = this.distanceToPlane(e);
                return null === i ? null : this.at(i, t)
            }, isIntersectionBox: function () {
                var e = new n.Vector3;
                return function (t) {
                    return null !== this.intersectBox(t, e)
                }
            }(), intersectBox: function (e, t) {
                var i, r, n, o, a, s, h = 1 / this.direction.x, l = 1 / this.direction.y, u = 1 / this.direction.z, c = this.origin;
                return h >= 0 ? (i = (e.min.x - c.x) * h, r = (e.max.x - c.x) * h) : (i = (e.max.x - c.x) * h, r = (e.min.x - c.x) * h), l >= 0 ? (n = (e.min.y - c.y) * l, o = (e.max.y - c.y) * l) : (n = (e.max.y - c.y) * l, o = (e.min.y - c.y) * l), i > o || n > r ? null : ((n > i || i !== i) && (i = n), (r > o || r !== r) && (r = o), u >= 0 ? (a = (e.min.z - c.z) * u, s = (e.max.z - c.z) * u) : (a = (e.max.z - c.z) * u, s = (e.min.z - c.z) * u), i > s || a > r ? null : ((a > i || i !== i) && (i = a), (r > s || r !== r) && (r = s), 0 > r ? null : this.at(i >= 0 ? i : r, t)))
            }, intersectTriangle: function () {
                var e = new n.Vector3, t = new n.Vector3, i = new n.Vector3, r = new n.Vector3;
                return function (n, o, a, s, h) {
                    t.subVectors(o, n), i.subVectors(a, n), r.crossVectors(t, i);
                    var l, u = this.direction.dot(r);
                    if (u > 0) {
                        if (s)return null;
                        l = 1
                    } else {
                        if (!(0 > u))return null;
                        l = -1, u = -u
                    }
                    e.subVectors(this.origin, n);
                    var c = l * this.direction.dot(i.crossVectors(e, i));
                    if (0 > c)return null;
                    var d = l * this.direction.dot(t.cross(e));
                    if (0 > d)return null;
                    if (c + d > u)return null;
                    var f = -l * e.dot(r);
                    return 0 > f ? null : this.at(f / u, h)
                }
            }(), applyMatrix4: function (e) {
                return this.direction.add(this.origin).applyMatrix4(e), this.origin.applyMatrix4(e), this.direction.sub(this.origin), this.direction.normalize(), this
            }, equals: function (e) {
                return e.origin.equals(this.origin) && e.direction.equals(this.direction)
            }, clone: function () {
                return (new n.Ray).copy(this)
            }
        },n.Sphere = function (e, t) {
            this.center = void 0 !== e ? e : new n.Vector3, this.radius = void 0 !== t ? t : 0
        },n.Sphere.prototype = {
            constructor: n.Sphere, set: function (e, t) {
                return this.center.copy(e), this.radius = t, this
            }, setFromPoints: function () {
                var e = new n.Box3;
                return function (t, i) {
                    var r = this.center;
                    void 0 !== i ? r.copy(i) : e.setFromPoints(t).center(r);
                    for (var n = 0, o = 0, a = t.length; a > o; o++)n = Math.max(n, r.distanceToSquared(t[o]));
                    return this.radius = Math.sqrt(n), this
                }
            }(), copy: function (e) {
                return this.center.copy(e.center), this.radius = e.radius, this
            }, empty: function () {
                return this.radius <= 0
            }, containsPoint: function (e) {
                return e.distanceToSquared(this.center) <= this.radius * this.radius
            }, distanceToPoint: function (e) {
                return e.distanceTo(this.center) - this.radius;
            }, intersectsSphere: function (e) {
                var t = this.radius + e.radius;
                return e.center.distanceToSquared(this.center) <= t * t
            }, clampPoint: function (e, t) {
                var i = this.center.distanceToSquared(e), r = t || new n.Vector3;
                return r.copy(e), i > this.radius * this.radius && (r.sub(this.center).normalize(), r.multiplyScalar(this.radius).add(this.center)), r
            }, getBoundingBox: function (e) {
                var t = e || new n.Box3;
                return t.set(this.center, this.center), t.expandByScalar(this.radius), t
            }, applyMatrix4: function (e) {
                return this.center.applyMatrix4(e), this.radius = this.radius * e.getMaxScaleOnAxis(), this
            }, translate: function (e) {
                return this.center.add(e), this
            }, equals: function (e) {
                return e.center.equals(this.center) && e.radius === this.radius
            }, clone: function () {
                return (new n.Sphere).copy(this)
            }
        },n.Frustum = function (e, t, i, r, o, a) {
            this.planes = [void 0 !== e ? e : new n.Plane, void 0 !== t ? t : new n.Plane, void 0 !== i ? i : new n.Plane, void 0 !== r ? r : new n.Plane, void 0 !== o ? o : new n.Plane, void 0 !== a ? a : new n.Plane]
        },n.Frustum.prototype = {
            constructor: n.Frustum, set: function (e, t, i, r, n, o) {
                var a = this.planes;
                return a[0].copy(e), a[1].copy(t), a[2].copy(i), a[3].copy(r), a[4].copy(n), a[5].copy(o), this
            }, copy: function (e) {
                for (var t = this.planes, i = 0; 6 > i; i++)t[i].copy(e.planes[i]);
                return this
            }, setFromMatrix: function (e) {
                var t = this.planes, i = e.elements, r = i[0], n = i[1], o = i[2], a = i[3], s = i[4], h = i[5], l = i[6], u = i[7], c = i[8], d = i[9], f = i[10], p = i[11], m = i[12], g = i[13], v = i[14], y = i[15];
                return t[0].setComponents(a - r, u - s, p - c, y - m).normalize(), t[1].setComponents(a + r, u + s, p + c, y + m).normalize(), t[2].setComponents(a + n, u + h, p + d, y + g).normalize(), t[3].setComponents(a - n, u - h, p - d, y - g).normalize(), t[4].setComponents(a - o, u - l, p - f, y - v).normalize(), t[5].setComponents(a + o, u + l, p + f, y + v).normalize(), this
            }, intersectsObject: function () {
                var e = new n.Sphere;
                return function (t) {
                    var i = t.geometry;
                    return null === i.boundingSphere && i.computeBoundingSphere(), e.copy(i.boundingSphere), e.applyMatrix4(t.matrixWorld), this.intersectsSphere(e)
                }
            }(), intersectsSphere: function (e) {
                for (var t = this.planes, i = e.center, r = -e.radius, n = 0; 6 > n; n++) {
                    var o = t[n].distanceToPoint(i);
                    if (r > o)return !1
                }
                return !0
            }, intersectsBox: function () {
                var e = new n.Vector3, t = new n.Vector3;
                return function (i) {
                    for (var r = this.planes, n = 0; 6 > n; n++) {
                        var o = r[n];
                        e.x = o.normal.x > 0 ? i.min.x : i.max.x, t.x = o.normal.x > 0 ? i.max.x : i.min.x, e.y = o.normal.y > 0 ? i.min.y : i.max.y, t.y = o.normal.y > 0 ? i.max.y : i.min.y, e.z = o.normal.z > 0 ? i.min.z : i.max.z, t.z = o.normal.z > 0 ? i.max.z : i.min.z;
                        var a = o.distanceToPoint(e), s = o.distanceToPoint(t);
                        if (0 > a && 0 > s)return !1
                    }
                    return !0
                }
            }(), containsPoint: function (e) {
                for (var t = this.planes, i = 0; 6 > i; i++)if (t[i].distanceToPoint(e) < 0)return !1;
                return !0
            }, clone: function () {
                return (new n.Frustum).copy(this)
            }
        },n.Plane = function (e, t) {
            this.normal = void 0 !== e ? e : new n.Vector3(1, 0, 0), this.constant = void 0 !== t ? t : 0
        },n.Plane.prototype = {
            constructor: n.Plane, set: function (e, t) {
                return this.normal.copy(e), this.constant = t, this
            }, setComponents: function (e, t, i, r) {
                return this.normal.set(e, t, i), this.constant = r, this
            }, setFromNormalAndCoplanarPoint: function (e, t) {
                return this.normal.copy(e), this.constant = -t.dot(this.normal), this
            }, setFromCoplanarPoints: function () {
                var e = new n.Vector3, t = new n.Vector3;
                return function (i, r, n) {
                    var o = e.subVectors(n, r).cross(t.subVectors(i, r)).normalize();
                    return this.setFromNormalAndCoplanarPoint(o, i), this
                }
            }(), copy: function (e) {
                return this.normal.copy(e.normal), this.constant = e.constant, this
            }, normalize: function () {
                var e = 1 / this.normal.length();
                return this.normal.multiplyScalar(e), this.constant *= e, this
            }, negate: function () {
                return this.constant *= -1, this.normal.negate(), this
            }, distanceToPoint: function (e) {
                return this.normal.dot(e) + this.constant
            }, distanceToSphere: function (e) {
                return this.distanceToPoint(e.center) - e.radius
            }, projectPoint: function (e, t) {
                return this.orthoPoint(e, t).sub(e).negate()
            }, orthoPoint: function (e, t) {
                var i = this.distanceToPoint(e), r = t || new n.Vector3;
                return r.copy(this.normal).multiplyScalar(i)
            }, isIntersectionLine: function (e) {
                var t = this.distanceToPoint(e.start), i = this.distanceToPoint(e.end);
                return 0 > t && i > 0 || 0 > i && t > 0
            }, intersectLine: function () {
                var e = new n.Vector3;
                return function (t, i) {
                    var r = i || new n.Vector3, o = t.delta(e), a = this.normal.dot(o);
                    if (0 != a) {
                        var s = -(t.start.dot(this.normal) + this.constant) / a;
                        if (!(0 > s || s > 1))return r.copy(o).multiplyScalar(s).add(t.start)
                    } else if (0 == this.distanceToPoint(t.start))return r.copy(t.start)
                }
            }(), coplanarPoint: function (e) {
                var t = e || new n.Vector3;
                return t.copy(this.normal).multiplyScalar(-this.constant)
            }, applyMatrix4: function () {
                var e = new n.Vector3, t = new n.Vector3, i = new n.Matrix3;
                return function (r, n) {
                    var o = n || i.getNormalMatrix(r), a = e.copy(this.normal).applyMatrix3(o), s = this.coplanarPoint(t);
                    return s.applyMatrix4(r), this.setFromNormalAndCoplanarPoint(a, s), this
                }
            }(), translate: function (e) {
                return this.constant = this.constant - e.dot(this.normal), this
            }, equals: function (e) {
                return e.normal.equals(this.normal) && e.constant == this.constant
            }, clone: function () {
                return (new n.Plane).copy(this)
            }
        },n.Math = {
            generateUUID: function () {
                var e, t = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), i = new Array(36), r = 0;
                return function () {
                    for (var n = 0; 36 > n; n++)8 == n || 13 == n || 18 == n || 23 == n ? i[n] = "-" : 14 == n ? i[n] = "4" : (2 >= r && (r = 33554432 + 16777216 * Math.random() | 0), e = 15 & r, r >>= 4, i[n] = t[19 == n ? 3 & e | 8 : e]);
                    return i.join("")
                }
            }(), clamp: function (e, t, i) {
                return t > e ? t : e > i ? i : e
            }, clampBottom: function (e, t) {
                return t > e ? t : e
            }, mapLinear: function (e, t, i, r, n) {
                return r + (e - t) * (n - r) / (i - t)
            }, smoothstep: function (e, t, i) {
                return t >= e ? 0 : e >= i ? 1 : (e = (e - t) / (i - t), e * e * (3 - 2 * e))
            }, smootherstep: function (e, t, i) {
                return t >= e ? 0 : e >= i ? 1 : (e = (e - t) / (i - t), e * e * e * (e * (6 * e - 15) + 10))
            }, random16: function () {
                return (65280 * Math.random() + 255 * Math.random()) / 65535
            }, randInt: function (e, t) {
                return Math.floor(this.randFloat(e, t))
            }, randFloat: function (e, t) {
                return e + Math.random() * (t - e)
            }, randFloatSpread: function (e) {
                return e * (.5 - Math.random())
            }, degToRad: function () {
                var e = Math.PI / 180;
                return function (t) {
                    return t * e
                }
            }(), radToDeg: function () {
                var e = 180 / Math.PI;
                return function (t) {
                    return t * e
                }
            }(), isPowerOfTwo: function (e) {
                return 0 === (e & e - 1) && 0 !== e
            }, nextPowerOfTwo: function (e) {
                return e--, e |= e >> 1, e |= e >> 2, e |= e >> 4, e |= e >> 8, e |= e >> 16, e++, e
            }
        },n.Spline = function (e) {
            function t(e, t, i, r, n, o, a) {
                var s = .5 * (i - e), h = .5 * (r - t);
                return (2 * (t - i) + s + h) * a + (-3 * (t - i) - 2 * s - h) * o + s * n + t
            }

            this.points = e;
            var i, r, o, a, s, h, l, u, c, d = [], f = {x: 0, y: 0, z: 0};
            this.initFromArray = function (e) {
                this.points = [];
                for (var t = 0; t < e.length; t++)this.points[t] = {x: e[t][0], y: e[t][1], z: e[t][2]}
            }, this.getPoint = function (e) {
                return i = (this.points.length - 1) * e, r = Math.floor(i), o = i - r, d[0] = 0 === r ? r : r - 1, d[1] = r, d[2] = r > this.points.length - 2 ? this.points.length - 1 : r + 1, d[3] = r > this.points.length - 3 ? this.points.length - 1 : r + 2, h = this.points[d[0]], l = this.points[d[1]], u = this.points[d[2]], c = this.points[d[3]], a = o * o, s = o * a, f.x = t(h.x, l.x, u.x, c.x, o, a, s), f.y = t(h.y, l.y, u.y, c.y, o, a, s), f.z = t(h.z, l.z, u.z, c.z, o, a, s), f
            }, this.getControlPointsArray = function () {
                var e, t, i = this.points.length, r = [];
                for (e = 0; i > e; e++)t = this.points[e], r[e] = [t.x, t.y, t.z];
                return r
            }, this.getLength = function (e) {
                var t, i, r, o, a = 0, s = 0, h = 0, l = new n.Vector3, u = new n.Vector3, c = [], d = 0;
                for (c[0] = 0, e || (e = 100), r = this.points.length * e, l.copy(this.points[0]), t = 1; r > t; t++)i = t / r, o = this.getPoint(i), u.copy(o), d += u.distanceTo(l), l.copy(o), a = (this.points.length - 1) * i, s = Math.floor(a), s != h && (c[s] = d, h = s);
                return c[c.length] = d, {chunks: c, total: d}
            }, this.reparametrizeByArcLength = function (e) {
                var t, i, r, o, a, s, h, l, u = [], c = new n.Vector3, d = this.getLength();
                for (u.push(c.copy(this.points[0]).clone()), t = 1; t < this.points.length; t++) {
                    for (s = d.chunks[t] - d.chunks[t - 1], h = Math.ceil(e * s / d.total), o = (t - 1) / (this.points.length - 1), a = t / (this.points.length - 1), i = 1; h - 1 > i; i++)r = o + i * (1 / h) * (a - o), l = this.getPoint(r), u.push(c.copy(l).clone());
                    u.push(c.copy(this.points[t]).clone())
                }
                this.points = u
            }
        },n.Triangle = function (e, t, i) {
            this.a = void 0 !== e ? e : new n.Vector3, this.b = void 0 !== t ? t : new n.Vector3, this.c = void 0 !== i ? i : new n.Vector3
        },n.Triangle.normal = function () {
            var e = new n.Vector3;
            return function (t, i, r, o) {
                var a = o || new n.Vector3;
                a.subVectors(r, i), e.subVectors(t, i), a.cross(e);
                var s = a.lengthSq();
                return s > 0 ? a.multiplyScalar(1 / Math.sqrt(s)) : a.set(0, 0, 0)
            }
        }(),n.Triangle.barycoordFromPoint = function () {
            var e = new n.Vector3, t = new n.Vector3, i = new n.Vector3;
            return function (r, o, a, s, h) {
                e.subVectors(s, o), t.subVectors(a, o), i.subVectors(r, o);
                var l = e.dot(e), u = e.dot(t), c = e.dot(i), d = t.dot(t), f = t.dot(i), p = l * d - u * u, m = h || new n.Vector3;
                if (0 == p)return m.set(-2, -1, -1);
                var g = 1 / p, v = (d * c - u * f) * g, y = (l * f - u * c) * g;
                return m.set(1 - v - y, y, v)
            }
        }(),n.Triangle.containsPoint = function () {
            var e = new n.Vector3;
            return function (t, i, r, o) {
                var a = n.Triangle.barycoordFromPoint(t, i, r, o, e);
                return a.x >= 0 && a.y >= 0 && a.x + a.y <= 1
            }
        }(),n.Triangle.prototype = {
            constructor: n.Triangle, set: function (e, t, i) {
                return this.a.copy(e), this.b.copy(t), this.c.copy(i), this
            }, setFromPointsAndIndices: function (e, t, i, r) {
                return this.a.copy(e[t]), this.b.copy(e[i]), this.c.copy(e[r]), this
            }, copy: function (e) {
                return this.a.copy(e.a), this.b.copy(e.b), this.c.copy(e.c), this
            }, area: function () {
                var e = new n.Vector3, t = new n.Vector3;
                return function () {
                    return e.subVectors(this.c, this.b), t.subVectors(this.a, this.b), .5 * e.cross(t).length()
                }
            }(), midpoint: function (e) {
                var t = e || new n.Vector3;
                return t.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3)
            }, normal: function (e) {
                return n.Triangle.normal(this.a, this.b, this.c, e)
            }, plane: function (e) {
                var t = e || new n.Plane;
                return t.setFromCoplanarPoints(this.a, this.b, this.c)
            }, barycoordFromPoint: function (e, t) {
                return n.Triangle.barycoordFromPoint(e, this.a, this.b, this.c, t)
            }, containsPoint: function (e) {
                return n.Triangle.containsPoint(e, this.a, this.b, this.c)
            }, equals: function (e) {
                return e.a.equals(this.a) && e.b.equals(this.b) && e.c.equals(this.c)
            }, clone: function () {
                return (new n.Triangle).copy(this)
            }
        },n.Clock = function (e) {
            this.autoStart = void 0 !== e ? e : !0, this.startTime = 0, this.oldTime = 0, this.elapsedTime = 0, this.running = !1
        },n.Clock.prototype = {
            constructor: n.Clock, start: function () {
                this.startTime = void 0 !== r.performance && void 0 !== r.performance.now ? r.performance.now() : Date.now(), this.oldTime = this.startTime, this.running = !0
            }, stop: function () {
                this.getElapsedTime(), this.running = !1
            }, getElapsedTime: function () {
                return this.getDelta(), this.elapsedTime
            }, getDelta: function () {
                var e = 0;
                if (this.autoStart && !this.running && this.start(), this.running) {
                    var t = void 0 !== r.performance && void 0 !== r.performance.now ? r.performance.now() : Date.now();
                    e = .001 * (t - this.oldTime), this.oldTime = t, this.elapsedTime += e
                }
                return e
            }
        },n.EventDispatcher = function () {
        },n.EventDispatcher.prototype = {
            constructor: n.EventDispatcher, apply: function (e) {
                e.addEventListener = n.EventDispatcher.prototype.addEventListener, e.hasEventListener = n.EventDispatcher.prototype.hasEventListener, e.removeEventListener = n.EventDispatcher.prototype.removeEventListener, e.dispatchEvent = n.EventDispatcher.prototype.dispatchEvent
            }, addEventListener: function (e, t) {
                void 0 === this._listeners && (this._listeners = {});
                var i = this._listeners;
                void 0 === i[e] && (i[e] = []), -1 === i[e].indexOf(t) && i[e].push(t)
            }, hasEventListener: function (e, t) {
                if (void 0 === this._listeners)return !1;
                var i = this._listeners;
                return void 0 !== i[e] && -1 !== i[e].indexOf(t) ? !0 : !1
            }, removeEventListener: function (e, t) {
                if (void 0 !== this._listeners) {
                    var i = this._listeners, r = i[e];
                    if (void 0 !== r) {
                        var n = r.indexOf(t);
                        -1 !== n && r.splice(n, 1)
                    }
                }
            }, dispatchEvent: function (e) {
                if (void 0 !== this._listeners) {
                    var t = this._listeners, i = t[e.type];
                    if (void 0 !== i) {
                        e.target = this;
                        for (var r = [], n = i.length, o = 0; n > o; o++)r[o] = i[o];
                        for (var o = 0; n > o; o++)r[o].call(this, e)
                    }
                }
            }
        },function (e) {
            e.Raycaster = function (t, i, r, n) {
                this.ray = new e.Ray(t, i), this.near = r || 0, this.far = n || 1 / 0, this.params = {
                    Sprite: {},
                    Mesh: {},
                    PointCloud: {threshold: 1},
                    LOD: {},
                    Line: {}
                }
            };
            var t = function (e, t) {
                return e.distance - t.distance
            }, i = function (e, t, r, n) {
                if (e.raycast(t, r), n === !0)for (var o = e.children, a = 0, s = o.length; s > a; a++)i(o[a], t, r, !0)
            };
            e.Raycaster.prototype = {
                constructor: e.Raycaster, precision: 1e-4, linePrecision: 1, set: function (e, t) {
                    this.ray.set(e, t)
                }, setFromCamera: function (t, i) {
                    i instanceof e.PerspectiveCamera ? (this.ray.origin.copy(i.position), this.ray.direction.set(t.x, t.y, .5).unproject(i).sub(i.position).normalize()) : i instanceof e.OrthographicCamera ? (this.ray.origin.set(t.x, t.y, -1).unproject(i), this.ray.direction.set(0, 0, -1).transformDirection(i.matrixWorld)) : e.error("THREE.Raycaster: Unsupported camera type.")
                }, intersectObject: function (e, r) {
                    var n = [];
                    return i(e, this, n, r), n.sort(t), n
                }, intersectObjects: function (r, n) {
                    var o = [];
                    if (r instanceof Array == !1)return e.warn("THREE.Raycaster.intersectObjects: objects is not an Array."), o;
                    for (var a = 0, s = r.length; s > a; a++)i(r[a], this, o, n);
                    return o.sort(t), o
                }
            }
        }(n),n.Object3D = function () {
            Object.defineProperty(this, "id", {value: n.Object3DIdCount++}), this.uuid = n.Math.generateUUID(), this.name = "", this.type = "Object3D", this.parent = void 0, this.children = [], this.up = n.Object3D.DefaultUp.clone();
            var e = new n.Vector3, t = new n.Euler, i = new n.Quaternion, r = new n.Vector3(1, 1, 1), o = function () {
                i.setFromEuler(t, !1)
            }, a = function () {
                t.setFromQuaternion(i, void 0, !1)
            };
            t.onChange(o), i.onChange(a), Object.defineProperties(this, {
                position: {enumerable: !0, value: e},
                rotation: {enumerable: !0, value: t},
                quaternion: {enumerable: !0, value: i},
                scale: {enumerable: !0, value: r}
            }), this.rotationAutoUpdate = !0, this.matrix = new n.Matrix4, this.matrixWorld = new n.Matrix4, this.matrixAutoUpdate = !0, this.matrixWorldNeedsUpdate = !1, this.visible = !0, this.castShadow = !1, this.receiveShadow = !1, this.frustumCulled = !0, this.renderOrder = 0, this.userData = {}
        },n.Object3D.DefaultUp = new n.Vector3(0, 1, 0),n.Object3D.prototype = {
            constructor: n.Object3D,
            get eulerOrder() {
                return n.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."), this.rotation.order
            },
            set eulerOrder(e) {
                n.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."), this.rotation.order = e
            },
            get useQuaternion() {
                n.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
            },
            set useQuaternion(e) {
                n.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
            },
            applyMatrix: function (e) {
                this.matrix.multiplyMatrices(e, this.matrix), this.matrix.decompose(this.position, this.quaternion, this.scale)
            },
            setRotationFromAxisAngle: function (e, t) {
                this.quaternion.setFromAxisAngle(e, t)
            },
            setRotationFromEuler: function (e) {
                this.quaternion.setFromEuler(e, !0)
            },
            setRotationFromMatrix: function (e) {
                this.quaternion.setFromRotationMatrix(e)
            },
            setRotationFromQuaternion: function (e) {
                this.quaternion.copy(e)
            },
            rotateOnAxis: function () {
                var e = new n.Quaternion;
                return function (t, i) {
                    return e.setFromAxisAngle(t, i), this.quaternion.multiply(e), this
                }
            }(),
            rotateX: function () {
                var e = new n.Vector3(1, 0, 0);
                return function (t) {
                    return this.rotateOnAxis(e, t)
                }
            }(),
            rotateY: function () {
                var e = new n.Vector3(0, 1, 0);
                return function (t) {
                    return this.rotateOnAxis(e, t)
                }
            }(),
            rotateZ: function () {
                var e = new n.Vector3(0, 0, 1);
                return function (t) {
                    return this.rotateOnAxis(e, t)
                }
            }(),
            translateOnAxis: function () {
                var e = new n.Vector3;
                return function (t, i) {
                    return e.copy(t).applyQuaternion(this.quaternion), this.position.add(e.multiplyScalar(i)), this
                }
            }(),
            translate: function (e, t) {
                return n.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."), this.translateOnAxis(t, e)
            },
            translateX: function () {
                var e = new n.Vector3(1, 0, 0);
                return function (t) {
                    return this.translateOnAxis(e, t)
                }
            }(),
            translateY: function () {
                var e = new n.Vector3(0, 1, 0);
                return function (t) {
                    return this.translateOnAxis(e, t)
                }
            }(),
            translateZ: function () {
                var e = new n.Vector3(0, 0, 1);
                return function (t) {
                    return this.translateOnAxis(e, t)
                }
            }(),
            localToWorld: function (e) {
                return e.applyMatrix4(this.matrixWorld)
            },
            worldToLocal: function () {
                var e = new n.Matrix4;
                return function (t) {
                    return t.applyMatrix4(e.getInverse(this.matrixWorld))
                }
            }(),
            lookAt: function () {
                var e = new n.Matrix4;
                return function (t) {
                    e.lookAt(t, this.position, this.up), this.quaternion.setFromRotationMatrix(e)
                }
            }(),
            add: function (e) {
                if (arguments.length > 1) {
                    for (var t = 0; t < arguments.length; t++)this.add(arguments[t]);
                    return this
                }
                return e === this ? (n.error("THREE.Object3D.add: object can't be added as a child of itself.", e), this) : (e instanceof n.Object3D ? (void 0 !== e.parent && e.parent.remove(e), e.parent = this, e.dispatchEvent({type: "added"}), this.children.push(e)) : n.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", e), this)
            },
            remove: function (e) {
                if (arguments.length > 1)for (var t = 0; t < arguments.length; t++)this.remove(arguments[t]);
                var i = this.children.indexOf(e);
                -1 !== i && (e.parent = void 0, e.dispatchEvent({type: "removed"}), this.children.splice(i, 1))
            },
            getChildByName: function (e) {
                return n.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."), this.getObjectByName(e)
            },
            getObjectById: function (e) {
                return this.getObjectByProperty("id", e)
            },
            getObjectByName: function (e) {
                return this.getObjectByProperty("name", e)
            },
            getObjectByProperty: function (e, t) {
                if (this[e] === t)return this;
                for (var i = 0, r = this.children.length; r > i; i++) {
                    var n = this.children[i], o = n.getObjectByProperty(e, t);
                    if (void 0 !== o)return o
                }
            },
            getWorldPosition: function (e) {
                var t = e || new n.Vector3;
                return this.updateMatrixWorld(!0), t.setFromMatrixPosition(this.matrixWorld)
            },
            getWorldQuaternion: function () {
                var e = new n.Vector3, t = new n.Vector3;
                return function (i) {
                    var r = i || new n.Quaternion;
                    return this.updateMatrixWorld(!0), this.matrixWorld.decompose(e, r, t), r
                }
            }(),
            getWorldRotation: function () {
                var e = new n.Quaternion;
                return function (t) {
                    var i = t || new n.Euler;
                    return this.getWorldQuaternion(e), i.setFromQuaternion(e, this.rotation.order, !1)
                }
            }(),
            getWorldScale: function () {
                var e = new n.Vector3, t = new n.Quaternion;
                return function (i) {
                    var r = i || new n.Vector3;
                    return this.updateMatrixWorld(!0), this.matrixWorld.decompose(e, t, r), r
                }
            }(),
            getWorldDirection: function () {
                var e = new n.Quaternion;
                return function (t) {
                    var i = t || new n.Vector3;
                    return this.getWorldQuaternion(e), i.set(0, 0, 1).applyQuaternion(e)
                }
            }(),
            raycast: function () {
            },
            traverse: function (e) {
                e(this);
                for (var t = 0, i = this.children.length; i > t; t++)this.children[t].traverse(e)
            },
            traverseVisible: function (e) {
                if (this.visible !== !1) {
                    e(this);
                    for (var t = 0, i = this.children.length; i > t; t++)this.children[t].traverseVisible(e)
                }
            },
            traverseAncestors: function (e) {
                this.parent && (e(this.parent), this.parent.traverseAncestors(e))
            },
            updateMatrix: function () {
                this.matrix.compose(this.position, this.quaternion, this.scale), this.matrixWorldNeedsUpdate = !0
            },
            updateMatrixWorld: function (e) {
                this.matrixAutoUpdate === !0 && this.updateMatrix(), (this.matrixWorldNeedsUpdate === !0 || e === !0) && (void 0 === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorldNeedsUpdate = !1, e = !0);
                for (var t = 0, i = this.children.length; i > t; t++)this.children[t].updateMatrixWorld(e)
            },
            toJSON: function () {
                var e = {
                    metadata: {
                        version: 4.3,
                        type: "Object",
                        generator: "ObjectExporter"
                    }
                }, t = {}, i = function (i) {
                    if (void 0 === e.geometries && (e.geometries = []), void 0 === t[i.uuid]) {
                        var r = i.toJSON();
                        delete r.metadata, t[i.uuid] = r, e.geometries.push(r)
                    }
                    return i.uuid
                }, r = {}, o = function (t) {
                    if (void 0 === e.materials && (e.materials = []), void 0 === r[t.uuid]) {
                        var i = t.toJSON();
                        delete i.metadata, r[t.uuid] = i, e.materials.push(i)
                    }
                    return t.uuid
                }, a = function (e) {
                    var t = {};
                    if (t.uuid = e.uuid, t.type = e.type, "" !== e.name && (t.name = e.name), "{}" !== JSON.stringify(e.userData) && (t.userData = e.userData), e.visible !== !0 && (t.visible = e.visible), e instanceof n.PerspectiveCamera ? (t.fov = e.fov, t.aspect = e.aspect, t.near = e.near, t.far = e.far) : e instanceof n.OrthographicCamera ? (t.left = e.left, t.right = e.right, t.top = e.top, t.bottom = e.bottom, t.near = e.near, t.far = e.far) : e instanceof n.AmbientLight ? t.color = e.color.getHex() : e instanceof n.DirectionalLight ? (t.color = e.color.getHex(), t.intensity = e.intensity) : e instanceof n.PointLight ? (t.color = e.color.getHex(), t.intensity = e.intensity, t.distance = e.distance, t.decay = e.decay) : e instanceof n.SpotLight ? (t.color = e.color.getHex(), t.intensity = e.intensity, t.distance = e.distance, t.angle = e.angle, t.exponent = e.exponent, t.decay = e.decay) : e instanceof n.HemisphereLight ? (t.color = e.color.getHex(), t.groundColor = e.groundColor.getHex()) : e instanceof n.Mesh || e instanceof n.Line || e instanceof n.PointCloud ? (t.geometry = i(e.geometry), t.material = o(e.material), e instanceof n.Line && (t.mode = e.mode)) : e instanceof n.Sprite && (t.material = o(e.material)), t.matrix = e.matrix.toArray(), e.children.length > 0) {
                        t.children = [];
                        for (var r = 0; r < e.children.length; r++)t.children.push(a(e.children[r]))
                    }
                    return t
                };
                return e.object = a(this), e
            },
            clone: function (e, t) {
                if (void 0 === e && (e = new n.Object3D), void 0 === t && (t = !0), e.name = this.name, e.up.copy(this.up), e.position.copy(this.position), e.quaternion.copy(this.quaternion), e.scale.copy(this.scale), e.rotationAutoUpdate = this.rotationAutoUpdate, e.matrix.copy(this.matrix), e.matrixWorld.copy(this.matrixWorld), e.matrixAutoUpdate = this.matrixAutoUpdate, e.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate, e.visible = this.visible, e.castShadow = this.castShadow, e.receiveShadow = this.receiveShadow, e.frustumCulled = this.frustumCulled, e.userData = JSON.parse(JSON.stringify(this.userData)), t === !0)for (var i = 0; i < this.children.length; i++) {
                    var r = this.children[i];
                    e.add(r.clone())
                }
                return e
            }
        },n.EventDispatcher.prototype.apply(n.Object3D.prototype),n.Object3DIdCount = 0,n.Face3 = function (e, t, i, r, o, a) {
            this.a = e, this.b = t, this.c = i, this.normal = r instanceof n.Vector3 ? r : new n.Vector3, this.vertexNormals = r instanceof Array ? r : [], this.color = o instanceof n.Color ? o : new n.Color, this.vertexColors = o instanceof Array ? o : [], this.vertexTangents = [], this.materialIndex = void 0 !== a ? a : 0
        },n.Face3.prototype = {
            constructor: n.Face3, clone: function () {
                var e = new n.Face3(this.a, this.b, this.c);
                e.normal.copy(this.normal), e.color.copy(this.color), e.materialIndex = this.materialIndex;
                for (var t = 0, i = this.vertexNormals.length; i > t; t++)e.vertexNormals[t] = this.vertexNormals[t].clone();
                for (var t = 0, i = this.vertexColors.length; i > t; t++)e.vertexColors[t] = this.vertexColors[t].clone();
                for (var t = 0, i = this.vertexTangents.length; i > t; t++)e.vertexTangents[t] = this.vertexTangents[t].clone();
                return e
            }
        },n.Face4 = function (e, t, i, r, o, a, s) {
            return n.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."), new n.Face3(e, t, i, o, a, s)
        },n.BufferAttribute = function (e, t) {
            this.array = e, this.itemSize = t, this.needsUpdate = !1
        },n.BufferAttribute.prototype = {
            constructor: n.BufferAttribute, get length() {
                return this.array.length
            }, copyAt: function (e, t, i) {
                e *= this.itemSize, i *= t.itemSize;
                for (var r = 0, n = this.itemSize; n > r; r++)this.array[e + r] = t.array[i + r];
                return this
            }, set: function (e, t) {
                return void 0 === t && (t = 0), this.array.set(e, t), this
            }, setX: function (e, t) {
                return this.array[e * this.itemSize] = t, this
            }, setY: function (e, t) {
                return this.array[e * this.itemSize + 1] = t, this
            }, setZ: function (e, t) {
                return this.array[e * this.itemSize + 2] = t, this
            }, setXY: function (e, t, i) {
                return e *= this.itemSize, this.array[e] = t, this.array[e + 1] = i, this
            }, setXYZ: function (e, t, i, r) {
                return e *= this.itemSize, this.array[e] = t, this.array[e + 1] = i, this.array[e + 2] = r, this
            }, setXYZW: function (e, t, i, r, n) {
                return e *= this.itemSize, this.array[e] = t, this.array[e + 1] = i, this.array[e + 2] = r, this.array[e + 3] = n, this
            }, clone: function () {
                return new n.BufferAttribute(new this.array.constructor(this.array), this.itemSize)
            }
        },n.Int8Attribute = function (e, t) {
            return n.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Uint8Attribute = function (e, t) {
            return n.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Uint8ClampedAttribute = function (e, t) {
            return n.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Int16Attribute = function (e, t) {
            return n.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Uint16Attribute = function (e, t) {
            return n.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Int32Attribute = function (e, t) {
            return n.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Uint32Attribute = function (e, t) {
            return n.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Float32Attribute = function (e, t) {
            return n.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.Float64Attribute = function (e, t) {
            return n.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."), new n.BufferAttribute(e, t)
        },n.DynamicBufferAttribute = function (e, t) {
            n.BufferAttribute.call(this, e, t), this.updateRange = {offset: 0, count: -1}
        },n.DynamicBufferAttribute.prototype = Object.create(n.BufferAttribute.prototype),n.DynamicBufferAttribute.prototype.constructor = n.DynamicBufferAttribute,n.DynamicBufferAttribute.prototype.clone = function () {
            return new n.DynamicBufferAttribute(new this.array.constructor(this.array), this.itemSize)
        },n.BufferGeometry = function () {
            Object.defineProperty(this, "id", {value: n.GeometryIdCount++}), this.uuid = n.Math.generateUUID(), this.name = "", this.type = "BufferGeometry", this.attributes = {}, this.attributesKeys = [], this.drawcalls = [], this.offsets = this.drawcalls, this.boundingBox = null, this.boundingSphere = null
        },n.BufferGeometry.prototype = {
            constructor: n.BufferGeometry, addAttribute: function (e, t) {
                return t instanceof n.BufferAttribute == !1 ? (n.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."), void(this.attributes[e] = {
                    array: arguments[1],
                    itemSize: arguments[2]
                })) : (this.attributes[e] = t, void(this.attributesKeys = Object.keys(this.attributes)))
            }, getAttribute: function (e) {
                return this.attributes[e]
            }, addDrawCall: function (e, t, i) {
                this.drawcalls.push({start: e, count: t, index: void 0 !== i ? i : 0})
            }, applyMatrix: function (e) {
                var t = this.attributes.position;
                void 0 !== t && (e.applyToVector3Array(t.array), t.needsUpdate = !0);
                var i = this.attributes.normal;
                if (void 0 !== i) {
                    var r = (new n.Matrix3).getNormalMatrix(e);
                    r.applyToVector3Array(i.array), i.needsUpdate = !0
                }
                null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere()
            }, center: function () {
                this.computeBoundingBox();
                var e = this.boundingBox.center().negate();
                return this.applyMatrix((new n.Matrix4).setPosition(e)), e
            }, fromGeometry: function (e, t) {
                t = t || {vertexColors: n.NoColors};
                var i = e.vertices, r = e.faces, o = e.faceVertexUvs, a = t.vertexColors, s = o[0].length > 0, h = 3 == r[0].vertexNormals.length, l = new Float32Array(3 * r.length * 3);
                this.addAttribute("position", new n.BufferAttribute(l, 3));
                var u = new Float32Array(3 * r.length * 3);
                if (this.addAttribute("normal", new n.BufferAttribute(u, 3)), a !== n.NoColors) {
                    var c = new Float32Array(3 * r.length * 3);
                    this.addAttribute("color", new n.BufferAttribute(c, 3))
                }
                if (s === !0) {
                    var d = new Float32Array(3 * r.length * 2);
                    this.addAttribute("uv", new n.BufferAttribute(d, 2))
                }
                for (var f = 0, p = 0, m = 0; f < r.length; f++, p += 6, m += 9) {
                    var g = r[f], v = i[g.a], y = i[g.b], b = i[g.c];
                    if (l[m] = v.x, l[m + 1] = v.y, l[m + 2] = v.z, l[m + 3] = y.x, l[m + 4] = y.y, l[m + 5] = y.z, l[m + 6] = b.x, l[m + 7] = b.y, l[m + 8] = b.z, h === !0) {
                        var w = g.vertexNormals[0], _ = g.vertexNormals[1], x = g.vertexNormals[2];
                        u[m] = w.x, u[m + 1] = w.y, u[m + 2] = w.z, u[m + 3] = _.x, u[m + 4] = _.y, u[m + 5] = _.z, u[m + 6] = x.x, u[m + 7] = x.y, u[m + 8] = x.z
                    } else {
                        var S = g.normal;
                        u[m] = S.x, u[m + 1] = S.y, u[m + 2] = S.z, u[m + 3] = S.x, u[m + 4] = S.y, u[m + 5] = S.z, u[m + 6] = S.x, u[m + 7] = S.y, u[m + 8] = S.z
                    }
                    if (a === n.FaceColors) {
                        var E = g.color;
                        c[m] = E.r, c[m + 1] = E.g, c[m + 2] = E.b, c[m + 3] = E.r, c[m + 4] = E.g, c[m + 5] = E.b, c[m + 6] = E.r, c[m + 7] = E.g, c[m + 8] = E.b
                    } else if (a === n.VertexColors) {
                        var M = g.vertexColors[0], A = g.vertexColors[1], T = g.vertexColors[2];
                        c[m] = M.r, c[m + 1] = M.g, c[m + 2] = M.b, c[m + 3] = A.r, c[m + 4] = A.g, c[m + 5] = A.b, c[m + 6] = T.r, c[m + 7] = T.g, c[m + 8] = T.b
                    }
                    if (s === !0) {
                        var C = o[0][f][0], P = o[0][f][1], L = o[0][f][2];
                        d[p] = C.x, d[p + 1] = C.y, d[p + 2] = P.x, d[p + 3] = P.y, d[p + 4] = L.x, d[p + 5] = L.y
                    }
                }
                return this.computeBoundingSphere(), this
            }, computeBoundingBox: function () {
                var e = new n.Vector3;
                return function () {
                    null === this.boundingBox && (this.boundingBox = new n.Box3);
                    var t = this.attributes.position.array;
                    if (t) {
                        var i = this.boundingBox;
                        i.makeEmpty();
                        for (var r = 0, o = t.length; o > r; r += 3)e.set(t[r], t[r + 1], t[r + 2]), i.expandByPoint(e)
                    }
                    (void 0 === t || 0 === t.length) && (this.boundingBox.min.set(0, 0, 0), this.boundingBox.max.set(0, 0, 0)), (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && n.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')
                }
            }(), computeBoundingSphere: function () {
                var e = new n.Box3, t = new n.Vector3;
                return function () {
                    null === this.boundingSphere && (this.boundingSphere = new n.Sphere);
                    var i = this.attributes.position.array;
                    if (i) {
                        e.makeEmpty();
                        for (var r = this.boundingSphere.center, o = 0, a = i.length; a > o; o += 3)t.set(i[o], i[o + 1], i[o + 2]), e.expandByPoint(t);
                        e.center(r);
                        for (var s = 0, o = 0, a = i.length; a > o; o += 3)t.set(i[o], i[o + 1], i[o + 2]), s = Math.max(s, r.distanceToSquared(t));
                        this.boundingSphere.radius = Math.sqrt(s), isNaN(this.boundingSphere.radius) && n.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')
                    }
                }
            }(), computeFaceNormals: function () {
            }, computeVertexNormals: function () {
                var e = this.attributes;
                if (e.position) {
                    var t = e.position.array;
                    if (void 0 === e.normal)this.addAttribute("normal", new n.BufferAttribute(new Float32Array(t.length), 3)); else for (var i = e.normal.array, r = 0, o = i.length; o > r; r++)i[r] = 0;
                    var a, s, h, i = e.normal.array, l = new n.Vector3, u = new n.Vector3, c = new n.Vector3, d = new n.Vector3, f = new n.Vector3;
                    if (e.index)for (var p = e.index.array, m = this.offsets.length > 0 ? this.offsets : [{
                        start: 0,
                        count: p.length,
                        index: 0
                    }], g = 0, v = m.length; v > g; ++g)for (var y = m[g].start, b = m[g].count, w = m[g].index, r = y, o = y + b; o > r; r += 3)a = 3 * (w + p[r]), s = 3 * (w + p[r + 1]), h = 3 * (w + p[r + 2]), l.fromArray(t, a), u.fromArray(t, s), c.fromArray(t, h), d.subVectors(c, u), f.subVectors(l, u), d.cross(f), i[a] += d.x, i[a + 1] += d.y, i[a + 2] += d.z, i[s] += d.x, i[s + 1] += d.y, i[s + 2] += d.z, i[h] += d.x, i[h + 1] += d.y, i[h + 2] += d.z; else for (var r = 0, o = t.length; o > r; r += 9)l.fromArray(t, r), u.fromArray(t, r + 3), c.fromArray(t, r + 6), d.subVectors(c, u), f.subVectors(l, u), d.cross(f), i[r] = d.x, i[r + 1] = d.y, i[r + 2] = d.z, i[r + 3] = d.x, i[r + 4] = d.y, i[r + 5] = d.z, i[r + 6] = d.x, i[r + 7] = d.y, i[r + 8] = d.z;
                    this.normalizeNormals(), e.normal.needsUpdate = !0
                }
            }, computeTangents: function () {
                function e(e, t, i) {
                    L.fromArray(r, 3 * e), k.fromArray(r, 3 * t), B.fromArray(r, 3 * i), R.fromArray(a, 2 * e), I.fromArray(a, 2 * t), F.fromArray(a, 2 * i), d = k.x - L.x, f = B.x - L.x, p = k.y - L.y, m = B.y - L.y, g = k.z - L.z, v = B.z - L.z, y = I.x - R.x, b = F.x - R.x, w = I.y - R.y, _ = F.y - R.y, x = 1 / (y * _ - b * w), D.set((_ * d - w * f) * x, (_ * p - w * m) * x, (_ * g - w * v) * x), O.set((y * f - b * d) * x, (y * m - b * p) * x, (y * v - b * g) * x), l[e].add(D), l[t].add(D), l[i].add(D), u[e].add(O), u[t].add(O), u[i].add(O)
                }

                function t(e) {
                    Z.fromArray(o, 3 * e), X.copy(Z), H = l[e], j.copy(H), j.sub(Z.multiplyScalar(Z.dot(H))).normalize(), Y.crossVectors(X, H), G = Y.dot(u[e]), W = 0 > G ? -1 : 1, h[4 * e] = j.x, h[4 * e + 1] = j.y, h[4 * e + 2] = j.z, h[4 * e + 3] = W
                }

                if (void 0 === this.attributes.index || void 0 === this.attributes.position || void 0 === this.attributes.normal || void 0 === this.attributes.uv)return void n.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");
                var i = this.attributes.index.array, r = this.attributes.position.array, o = this.attributes.normal.array, a = this.attributes.uv.array, s = r.length / 3;
                void 0 === this.attributes.tangent && this.addAttribute("tangent", new n.BufferAttribute(new Float32Array(4 * s), 4));
                for (var h = this.attributes.tangent.array, l = [], u = [], c = 0; s > c; c++)l[c] = new n.Vector3, u[c] = new n.Vector3;
                var d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C, P, L = new n.Vector3, k = new n.Vector3, B = new n.Vector3, R = new n.Vector2, I = new n.Vector2, F = new n.Vector2, D = new n.Vector3, O = new n.Vector3;
                0 === this.drawcalls.length && this.addDrawCall(0, i.length, 0);
                var N = this.drawcalls;
                for (M = 0, A = N.length; A > M; ++M) {
                    var U = N[M].start, z = N[M].count, V = N[M].index;
                    for (S = U, E = U + z; E > S; S += 3)T = V + i[S], C = V + i[S + 1], P = V + i[S + 2], e(T, C, P)
                }
                var W, H, G, j = new n.Vector3, Y = new n.Vector3, Z = new n.Vector3, X = new n.Vector3;
                for (M = 0, A = N.length; A > M; ++M) {
                    var U = N[M].start, z = N[M].count, V = N[M].index;
                    for (S = U, E = U + z; E > S; S += 3)T = V + i[S], C = V + i[S + 1], P = V + i[S + 2], t(T), t(C), t(P)
                }
            }, computeOffsets: function (e) {
                void 0 === e && (e = 65535);
                for (var t = this.attributes.index.array, i = this.attributes.position.array, r = t.length / 3, n = new Uint16Array(t.length), o = 0, a = 0, s = [{
                    start: 0,
                    count: 0,
                    index: 0
                }], h = s[0], l = 0, u = 0, c = new Int32Array(6), d = new Int32Array(i.length), f = new Int32Array(i.length), p = 0; p < i.length; p++)d[p] = -1, f[p] = -1;
                for (var m = 0; r > m; m++) {
                    u = 0;
                    for (var g = 0; 3 > g; g++) {
                        var v = t[3 * m + g];
                        -1 == d[v] ? (c[2 * g] = v, c[2 * g + 1] = -1, u++) : d[v] < h.index ? (c[2 * g] = v, c[2 * g + 1] = -1, l++) : (c[2 * g] = v, c[2 * g + 1] = d[v])
                    }
                    var y = a + u;
                    if (y > h.index + e) {
                        var b = {start: o, count: 0, index: a};
                        s.push(b), h = b;
                        for (var w = 0; 6 > w; w += 2) {
                            var _ = c[w + 1];
                            _ > -1 && _ < h.index && (c[w + 1] = -1)
                        }
                    }
                    for (var w = 0; 6 > w; w += 2) {
                        var v = c[w], _ = c[w + 1];
                        -1 === _ && (_ = a++), d[v] = _, f[_] = v, n[o++] = _ - h.index, h.count++
                    }
                }
                return this.reorderBuffers(n, f, a), this.offsets = s, this.drawcalls = s, s
            }, merge: function (e, t) {
                if (e instanceof n.BufferGeometry == !1)return void n.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", e);
                void 0 === t && (t = 0);
                var i = this.attributes;
                for (var r in i)if (void 0 !== e.attributes[r])for (var o = i[r], a = o.array, s = e.attributes[r], h = s.array, l = s.itemSize, u = 0, c = l * t; u < h.length; u++, c++)a[c] = h[u];
                return this
            }, normalizeNormals: function () {
                for (var e, t, i, r, n = this.attributes.normal.array, o = 0, a = n.length; a > o; o += 3)e = n[o], t = n[o + 1], i = n[o + 2], r = 1 / Math.sqrt(e * e + t * t + i * i), n[o] *= r, n[o + 1] *= r, n[o + 2] *= r
            }, reorderBuffers: function (e, t, i) {
                var r = {};
                for (var n in this.attributes)if ("index" != n) {
                    var o = this.attributes[n].array;
                    r[n] = new o.constructor(this.attributes[n].itemSize * i)
                }
                for (var a = 0; i > a; a++) {
                    var s = t[a];
                    for (var n in this.attributes)if ("index" != n)for (var h = this.attributes[n].array, l = this.attributes[n].itemSize, u = r[n], c = 0; l > c; c++)u[a * l + c] = h[s * l + c]
                }
                this.attributes.index.array = e;
                for (var n in this.attributes)"index" != n && (this.attributes[n].array = r[n], this.attributes[n].numItems = this.attributes[n].itemSize * i)
            }, toJSON: function () {
                var e = {
                    metadata: {version: 4, type: "BufferGeometry", generator: "BufferGeometryExporter"},
                    uuid: this.uuid,
                    type: this.type,
                    data: {attributes: {}}
                }, t = this.attributes, i = this.offsets, r = this.boundingSphere;
                for (var n in t) {
                    var o = t[n], a = Array.prototype.slice.call(o.array);
                    e.data.attributes[n] = {itemSize: o.itemSize, type: o.array.constructor.name, array: a}
                }
                return i.length > 0 && (e.data.offsets = JSON.parse(JSON.stringify(i))), null !== r && (e.data.boundingSphere = {
                    center: r.center.toArray(),
                    radius: r.radius
                }), e
            }, clone: function () {
                var e = new n.BufferGeometry;
                for (var t in this.attributes) {
                    var i = this.attributes[t];
                    e.addAttribute(t, i.clone())
                }
                for (var r = 0, o = this.offsets.length; o > r; r++) {
                    var a = this.offsets[r];
                    e.offsets.push({start: a.start, index: a.index, count: a.count})
                }
                return e
            }, dispose: function () {
                this.dispatchEvent({type: "dispose"})
            }
        },n.EventDispatcher.prototype.apply(n.BufferGeometry.prototype),n.Geometry = function () {
            Object.defineProperty(this, "id", {value: n.GeometryIdCount++}), this.uuid = n.Math.generateUUID(), this.name = "", this.type = "Geometry", this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [[]], this.morphTargets = [], this.morphColors = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.hasTangents = !1, this.dynamic = !0, this.verticesNeedUpdate = !1, this.elementsNeedUpdate = !1, this.uvsNeedUpdate = !1, this.normalsNeedUpdate = !1, this.tangentsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.lineDistancesNeedUpdate = !1, this.groupsNeedUpdate = !1
        },n.Geometry.prototype = {
            constructor: n.Geometry, applyMatrix: function (e) {
                for (var t = (new n.Matrix3).getNormalMatrix(e), i = 0, r = this.vertices.length; r > i; i++) {
                    var o = this.vertices[i];
                    o.applyMatrix4(e)
                }
                for (var i = 0, r = this.faces.length; r > i; i++) {
                    var a = this.faces[i];
                    a.normal.applyMatrix3(t).normalize();
                    for (var s = 0, h = a.vertexNormals.length; h > s; s++)a.vertexNormals[s].applyMatrix3(t).normalize()
                }
                null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this.verticesNeedUpdate = !0, this.normalsNeedUpdate = !0
            }, fromBufferGeometry: function (e) {
                for (var t = this, i = e.attributes, r = i.position.array, o = void 0 !== i.index ? i.index.array : void 0, a = void 0 !== i.normal ? i.normal.array : void 0, s = void 0 !== i.color ? i.color.array : void 0, h = void 0 !== i.uv ? i.uv.array : void 0, l = [], u = [], c = 0, d = 0; c < r.length; c += 3, d += 2)t.vertices.push(new n.Vector3(r[c], r[c + 1], r[c + 2])), void 0 !== a && l.push(new n.Vector3(a[c], a[c + 1], a[c + 2])), void 0 !== s && t.colors.push(new n.Color(s[c], s[c + 1], s[c + 2])), void 0 !== h && u.push(new n.Vector2(h[d], h[d + 1]));
                var f = function (e, i, r) {
                    var o = void 0 !== a ? [l[e].clone(), l[i].clone(), l[r].clone()] : [], c = void 0 !== s ? [t.colors[e].clone(), t.colors[i].clone(), t.colors[r].clone()] : [];
                    t.faces.push(new n.Face3(e, i, r, o, c)), void 0 !== h && t.faceVertexUvs[0].push([u[e].clone(), u[i].clone(), u[r].clone()])
                };
                if (void 0 !== o) {
                    var p = e.drawcalls;
                    if (p.length > 0)for (var c = 0; c < p.length; c++)for (var m = p[c], g = m.start, v = m.count, y = m.index, d = g, b = g + v; b > d; d += 3)f(y + o[d], y + o[d + 1], y + o[d + 2]); else for (var c = 0; c < o.length; c += 3)f(o[c], o[c + 1], o[c + 2])
                } else for (var c = 0; c < r.length / 3; c += 3)f(c, c + 1, c + 2);
                return this.computeFaceNormals(), null !== e.boundingBox && (this.boundingBox = e.boundingBox.clone()), null !== e.boundingSphere && (this.boundingSphere = e.boundingSphere.clone()), this
            }, center: function () {
                this.computeBoundingBox();
                var e = this.boundingBox.center().negate();
                return this.applyMatrix((new n.Matrix4).setPosition(e)), e
            }, computeFaceNormals: function () {
                for (var e = new n.Vector3, t = new n.Vector3, i = 0, r = this.faces.length; r > i; i++) {
                    var o = this.faces[i], a = this.vertices[o.a], s = this.vertices[o.b], h = this.vertices[o.c];
                    e.subVectors(h, s), t.subVectors(a, s), e.cross(t), e.normalize(), o.normal.copy(e)
                }
            }, computeVertexNormals: function (e) {
                var t, i, r, o, a, s;
                for (s = new Array(this.vertices.length), t = 0, i = this.vertices.length; i > t; t++)s[t] = new n.Vector3;
                if (e) {
                    var h, l, u, c = new n.Vector3, d = new n.Vector3;
                    for (r = 0, o = this.faces.length; o > r; r++)a = this.faces[r], h = this.vertices[a.a], l = this.vertices[a.b], u = this.vertices[a.c], c.subVectors(u, l), d.subVectors(h, l), c.cross(d), s[a.a].add(c), s[a.b].add(c), s[a.c].add(c)
                } else for (r = 0, o = this.faces.length; o > r; r++)a = this.faces[r], s[a.a].add(a.normal), s[a.b].add(a.normal), s[a.c].add(a.normal);
                for (t = 0, i = this.vertices.length; i > t; t++)s[t].normalize();
                for (r = 0, o = this.faces.length; o > r; r++)a = this.faces[r], a.vertexNormals[0] = s[a.a].clone(), a.vertexNormals[1] = s[a.b].clone(), a.vertexNormals[2] = s[a.c].clone()
            }, computeMorphNormals: function () {
                var e, t, i, r, o;
                for (i = 0, r = this.faces.length; r > i; i++)for (o = this.faces[i], o.__originalFaceNormal ? o.__originalFaceNormal.copy(o.normal) : o.__originalFaceNormal = o.normal.clone(), o.__originalVertexNormals || (o.__originalVertexNormals = []), e = 0, t = o.vertexNormals.length; t > e; e++)o.__originalVertexNormals[e] ? o.__originalVertexNormals[e].copy(o.vertexNormals[e]) : o.__originalVertexNormals[e] = o.vertexNormals[e].clone();
                var a = new n.Geometry;
                for (a.faces = this.faces, e = 0, t = this.morphTargets.length; t > e; e++) {
                    if (!this.morphNormals[e]) {
                        this.morphNormals[e] = {}, this.morphNormals[e].faceNormals = [], this.morphNormals[e].vertexNormals = [];
                        var s, h, l = this.morphNormals[e].faceNormals, u = this.morphNormals[e].vertexNormals;
                        for (i = 0, r = this.faces.length; r > i; i++)s = new n.Vector3, h = {
                            a: new n.Vector3,
                            b: new n.Vector3,
                            c: new n.Vector3
                        }, l.push(s), u.push(h)
                    }
                    var c = this.morphNormals[e];
                    a.vertices = this.morphTargets[e].vertices, a.computeFaceNormals(), a.computeVertexNormals();
                    var s, h;
                    for (i = 0, r = this.faces.length; r > i; i++)o = this.faces[i], s = c.faceNormals[i], h = c.vertexNormals[i], s.copy(o.normal), h.a.copy(o.vertexNormals[0]), h.b.copy(o.vertexNormals[1]), h.c.copy(o.vertexNormals[2])
                }
                for (i = 0, r = this.faces.length; r > i; i++)o = this.faces[i], o.normal = o.__originalFaceNormal, o.vertexNormals = o.__originalVertexNormals
            }, computeTangents: function () {
                function e(e, t, i, r, n, o, a) {
                    u = e.vertices[t], c = e.vertices[i], d = e.vertices[r], f = l[n], p = l[o], m = l[a], g = c.x - u.x, v = d.x - u.x, y = c.y - u.y, b = d.y - u.y, w = c.z - u.z, _ = d.z - u.z, x = p.x - f.x, S = m.x - f.x, E = p.y - f.y, M = m.y - f.y, A = 1 / (x * M - S * E), B.set((M * g - E * v) * A, (M * y - E * b) * A, (M * w - E * _) * A), R.set((x * v - S * g) * A, (x * b - S * y) * A, (x * _ - S * w) * A), L[t].add(B), L[i].add(B), L[r].add(B), k[t].add(R), k[i].add(R), k[r].add(R)
                }

                var t, i, r, o, a, s, h, l, u, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C, P, L = [], k = [], B = new n.Vector3, R = new n.Vector3, I = new n.Vector3, F = new n.Vector3, D = new n.Vector3;
                for (r = 0, o = this.vertices.length; o > r; r++)L[r] = new n.Vector3, k[r] = new n.Vector3;
                for (t = 0, i = this.faces.length; i > t; t++)h = this.faces[t], l = this.faceVertexUvs[0][t], e(this, h.a, h.b, h.c, 0, 1, 2);
                var O = ["a", "b", "c", "d"];
                for (t = 0, i = this.faces.length; i > t; t++)for (h = this.faces[t], a = 0; a < Math.min(h.vertexNormals.length, 3); a++)D.copy(h.vertexNormals[a]), s = h[O[a]], T = L[s], I.copy(T), I.sub(D.multiplyScalar(D.dot(T))).normalize(), F.crossVectors(h.vertexNormals[a], T), C = F.dot(k[s]), P = 0 > C ? -1 : 1, h.vertexTangents[a] = new n.Vector4(I.x, I.y, I.z, P);
                this.hasTangents = !0
            }, computeLineDistances: function () {
                for (var e = 0, t = this.vertices, i = 0, r = t.length; r > i; i++)i > 0 && (e += t[i].distanceTo(t[i - 1])), this.lineDistances[i] = e
            }, computeBoundingBox: function () {
                null === this.boundingBox && (this.boundingBox = new n.Box3), this.boundingBox.setFromPoints(this.vertices)
            }, computeBoundingSphere: function () {
                null === this.boundingSphere && (this.boundingSphere = new n.Sphere), this.boundingSphere.setFromPoints(this.vertices)
            }, merge: function (e, t, i) {
                if (e instanceof n.Geometry == !1)return void n.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.", e);
                var r, o = this.vertices.length, a = this.vertices, s = e.vertices, h = this.faces, l = e.faces, u = this.faceVertexUvs[0], c = e.faceVertexUvs[0];
                void 0 === i && (i = 0), void 0 !== t && (r = (new n.Matrix3).getNormalMatrix(t));
                for (var d = 0, f = s.length; f > d; d++) {
                    var p = s[d], m = p.clone();
                    void 0 !== t && m.applyMatrix4(t), a.push(m)
                }
                for (d = 0, f = l.length; f > d; d++) {
                    var g, v, y, b = l[d], w = b.vertexNormals, _ = b.vertexColors;
                    g = new n.Face3(b.a + o, b.b + o, b.c + o), g.normal.copy(b.normal), void 0 !== r && g.normal.applyMatrix3(r).normalize();
                    for (var x = 0, S = w.length; S > x; x++)v = w[x].clone(), void 0 !== r && v.applyMatrix3(r).normalize(), g.vertexNormals.push(v);
                    g.color.copy(b.color);
                    for (var x = 0, S = _.length; S > x; x++)y = _[x], g.vertexColors.push(y.clone());
                    g.materialIndex = b.materialIndex + i, h.push(g)
                }
                for (d = 0, f = c.length; f > d; d++) {
                    var E = c[d], M = [];
                    if (void 0 !== E) {
                        for (var x = 0, S = E.length; S > x; x++)M.push(E[x].clone());
                        u.push(M)
                    }
                }
            }, mergeMesh: function (e) {
                return e instanceof n.Mesh == !1 ? void n.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.", e) : (e.matrixAutoUpdate && e.updateMatrix(), void this.merge(e.geometry, e.matrix))
            }, mergeVertices: function () {
                var e, t, i, r, n, o, a, s, h = {}, l = [], u = [], c = 4, d = Math.pow(10, c);
                for (i = 0, r = this.vertices.length; r > i; i++)e = this.vertices[i], t = Math.round(e.x * d) + "_" + Math.round(e.y * d) + "_" + Math.round(e.z * d), void 0 === h[t] ? (h[t] = i, l.push(this.vertices[i]), u[i] = l.length - 1) : u[i] = u[h[t]];
                var f = [];
                for (i = 0, r = this.faces.length; r > i; i++) {
                    n = this.faces[i], n.a = u[n.a], n.b = u[n.b], n.c = u[n.c], o = [n.a, n.b, n.c];
                    for (var p = -1, m = 0; 3 > m; m++)if (o[m] == o[(m + 1) % 3]) {
                        p = m, f.push(i);
                        break
                    }
                }
                for (i = f.length - 1; i >= 0; i--) {
                    var g = f[i];
                    for (this.faces.splice(g, 1), a = 0, s = this.faceVertexUvs.length; s > a; a++)this.faceVertexUvs[a].splice(g, 1)
                }
                var v = this.vertices.length - l.length;
                return this.vertices = l, v
            }, toJSON: function () {
                function e(e, t, i) {
                    return i ? e | 1 << t : e & ~(1 << t)
                }

                function t(e) {
                    var t = e.x.toString() + e.y.toString() + e.z.toString();
                    return void 0 !== d[t] ? d[t] : (d[t] = c.length / 3, c.push(e.x, e.y, e.z), d[t])
                }

                function i(e) {
                    var t = e.r.toString() + e.g.toString() + e.b.toString();
                    return void 0 !== p[t] ? p[t] : (p[t] = f.length, f.push(e.getHex()), p[t])
                }

                function r(e) {
                    var t = e.x.toString() + e.y.toString();
                    return void 0 !== g[t] ? g[t] : (g[t] = m.length / 2, m.push(e.x, e.y), g[t])
                }

                var n = {
                    metadata: {version: 4, type: "BufferGeometry", generator: "BufferGeometryExporter"},
                    uuid: this.uuid,
                    type: this.type
                };
                if ("" !== this.name && (n.name = this.name), void 0 !== this.parameters) {
                    var o = this.parameters;
                    for (var a in o)void 0 !== o[a] && (n[a] = o[a]);
                    return n
                }
                for (var s = [], h = 0; h < this.vertices.length; h++) {
                    var l = this.vertices[h];
                    s.push(l.x, l.y, l.z)
                }
                for (var u = [], c = [], d = {}, f = [], p = {}, m = [], g = {}, h = 0; h < this.faces.length; h++) {
                    var v = this.faces[h], y = !1, b = !1, w = void 0 !== this.faceVertexUvs[0][h], _ = v.normal.length() > 0, x = v.vertexNormals.length > 0, S = 1 !== v.color.r || 1 !== v.color.g || 1 !== v.color.b, E = v.vertexColors.length > 0, M = 0;
                    if (M = e(M, 0, 0), M = e(M, 1, y), M = e(M, 2, b), M = e(M, 3, w), M = e(M, 4, _), M = e(M, 5, x), M = e(M, 6, S), M = e(M, 7, E), u.push(M), u.push(v.a, v.b, v.c), w) {
                        var A = this.faceVertexUvs[0][h];
                        u.push(r(A[0]), r(A[1]), r(A[2]))
                    }
                    if (_ && u.push(t(v.normal)), x) {
                        var T = v.vertexNormals;
                        u.push(t(T[0]), t(T[1]), t(T[2]))
                    }
                    if (S && u.push(i(v.color)), E) {
                        var C = v.vertexColors;
                        u.push(i(C[0]), i(C[1]), i(C[2]))
                    }
                }
                return n.data = {}, n.data.vertices = s, n.data.normals = c, f.length > 0 && (n.data.colors = f), m.length > 0 && (n.data.uvs = [m]), n.data.faces = u, n
            }, clone: function () {
                for (var e = new n.Geometry, t = this.vertices, i = 0, r = t.length; r > i; i++)e.vertices.push(t[i].clone());
                for (var o = this.faces, i = 0, r = o.length; r > i; i++)e.faces.push(o[i].clone());
                for (var i = 0, r = this.faceVertexUvs.length; r > i; i++) {
                    var a = this.faceVertexUvs[i];
                    void 0 === e.faceVertexUvs[i] && (e.faceVertexUvs[i] = []);
                    for (var s = 0, h = a.length; h > s; s++) {
                        for (var l = a[s], u = [], c = 0, d = l.length; d > c; c++) {
                            var f = l[c];
                            u.push(f.clone())
                        }
                        e.faceVertexUvs[i].push(u)
                    }
                }
                return e
            }, dispose: function () {
                this.dispatchEvent({type: "dispose"})
            }
        },n.EventDispatcher.prototype.apply(n.Geometry.prototype),n.GeometryIdCount = 0,n.Camera = function () {
            n.Object3D.call(this), this.type = "Camera", this.matrixWorldInverse = new n.Matrix4, this.projectionMatrix = new n.Matrix4
        },n.Camera.prototype = Object.create(n.Object3D.prototype),n.Camera.prototype.constructor = n.Camera,n.Camera.prototype.getWorldDirection = function () {
            var e = new n.Quaternion;
            return function (t) {
                var i = t || new n.Vector3;
                return this.getWorldQuaternion(e), i.set(0, 0, -1).applyQuaternion(e)
            }
        }(),n.Camera.prototype.lookAt = function () {
            var e = new n.Matrix4;
            return function (t) {
                e.lookAt(this.position, t, this.up), this.quaternion.setFromRotationMatrix(e)
            }
        }(),n.Camera.prototype.clone = function (e) {
            return void 0 === e && (e = new n.Camera), n.Object3D.prototype.clone.call(this, e), e.matrixWorldInverse.copy(this.matrixWorldInverse), e.projectionMatrix.copy(this.projectionMatrix), e
        },n.CubeCamera = function (e, t, i) {
            n.Object3D.call(this), this.type = "CubeCamera";
            var r = 90, o = 1, a = new n.PerspectiveCamera(r, o, e, t);
            a.up.set(0, -1, 0), a.lookAt(new n.Vector3(1, 0, 0)), this.add(a);
            var s = new n.PerspectiveCamera(r, o, e, t);
            s.up.set(0, -1, 0), s.lookAt(new n.Vector3(-1, 0, 0)), this.add(s);
            var h = new n.PerspectiveCamera(r, o, e, t);
            h.up.set(0, 0, 1), h.lookAt(new n.Vector3(0, 1, 0)), this.add(h);
            var l = new n.PerspectiveCamera(r, o, e, t);
            l.up.set(0, 0, -1), l.lookAt(new n.Vector3(0, -1, 0)), this.add(l);
            var u = new n.PerspectiveCamera(r, o, e, t);
            u.up.set(0, -1, 0), u.lookAt(new n.Vector3(0, 0, 1)), this.add(u);
            var c = new n.PerspectiveCamera(r, o, e, t);
            c.up.set(0, -1, 0), c.lookAt(new n.Vector3(0, 0, -1)), this.add(c), this.renderTarget = new n.WebGLRenderTargetCube(i, i, {
                format: n.RGBFormat,
                magFilter: n.LinearFilter,
                minFilter: n.LinearFilter
            }), this.updateCubeMap = function (e, t) {
                var i = this.renderTarget, r = i.generateMipmaps;
                i.generateMipmaps = !1, i.activeCubeFace = 0, e.render(t, a, i), i.activeCubeFace = 1, e.render(t, s, i), i.activeCubeFace = 2, e.render(t, h, i), i.activeCubeFace = 3, e.render(t, l, i), i.activeCubeFace = 4, e.render(t, u, i), i.generateMipmaps = r, i.activeCubeFace = 5, e.render(t, c, i)
            }
        },n.CubeCamera.prototype = Object.create(n.Object3D.prototype),n.CubeCamera.prototype.constructor = n.CubeCamera,n.OrthographicCamera = function (e, t, i, r, o, a) {
            n.Camera.call(this), this.type = "OrthographicCamera", this.zoom = 1, this.left = e, this.right = t, this.top = i, this.bottom = r, this.near = void 0 !== o ? o : .1, this.far = void 0 !== a ? a : 2e3, this.updateProjectionMatrix()
        },n.OrthographicCamera.prototype = Object.create(n.Camera.prototype),n.OrthographicCamera.prototype.constructor = n.OrthographicCamera,n.OrthographicCamera.prototype.updateProjectionMatrix = function () {
            var e = (this.right - this.left) / (2 * this.zoom), t = (this.top - this.bottom) / (2 * this.zoom), i = (this.right + this.left) / 2, r = (this.top + this.bottom) / 2;
            this.projectionMatrix.makeOrthographic(i - e, i + e, r + t, r - t, this.near, this.far)
        },n.OrthographicCamera.prototype.clone = function () {
            var e = new n.OrthographicCamera;
            return n.Camera.prototype.clone.call(this, e), e.zoom = this.zoom, e.left = this.left, e.right = this.right, e.top = this.top, e.bottom = this.bottom, e.near = this.near, e.far = this.far, e.projectionMatrix.copy(this.projectionMatrix), e
        },n.PerspectiveCamera = function (e, t, i, r) {
            n.Camera.call(this), this.type = "PerspectiveCamera", this.zoom = 1, this.fov = void 0 !== e ? e : 50, this.aspect = void 0 !== t ? t : 1, this.near = void 0 !== i ? i : .1, this.far = void 0 !== r ? r : 2e3, this.updateProjectionMatrix()
        },n.PerspectiveCamera.prototype = Object.create(n.Camera.prototype),n.PerspectiveCamera.prototype.constructor = n.PerspectiveCamera,n.PerspectiveCamera.prototype.setLens = function (e, t) {
            void 0 === t && (t = 24), this.fov = 2 * n.Math.radToDeg(Math.atan(t / (2 * e))), this.updateProjectionMatrix()
        },n.PerspectiveCamera.prototype.setViewOffset = function (e, t, i, r, n, o) {
            this.fullWidth = e, this.fullHeight = t, this.x = i, this.y = r, this.width = n, this.height = o, this.updateProjectionMatrix()
        },n.PerspectiveCamera.prototype.updateProjectionMatrix = function () {
            var e = n.Math.radToDeg(2 * Math.atan(Math.tan(.5 * n.Math.degToRad(this.fov)) / this.zoom));
            if (this.fullWidth) {
                var t = this.fullWidth / this.fullHeight, i = Math.tan(n.Math.degToRad(.5 * e)) * this.near, r = -i, o = t * r, a = t * i, s = Math.abs(a - o), h = Math.abs(i - r);
                this.projectionMatrix.makeFrustum(o + this.x * s / this.fullWidth, o + (this.x + this.width) * s / this.fullWidth, i - (this.y + this.height) * h / this.fullHeight, i - this.y * h / this.fullHeight, this.near, this.far)
            } else this.projectionMatrix.makePerspective(e, this.aspect, this.near, this.far)
        },n.PerspectiveCamera.prototype.clone = function () {
            var e = new n.PerspectiveCamera;
            return n.Camera.prototype.clone.call(this, e), e.zoom = this.zoom, e.fov = this.fov, e.aspect = this.aspect, e.near = this.near, e.far = this.far, e.projectionMatrix.copy(this.projectionMatrix), e
        },n.Light = function (e) {
            n.Object3D.call(this), this.type = "Light", this.color = new n.Color(e)
        },n.Light.prototype = Object.create(n.Object3D.prototype),n.Light.prototype.constructor = n.Light,n.Light.prototype.clone = function (e) {
            return void 0 === e && (e = new n.Light), n.Object3D.prototype.clone.call(this, e), e.color.copy(this.color), e
        },n.AmbientLight = function (e) {
            n.Light.call(this, e), this.type = "AmbientLight"
        },n.AmbientLight.prototype = Object.create(n.Light.prototype),n.AmbientLight.prototype.constructor = n.AmbientLight,n.AmbientLight.prototype.clone = function () {
            var e = new n.AmbientLight;
            return n.Light.prototype.clone.call(this, e), e
        },n.AreaLight = function (e, t) {
            n.Light.call(this, e), this.type = "AreaLight", this.normal = new n.Vector3(0, -1, 0), this.right = new n.Vector3(1, 0, 0), this.intensity = void 0 !== t ? t : 1, this.width = 1, this.height = 1, this.constantAttenuation = 1.5, this.linearAttenuation = .5, this.quadraticAttenuation = .1
        },n.AreaLight.prototype = Object.create(n.Light.prototype),n.AreaLight.prototype.constructor = n.AreaLight,n.DirectionalLight = function (e, t) {
            n.Light.call(this, e), this.type = "DirectionalLight", this.position.set(0, 1, 0), this.target = new n.Object3D, this.intensity = void 0 !== t ? t : 1, this.castShadow = !1, this.onlyShadow = !1, this.shadowCameraNear = 50, this.shadowCameraFar = 5e3, this.shadowCameraLeft = -500, this.shadowCameraRight = 500, this.shadowCameraTop = 500, this.shadowCameraBottom = -500, this.shadowCameraVisible = !1, this.shadowBias = 0, this.shadowDarkness = .5, this.shadowMapWidth = 512, this.shadowMapHeight = 512, this.shadowCascade = !1, this.shadowCascadeOffset = new n.Vector3(0, 0, -1e3), this.shadowCascadeCount = 2, this.shadowCascadeBias = [0, 0, 0], this.shadowCascadeWidth = [512, 512, 512], this.shadowCascadeHeight = [512, 512, 512], this.shadowCascadeNearZ = [-1, .99, .998], this.shadowCascadeFarZ = [.99, .998, 1], this.shadowCascadeArray = [], this.shadowMap = null, this.shadowMapSize = null, this.shadowCamera = null, this.shadowMatrix = null
        },n.DirectionalLight.prototype = Object.create(n.Light.prototype),n.DirectionalLight.prototype.constructor = n.DirectionalLight,n.DirectionalLight.prototype.clone = function () {
            var e = new n.DirectionalLight;
            return n.Light.prototype.clone.call(this, e), e.target = this.target.clone(), e.intensity = this.intensity, e.castShadow = this.castShadow, e.onlyShadow = this.onlyShadow, e.shadowCameraNear = this.shadowCameraNear, e.shadowCameraFar = this.shadowCameraFar, e.shadowCameraLeft = this.shadowCameraLeft, e.shadowCameraRight = this.shadowCameraRight, e.shadowCameraTop = this.shadowCameraTop, e.shadowCameraBottom = this.shadowCameraBottom, e.shadowCameraVisible = this.shadowCameraVisible, e.shadowBias = this.shadowBias, e.shadowDarkness = this.shadowDarkness, e.shadowMapWidth = this.shadowMapWidth, e.shadowMapHeight = this.shadowMapHeight, e.shadowCascade = this.shadowCascade, e.shadowCascadeOffset.copy(this.shadowCascadeOffset), e.shadowCascadeCount = this.shadowCascadeCount, e.shadowCascadeBias = this.shadowCascadeBias.slice(0), e.shadowCascadeWidth = this.shadowCascadeWidth.slice(0), e.shadowCascadeHeight = this.shadowCascadeHeight.slice(0), e.shadowCascadeNearZ = this.shadowCascadeNearZ.slice(0), e.shadowCascadeFarZ = this.shadowCascadeFarZ.slice(0), e
        },n.HemisphereLight = function (e, t, i) {
            n.Light.call(this, e), this.type = "HemisphereLight", this.position.set(0, 100, 0), this.groundColor = new n.Color(t), this.intensity = void 0 !== i ? i : 1
        },n.HemisphereLight.prototype = Object.create(n.Light.prototype),n.HemisphereLight.prototype.constructor = n.HemisphereLight,n.HemisphereLight.prototype.clone = function () {
            var e = new n.HemisphereLight;
            return n.Light.prototype.clone.call(this, e), e.groundColor.copy(this.groundColor), e.intensity = this.intensity, e
        },n.PointLight = function (e, t, i, r) {
            n.Light.call(this, e), this.type = "PointLight", this.intensity = void 0 !== t ? t : 1, this.distance = void 0 !== i ? i : 0, this.decay = void 0 !== r ? r : 1
        },n.PointLight.prototype = Object.create(n.Light.prototype),n.PointLight.prototype.constructor = n.PointLight,n.PointLight.prototype.clone = function () {
            var e = new n.PointLight;
            return n.Light.prototype.clone.call(this, e), e.intensity = this.intensity, e.distance = this.distance, e.decay = this.decay, e
        },n.SpotLight = function (e, t, i, r, o, a) {
            n.Light.call(this, e), this.type = "SpotLight", this.position.set(0, 1, 0), this.target = new n.Object3D, this.intensity = void 0 !== t ? t : 1, this.distance = void 0 !== i ? i : 0, this.angle = void 0 !== r ? r : Math.PI / 3, this.exponent = void 0 !== o ? o : 10, this.decay = void 0 !== a ? a : 1, this.castShadow = !1, this.onlyShadow = !1, this.shadowCameraNear = 50, this.shadowCameraFar = 5e3, this.shadowCameraFov = 50, this.shadowCameraVisible = !1, this.shadowBias = 0, this.shadowDarkness = .5, this.shadowMapWidth = 512, this.shadowMapHeight = 512, this.shadowMap = null, this.shadowMapSize = null, this.shadowCamera = null, this.shadowMatrix = null
        },n.SpotLight.prototype = Object.create(n.Light.prototype),n.SpotLight.prototype.constructor = n.SpotLight,n.SpotLight.prototype.clone = function () {
            var e = new n.SpotLight;
            return n.Light.prototype.clone.call(this, e), e.target = this.target.clone(), e.intensity = this.intensity, e.distance = this.distance, e.angle = this.angle, e.exponent = this.exponent, e.decay = this.decay, e.castShadow = this.castShadow, e.onlyShadow = this.onlyShadow, e.shadowCameraNear = this.shadowCameraNear, e.shadowCameraFar = this.shadowCameraFar, e.shadowCameraFov = this.shadowCameraFov, e.shadowCameraVisible = this.shadowCameraVisible, e.shadowBias = this.shadowBias, e.shadowDarkness = this.shadowDarkness, e.shadowMapWidth = this.shadowMapWidth, e.shadowMapHeight = this.shadowMapHeight, e
        },n.Cache = {
            files: {}, add: function (e, t) {
                this.files[e] = t
            }, get: function (e) {
                return this.files[e]
            }, remove: function (e) {
                delete this.files[e]
            }, clear: function () {
                this.files = {}
            }
        },n.Loader = function (e) {
            this.showStatus = e, this.statusDomElement = e ? n.Loader.prototype.addStatusElement() : null, this.imageLoader = new n.ImageLoader, this.onLoadStart = function () {
            }, this.onLoadProgress = function () {
            }, this.onLoadComplete = function () {
            }
        },n.Loader.prototype = {
            constructor: n.Loader, crossOrigin: void 0, addStatusElement: function () {
                var e = document.createElement("div");
                return e.style.position = "absolute", e.style.right = "0px", e.style.top = "0px", e.style.fontSize = "0.8em", e.style.textAlign = "left", e.style.background = "rgba(0,0,0,0.25)", e.style.color = "#fff", e.style.width = "120px", e.style.padding = "0.5em 0.5em 0.5em 0.5em", e.style.zIndex = 1e3, e.innerHTML = "Loading ...", e
            }, updateProgress: function (e) {
                var t = "Loaded ";
                t += e.total ? (100 * e.loaded / e.total).toFixed(0) + "%" : (e.loaded / 1024).toFixed(2) + " KB", this.statusDomElement.innerHTML = t
            }, extractUrlBase: function (e) {
                var t = e.split("/");
                return 1 === t.length ? "./" : (t.pop(), t.join("/") + "/")
            }, initMaterials: function (e, t) {
                for (var i = [], r = 0; r < e.length; ++r)i[r] = this.createMaterial(e[r], t);
                return i
            }, needsTangents: function (e) {
                for (var t = 0, i = e.length; i > t; t++) {
                    var r = e[t];
                    if (r instanceof n.ShaderMaterial)return !0
                }
                return !1
            }, createMaterial: function (e, t) {
                function i(e) {
                    var t = Math.log(e) / Math.LN2;
                    return Math.pow(2, Math.round(t))
                }

                function r(e, r, o, s, h, l, u) {
                    var c, d = t + o, f = n.Loader.Handlers.get(d);
                    if (null !== f ? c = f.load(d) : (c = new n.Texture, f = a.imageLoader, f.crossOrigin = a.crossOrigin, f.load(d, function (e) {
                            if (n.Math.isPowerOfTwo(e.width) === !1 || n.Math.isPowerOfTwo(e.height) === !1) {
                                var t = i(e.width), r = i(e.height), o = document.createElement("canvas");
                                o.width = t, o.height = r;
                                var a = o.getContext("2d");
                                a.drawImage(e, 0, 0, t, r), c.image = o
                            } else c.image = e;
                            c.needsUpdate = !0
                        })), c.sourceFile = o, s && (c.repeat.set(s[0], s[1]), 1 !== s[0] && (c.wrapS = n.RepeatWrapping), 1 !== s[1] && (c.wrapT = n.RepeatWrapping)), h && c.offset.set(h[0], h[1]), l) {
                        var p = {repeat: n.RepeatWrapping, mirror: n.MirroredRepeatWrapping};
                        void 0 !== p[l[0]] && (c.wrapS = p[l[0]]), void 0 !== p[l[1]] && (c.wrapT = p[l[1]])
                    }
                    u && (c.anisotropy = u), e[r] = c
                }

                function o(e) {
                    return (255 * e[0] << 16) + (255 * e[1] << 8) + 255 * e[2]
                }

                var a = this, s = "MeshLambertMaterial", h = {
                    color: 15658734,
                    opacity: 1,
                    map: null,
                    lightMap: null,
                    normalMap: null,
                    bumpMap: null,
                    wireframe: !1
                };
                if (e.shading) {
                    var l = e.shading.toLowerCase();
                    "phong" === l ? s = "MeshPhongMaterial" : "basic" === l && (s = "MeshBasicMaterial")
                }
                void 0 !== e.blending && void 0 !== n[e.blending] && (h.blending = n[e.blending]), void 0 !== e.transparent && (h.transparent = e.transparent), void 0 !== e.opacity && e.opacity < 1 && (h.transparent = !0), void 0 !== e.depthTest && (h.depthTest = e.depthTest), void 0 !== e.depthWrite && (h.depthWrite = e.depthWrite), void 0 !== e.visible && (h.visible = e.visible), void 0 !== e.flipSided && (h.side = n.BackSide), void 0 !== e.doubleSided && (h.side = n.DoubleSide), void 0 !== e.wireframe && (h.wireframe = e.wireframe), void 0 !== e.vertexColors && ("face" === e.vertexColors ? h.vertexColors = n.FaceColors : e.vertexColors && (h.vertexColors = n.VertexColors)), e.colorDiffuse ? h.color = o(e.colorDiffuse) : e.DbgColor && (h.color = e.DbgColor), e.colorSpecular && (h.specular = o(e.colorSpecular)), e.colorEmissive && (h.emissive = o(e.colorEmissive)), void 0 !== e.transparency && (console.warn("THREE.Loader: transparency has been renamed to opacity"), e.opacity = e.transparency), void 0 !== e.opacity && (h.opacity = e.opacity), e.specularCoef && (h.shininess = e.specularCoef), e.mapDiffuse && t && r(h, "map", e.mapDiffuse, e.mapDiffuseRepeat, e.mapDiffuseOffset, e.mapDiffuseWrap, e.mapDiffuseAnisotropy), e.mapLight && t && r(h, "lightMap", e.mapLight, e.mapLightRepeat, e.mapLightOffset, e.mapLightWrap, e.mapLightAnisotropy), e.mapBump && t && r(h, "bumpMap", e.mapBump, e.mapBumpRepeat, e.mapBumpOffset, e.mapBumpWrap, e.mapBumpAnisotropy), e.mapNormal && t && r(h, "normalMap", e.mapNormal, e.mapNormalRepeat, e.mapNormalOffset, e.mapNormalWrap, e.mapNormalAnisotropy), e.mapSpecular && t && r(h, "specularMap", e.mapSpecular, e.mapSpecularRepeat, e.mapSpecularOffset, e.mapSpecularWrap, e.mapSpecularAnisotropy), e.mapAlpha && t && r(h, "alphaMap", e.mapAlpha, e.mapAlphaRepeat, e.mapAlphaOffset, e.mapAlphaWrap, e.mapAlphaAnisotropy), e.mapBumpScale && (h.bumpScale = e.mapBumpScale), e.mapNormalFactor && (h.normalScale = new n.Vector2(e.mapNormalFactor, e.mapNormalFactor));
                var u = new n[s](h);
                return void 0 !== e.DbgName && (u.name = e.DbgName), u
            }
        },n.Loader.Handlers = {
            handlers: [], add: function (e, t) {
                this.handlers.push(e, t)
            }, get: function (e) {
                for (var t = 0, i = this.handlers.length; i > t; t += 2) {
                    var r = this.handlers[t], n = this.handlers[t + 1];
                    if (r.test(e))return n
                }
                return null
            }
        },n.XHRLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager
        },n.XHRLoader.prototype = {
            constructor: n.XHRLoader, load: function (e, t, i, r) {
                var o = this, a = n.Cache.get(e);
                if (void 0 !== a)return void(t && t(a));
                var s = new XMLHttpRequest;
                s.open("GET", e, !0), s.addEventListener("load", function (i) {
                    n.Cache.add(e, this.response), t && t(this.response), o.manager.itemEnd(e)
                }, !1), void 0 !== i && s.addEventListener("progress", function (e) {
                    i(e)
                }, !1), void 0 !== r && s.addEventListener("error", function (e) {
                    r(e)
                }, !1), void 0 !== this.crossOrigin && (s.crossOrigin = this.crossOrigin), void 0 !== this.responseType && (s.responseType = this.responseType), s.send(null), o.manager.itemStart(e)
            }, setResponseType: function (e) {
                this.responseType = e
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }
        },n.ImageLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager
        },n.ImageLoader.prototype = {
            constructor: n.ImageLoader, load: function (e, t, i, r) {
                var o = this, a = n.Cache.get(e);
                if (void 0 !== a)return void t(a);
                var s = document.createElement("img");
                return s.addEventListener("load", function (i) {
                    n.Cache.add(e, this), t && t(this), o.manager.itemEnd(e)
                }, !1), void 0 !== i && s.addEventListener("progress", function (e) {
                    i(e)
                }, !1), void 0 !== r && s.addEventListener("error", function (e) {
                    r(e)
                }, !1), void 0 !== this.crossOrigin && (s.crossOrigin = this.crossOrigin), s.src = e, o.manager.itemStart(e), s
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }
        },n.JSONLoader = function (e) {
            n.Loader.call(this, e), this.withCredentials = !1
        },n.JSONLoader.prototype = Object.create(n.Loader.prototype),n.JSONLoader.prototype.constructor = n.JSONLoader,n.JSONLoader.prototype.load = function (e, t, i) {
            i = i && "string" == typeof i ? i : this.extractUrlBase(e), this.onLoadStart(), this.loadAjaxJSON(this, e, t, i)
        },n.JSONLoader.prototype.loadAjaxJSON = function (e, t, i, r, o) {
            var a = new XMLHttpRequest, s = 0;
            a.onreadystatechange = function () {
                if (a.readyState === a.DONE)if (200 === a.status || 0 === a.status) {
                    if (a.responseText) {
                        var h = JSON.parse(a.responseText), l = h.metadata;
                        if (void 0 !== l) {
                            if ("object" === l.type)return void n.error("THREE.JSONLoader: " + t + " should be loaded with THREE.ObjectLoader instead.");
                            if ("scene" === l.type)return void n.error("THREE.JSONLoader: " + t + " seems to be a Scene. Use THREE.SceneLoader instead.")
                        }
                        var u = e.parse(h, r);
                        i(u.geometry, u.materials)
                    } else n.error("THREE.JSONLoader: " + t + " seems to be unreachable or the file is empty.");
                    e.onLoadComplete()
                } else n.error("THREE.JSONLoader: Couldn't load " + t + " (" + a.status + ")"); else a.readyState === a.LOADING ? o && (0 === s && (s = a.getResponseHeader("Content-Length")), o({
                    total: s,
                    loaded: a.responseText.length
                })) : a.readyState === a.HEADERS_RECEIVED && void 0 !== o && (s = a.getResponseHeader("Content-Length"))
            }, a.open("GET", t, !0), a.withCredentials = this.withCredentials, a.send(null)
        },n.JSONLoader.prototype.parse = function (e, t) {
            function i(t) {
                function i(e, t) {
                    return e & 1 << t
                }

                var r, o, s, h, l, u, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C, P, L, k, B = e.faces, R = e.vertices, I = e.normals, F = e.colors, D = 0;
                if (void 0 !== e.uvs) {
                    for (r = 0; r < e.uvs.length; r++)e.uvs[r].length && D++;
                    for (r = 0; D > r; r++)a.faceVertexUvs[r] = []
                }
                for (h = 0, l = R.length; l > h;)x = new n.Vector3, x.x = R[h++] * t, x.y = R[h++] * t, x.z = R[h++] * t, a.vertices.push(x);
                for (h = 0, l = B.length; l > h;)if (p = B[h++], m = i(p, 0), g = i(p, 1), v = i(p, 3), y = i(p, 4), b = i(p, 5), w = i(p, 6), _ = i(p, 7), m) {
                    if (E = new n.Face3, E.a = B[h], E.b = B[h + 1], E.c = B[h + 3], M = new n.Face3, M.a = B[h + 1], M.b = B[h + 2], M.c = B[h + 3], h += 4, g && (f = B[h++], E.materialIndex = f, M.materialIndex = f), s = a.faces.length, v)for (r = 0; D > r; r++)for (C = e.uvs[r], a.faceVertexUvs[r][s] = [], a.faceVertexUvs[r][s + 1] = [], o = 0; 4 > o; o++)d = B[h++], L = C[2 * d], k = C[2 * d + 1], P = new n.Vector2(L, k), 2 !== o && a.faceVertexUvs[r][s].push(P), 0 !== o && a.faceVertexUvs[r][s + 1].push(P);
                    if (y && (c = 3 * B[h++], E.normal.set(I[c++], I[c++], I[c]), M.normal.copy(E.normal)), b)for (r = 0; 4 > r; r++)c = 3 * B[h++], T = new n.Vector3(I[c++], I[c++], I[c]), 2 !== r && E.vertexNormals.push(T), 0 !== r && M.vertexNormals.push(T);
                    if (w && (u = B[h++], A = F[u], E.color.setHex(A), M.color.setHex(A)), _)for (r = 0; 4 > r; r++)u = B[h++], A = F[u], 2 !== r && E.vertexColors.push(new n.Color(A)), 0 !== r && M.vertexColors.push(new n.Color(A));
                    a.faces.push(E), a.faces.push(M)
                } else {
                    if (S = new n.Face3, S.a = B[h++], S.b = B[h++], S.c = B[h++], g && (f = B[h++], S.materialIndex = f), s = a.faces.length, v)for (r = 0; D > r; r++)for (C = e.uvs[r], a.faceVertexUvs[r][s] = [], o = 0; 3 > o; o++)d = B[h++], L = C[2 * d], k = C[2 * d + 1], P = new n.Vector2(L, k), a.faceVertexUvs[r][s].push(P);
                    if (y && (c = 3 * B[h++], S.normal.set(I[c++], I[c++], I[c])), b)for (r = 0; 3 > r; r++)c = 3 * B[h++], T = new n.Vector3(I[c++], I[c++], I[c]), S.vertexNormals.push(T);
                    if (w && (u = B[h++], S.color.setHex(F[u])), _)for (r = 0; 3 > r; r++)u = B[h++], S.vertexColors.push(new n.Color(F[u]));
                    a.faces.push(S)
                }
            }

            function r() {
                var t = void 0 !== e.influencesPerVertex ? e.influencesPerVertex : 2;
                if (e.skinWeights)for (var i = 0, r = e.skinWeights.length; r > i; i += t) {
                    var o = e.skinWeights[i], s = t > 1 ? e.skinWeights[i + 1] : 0, h = t > 2 ? e.skinWeights[i + 2] : 0, l = t > 3 ? e.skinWeights[i + 3] : 0;
                    a.skinWeights.push(new n.Vector4(o, s, h, l))
                }
                if (e.skinIndices)for (var i = 0, r = e.skinIndices.length; r > i; i += t) {
                    var u = e.skinIndices[i], c = t > 1 ? e.skinIndices[i + 1] : 0, d = t > 2 ? e.skinIndices[i + 2] : 0, f = t > 3 ? e.skinIndices[i + 3] : 0;
                    a.skinIndices.push(new n.Vector4(u, c, d, f))
                }
                a.bones = e.bones,
                a.bones && a.bones.length > 0 && (a.skinWeights.length !== a.skinIndices.length || a.skinIndices.length !== a.vertices.length) && n.warn("THREE.JSONLoader: When skinning, number of vertices (" + a.vertices.length + "), skinIndices (" + a.skinIndices.length + "), and skinWeights (" + a.skinWeights.length + ") should match."), a.animation = e.animation, a.animations = e.animations
            }

            function o(t) {
                if (void 0 !== e.morphTargets) {
                    var i, r, o, s, h, l;
                    for (i = 0, r = e.morphTargets.length; r > i; i++)for (a.morphTargets[i] = {}, a.morphTargets[i].name = e.morphTargets[i].name, a.morphTargets[i].vertices = [], h = a.morphTargets[i].vertices, l = e.morphTargets[i].vertices, o = 0, s = l.length; s > o; o += 3) {
                        var u = new n.Vector3;
                        u.x = l[o] * t, u.y = l[o + 1] * t, u.z = l[o + 2] * t, h.push(u)
                    }
                }
                if (void 0 !== e.morphColors) {
                    var i, r, c, d, f, p, m;
                    for (i = 0, r = e.morphColors.length; r > i; i++)for (a.morphColors[i] = {}, a.morphColors[i].name = e.morphColors[i].name, a.morphColors[i].colors = [], f = a.morphColors[i].colors, p = e.morphColors[i].colors, c = 0, d = p.length; d > c; c += 3)m = new n.Color(16755200), m.setRGB(p[c], p[c + 1], p[c + 2]), f.push(m)
                }
            }

            var a = new n.Geometry, s = void 0 !== e.scale ? 1 / e.scale : 1;
            if (i(s), r(), o(s), a.computeFaceNormals(), a.computeBoundingSphere(), void 0 === e.materials || 0 === e.materials.length)return {geometry: a};
            var h = this.initMaterials(e.materials, t);
            return this.needsTangents(h) && a.computeTangents(), {geometry: a, materials: h}
        },n.LoadingManager = function (e, t, i) {
            var r = this, n = 0, o = 0;
            this.onLoad = e, this.onProgress = t, this.onError = i, this.itemStart = function (e) {
                o++
            }, this.itemEnd = function (e) {
                n++, void 0 !== r.onProgress && r.onProgress(e, n, o), n === o && void 0 !== r.onLoad && r.onLoad()
            }
        },n.DefaultLoadingManager = new n.LoadingManager,n.BufferGeometryLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager
        },n.BufferGeometryLoader.prototype = {
            constructor: n.BufferGeometryLoader, load: function (e, t, i, r) {
                var o = this, a = new n.XHRLoader(o.manager);
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    t(o.parse(JSON.parse(e)))
                }, i, r)
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }, parse: function (e) {
                var t = new n.BufferGeometry, i = e.data.attributes;
                for (var o in i) {
                    var a = i[o], s = new r[a.type](a.array);
                    t.addAttribute(o, new n.BufferAttribute(s, a.itemSize))
                }
                var h = e.data.offsets;
                void 0 !== h && (t.offsets = JSON.parse(JSON.stringify(h)));
                var l = e.data.boundingSphere;
                if (void 0 !== l) {
                    var u = new n.Vector3;
                    void 0 !== l.center && u.fromArray(l.center), t.boundingSphere = new n.Sphere(u, l.radius)
                }
                return t
            }
        },n.MaterialLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager
        },n.MaterialLoader.prototype = {
            constructor: n.MaterialLoader, load: function (e, t, i, r) {
                var o = this, a = new n.XHRLoader(o.manager);
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    t(o.parse(JSON.parse(e)))
                }, i, r)
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }, parse: function (e) {
                var t = new n[e.type];
                if (void 0 !== e.color && t.color.setHex(e.color), void 0 !== e.emissive && t.emissive.setHex(e.emissive), void 0 !== e.specular && t.specular.setHex(e.specular), void 0 !== e.shininess && (t.shininess = e.shininess), void 0 !== e.uniforms && (t.uniforms = e.uniforms), void 0 !== e.vertexShader && (t.vertexShader = e.vertexShader), void 0 !== e.fragmentShader && (t.fragmentShader = e.fragmentShader), void 0 !== e.vertexColors && (t.vertexColors = e.vertexColors), void 0 !== e.shading && (t.shading = e.shading), void 0 !== e.blending && (t.blending = e.blending), void 0 !== e.side && (t.side = e.side), void 0 !== e.opacity && (t.opacity = e.opacity), void 0 !== e.transparent && (t.transparent = e.transparent), void 0 !== e.wireframe && (t.wireframe = e.wireframe), void 0 !== e.size && (t.size = e.size), void 0 !== e.sizeAttenuation && (t.sizeAttenuation = e.sizeAttenuation), void 0 !== e.materials)for (var i = 0, r = e.materials.length; r > i; i++)t.materials.push(this.parse(e.materials[i]));
                return t
            }
        },n.ObjectLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager, this.texturePath = ""
        },n.ObjectLoader.prototype = {
            constructor: n.ObjectLoader, load: function (e, t, i, r) {
                "" === this.texturePath && (this.texturePath = e.substring(0, e.lastIndexOf("/") + 1));
                var o = this, a = new n.XHRLoader(o.manager);
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    o.parse(JSON.parse(e), t)
                }, i, r)
            }, setTexturePath: function (e) {
                this.texturePath = e
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }, parse: function (e, t) {
                var i = this.parseGeometries(e.geometries), r = this.parseImages(e.images, function () {
                    void 0 !== t && t(a)
                }), n = this.parseTextures(e.textures, r), o = this.parseMaterials(e.materials, n), a = this.parseObject(e.object, i, o);
                return (void 0 === e.images || 0 === e.images.length) && void 0 !== t && t(a), a
            }, parseGeometries: function (e) {
                var t = {};
                if (void 0 !== e)for (var i = new n.JSONLoader, r = new n.BufferGeometryLoader, o = 0, a = e.length; a > o; o++) {
                    var s, h = e[o];
                    switch (h.type) {
                        case"PlaneGeometry":
                        case"PlaneBufferGeometry":
                            s = new n[h.type](h.width, h.height, h.widthSegments, h.heightSegments);
                            break;
                        case"BoxGeometry":
                        case"CubeGeometry":
                            s = new n.BoxGeometry(h.width, h.height, h.depth, h.widthSegments, h.heightSegments, h.depthSegments);
                            break;
                        case"CircleGeometry":
                            s = new n.CircleGeometry(h.radius, h.segments);
                            break;
                        case"CylinderGeometry":
                            s = new n.CylinderGeometry(h.radiusTop, h.radiusBottom, h.height, h.radialSegments, h.heightSegments, h.openEnded);
                            break;
                        case"SphereGeometry":
                            s = new n.SphereGeometry(h.radius, h.widthSegments, h.heightSegments, h.phiStart, h.phiLength, h.thetaStart, h.thetaLength);
                            break;
                        case"IcosahedronGeometry":
                            s = new n.IcosahedronGeometry(h.radius, h.detail);
                            break;
                        case"TorusGeometry":
                            s = new n.TorusGeometry(h.radius, h.tube, h.radialSegments, h.tubularSegments, h.arc);
                            break;
                        case"TorusKnotGeometry":
                            s = new n.TorusKnotGeometry(h.radius, h.tube, h.radialSegments, h.tubularSegments, h.p, h.q, h.heightScale);
                            break;
                        case"BufferGeometry":
                            s = r.parse(h);
                            break;
                        case"Geometry":
                            s = i.parse(h.data).geometry
                    }
                    s.uuid = h.uuid, void 0 !== h.name && (s.name = h.name), t[h.uuid] = s
                }
                return t
            }, parseMaterials: function (e, t) {
                var i = {};
                if (void 0 !== e)for (var r = function (e) {
                    return void 0 === t[e] && n.warn("THREE.ObjectLoader: Undefined texture", e), t[e]
                }, o = new n.MaterialLoader, a = 0, s = e.length; s > a; a++) {
                    var h = e[a], l = o.parse(h);
                    l.uuid = h.uuid, void 0 !== h.name && (l.name = h.name), void 0 !== h.map && (l.map = r(h.map)), void 0 !== h.bumpMap && (l.bumpMap = r(h.bumpMap), h.bumpScale && (l.bumpScale = new n.Vector2(h.bumpScale, h.bumpScale))), void 0 !== h.alphaMap && (l.alphaMap = r(h.alphaMap)), void 0 !== h.envMap && (l.envMap = r(h.envMap)), void 0 !== h.normalMap && (l.normalMap = r(h.normalMap), h.normalScale && (l.normalScale = new n.Vector2(h.normalScale, h.normalScale))), void 0 !== h.lightMap && (l.lightMap = r(h.lightMap)), void 0 !== h.specularMap && (l.specularMap = r(h.specularMap)), i[h.uuid] = l
                }
                return i
            }, parseImages: function (e, t) {
                var i = this, r = {};
                if (void 0 !== e && e.length > 0) {
                    var o = new n.LoadingManager(t), a = new n.ImageLoader(o);
                    a.setCrossOrigin(this.crossOrigin);
                    for (var s = function (e) {
                        return i.manager.itemStart(e), a.load(e, function () {
                            i.manager.itemEnd(e)
                        })
                    }, h = 0, l = e.length; l > h; h++) {
                        var u = e[h], c = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url) ? u.url : i.texturePath + u.url;
                        r[u.uuid] = s(c)
                    }
                }
                return r
            }, parseTextures: function (e, t) {
                var i = {};
                if (void 0 !== e)for (var r = 0, o = e.length; o > r; r++) {
                    var a = e[r];
                    void 0 === a.image && n.warn('THREE.ObjectLoader: No "image" speficied for', a.uuid), void 0 === t[a.image] && n.warn("THREE.ObjectLoader: Undefined image", a.image);
                    var s = new n.Texture(t[a.image]);
                    s.needsUpdate = !0, s.uuid = a.uuid, void 0 !== a.name && (s.name = a.name), void 0 !== a.repeat && (s.repeat = new n.Vector2(a.repeat[0], a.repeat[1])), void 0 !== a.minFilter && (s.minFilter = n[a.minFilter]), void 0 !== a.magFilter && (s.magFilter = n[a.magFilter]), void 0 !== a.anisotropy && (s.anisotropy = a.anisotropy), a.wrap instanceof Array && (s.wrapS = n[a.wrap[0]], s.wrapT = n[a.wrap[1]]), i[a.uuid] = s
                }
                return i
            }, parseObject: function () {
                var e = new n.Matrix4;
                return function (t, i, r) {
                    var o, a = function (e) {
                        return void 0 === i[e] && n.warn("THREE.ObjectLoader: Undefined geometry", e), i[e]
                    }, s = function (e) {
                        return void 0 === r[e] && n.warn("THREE.ObjectLoader: Undefined material", e), r[e]
                    };
                    switch (t.type) {
                        case"Scene":
                            o = new n.Scene;
                            break;
                        case"PerspectiveCamera":
                            o = new n.PerspectiveCamera(t.fov, t.aspect, t.near, t.far);
                            break;
                        case"OrthographicCamera":
                            o = new n.OrthographicCamera(t.left, t.right, t.top, t.bottom, t.near, t.far);
                            break;
                        case"AmbientLight":
                            o = new n.AmbientLight(t.color);
                            break;
                        case"DirectionalLight":
                            o = new n.DirectionalLight(t.color, t.intensity);
                            break;
                        case"PointLight":
                            o = new n.PointLight(t.color, t.intensity, t.distance, t.decay);
                            break;
                        case"SpotLight":
                            o = new n.SpotLight(t.color, t.intensity, t.distance, t.angle, t.exponent, t.decay);
                            break;
                        case"HemisphereLight":
                            o = new n.HemisphereLight(t.color, t.groundColor, t.intensity);
                            break;
                        case"Mesh":
                            o = new n.Mesh(a(t.geometry), s(t.material));
                            break;
                        case"Line":
                            o = new n.Line(a(t.geometry), s(t.material), t.mode);
                            break;
                        case"PointCloud":
                            o = new n.PointCloud(a(t.geometry), s(t.material));
                            break;
                        case"Sprite":
                            o = new n.Sprite(s(t.material));
                            break;
                        case"Group":
                            o = new n.Group;
                            break;
                        default:
                            o = new n.Object3D
                    }
                    if (o.uuid = t.uuid, void 0 !== t.name && (o.name = t.name), void 0 !== t.matrix ? (e.fromArray(t.matrix), e.decompose(o.position, o.quaternion, o.scale)) : (void 0 !== t.position && o.position.fromArray(t.position), void 0 !== t.rotation && o.rotation.fromArray(t.rotation), void 0 !== t.scale && o.scale.fromArray(t.scale)), void 0 !== t.visible && (o.visible = t.visible), void 0 !== t.userData && (o.userData = t.userData), void 0 !== t.children)for (var h in t.children)o.add(this.parseObject(t.children[h], i, r));
                    return o
                }
            }()
        },n.TextureLoader = function (e) {
            this.manager = void 0 !== e ? e : n.DefaultLoadingManager
        },n.TextureLoader.prototype = {
            constructor: n.TextureLoader, load: function (e, t, i, r) {
                var o = this, a = new n.ImageLoader(o.manager);
                a.setCrossOrigin(this.crossOrigin), a.load(e, function (e) {
                    var i = new n.Texture(e);
                    i.needsUpdate = !0, void 0 !== t && t(i)
                }, i, r)
            }, setCrossOrigin: function (e) {
                this.crossOrigin = e
            }
        },n.DataTextureLoader = n.BinaryTextureLoader = function () {
            this._parser = null
        },n.BinaryTextureLoader.prototype = {
            constructor: n.BinaryTextureLoader, load: function (e, t, i, r) {
                var o = this, a = new n.DataTexture, s = new n.XHRLoader;
                return s.setResponseType("arraybuffer"), s.load(e, function (e) {
                    var i = o._parser(e);
                    i && (void 0 !== i.image ? a.image = i.image : void 0 !== i.data && (a.image.width = i.width, a.image.height = i.height, a.image.data = i.data), a.wrapS = void 0 !== i.wrapS ? i.wrapS : n.ClampToEdgeWrapping, a.wrapT = void 0 !== i.wrapT ? i.wrapT : n.ClampToEdgeWrapping, a.magFilter = void 0 !== i.magFilter ? i.magFilter : n.LinearFilter, a.minFilter = void 0 !== i.minFilter ? i.minFilter : n.LinearMipMapLinearFilter, a.anisotropy = void 0 !== i.anisotropy ? i.anisotropy : 1, void 0 !== i.format && (a.format = i.format), void 0 !== i.type && (a.type = i.type), void 0 !== i.mipmaps && (a.mipmaps = i.mipmaps), 1 === i.mipmapCount && (a.minFilter = n.LinearFilter), a.needsUpdate = !0, t && t(a, i))
                }, i, r), a
            }
        },n.CompressedTextureLoader = function () {
            this._parser = null
        },n.CompressedTextureLoader.prototype = {
            constructor: n.CompressedTextureLoader, load: function (e, t, i) {
                var r = this, o = [], a = new n.CompressedTexture;
                a.image = o;
                var s = new n.XHRLoader;
                if (s.setResponseType("arraybuffer"), e instanceof Array)for (var h = 0, l = function (i) {
                    s.load(e[i], function (e) {
                        var s = r._parser(e, !0);
                        o[i] = {
                            width: s.width,
                            height: s.height,
                            format: s.format,
                            mipmaps: s.mipmaps
                        }, h += 1, 6 === h && (1 == s.mipmapCount && (a.minFilter = n.LinearFilter), a.format = s.format, a.needsUpdate = !0, t && t(a))
                    })
                }, u = 0, c = e.length; c > u; ++u)l(u); else s.load(e, function (e) {
                    var i = r._parser(e, !0);
                    if (i.isCubemap)for (var s = i.mipmaps.length / i.mipmapCount, h = 0; s > h; h++) {
                        o[h] = {mipmaps: []};
                        for (var l = 0; l < i.mipmapCount; l++)o[h].mipmaps.push(i.mipmaps[h * i.mipmapCount + l]), o[h].format = i.format, o[h].width = i.width, o[h].height = i.height
                    } else a.image.width = i.width, a.image.height = i.height, a.mipmaps = i.mipmaps;
                    1 === i.mipmapCount && (a.minFilter = n.LinearFilter), a.format = i.format, a.needsUpdate = !0, t && t(a)
                });
                return a
            }
        },n.Material = function () {
            Object.defineProperty(this, "id", {value: n.MaterialIdCount++}), this.uuid = n.Math.generateUUID(), this.name = "", this.type = "Material", this.side = n.FrontSide, this.opacity = 1, this.transparent = !1, this.blending = n.NormalBlending, this.blendSrc = n.SrcAlphaFactor, this.blendDst = n.OneMinusSrcAlphaFactor, this.blendEquation = n.AddEquation, this.blendSrcAlpha = null, this.blendDstAlpha = null, this.blendEquationAlpha = null, this.depthTest = !0, this.depthWrite = !0, this.colorWrite = !0, this.polygonOffset = !1, this.polygonOffsetFactor = 0, this.polygonOffsetUnits = 0, this.alphaTest = 0, this.overdraw = 0, this.visible = !0, this._needsUpdate = !0
        },n.Material.prototype = {
            constructor: n.Material, get needsUpdate() {
                return this._needsUpdate
            }, set needsUpdate(e) {
                e === !0 && this.update(), this._needsUpdate = e
            }, setValues: function (e) {
                if (void 0 !== e)for (var t in e) {
                    var i = e[t];
                    if (void 0 !== i) {
                        if (t in this) {
                            var r = this[t];
                            r instanceof n.Color ? r.set(i) : r instanceof n.Vector3 && i instanceof n.Vector3 ? r.copy(i) : "overdraw" == t ? this[t] = Number(i) : this[t] = i
                        }
                    } else n.warn("THREE.Material: '" + t + "' parameter is undefined.")
                }
            }, toJSON: function () {
                var e = {
                    metadata: {version: 4.2, type: "material", generator: "MaterialExporter"},
                    uuid: this.uuid,
                    type: this.type
                };
                return "" !== this.name && (e.name = this.name), this instanceof n.MeshBasicMaterial ? (e.color = this.color.getHex(), this.vertexColors !== n.NoColors && (e.vertexColors = this.vertexColors), this.blending !== n.NormalBlending && (e.blending = this.blending), this.side !== n.FrontSide && (e.side = this.side)) : this instanceof n.MeshLambertMaterial ? (e.color = this.color.getHex(), e.emissive = this.emissive.getHex(), this.vertexColors !== n.NoColors && (e.vertexColors = this.vertexColors), this.shading !== n.SmoothShading && (e.shading = this.shading), this.blending !== n.NormalBlending && (e.blending = this.blending), this.side !== n.FrontSide && (e.side = this.side)) : this instanceof n.MeshPhongMaterial ? (e.color = this.color.getHex(), e.emissive = this.emissive.getHex(), e.specular = this.specular.getHex(), e.shininess = this.shininess, this.vertexColors !== n.NoColors && (e.vertexColors = this.vertexColors), this.shading !== n.SmoothShading && (e.shading = this.shading), this.blending !== n.NormalBlending && (e.blending = this.blending), this.side !== n.FrontSide && (e.side = this.side)) : this instanceof n.MeshNormalMaterial ? (this.blending !== n.NormalBlending && (e.blending = this.blending), this.side !== n.FrontSide && (e.side = this.side)) : this instanceof n.MeshDepthMaterial ? (this.blending !== n.NormalBlending && (e.blending = this.blending), this.side !== n.FrontSide && (e.side = this.side)) : this instanceof n.PointCloudMaterial ? (e.size = this.size, e.sizeAttenuation = this.sizeAttenuation, e.color = this.color.getHex(), this.vertexColors !== n.NoColors && (e.vertexColors = this.vertexColors), this.blending !== n.NormalBlending && (e.blending = this.blending)) : this instanceof n.ShaderMaterial ? (e.uniforms = this.uniforms, e.vertexShader = this.vertexShader, e.fragmentShader = this.fragmentShader) : this instanceof n.SpriteMaterial && (e.color = this.color.getHex()), this.opacity < 1 && (e.opacity = this.opacity), this.transparent !== !1 && (e.transparent = this.transparent), this.wireframe !== !1 && (e.wireframe = this.wireframe), e
            }, clone: function (e) {
                return void 0 === e && (e = new n.Material), e.name = this.name, e.side = this.side, e.opacity = this.opacity, e.transparent = this.transparent, e.blending = this.blending, e.blendSrc = this.blendSrc, e.blendDst = this.blendDst, e.blendEquation = this.blendEquation, e.blendSrcAlpha = this.blendSrcAlpha, e.blendDstAlpha = this.blendDstAlpha, e.blendEquationAlpha = this.blendEquationAlpha, e.depthTest = this.depthTest, e.depthWrite = this.depthWrite, e.polygonOffset = this.polygonOffset, e.polygonOffsetFactor = this.polygonOffsetFactor, e.polygonOffsetUnits = this.polygonOffsetUnits, e.alphaTest = this.alphaTest, e.overdraw = this.overdraw, e.visible = this.visible, e
            }, update: function () {
                this.dispatchEvent({type: "update"})
            }, dispose: function () {
                this.dispatchEvent({type: "dispose"})
            }
        },n.EventDispatcher.prototype.apply(n.Material.prototype),n.MaterialIdCount = 0,n.LineBasicMaterial = function (e) {
            n.Material.call(this), this.type = "LineBasicMaterial", this.color = new n.Color(16777215), this.linewidth = 1, this.linecap = "round", this.linejoin = "round", this.vertexColors = n.NoColors, this.fog = !0, this.setValues(e)
        },n.LineBasicMaterial.prototype = Object.create(n.Material.prototype),n.LineBasicMaterial.prototype.constructor = n.LineBasicMaterial,n.LineBasicMaterial.prototype.clone = function () {
            var e = new n.LineBasicMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.linewidth = this.linewidth, e.linecap = this.linecap, e.linejoin = this.linejoin, e.vertexColors = this.vertexColors, e.fog = this.fog, e
        },n.LineDashedMaterial = function (e) {
            n.Material.call(this), this.type = "LineDashedMaterial", this.color = new n.Color(16777215), this.linewidth = 1, this.scale = 1, this.dashSize = 3, this.gapSize = 1, this.vertexColors = !1, this.fog = !0, this.setValues(e)
        },n.LineDashedMaterial.prototype = Object.create(n.Material.prototype),n.LineDashedMaterial.prototype.constructor = n.LineDashedMaterial,n.LineDashedMaterial.prototype.clone = function () {
            var e = new n.LineDashedMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.linewidth = this.linewidth, e.scale = this.scale, e.dashSize = this.dashSize, e.gapSize = this.gapSize, e.vertexColors = this.vertexColors, e.fog = this.fog, e
        },n.MeshBasicMaterial = function (e) {
            n.Material.call(this), this.type = "MeshBasicMaterial", this.color = new n.Color(16777215), this.map = null, this.lightMap = null, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = n.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.fog = !0, this.shading = n.SmoothShading, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.vertexColors = n.NoColors, this.skinning = !1, this.morphTargets = !1, this.setValues(e)
        },n.MeshBasicMaterial.prototype = Object.create(n.Material.prototype),n.MeshBasicMaterial.prototype.constructor = n.MeshBasicMaterial,n.MeshBasicMaterial.prototype.clone = function () {
            var e = new n.MeshBasicMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.map = this.map, e.lightMap = this.lightMap, e.specularMap = this.specularMap, e.alphaMap = this.alphaMap, e.envMap = this.envMap, e.combine = this.combine, e.reflectivity = this.reflectivity, e.refractionRatio = this.refractionRatio, e.fog = this.fog, e.shading = this.shading, e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e.wireframeLinecap = this.wireframeLinecap, e.wireframeLinejoin = this.wireframeLinejoin, e.vertexColors = this.vertexColors, e.skinning = this.skinning, e.morphTargets = this.morphTargets, e
        },n.MeshLambertMaterial = function (e) {
            n.Material.call(this), this.type = "MeshLambertMaterial", this.color = new n.Color(16777215), this.emissive = new n.Color(0), this.wrapAround = !1, this.wrapRGB = new n.Vector3(1, 1, 1), this.map = null, this.lightMap = null, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = n.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.fog = !0, this.shading = n.SmoothShading, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.vertexColors = n.NoColors, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e)
        },n.MeshLambertMaterial.prototype = Object.create(n.Material.prototype),n.MeshLambertMaterial.prototype.constructor = n.MeshLambertMaterial,n.MeshLambertMaterial.prototype.clone = function () {
            var e = new n.MeshLambertMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.emissive.copy(this.emissive), e.wrapAround = this.wrapAround, e.wrapRGB.copy(this.wrapRGB), e.map = this.map, e.lightMap = this.lightMap, e.specularMap = this.specularMap, e.alphaMap = this.alphaMap, e.envMap = this.envMap, e.combine = this.combine, e.reflectivity = this.reflectivity, e.refractionRatio = this.refractionRatio, e.fog = this.fog, e.shading = this.shading, e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e.wireframeLinecap = this.wireframeLinecap, e.wireframeLinejoin = this.wireframeLinejoin, e.vertexColors = this.vertexColors, e.skinning = this.skinning, e.morphTargets = this.morphTargets, e.morphNormals = this.morphNormals, e
        },n.MeshPhongMaterial = function (e) {
            n.Material.call(this), this.type = "MeshPhongMaterial", this.color = new n.Color(16777215), this.emissive = new n.Color(0), this.specular = new n.Color(1118481), this.shininess = 30, this.metal = !1, this.wrapAround = !1, this.wrapRGB = new n.Vector3(1, 1, 1), this.map = null, this.lightMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new n.Vector2(1, 1), this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = n.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.fog = !0, this.shading = n.SmoothShading, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.vertexColors = n.NoColors, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e)
        },n.MeshPhongMaterial.prototype = Object.create(n.Material.prototype),n.MeshPhongMaterial.prototype.constructor = n.MeshPhongMaterial,n.MeshPhongMaterial.prototype.clone = function () {
            var e = new n.MeshPhongMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.emissive.copy(this.emissive), e.specular.copy(this.specular), e.shininess = this.shininess, e.metal = this.metal, e.wrapAround = this.wrapAround, e.wrapRGB.copy(this.wrapRGB), e.map = this.map, e.lightMap = this.lightMap, e.bumpMap = this.bumpMap, e.bumpScale = this.bumpScale, e.normalMap = this.normalMap, e.normalScale.copy(this.normalScale), e.specularMap = this.specularMap, e.alphaMap = this.alphaMap, e.envMap = this.envMap, e.combine = this.combine, e.reflectivity = this.reflectivity, e.refractionRatio = this.refractionRatio, e.fog = this.fog, e.shading = this.shading, e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e.wireframeLinecap = this.wireframeLinecap, e.wireframeLinejoin = this.wireframeLinejoin, e.vertexColors = this.vertexColors, e.skinning = this.skinning, e.morphTargets = this.morphTargets, e.morphNormals = this.morphNormals, e
        },n.MeshDepthMaterial = function (e) {
            n.Material.call(this), this.type = "MeshDepthMaterial", this.morphTargets = !1, this.wireframe = !1, this.wireframeLinewidth = 1, this.setValues(e)
        },n.MeshDepthMaterial.prototype = Object.create(n.Material.prototype),n.MeshDepthMaterial.prototype.constructor = n.MeshDepthMaterial,n.MeshDepthMaterial.prototype.clone = function () {
            var e = new n.MeshDepthMaterial;
            return n.Material.prototype.clone.call(this, e), e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e
        },n.MeshNormalMaterial = function (e) {
            n.Material.call(this, e), this.type = "MeshNormalMaterial", this.wireframe = !1, this.wireframeLinewidth = 1, this.morphTargets = !1, this.setValues(e)
        },n.MeshNormalMaterial.prototype = Object.create(n.Material.prototype),n.MeshNormalMaterial.prototype.constructor = n.MeshNormalMaterial,n.MeshNormalMaterial.prototype.clone = function () {
            var e = new n.MeshNormalMaterial;
            return n.Material.prototype.clone.call(this, e), e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e
        },n.MeshFaceMaterial = function (e) {
            this.uuid = n.Math.generateUUID(), this.type = "MeshFaceMaterial", this.materials = e instanceof Array ? e : []
        },n.MeshFaceMaterial.prototype = {
            constructor: n.MeshFaceMaterial, toJSON: function () {
                for (var e = {
                    metadata: {version: 4.2, type: "material", generator: "MaterialExporter"},
                    uuid: this.uuid,
                    type: this.type,
                    materials: []
                }, t = 0, i = this.materials.length; i > t; t++)e.materials.push(this.materials[t].toJSON());
                return e
            }, clone: function () {
                for (var e = new n.MeshFaceMaterial, t = 0; t < this.materials.length; t++)e.materials.push(this.materials[t].clone());
                return e
            }
        },n.PointCloudMaterial = function (e) {
            n.Material.call(this), this.type = "PointCloudMaterial", this.color = new n.Color(16777215), this.map = null, this.size = 1, this.sizeAttenuation = !0, this.vertexColors = n.NoColors, this.fog = !0, this.setValues(e)
        },n.PointCloudMaterial.prototype = Object.create(n.Material.prototype),n.PointCloudMaterial.prototype.constructor = n.PointCloudMaterial,n.PointCloudMaterial.prototype.clone = function () {
            var e = new n.PointCloudMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.map = this.map, e.size = this.size, e.sizeAttenuation = this.sizeAttenuation, e.vertexColors = this.vertexColors, e.fog = this.fog, e
        },n.ParticleBasicMaterial = function (e) {
            return n.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."), new n.PointCloudMaterial(e)
        },n.ParticleSystemMaterial = function (e) {
            return n.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."), new n.PointCloudMaterial(e)
        },n.ShaderMaterial = function (e) {
            n.Material.call(this), this.type = "ShaderMaterial", this.defines = {}, this.uniforms = {}, this.attributes = null, this.vertexShader = "void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}", this.fragmentShader = "void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}", this.shading = n.SmoothShading, this.linewidth = 1, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.vertexColors = n.NoColors, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.defaultAttributeValues = {
                color: [1, 1, 1],
                uv: [0, 0],
                uv2: [0, 0]
            }, this.index0AttributeName = void 0, this.setValues(e)
        },n.ShaderMaterial.prototype = Object.create(n.Material.prototype),n.ShaderMaterial.prototype.constructor = n.ShaderMaterial,n.ShaderMaterial.prototype.clone = function () {
            var e = new n.ShaderMaterial;
            return n.Material.prototype.clone.call(this, e), e.fragmentShader = this.fragmentShader, e.vertexShader = this.vertexShader, e.uniforms = n.UniformsUtils.clone(this.uniforms), e.attributes = this.attributes, e.defines = this.defines, e.shading = this.shading, e.wireframe = this.wireframe, e.wireframeLinewidth = this.wireframeLinewidth, e.fog = this.fog, e.lights = this.lights, e.vertexColors = this.vertexColors, e.skinning = this.skinning, e.morphTargets = this.morphTargets, e.morphNormals = this.morphNormals, e
        },n.RawShaderMaterial = function (e) {
            n.ShaderMaterial.call(this, e), this.type = "RawShaderMaterial"
        },n.RawShaderMaterial.prototype = Object.create(n.ShaderMaterial.prototype),n.RawShaderMaterial.prototype.constructor = n.RawShaderMaterial,n.RawShaderMaterial.prototype.clone = function () {
            var e = new n.RawShaderMaterial;
            return n.ShaderMaterial.prototype.clone.call(this, e), e
        },n.SpriteMaterial = function (e) {
            n.Material.call(this), this.type = "SpriteMaterial", this.color = new n.Color(16777215), this.map = null, this.rotation = 0, this.fog = !1, this.setValues(e)
        },n.SpriteMaterial.prototype = Object.create(n.Material.prototype),n.SpriteMaterial.prototype.constructor = n.SpriteMaterial,n.SpriteMaterial.prototype.clone = function () {
            var e = new n.SpriteMaterial;
            return n.Material.prototype.clone.call(this, e), e.color.copy(this.color), e.map = this.map, e.rotation = this.rotation, e.fog = this.fog, e
        },n.Texture = function (e, t, i, r, o, a, s, h, l) {
            Object.defineProperty(this, "id", {value: n.TextureIdCount++}), this.uuid = n.Math.generateUUID(), this.name = "", this.sourceFile = "", this.image = void 0 !== e ? e : n.Texture.DEFAULT_IMAGE, this.mipmaps = [], this.mapping = void 0 !== t ? t : n.Texture.DEFAULT_MAPPING, this.wrapS = void 0 !== i ? i : n.ClampToEdgeWrapping, this.wrapT = void 0 !== r ? r : n.ClampToEdgeWrapping, this.magFilter = void 0 !== o ? o : n.LinearFilter, this.minFilter = void 0 !== a ? a : n.LinearMipMapLinearFilter, this.anisotropy = void 0 !== l ? l : 1, this.format = void 0 !== s ? s : n.RGBAFormat, this.type = void 0 !== h ? h : n.UnsignedByteType, this.offset = new n.Vector2(0, 0), this.repeat = new n.Vector2(1, 1), this.generateMipmaps = !0, this.premultiplyAlpha = !1, this.flipY = !0, this.unpackAlignment = 4, this._needsUpdate = !1, this.onUpdate = null
        },n.Texture.DEFAULT_IMAGE = void 0,n.Texture.DEFAULT_MAPPING = n.UVMapping,n.Texture.prototype = {
            constructor: n.Texture,
            get needsUpdate() {
                return this._needsUpdate
            },
            set needsUpdate(e) {
                e === !0 && this.update(), this._needsUpdate = e
            },
            clone: function (e) {
                return void 0 === e && (e = new n.Texture), e.image = this.image, e.mipmaps = this.mipmaps.slice(0), e.mapping = this.mapping, e.wrapS = this.wrapS, e.wrapT = this.wrapT, e.magFilter = this.magFilter, e.minFilter = this.minFilter, e.anisotropy = this.anisotropy, e.format = this.format, e.type = this.type, e.offset.copy(this.offset), e.repeat.copy(this.repeat), e.generateMipmaps = this.generateMipmaps, e.premultiplyAlpha = this.premultiplyAlpha, e.flipY = this.flipY, e.unpackAlignment = this.unpackAlignment, e
            },
            update: function () {
                this.dispatchEvent({type: "update"})
            },
            dispose: function () {
                this.dispatchEvent({type: "dispose"})
            }
        },n.EventDispatcher.prototype.apply(n.Texture.prototype),n.TextureIdCount = 0,n.CubeTexture = function (e, t, i, r, o, a, s, h, l) {
            t = void 0 !== t ? t : n.CubeReflectionMapping, n.Texture.call(this, e, t, i, r, o, a, s, h, l), this.images = e
        },n.CubeTexture.prototype = Object.create(n.Texture.prototype),n.CubeTexture.prototype.constructor = n.CubeTexture,n.CubeTexture.clone = function (e) {
            return void 0 === e && (e = new n.CubeTexture), n.Texture.prototype.clone.call(this, e), e.images = this.images, e
        },n.CompressedTexture = function (e, t, i, r, o, a, s, h, l, u, c) {
            n.Texture.call(this, null, a, s, h, l, u, r, o, c), this.image = {
                width: t,
                height: i
            }, this.mipmaps = e, this.flipY = !1, this.generateMipmaps = !1
        },n.CompressedTexture.prototype = Object.create(n.Texture.prototype),n.CompressedTexture.prototype.constructor = n.CompressedTexture,n.CompressedTexture.prototype.clone = function () {
            var e = new n.CompressedTexture;
            return n.Texture.prototype.clone.call(this, e), e
        },n.DataTexture = function (e, t, i, r, o, a, s, h, l, u, c) {
            n.Texture.call(this, null, a, s, h, l, u, r, o, c), this.image = {data: e, width: t, height: i}
        },n.DataTexture.prototype = Object.create(n.Texture.prototype),n.DataTexture.prototype.constructor = n.DataTexture,n.DataTexture.prototype.clone = function () {
            var e = new n.DataTexture;
            return n.Texture.prototype.clone.call(this, e), e
        },n.VideoTexture = function (e, t, i, r, o, a, s, h, l) {
            n.Texture.call(this, e, t, i, r, o, a, s, h, l), this.generateMipmaps = !1;
            var u = this, c = function () {
                requestAnimationFrame(c), e.readyState === e.HAVE_ENOUGH_DATA && (u.needsUpdate = !0)
            };
            c()
        },n.VideoTexture.prototype = Object.create(n.Texture.prototype),n.VideoTexture.prototype.constructor = n.VideoTexture,n.Group = function () {
            n.Object3D.call(this), this.type = "Group"
        },n.Group.prototype = Object.create(n.Object3D.prototype),n.Group.prototype.constructor = n.Group,n.PointCloud = function (e, t) {
            n.Object3D.call(this), this.type = "PointCloud", this.geometry = void 0 !== e ? e : new n.Geometry, this.material = void 0 !== t ? t : new n.PointCloudMaterial({color: 16777215 * Math.random()})
        },n.PointCloud.prototype = Object.create(n.Object3D.prototype),n.PointCloud.prototype.constructor = n.PointCloud,n.PointCloud.prototype.raycast = function () {
            var e = new n.Matrix4, t = new n.Ray;
            return function (i, r) {
                var o = this, a = o.geometry, s = i.params.PointCloud.threshold;
                if (e.getInverse(this.matrixWorld), t.copy(i.ray).applyMatrix4(e), null === a.boundingBox || t.isIntersectionBox(a.boundingBox) !== !1) {
                    var h = s / ((this.scale.x + this.scale.y + this.scale.z) / 3), l = new n.Vector3, u = function (e, n) {
                        var a = t.distanceToPoint(e);
                        if (h > a) {
                            var s = t.closestPointToPoint(e);
                            s.applyMatrix4(o.matrixWorld);
                            var l = i.ray.origin.distanceTo(s);
                            r.push({distance: l, distanceToRay: a, point: s.clone(), index: n, face: null, object: o})
                        }
                    };
                    if (a instanceof n.BufferGeometry) {
                        var c = a.attributes, d = c.position.array;
                        if (void 0 !== c.index) {
                            var f = c.index.array, p = a.offsets;
                            if (0 === p.length) {
                                var m = {start: 0, count: f.length, index: 0};
                                p = [m]
                            }
                            for (var g = 0, v = p.length; v > g; ++g)for (var y = p[g].start, b = p[g].count, w = p[g].index, _ = y, x = y + b; x > _; _++) {
                                var S = w + f[_];
                                l.fromArray(d, 3 * S), u(l, S)
                            }
                        } else for (var E = d.length / 3, _ = 0; E > _; _++)l.set(d[3 * _], d[3 * _ + 1], d[3 * _ + 2]), u(l, _)
                    } else for (var M = this.geometry.vertices, _ = 0; _ < M.length; _++)u(M[_], _)
                }
            }
        }(),n.PointCloud.prototype.clone = function (e) {
            return void 0 === e && (e = new n.PointCloud(this.geometry, this.material)), n.Object3D.prototype.clone.call(this, e), e
        },n.ParticleSystem = function (e, t) {
            return n.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."), new n.PointCloud(e, t)
        },n.Line = function (e, t, i) {
            n.Object3D.call(this), this.type = "Line", this.geometry = void 0 !== e ? e : new n.Geometry, this.material = void 0 !== t ? t : new n.LineBasicMaterial({color: 16777215 * Math.random()}), this.mode = void 0 !== i ? i : n.LineStrip
        },n.LineStrip = 0,n.LinePieces = 1,n.Line.prototype = Object.create(n.Object3D.prototype),n.Line.prototype.constructor = n.Line,n.Line.prototype.raycast = function () {
            var e = new n.Matrix4, t = new n.Ray, i = new n.Sphere;
            return function (r, o) {
                var a = r.linePrecision, s = a * a, h = this.geometry;
                if (null === h.boundingSphere && h.computeBoundingSphere(), i.copy(h.boundingSphere), i.applyMatrix4(this.matrixWorld), r.ray.isIntersectionSphere(i) !== !1) {
                    e.getInverse(this.matrixWorld), t.copy(r.ray).applyMatrix4(e);
                    var l = new n.Vector3, u = new n.Vector3, c = new n.Vector3, d = new n.Vector3, f = this.mode === n.LineStrip ? 1 : 2;
                    if (h instanceof n.BufferGeometry) {
                        var p = h.attributes;
                        if (void 0 !== p.index) {
                            var m = p.index.array, g = p.position.array, v = h.offsets;
                            0 === v.length && (v = [{start: 0, count: m.length, index: 0}]);
                            for (var y = 0; y < v.length; y++)for (var b = v[y].start, w = v[y].count, _ = v[y].index, x = b; b + w - 1 > x; x += f) {
                                var S = _ + m[x], E = _ + m[x + 1];
                                l.fromArray(g, 3 * S), u.fromArray(g, 3 * E);
                                var M = t.distanceSqToSegment(l, u, d, c);
                                if (!(M > s)) {
                                    var A = t.origin.distanceTo(d);
                                    A < r.near || A > r.far || o.push({
                                        distance: A,
                                        point: c.clone().applyMatrix4(this.matrixWorld),
                                        index: x,
                                        offsetIndex: y,
                                        face: null,
                                        faceIndex: null,
                                        object: this
                                    })
                                }
                            }
                        } else for (var g = p.position.array, x = 0; x < g.length / 3 - 1; x += f) {
                            l.fromArray(g, 3 * x), u.fromArray(g, 3 * x + 3);
                            var M = t.distanceSqToSegment(l, u, d, c);
                            if (!(M > s)) {
                                var A = t.origin.distanceTo(d);
                                A < r.near || A > r.far || o.push({
                                    distance: A,
                                    point: c.clone().applyMatrix4(this.matrixWorld),
                                    index: x,
                                    face: null,
                                    faceIndex: null,
                                    object: this
                                })
                            }
                        }
                    } else if (h instanceof n.Geometry)for (var T = h.vertices, C = T.length, x = 0; C - 1 > x; x += f) {
                        var M = t.distanceSqToSegment(T[x], T[x + 1], d, c);
                        if (!(M > s)) {
                            var A = t.origin.distanceTo(d);
                            A < r.near || A > r.far || o.push({
                                distance: A,
                                point: c.clone().applyMatrix4(this.matrixWorld),
                                index: x,
                                face: null,
                                faceIndex: null,
                                object: this
                            })
                        }
                    }
                }
            }
        }(),n.Line.prototype.clone = function (e) {
            return void 0 === e && (e = new n.Line(this.geometry, this.material, this.mode)), n.Object3D.prototype.clone.call(this, e), e
        },n.Mesh = function (e, t) {
            n.Object3D.call(this), this.type = "Mesh", this.geometry = void 0 !== e ? e : new n.Geometry, this.material = void 0 !== t ? t : new n.MeshBasicMaterial({color: 16777215 * Math.random()}), this.updateMorphTargets()
        },n.Mesh.prototype = Object.create(n.Object3D.prototype),n.Mesh.prototype.constructor = n.Mesh,n.Mesh.prototype.updateMorphTargets = function () {
            if (void 0 !== this.geometry.morphTargets && this.geometry.morphTargets.length > 0) {
                this.morphTargetBase = -1, this.morphTargetForcedOrder = [], this.morphTargetInfluences = [], this.morphTargetDictionary = {};
                for (var e = 0, t = this.geometry.morphTargets.length; t > e; e++)this.morphTargetInfluences.push(0), this.morphTargetDictionary[this.geometry.morphTargets[e].name] = e
            }
        },n.Mesh.prototype.getMorphTargetIndexByName = function (e) {
            return void 0 !== this.morphTargetDictionary[e] ? this.morphTargetDictionary[e] : (n.warn("THREE.Mesh.getMorphTargetIndexByName: morph target " + e + " does not exist. Returning 0."), 0)
        },n.Mesh.prototype.raycast = function () {
            var e = new n.Matrix4, t = new n.Ray, i = new n.Sphere, r = new n.Vector3, o = new n.Vector3, a = new n.Vector3;
            return function (s, h) {
                var l = this.geometry;
                if (null === l.boundingSphere && l.computeBoundingSphere(), i.copy(l.boundingSphere), i.applyMatrix4(this.matrixWorld), s.ray.isIntersectionSphere(i) !== !1 && (e.getInverse(this.matrixWorld), t.copy(s.ray).applyMatrix4(e), null === l.boundingBox || t.isIntersectionBox(l.boundingBox) !== !1))if (l instanceof n.BufferGeometry) {
                    var u = this.material;
                    if (void 0 === u)return;
                    var c, d, f, p = l.attributes, m = s.precision;
                    if (void 0 !== p.index) {
                        var g = p.index.array, v = p.position.array, y = l.offsets;
                        0 === y.length && (y = [{start: 0, count: g.length, index: 0}]);
                        for (var b = 0, w = y.length; w > b; ++b)for (var _ = y[b].start, x = y[b].count, S = y[b].index, E = _, M = _ + x; M > E; E += 3) {
                            if (c = S + g[E], d = S + g[E + 1], f = S + g[E + 2], r.fromArray(v, 3 * c), o.fromArray(v, 3 * d), a.fromArray(v, 3 * f), u.side === n.BackSide)var A = t.intersectTriangle(a, o, r, !0); else var A = t.intersectTriangle(r, o, a, u.side !== n.DoubleSide);
                            if (null !== A) {
                                A.applyMatrix4(this.matrixWorld);
                                var T = s.ray.origin.distanceTo(A);
                                m > T || T < s.near || T > s.far || h.push({
                                    distance: T,
                                    point: A,
                                    face: new n.Face3(c, d, f, n.Triangle.normal(r, o, a)),
                                    faceIndex: null,
                                    object: this
                                })
                            }
                        }
                    } else for (var v = p.position.array, E = 0, C = 0, M = v.length; M > E; E += 3, C += 9) {
                        if (c = E, d = E + 1, f = E + 2, r.fromArray(v, C), o.fromArray(v, C + 3), a.fromArray(v, C + 6), u.side === n.BackSide)var A = t.intersectTriangle(a, o, r, !0); else var A = t.intersectTriangle(r, o, a, u.side !== n.DoubleSide);
                        if (null !== A) {
                            A.applyMatrix4(this.matrixWorld);
                            var T = s.ray.origin.distanceTo(A);
                            m > T || T < s.near || T > s.far || h.push({
                                distance: T,
                                point: A,
                                face: new n.Face3(c, d, f, n.Triangle.normal(r, o, a)),
                                faceIndex: null,
                                object: this
                            })
                        }
                    }
                } else if (l instanceof n.Geometry)for (var c, d, f, P = this.material instanceof n.MeshFaceMaterial, L = P === !0 ? this.material.materials : null, m = s.precision, k = l.vertices, B = 0, R = l.faces.length; R > B; B++) {
                    var I = l.faces[B], u = P === !0 ? L[I.materialIndex] : this.material;
                    if (void 0 !== u) {
                        if (c = k[I.a], d = k[I.b], f = k[I.c], u.morphTargets === !0) {
                            var F = l.morphTargets, D = this.morphTargetInfluences;
                            r.set(0, 0, 0), o.set(0, 0, 0), a.set(0, 0, 0);
                            for (var O = 0, N = F.length; N > O; O++) {
                                var U = D[O];
                                if (0 !== U) {
                                    var z = F[O].vertices;
                                    r.x += (z[I.a].x - c.x) * U, r.y += (z[I.a].y - c.y) * U, r.z += (z[I.a].z - c.z) * U, o.x += (z[I.b].x - d.x) * U, o.y += (z[I.b].y - d.y) * U, o.z += (z[I.b].z - d.z) * U, a.x += (z[I.c].x - f.x) * U, a.y += (z[I.c].y - f.y) * U, a.z += (z[I.c].z - f.z) * U
                                }
                            }
                            r.add(c), o.add(d), a.add(f), c = r, d = o, f = a
                        }
                        if (u.side === n.BackSide)var A = t.intersectTriangle(f, d, c, !0); else var A = t.intersectTriangle(c, d, f, u.side !== n.DoubleSide);
                        if (null !== A) {
                            A.applyMatrix4(this.matrixWorld);
                            var T = s.ray.origin.distanceTo(A);
                            m > T || T < s.near || T > s.far || h.push({
                                distance: T,
                                point: A,
                                face: I,
                                faceIndex: B,
                                object: this
                            })
                        }
                    }
                }
            }
        }(),n.Mesh.prototype.clone = function (e, t) {
            return void 0 === e && (e = new n.Mesh(this.geometry, this.material)), n.Object3D.prototype.clone.call(this, e, t), e
        },n.Bone = function (e) {
            n.Object3D.call(this), this.type = "Bone", this.skin = e
        },n.Bone.prototype = Object.create(n.Object3D.prototype),n.Bone.prototype.constructor = n.Bone,n.Skeleton = function (e, t, i) {
            if (this.useVertexTexture = void 0 !== i ? i : !0, this.identityMatrix = new n.Matrix4, e = e || [], this.bones = e.slice(0), this.useVertexTexture) {
                var r;
                r = this.bones.length > 256 ? 64 : this.bones.length > 64 ? 32 : this.bones.length > 16 ? 16 : 8, this.boneTextureWidth = r, this.boneTextureHeight = r, this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4), this.boneTexture = new n.DataTexture(this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, n.RGBAFormat, n.FloatType), this.boneTexture.minFilter = n.NearestFilter, this.boneTexture.magFilter = n.NearestFilter, this.boneTexture.generateMipmaps = !1, this.boneTexture.flipY = !1
            } else this.boneMatrices = new Float32Array(16 * this.bones.length);
            if (void 0 === t)this.calculateInverses(); else if (this.bones.length === t.length)this.boneInverses = t.slice(0); else {
                n.warn("THREE.Skeleton bonInverses is the wrong length."), this.boneInverses = [];
                for (var o = 0, a = this.bones.length; a > o; o++)this.boneInverses.push(new n.Matrix4)
            }
        },n.Skeleton.prototype.calculateInverses = function () {
            this.boneInverses = [];
            for (var e = 0, t = this.bones.length; t > e; e++) {
                var i = new n.Matrix4;
                this.bones[e] && i.getInverse(this.bones[e].matrixWorld), this.boneInverses.push(i)
            }
        },n.Skeleton.prototype.pose = function () {
            for (var e, t = 0, i = this.bones.length; i > t; t++)e = this.bones[t], e && e.matrixWorld.getInverse(this.boneInverses[t]);
            for (var t = 0, i = this.bones.length; i > t; t++)e = this.bones[t], e && (e.parent ? (e.matrix.getInverse(e.parent.matrixWorld), e.matrix.multiply(e.matrixWorld)) : e.matrix.copy(e.matrixWorld), e.matrix.decompose(e.position, e.quaternion, e.scale))
        },n.Skeleton.prototype.update = function () {
            var e = new n.Matrix4;
            return function () {
                for (var t = 0, i = this.bones.length; i > t; t++) {
                    var r = this.bones[t] ? this.bones[t].matrixWorld : this.identityMatrix;
                    e.multiplyMatrices(r, this.boneInverses[t]), e.flattenToArrayOffset(this.boneMatrices, 16 * t)
                }
                this.useVertexTexture && (this.boneTexture.needsUpdate = !0)
            }
        }(),n.SkinnedMesh = function (e, t, i) {
            n.Mesh.call(this, e, t), this.type = "SkinnedMesh", this.bindMode = "attached", this.bindMatrix = new n.Matrix4, this.bindMatrixInverse = new n.Matrix4;
            var r = [];
            if (this.geometry && void 0 !== this.geometry.bones) {
                for (var o, a, s, h, l, u = 0, c = this.geometry.bones.length; c > u; ++u)a = this.geometry.bones[u], s = a.pos, h = a.rotq, l = a.scl, o = new n.Bone(this), r.push(o), o.name = a.name, o.position.set(s[0], s[1], s[2]), o.quaternion.set(h[0], h[1], h[2], h[3]), void 0 !== l ? o.scale.set(l[0], l[1], l[2]) : o.scale.set(1, 1, 1);
                for (var u = 0, c = this.geometry.bones.length; c > u; ++u)a = this.geometry.bones[u], -1 !== a.parent ? r[a.parent].add(r[u]) : this.add(r[u])
            }
            this.normalizeSkinWeights(), this.updateMatrixWorld(!0), this.bind(new n.Skeleton(r, void 0, i))
        },n.SkinnedMesh.prototype = Object.create(n.Mesh.prototype),n.SkinnedMesh.prototype.constructor = n.SkinnedMesh,n.SkinnedMesh.prototype.bind = function (e, t) {
            this.skeleton = e, void 0 === t && (this.updateMatrixWorld(!0), t = this.matrixWorld), this.bindMatrix.copy(t), this.bindMatrixInverse.getInverse(t)
        },n.SkinnedMesh.prototype.pose = function () {
            this.skeleton.pose()
        },n.SkinnedMesh.prototype.normalizeSkinWeights = function () {
            if (this.geometry instanceof n.Geometry)for (var e = 0; e < this.geometry.skinIndices.length; e++) {
                var t = this.geometry.skinWeights[e], i = 1 / t.lengthManhattan();
                i !== 1 / 0 ? t.multiplyScalar(i) : t.set(1)
            }
        },n.SkinnedMesh.prototype.updateMatrixWorld = function (e) {
            n.Mesh.prototype.updateMatrixWorld.call(this, !0), "attached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.matrixWorld) : "detached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.bindMatrix) : n.warn("THREE.SkinnedMesh unreckognized bindMode: " + this.bindMode)
        },n.SkinnedMesh.prototype.clone = function (e) {
            return void 0 === e && (e = new n.SkinnedMesh(this.geometry, this.material, this.useVertexTexture)), n.Mesh.prototype.clone.call(this, e), e
        },n.MorphAnimMesh = function (e, t) {
            n.Mesh.call(this, e, t), this.type = "MorphAnimMesh", this.duration = 1e3, this.mirroredLoop = !1, this.time = 0, this.lastKeyframe = 0, this.currentKeyframe = 0, this.direction = 1, this.directionBackwards = !1, this.setFrameRange(0, this.geometry.morphTargets.length - 1)
        },n.MorphAnimMesh.prototype = Object.create(n.Mesh.prototype),n.MorphAnimMesh.prototype.constructor = n.MorphAnimMesh,n.MorphAnimMesh.prototype.setFrameRange = function (e, t) {
            this.startKeyframe = e, this.endKeyframe = t, this.length = this.endKeyframe - this.startKeyframe + 1
        },n.MorphAnimMesh.prototype.setDirectionForward = function () {
            this.direction = 1, this.directionBackwards = !1
        },n.MorphAnimMesh.prototype.setDirectionBackward = function () {
            this.direction = -1, this.directionBackwards = !0
        },n.MorphAnimMesh.prototype.parseAnimations = function () {
            var e = this.geometry;
            e.animations || (e.animations = {});
            for (var t, i = e.animations, r = /([a-z]+)_?(\d+)/, n = 0, o = e.morphTargets.length; o > n; n++) {
                var a = e.morphTargets[n], s = a.name.match(r);
                if (s && s.length > 1) {
                    var h = s[1];
                    i[h] || (i[h] = {start: 1 / 0, end: -(1 / 0)});
                    var l = i[h];
                    n < l.start && (l.start = n), n > l.end && (l.end = n), t || (t = h)
                }
            }
            e.firstAnimation = t
        },n.MorphAnimMesh.prototype.setAnimationLabel = function (e, t, i) {
            this.geometry.animations || (this.geometry.animations = {}), this.geometry.animations[e] = {
                start: t,
                end: i
            }
        },n.MorphAnimMesh.prototype.playAnimation = function (e, t) {
            var i = this.geometry.animations[e];
            i ? (this.setFrameRange(i.start, i.end), this.duration = 1e3 * ((i.end - i.start) / t), this.time = 0) : n.warn("THREE.MorphAnimMesh: animation[" + e + "] undefined in .playAnimation()")
        },n.MorphAnimMesh.prototype.updateAnimation = function (e) {
            var t = this.duration / this.length;
            this.time += this.direction * e, this.mirroredLoop ? (this.time > this.duration || this.time < 0) && (this.direction *= -1, this.time > this.duration && (this.time = this.duration, this.directionBackwards = !0), this.time < 0 && (this.time = 0, this.directionBackwards = !1)) : (this.time = this.time % this.duration, this.time < 0 && (this.time += this.duration));
            var i = this.startKeyframe + n.Math.clamp(Math.floor(this.time / t), 0, this.length - 1);
            i !== this.currentKeyframe && (this.morphTargetInfluences[this.lastKeyframe] = 0, this.morphTargetInfluences[this.currentKeyframe] = 1, this.morphTargetInfluences[i] = 0, this.lastKeyframe = this.currentKeyframe, this.currentKeyframe = i);
            var r = this.time % t / t;
            this.directionBackwards && (r = 1 - r), this.morphTargetInfluences[this.currentKeyframe] = r, this.morphTargetInfluences[this.lastKeyframe] = 1 - r
        },n.MorphAnimMesh.prototype.interpolateTargets = function (e, t, i) {
            for (var r = this.morphTargetInfluences, n = 0, o = r.length; o > n; n++)r[n] = 0;
            e > -1 && (r[e] = 1 - i), t > -1 && (r[t] = i)
        },n.MorphAnimMesh.prototype.clone = function (e) {
            return void 0 === e && (e = new n.MorphAnimMesh(this.geometry, this.material)), e.duration = this.duration, e.mirroredLoop = this.mirroredLoop, e.time = this.time, e.lastKeyframe = this.lastKeyframe, e.currentKeyframe = this.currentKeyframe, e.direction = this.direction, e.directionBackwards = this.directionBackwards, n.Mesh.prototype.clone.call(this, e), e
        },n.LOD = function () {
            n.Object3D.call(this), this.objects = []
        },n.LOD.prototype = Object.create(n.Object3D.prototype),n.LOD.prototype.constructor = n.LOD,n.LOD.prototype.addLevel = function (e, t) {
            void 0 === t && (t = 0), t = Math.abs(t);
            for (var i = 0; i < this.objects.length && !(t < this.objects[i].distance); i++);
            this.objects.splice(i, 0, {distance: t, object: e}), this.add(e)
        },n.LOD.prototype.getObjectForDistance = function (e) {
            for (var t = 1, i = this.objects.length; i > t && !(e < this.objects[t].distance); t++);
            return this.objects[t - 1].object
        },n.LOD.prototype.raycast = function () {
            var e = new n.Vector3;
            return function (t, i) {
                e.setFromMatrixPosition(this.matrixWorld);
                var r = t.ray.origin.distanceTo(e);
                this.getObjectForDistance(r).raycast(t, i)
            }
        }(),n.LOD.prototype.update = function () {
            var e = new n.Vector3, t = new n.Vector3;
            return function (i) {
                if (this.objects.length > 1) {
                    e.setFromMatrixPosition(i.matrixWorld), t.setFromMatrixPosition(this.matrixWorld);
                    var r = e.distanceTo(t);
                    this.objects[0].object.visible = !0;
                    for (var n = 1, o = this.objects.length; o > n && r >= this.objects[n].distance; n++)this.objects[n - 1].object.visible = !1, this.objects[n].object.visible = !0;
                    for (; o > n; n++)this.objects[n].object.visible = !1
                }
            }
        }(),n.LOD.prototype.clone = function (e) {
            void 0 === e && (e = new n.LOD), n.Object3D.prototype.clone.call(this, e);
            for (var t = 0, i = this.objects.length; i > t; t++) {
                var r = this.objects[t].object.clone();
                r.visible = 0 === t, e.addLevel(r, this.objects[t].distance)
            }
            return e
        },n.Sprite = function () {
            var e = new Uint16Array([0, 1, 2, 0, 2, 3]), t = new Float32Array([-.5, -.5, 0, .5, -.5, 0, .5, .5, 0, -.5, .5, 0]), i = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), r = new n.BufferGeometry;
            return r.addAttribute("index", new n.BufferAttribute(e, 1)), r.addAttribute("position", new n.BufferAttribute(t, 3)), r.addAttribute("uv", new n.BufferAttribute(i, 2)), function (e) {
                n.Object3D.call(this), this.type = "Sprite", this.geometry = r, this.material = void 0 !== e ? e : new n.SpriteMaterial
            }
        }(),n.Sprite.prototype = Object.create(n.Object3D.prototype),n.Sprite.prototype.constructor = n.Sprite,n.Sprite.prototype.raycast = function () {
            var e = new n.Vector3;
            return function (t, i) {
                e.setFromMatrixPosition(this.matrixWorld);
                var r = t.ray.distanceToPoint(e);
                r > this.scale.x || i.push({distance: r, point: this.position, face: null, object: this})
            }
        }(),n.Sprite.prototype.clone = function (e) {
            return void 0 === e && (e = new n.Sprite(this.material)), n.Object3D.prototype.clone.call(this, e), e
        },n.Particle = n.Sprite,n.LensFlare = function (e, t, i, r, o) {
            n.Object3D.call(this), this.lensFlares = [], this.positionScreen = new n.Vector3, this.customUpdateCallback = void 0, void 0 !== e && this.add(e, t, i, r, o)
        },n.LensFlare.prototype = Object.create(n.Object3D.prototype),n.LensFlare.prototype.constructor = n.LensFlare,n.LensFlare.prototype.add = function (e, t, i, r, o, a) {
            void 0 === t && (t = -1), void 0 === i && (i = 0), void 0 === a && (a = 1), void 0 === o && (o = new n.Color(16777215)), void 0 === r && (r = n.NormalBlending), i = Math.min(i, Math.max(0, i)), this.lensFlares.push({
                texture: e,
                size: t,
                distance: i,
                x: 0,
                y: 0,
                z: 0,
                scale: 1,
                rotation: 1,
                opacity: a,
                color: o,
                blending: r
            })
        },n.LensFlare.prototype.updateLensFlares = function () {
            var e, t, i = this.lensFlares.length, r = 2 * -this.positionScreen.x, n = 2 * -this.positionScreen.y;
            for (e = 0; i > e; e++)t = this.lensFlares[e], t.x = this.positionScreen.x + r * t.distance, t.y = this.positionScreen.y + n * t.distance, t.wantedRotation = t.x * Math.PI * .25, t.rotation += .25 * (t.wantedRotation - t.rotation)
        },n.Scene = function () {
            n.Object3D.call(this), this.type = "Scene", this.fog = null, this.overrideMaterial = null, this.autoUpdate = !0
        },n.Scene.prototype = Object.create(n.Object3D.prototype),n.Scene.prototype.constructor = n.Scene,n.Scene.prototype.clone = function (e) {
            return void 0 === e && (e = new n.Scene), n.Object3D.prototype.clone.call(this, e), null !== this.fog && (e.fog = this.fog.clone()), null !== this.overrideMaterial && (e.overrideMaterial = this.overrideMaterial.clone()), e.autoUpdate = this.autoUpdate, e.matrixAutoUpdate = this.matrixAutoUpdate, e
        },n.Fog = function (e, t, i) {
            this.name = "", this.color = new n.Color(e), this.near = void 0 !== t ? t : 1, this.far = void 0 !== i ? i : 1e3
        },n.Fog.prototype.clone = function () {
            return new n.Fog(this.color.getHex(), this.near, this.far)
        },n.FogExp2 = function (e, t) {
            this.name = "", this.color = new n.Color(e), this.density = void 0 !== t ? t : 25e-5
        },n.FogExp2.prototype.clone = function () {
            return new n.FogExp2(this.color.getHex(), this.density)
        },n.ShaderChunk = {},n.ShaderChunk.common = "#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n	float distance = dot( planeNormal, point-pointOnPlane );\n	return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n	if ( decayExponent > 0.0 ) {\n	  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n	}\n	return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n	return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n	return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n	return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n	return a;\n#endif\n}\n",n.ShaderChunk.alphatest_fragment = "#ifdef ALPHATEST\n\n	if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",n.ShaderChunk.lights_lambert_vertex = "vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack += ambientLightColor;\n\n#endif\n",n.ShaderChunk.map_particle_pars_fragment = "#ifdef USE_MAP\n\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n\n#endif\n",n.ShaderChunk.default_vertex = "#ifdef USE_SKINNING\n\n	vec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n	vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",n.ShaderChunk.map_pars_fragment = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",n.ShaderChunk.skinnormal_vertex = "#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n",n.ShaderChunk.logdepthbuf_pars_vertex = "#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",n.ShaderChunk.lightmap_pars_vertex = "#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif",n.ShaderChunk.lights_phong_fragment = "#ifndef FLAT_SHADED\n\n	vec3 normal = normalize( vNormal );\n\n	#ifdef DOUBLE_SIDED\n\n		normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n	#endif\n\n#else\n\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		totalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		totalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			totalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n			// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			totalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n		// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		totalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		totalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		totalDiffuseLight += hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		totalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\n#ifdef METAL\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n	outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",
        n.ShaderChunk.fog_pars_fragment = "#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",n.ShaderChunk.morphnormal_vertex = "#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif",n.ShaderChunk.envmap_pars_fragment = "#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif\n",n.ShaderChunk.logdepthbuf_fragment = "#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",n.ShaderChunk.normalmap_pars_fragment = "#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n	// Per-Pixel Tangent Space Normal Mapping\n	// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",n.ShaderChunk.lights_phong_pars_vertex = "#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",n.ShaderChunk.lightmap_pars_fragment = "#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif",n.ShaderChunk.shadowmap_vertex = "#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",n.ShaderChunk.lights_phong_vertex = "#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif",n.ShaderChunk.map_fragment = "#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	texelColor.xyz = inputToLinear( texelColor.xyz );\n\n	diffuseColor *= texelColor;\n\n#endif",n.ShaderChunk.lightmap_vertex = "#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif",n.ShaderChunk.map_particle_fragment = "#ifdef USE_MAP\n\n	diffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",n.ShaderChunk.color_pars_fragment = "#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",n.ShaderChunk.color_vertex = "#ifdef USE_COLOR\n\n	vColor.xyz = inputToLinear( color.xyz );\n\n#endif",n.ShaderChunk.skinning_vertex = "#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",n.ShaderChunk.envmap_pars_vertex = "#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n\n#endif\n",n.ShaderChunk.linear_to_gamma_fragment = "\n	outgoingLight = linearToOutput( outgoingLight );\n",n.ShaderChunk.color_pars_vertex = "#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",n.ShaderChunk.lights_lambert_pars_vertex = "uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n",n.ShaderChunk.map_pars_vertex = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",n.ShaderChunk.envmap_fragment = "#ifdef USE_ENVMAP\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// Transforming Normal Vectors with the Inverse Transformation\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n		#ifdef ENVMAP_MODE_REFLECTION\n\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n		#else\n\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		#endif\n\n	#else\n\n		vec3 reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n	#else\n		float flipNormal = 1.0;\n	#endif\n\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n\n	envColor.xyz = inputToLinear( envColor.xyz );\n\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_MIX )\n\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_ADD )\n\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n	#endif\n\n#endif\n",n.ShaderChunk.specularmap_pars_fragment = "#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",n.ShaderChunk.logdepthbuf_vertex = "#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",n.ShaderChunk.morphtarget_pars_vertex = "#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",n.ShaderChunk.specularmap_fragment = "float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",n.ShaderChunk.fog_fragment = "#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		float fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n		fogFactor = whiteCompliment( fogFactor );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",n.ShaderChunk.bumpmap_pars_fragment = "#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n	// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n	// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif\n",n.ShaderChunk.defaultnormal_vertex = "#ifdef USE_SKINNING\n\n	vec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n	vec3 objectNormal = morphedNormal;\n\n#else\n\n	vec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",n.ShaderChunk.lights_phong_pars_fragment = "uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n	varying vec3 vNormal;\n\n#endif\n",n.ShaderChunk.skinbase_vertex = "#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",n.ShaderChunk.map_vertex = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",n.ShaderChunk.lightmap_fragment = "#ifdef USE_LIGHTMAP\n\n	outgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",n.ShaderChunk.shadowmap_pars_vertex = "#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",n.ShaderChunk.color_fragment = "#ifdef USE_COLOR\n\n	diffuseColor.rgb *= vColor;\n\n#endif",n.ShaderChunk.morphtarget_vertex = "#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif",n.ShaderChunk.envmap_vertex = "#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	#ifdef ENVMAP_MODE_REFLECTION\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	#else\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	#endif\n\n#endif\n",n.ShaderChunk.shadowmap_fragment = "#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n	shadowColor = inputToLinear( shadowColor );\n\n	outgoingLight = outgoingLight * shadowColor;\n\n#endif\n",n.ShaderChunk.worldpos_vertex = "#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#elif defined( USE_MORPHTARGETS )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif\n",n.ShaderChunk.shadowmap_pars_fragment = "#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",n.ShaderChunk.skinning_pars_vertex = "#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",n.ShaderChunk.logdepthbuf_pars_fragment = "#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif",n.ShaderChunk.alphamap_fragment = "#ifdef USE_ALPHAMAP\n\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",n.ShaderChunk.alphamap_pars_fragment = "#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",n.UniformsUtils = {
            merge: function (e) {
                for (var t = {}, i = 0; i < e.length; i++) {
                    var r = this.clone(e[i]);
                    for (var n in r)t[n] = r[n]
                }
                return t
            }, clone: function (e) {
                var t = {};
                for (var i in e) {
                    t[i] = {};
                    for (var r in e[i]) {
                        var o = e[i][r];
                        o instanceof n.Color || o instanceof n.Vector2 || o instanceof n.Vector3 || o instanceof n.Vector4 || o instanceof n.Matrix4 || o instanceof n.Texture ? t[i][r] = o.clone() : o instanceof Array ? t[i][r] = o.slice() : t[i][r] = o
                    }
                }
                return t
            }
        },n.UniformsLib = {
            common: {
                diffuse: {type: "c", value: new n.Color(15658734)},
                opacity: {type: "f", value: 1},
                map: {type: "t", value: null},
                offsetRepeat: {type: "v4", value: new n.Vector4(0, 0, 1, 1)},
                lightMap: {type: "t", value: null},
                specularMap: {type: "t", value: null},
                alphaMap: {type: "t", value: null},
                envMap: {type: "t", value: null},
                flipEnvMap: {type: "f", value: -1},
                reflectivity: {type: "f", value: 1},
                refractionRatio: {type: "f", value: .98},
                morphTargetInfluences: {type: "f", value: 0}
            },
            bump: {bumpMap: {type: "t", value: null}, bumpScale: {type: "f", value: 1}},
            normalmap: {normalMap: {type: "t", value: null}, normalScale: {type: "v2", value: new n.Vector2(1, 1)}},
            fog: {
                fogDensity: {type: "f", value: 25e-5},
                fogNear: {type: "f", value: 1},
                fogFar: {type: "f", value: 2e3},
                fogColor: {type: "c", value: new n.Color(16777215)}
            },
            lights: {
                ambientLightColor: {type: "fv", value: []},
                directionalLightDirection: {type: "fv", value: []},
                directionalLightColor: {type: "fv", value: []},
                hemisphereLightDirection: {type: "fv", value: []},
                hemisphereLightSkyColor: {type: "fv", value: []},
                hemisphereLightGroundColor: {type: "fv", value: []},
                pointLightColor: {type: "fv", value: []},
                pointLightPosition: {type: "fv", value: []},
                pointLightDistance: {type: "fv1", value: []},
                pointLightDecay: {type: "fv1", value: []},
                spotLightColor: {type: "fv", value: []},
                spotLightPosition: {type: "fv", value: []},
                spotLightDirection: {type: "fv", value: []},
                spotLightDistance: {type: "fv1", value: []},
                spotLightAngleCos: {type: "fv1", value: []},
                spotLightExponent: {type: "fv1", value: []},
                spotLightDecay: {type: "fv1", value: []}
            },
            particle: {
                psColor: {type: "c", value: new n.Color(15658734)},
                opacity: {type: "f", value: 1},
                size: {type: "f", value: 1},
                scale: {type: "f", value: 1},
                map: {type: "t", value: null},
                offsetRepeat: {type: "v4", value: new n.Vector4(0, 0, 1, 1)},
                fogDensity: {type: "f", value: 25e-5},
                fogNear: {type: "f", value: 1},
                fogFar: {type: "f", value: 2e3},
                fogColor: {type: "c", value: new n.Color(16777215)}
            },
            shadowmap: {
                shadowMap: {type: "tv", value: []},
                shadowMapSize: {type: "v2v", value: []},
                shadowBias: {type: "fv1", value: []},
                shadowDarkness: {type: "fv1", value: []},
                shadowMatrix: {type: "m4v", value: []}
            }
        },n.ShaderLib = {
            basic: {
                uniforms: n.UniformsUtils.merge([n.UniformsLib.common, n.UniformsLib.fog, n.UniformsLib.shadowmap]),
                vertexShader: [n.ShaderChunk.common, n.ShaderChunk.map_pars_vertex, n.ShaderChunk.lightmap_pars_vertex, n.ShaderChunk.envmap_pars_vertex, n.ShaderChunk.color_pars_vertex, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.skinning_pars_vertex, n.ShaderChunk.shadowmap_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.map_vertex, n.ShaderChunk.lightmap_vertex, n.ShaderChunk.color_vertex, n.ShaderChunk.skinbase_vertex, "	#ifdef USE_ENVMAP", n.ShaderChunk.morphnormal_vertex, n.ShaderChunk.skinnormal_vertex, n.ShaderChunk.defaultnormal_vertex, "	#endif", n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.skinning_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, n.ShaderChunk.worldpos_vertex, n.ShaderChunk.envmap_vertex, n.ShaderChunk.shadowmap_vertex, "}"].join("\n"),
                fragmentShader: ["uniform vec3 diffuse;", "uniform float opacity;", n.ShaderChunk.common, n.ShaderChunk.color_pars_fragment, n.ShaderChunk.map_pars_fragment, n.ShaderChunk.alphamap_pars_fragment, n.ShaderChunk.lightmap_pars_fragment, n.ShaderChunk.envmap_pars_fragment, n.ShaderChunk.fog_pars_fragment, n.ShaderChunk.shadowmap_pars_fragment, n.ShaderChunk.specularmap_pars_fragment, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	vec3 outgoingLight = vec3( 0.0 );", "	vec4 diffuseColor = vec4( diffuse, opacity );", n.ShaderChunk.logdepthbuf_fragment, n.ShaderChunk.map_fragment, n.ShaderChunk.color_fragment, n.ShaderChunk.alphamap_fragment, n.ShaderChunk.alphatest_fragment, n.ShaderChunk.specularmap_fragment, "	outgoingLight = diffuseColor.rgb;", n.ShaderChunk.lightmap_fragment, n.ShaderChunk.envmap_fragment, n.ShaderChunk.shadowmap_fragment, n.ShaderChunk.linear_to_gamma_fragment, n.ShaderChunk.fog_fragment, "	gl_FragColor = vec4( outgoingLight, diffuseColor.a );", "}"].join("\n")
            },
            lambert: {
                uniforms: n.UniformsUtils.merge([n.UniformsLib.common, n.UniformsLib.fog, n.UniformsLib.lights, n.UniformsLib.shadowmap, {
                    emissive: {
                        type: "c",
                        value: new n.Color(0)
                    }, wrapRGB: {type: "v3", value: new n.Vector3(1, 1, 1)}
                }]),
                vertexShader: ["#define LAMBERT", "varying vec3 vLightFront;", "#ifdef DOUBLE_SIDED", "	varying vec3 vLightBack;", "#endif", n.ShaderChunk.common, n.ShaderChunk.map_pars_vertex, n.ShaderChunk.lightmap_pars_vertex, n.ShaderChunk.envmap_pars_vertex, n.ShaderChunk.lights_lambert_pars_vertex, n.ShaderChunk.color_pars_vertex, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.skinning_pars_vertex, n.ShaderChunk.shadowmap_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.map_vertex, n.ShaderChunk.lightmap_vertex, n.ShaderChunk.color_vertex, n.ShaderChunk.morphnormal_vertex, n.ShaderChunk.skinbase_vertex, n.ShaderChunk.skinnormal_vertex, n.ShaderChunk.defaultnormal_vertex, n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.skinning_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, n.ShaderChunk.worldpos_vertex, n.ShaderChunk.envmap_vertex, n.ShaderChunk.lights_lambert_vertex, n.ShaderChunk.shadowmap_vertex, "}"].join("\n"),
                fragmentShader: ["uniform vec3 diffuse;", "uniform vec3 emissive;", "uniform float opacity;", "varying vec3 vLightFront;", "#ifdef DOUBLE_SIDED", "	varying vec3 vLightBack;", "#endif", n.ShaderChunk.common, n.ShaderChunk.color_pars_fragment, n.ShaderChunk.map_pars_fragment, n.ShaderChunk.alphamap_pars_fragment, n.ShaderChunk.lightmap_pars_fragment, n.ShaderChunk.envmap_pars_fragment, n.ShaderChunk.fog_pars_fragment, n.ShaderChunk.shadowmap_pars_fragment, n.ShaderChunk.specularmap_pars_fragment, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	vec3 outgoingLight = vec3( 0.0 );", "	vec4 diffuseColor = vec4( diffuse, opacity );", n.ShaderChunk.logdepthbuf_fragment, n.ShaderChunk.map_fragment, n.ShaderChunk.color_fragment, n.ShaderChunk.alphamap_fragment, n.ShaderChunk.alphatest_fragment, n.ShaderChunk.specularmap_fragment, "	#ifdef DOUBLE_SIDED", "		if ( gl_FrontFacing )", "			outgoingLight += diffuseColor.rgb * vLightFront + emissive;", "		else", "			outgoingLight += diffuseColor.rgb * vLightBack + emissive;", "	#else", "		outgoingLight += diffuseColor.rgb * vLightFront + emissive;", "	#endif", n.ShaderChunk.lightmap_fragment, n.ShaderChunk.envmap_fragment, n.ShaderChunk.shadowmap_fragment, n.ShaderChunk.linear_to_gamma_fragment, n.ShaderChunk.fog_fragment, "	gl_FragColor = vec4( outgoingLight, diffuseColor.a );", "}"].join("\n")
            },
            phong: {
                uniforms: n.UniformsUtils.merge([n.UniformsLib.common, n.UniformsLib.bump, n.UniformsLib.normalmap, n.UniformsLib.fog, n.UniformsLib.lights, n.UniformsLib.shadowmap, {
                    emissive: {
                        type: "c",
                        value: new n.Color(0)
                    },
                    specular: {type: "c", value: new n.Color(1118481)},
                    shininess: {type: "f", value: 30},
                    wrapRGB: {type: "v3", value: new n.Vector3(1, 1, 1)}
                }]),
                vertexShader: ["#define PHONG", "varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", n.ShaderChunk.common, n.ShaderChunk.map_pars_vertex, n.ShaderChunk.lightmap_pars_vertex, n.ShaderChunk.envmap_pars_vertex, n.ShaderChunk.lights_phong_pars_vertex, n.ShaderChunk.color_pars_vertex, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.skinning_pars_vertex, n.ShaderChunk.shadowmap_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.map_vertex, n.ShaderChunk.lightmap_vertex, n.ShaderChunk.color_vertex, n.ShaderChunk.morphnormal_vertex, n.ShaderChunk.skinbase_vertex, n.ShaderChunk.skinnormal_vertex, n.ShaderChunk.defaultnormal_vertex, "#ifndef FLAT_SHADED", "	vNormal = normalize( transformedNormal );", "#endif", n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.skinning_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, "	vViewPosition = -mvPosition.xyz;", n.ShaderChunk.worldpos_vertex, n.ShaderChunk.envmap_vertex, n.ShaderChunk.lights_phong_vertex, n.ShaderChunk.shadowmap_vertex, "}"].join("\n"),
                fragmentShader: ["#define PHONG", "uniform vec3 diffuse;", "uniform vec3 emissive;", "uniform vec3 specular;", "uniform float shininess;", "uniform float opacity;", n.ShaderChunk.common, n.ShaderChunk.color_pars_fragment, n.ShaderChunk.map_pars_fragment, n.ShaderChunk.alphamap_pars_fragment, n.ShaderChunk.lightmap_pars_fragment, n.ShaderChunk.envmap_pars_fragment, n.ShaderChunk.fog_pars_fragment, n.ShaderChunk.lights_phong_pars_fragment, n.ShaderChunk.shadowmap_pars_fragment, n.ShaderChunk.bumpmap_pars_fragment, n.ShaderChunk.normalmap_pars_fragment, n.ShaderChunk.specularmap_pars_fragment, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	vec3 outgoingLight = vec3( 0.0 );", "	vec4 diffuseColor = vec4( diffuse, opacity );", n.ShaderChunk.logdepthbuf_fragment, n.ShaderChunk.map_fragment, n.ShaderChunk.color_fragment, n.ShaderChunk.alphamap_fragment, n.ShaderChunk.alphatest_fragment, n.ShaderChunk.specularmap_fragment, n.ShaderChunk.lights_phong_fragment, n.ShaderChunk.lightmap_fragment, n.ShaderChunk.envmap_fragment, n.ShaderChunk.shadowmap_fragment, n.ShaderChunk.linear_to_gamma_fragment, n.ShaderChunk.fog_fragment, "	gl_FragColor = vec4( outgoingLight, diffuseColor.a );", "}"].join("\n")
            },
            particle_basic: {
                uniforms: n.UniformsUtils.merge([n.UniformsLib.particle, n.UniformsLib.shadowmap]),
                vertexShader: ["uniform float size;", "uniform float scale;", n.ShaderChunk.common, n.ShaderChunk.color_pars_vertex, n.ShaderChunk.shadowmap_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.color_vertex, "	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );", "	#ifdef USE_SIZEATTENUATION", "		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );", "	#else", "		gl_PointSize = size;", "	#endif", "	gl_Position = projectionMatrix * mvPosition;", n.ShaderChunk.logdepthbuf_vertex, n.ShaderChunk.worldpos_vertex, n.ShaderChunk.shadowmap_vertex, "}"].join("\n"),
                fragmentShader: ["uniform vec3 psColor;", "uniform float opacity;", n.ShaderChunk.common, n.ShaderChunk.color_pars_fragment, n.ShaderChunk.map_particle_pars_fragment, n.ShaderChunk.fog_pars_fragment, n.ShaderChunk.shadowmap_pars_fragment, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	vec3 outgoingLight = vec3( 0.0 );", "	vec4 diffuseColor = vec4( psColor, opacity );", n.ShaderChunk.logdepthbuf_fragment, n.ShaderChunk.map_particle_fragment, n.ShaderChunk.color_fragment, n.ShaderChunk.alphatest_fragment, "	outgoingLight = diffuseColor.rgb;", n.ShaderChunk.shadowmap_fragment, n.ShaderChunk.fog_fragment, "	gl_FragColor = vec4( outgoingLight, diffuseColor.a );", "}"].join("\n")
            },
            dashed: {
                uniforms: n.UniformsUtils.merge([n.UniformsLib.common, n.UniformsLib.fog, {
                    scale: {
                        type: "f",
                        value: 1
                    }, dashSize: {type: "f", value: 1}, totalSize: {type: "f", value: 2}
                }]),
                vertexShader: ["uniform float scale;", "attribute float lineDistance;", "varying float vLineDistance;", n.ShaderChunk.common, n.ShaderChunk.color_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.color_vertex, "	vLineDistance = scale * lineDistance;", "	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );", "	gl_Position = projectionMatrix * mvPosition;", n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: ["uniform vec3 diffuse;", "uniform float opacity;", "uniform float dashSize;", "uniform float totalSize;", "varying float vLineDistance;", n.ShaderChunk.common, n.ShaderChunk.color_pars_fragment, n.ShaderChunk.fog_pars_fragment, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	if ( mod( vLineDistance, totalSize ) > dashSize ) {", "		discard;", "	}", "	vec3 outgoingLight = vec3( 0.0 );", "	vec4 diffuseColor = vec4( diffuse, opacity );", n.ShaderChunk.logdepthbuf_fragment, n.ShaderChunk.color_fragment, "	outgoingLight = diffuseColor.rgb;", n.ShaderChunk.fog_fragment, "	gl_FragColor = vec4( outgoingLight, diffuseColor.a );", "}"].join("\n")
            },
            depth: {
                uniforms: {
                    mNear: {type: "f", value: 1},
                    mFar: {type: "f", value: 2e3},
                    opacity: {type: "f", value: 1}
                },
                vertexShader: [n.ShaderChunk.common, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: ["uniform float mNear;", "uniform float mFar;", "uniform float opacity;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", n.ShaderChunk.logdepthbuf_fragment, "	#ifdef USE_LOGDEPTHBUF_EXT", "		float depth = gl_FragDepthEXT / gl_FragCoord.w;", "	#else", "		float depth = gl_FragCoord.z / gl_FragCoord.w;", "	#endif", "	float color = 1.0 - smoothstep( mNear, mFar, depth );", "	gl_FragColor = vec4( vec3( color ), opacity );", "}"].join("\n")
            },
            normal: {
                uniforms: {opacity: {type: "f", value: 1}},
                vertexShader: ["varying vec3 vNormal;", n.ShaderChunk.common, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", "	vNormal = normalize( normalMatrix * normal );", n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: ["uniform float opacity;", "varying vec3 vNormal;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );", n.ShaderChunk.logdepthbuf_fragment, "}"].join("\n")
            },
            cube: {
                uniforms: {tCube: {type: "t", value: null}, tFlip: {type: "f", value: -1}},
                vertexShader: ["varying vec3 vWorldPosition;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", "	vWorldPosition = transformDirection( position, modelMatrix );", "	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );", n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: ["uniform samplerCube tCube;", "uniform float tFlip;", "varying vec3 vWorldPosition;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );", n.ShaderChunk.logdepthbuf_fragment, "}"].join("\n")
            },
            equirect: {
                uniforms: {tEquirect: {type: "t", value: null}, tFlip: {type: "f", value: -1}},
                vertexShader: ["varying vec3 vWorldPosition;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", "	vWorldPosition = transformDirection( position, modelMatrix );", "	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );", n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: ["uniform sampler2D tEquirect;", "uniform float tFlip;", "varying vec3 vWorldPosition;", n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_fragment, "void main() {", "vec3 direction = normalize( vWorldPosition );", "vec2 sampleUV;", "sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );", "sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;", "gl_FragColor = texture2D( tEquirect, sampleUV );", n.ShaderChunk.logdepthbuf_fragment, "}"].join("\n")
            },
            depthRGBA: {
                uniforms: {},
                vertexShader: [n.ShaderChunk.common, n.ShaderChunk.morphtarget_pars_vertex, n.ShaderChunk.skinning_pars_vertex, n.ShaderChunk.logdepthbuf_pars_vertex, "void main() {", n.ShaderChunk.skinbase_vertex, n.ShaderChunk.morphtarget_vertex, n.ShaderChunk.skinning_vertex, n.ShaderChunk.default_vertex, n.ShaderChunk.logdepthbuf_vertex, "}"].join("\n"),
                fragmentShader: [n.ShaderChunk.common, n.ShaderChunk.logdepthbuf_pars_fragment, "vec4 pack_depth( const in float depth ) {", "	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );", "	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );", "	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );", "	res -= res.xxyz * bit_mask;", "	return res;", "}", "void main() {", n.ShaderChunk.logdepthbuf_fragment, "	#ifdef USE_LOGDEPTHBUF_EXT", "		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );", "	#else", "		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );", "	#endif", "}"].join("\n")
            }
        },n.WebGLRenderer = function (e) {
            function t(e) {
                e.__webglVertexBuffer = ke.createBuffer(), e.__webglColorBuffer = ke.createBuffer(), Be.info.memory.geometries++
            }

            function i(e) {
                e.__webglVertexBuffer = ke.createBuffer(), e.__webglColorBuffer = ke.createBuffer(), e.__webglLineDistanceBuffer = ke.createBuffer(), Be.info.memory.geometries++
            }

            function r(e) {
                e.__webglVertexBuffer = ke.createBuffer(), e.__webglNormalBuffer = ke.createBuffer(), e.__webglTangentBuffer = ke.createBuffer(), e.__webglColorBuffer = ke.createBuffer(), e.__webglUVBuffer = ke.createBuffer(), e.__webglUV2Buffer = ke.createBuffer(), e.__webglSkinIndicesBuffer = ke.createBuffer(), e.__webglSkinWeightsBuffer = ke.createBuffer(), e.__webglFaceBuffer = ke.createBuffer(), e.__webglLineBuffer = ke.createBuffer();
                var t = e.numMorphTargets;
                if (t) {
                    e.__webglMorphTargetsBuffers = [];
                    for (var i = 0, r = t; r > i; i++)e.__webglMorphTargetsBuffers.push(ke.createBuffer())
                }
                var n = e.numMorphNormals;
                if (n) {
                    e.__webglMorphNormalsBuffers = [];
                    for (var i = 0, r = n; r > i; i++)e.__webglMorphNormalsBuffers.push(ke.createBuffer())
                }
                Be.info.memory.geometries++
            }

            function o(e) {
                var t = e.geometry, i = e.material, r = t.vertices.length;
                if (i.attributes) {
                    void 0 === t.__webglCustomAttributesList && (t.__webglCustomAttributesList = []);
                    for (var n in i.attributes) {
                        var o = i.attributes[n];
                        if (!o.__webglInitialized || o.createUniqueBuffers) {
                            o.__webglInitialized = !0;
                            var a = 1;
                            "v2" === o.type ? a = 2 : "v3" === o.type ? a = 3 : "v4" === o.type ? a = 4 : "c" === o.type && (a = 3), o.size = a, o.array = new Float32Array(r * a), o.buffer = ke.createBuffer(), o.buffer.belongsToAttribute = n, o.needsUpdate = !0
                        }
                        t.__webglCustomAttributesList.push(o)
                    }
                }
            }

            function a(e, t) {
                var i = e.vertices.length;
                e.__vertexArray = new Float32Array(3 * i), e.__colorArray = new Float32Array(3 * i), e.__webglParticleCount = i, o(t)
            }

            function s(e, t) {
                var i = e.vertices.length;
                e.__vertexArray = new Float32Array(3 * i), e.__colorArray = new Float32Array(3 * i), e.__lineDistanceArray = new Float32Array(1 * i), e.__webglLineCount = i, o(t)
            }

            function h(e, t) {
                var i = t.geometry, r = e.faces3, n = 3 * r.length, o = 1 * r.length, a = 3 * r.length, s = l(t, e);
                e.__vertexArray = new Float32Array(3 * n), e.__normalArray = new Float32Array(3 * n), e.__colorArray = new Float32Array(3 * n), e.__uvArray = new Float32Array(2 * n), i.faceVertexUvs.length > 1 && (e.__uv2Array = new Float32Array(2 * n)), i.hasTangents && (e.__tangentArray = new Float32Array(4 * n)), t.geometry.skinWeights.length && t.geometry.skinIndices.length && (e.__skinIndexArray = new Float32Array(4 * n), e.__skinWeightArray = new Float32Array(4 * n));
                var h = null !== tt.get("OES_element_index_uint") && o > 21845 ? Uint32Array : Uint16Array;
                e.__typeArray = h, e.__faceArray = new h(3 * o), e.__lineArray = new h(2 * a);
                var u = e.numMorphTargets;
                if (u) {
                    e.__morphTargetsArrays = [];
                    for (var c = 0, d = u; d > c; c++)e.__morphTargetsArrays.push(new Float32Array(3 * n))
                }
                var f = e.numMorphNormals;
                if (f) {
                    e.__morphNormalsArrays = [];
                    for (var c = 0, d = f; d > c; c++)e.__morphNormalsArrays.push(new Float32Array(3 * n))
                }
                if (e.__webglFaceCount = 3 * o, e.__webglLineCount = 2 * a, s.attributes) {
                    void 0 === e.__webglCustomAttributesList && (e.__webglCustomAttributesList = []);
                    for (var p in s.attributes) {
                        var m = s.attributes[p], g = {};
                        for (var v in m)g[v] = m[v];
                        if (!g.__webglInitialized || g.createUniqueBuffers) {
                            g.__webglInitialized = !0;
                            var y = 1;
                            "v2" === g.type ? y = 2 : "v3" === g.type ? y = 3 : "v4" === g.type ? y = 4 : "c" === g.type && (y = 3), g.size = y, g.array = new Float32Array(n * y), g.buffer = ke.createBuffer(), g.buffer.belongsToAttribute = p, m.needsUpdate = !0, g.__original = m
                        }
                        e.__webglCustomAttributesList.push(g)
                    }
                }
                e.__inittedArrays = !0
            }

            function l(e, t) {
                return e.material instanceof n.MeshFaceMaterial ? e.material.materials[t.materialIndex] : e.material
            }

            function u(e) {
                return e instanceof n.MeshPhongMaterial == !1 && e.shading === n.FlatShading
            }

            function c(e, t, i) {
                var r, n, o, a, s, h, l, u, c, d, f, p = e.vertices, m = p.length, g = e.colors, v = g.length, y = e.__vertexArray, b = e.__colorArray, w = e.verticesNeedUpdate, _ = e.colorsNeedUpdate, x = e.__webglCustomAttributesList;
                if (w) {
                    for (r = 0; m > r; r++)o = p[r], a = 3 * r, y[a] = o.x, y[a + 1] = o.y, y[a + 2] = o.z;
                    ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglVertexBuffer), ke.bufferData(ke.ARRAY_BUFFER, y, t)
                }
                if (_) {
                    for (n = 0; v > n; n++)s = g[n], a = 3 * n, b[a] = s.r, b[a + 1] = s.g, b[a + 2] = s.b;
                    ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglColorBuffer), ke.bufferData(ke.ARRAY_BUFFER, b, t)
                }
                if (x)for (h = 0, l = x.length; l > h; h++) {
                    if (f = x[h], f.needsUpdate && (void 0 === f.boundTo || "vertices" === f.boundTo))if (c = f.value.length, a = 0, 1 === f.size)for (u = 0; c > u; u++)f.array[u] = f.value[u]; else if (2 === f.size)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, a += 2; else if (3 === f.size)if ("c" === f.type)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.r, f.array[a + 1] = d.g, f.array[a + 2] = d.b, a += 3; else for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, f.array[a + 2] = d.z, a += 3; else if (4 === f.size)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, f.array[a + 2] = d.z, f.array[a + 3] = d.w, a += 4;
                    ke.bindBuffer(ke.ARRAY_BUFFER, f.buffer), ke.bufferData(ke.ARRAY_BUFFER, f.array, t), f.needsUpdate = !1
                }
            }

            function d(e, t) {
                var i, r, n, o, a, s, h, l, u, c, d, f, p = e.vertices, m = e.colors, g = e.lineDistances, v = p.length, y = m.length, b = g.length, w = e.__vertexArray, _ = e.__colorArray, x = e.__lineDistanceArray, S = e.verticesNeedUpdate, E = e.colorsNeedUpdate, M = e.lineDistancesNeedUpdate, A = e.__webglCustomAttributesList;
                if (S) {
                    for (i = 0; v > i; i++)o = p[i], a = 3 * i, w[a] = o.x, w[a + 1] = o.y, w[a + 2] = o.z;
                    ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglVertexBuffer), ke.bufferData(ke.ARRAY_BUFFER, w, t)
                }
                if (E) {
                    for (r = 0; y > r; r++)s = m[r], a = 3 * r, _[a] = s.r, _[a + 1] = s.g, _[a + 2] = s.b;
                    ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglColorBuffer), ke.bufferData(ke.ARRAY_BUFFER, _, t)
                }
                if (M) {
                    for (n = 0; b > n; n++)x[n] = g[n];
                    ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglLineDistanceBuffer), ke.bufferData(ke.ARRAY_BUFFER, x, t)
                }
                if (A)for (h = 0, l = A.length; l > h; h++)if (f = A[h], f.needsUpdate && (void 0 === f.boundTo || "vertices" === f.boundTo)) {
                    if (a = 0, c = f.value.length, 1 === f.size)for (u = 0; c > u; u++)f.array[u] = f.value[u]; else if (2 === f.size)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, a += 2; else if (3 === f.size)if ("c" === f.type)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.r, f.array[a + 1] = d.g, f.array[a + 2] = d.b, a += 3; else for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, f.array[a + 2] = d.z, a += 3; else if (4 === f.size)for (u = 0; c > u; u++)d = f.value[u], f.array[a] = d.x, f.array[a + 1] = d.y, f.array[a + 2] = d.z, f.array[a + 3] = d.w, a += 4;
                    ke.bindBuffer(ke.ARRAY_BUFFER, f.buffer), ke.bufferData(ke.ARRAY_BUFFER, f.array, t), f.needsUpdate = !1
                }
            }

            function f(e, t, i, r, o) {
                if (e.__inittedArrays) {
                    var a, s, h, l, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C, P, L, k, B, R, I, F, D, O, N, U, z, V, W, H, G, j, Y, Z, X, q = u(o), K = 0, Q = 0, J = 0, $ = 0, ee = 0, te = 0, ie = 0, re = 0, ne = 0, oe = 0, ae = 0, se = 0, he = e.__vertexArray, le = e.__uvArray, ue = e.__uv2Array, ce = e.__normalArray, de = e.__tangentArray, fe = e.__colorArray, pe = e.__skinIndexArray, me = e.__skinWeightArray, ge = e.__morphTargetsArrays, ve = e.__morphNormalsArrays, ye = e.__webglCustomAttributesList, be = e.__faceArray, we = e.__lineArray, _e = t.geometry, xe = _e.verticesNeedUpdate, Se = _e.elementsNeedUpdate, Ee = _e.uvsNeedUpdate, Me = _e.normalsNeedUpdate, Ae = _e.tangentsNeedUpdate, Te = _e.colorsNeedUpdate, Ce = _e.morphTargetsNeedUpdate, Pe = _e.vertices, Le = e.faces3, Be = _e.faces, Re = _e.faceVertexUvs[0], Ie = _e.faceVertexUvs[1], Fe = _e.skinIndices, De = _e.skinWeights, Oe = _e.morphTargets, Ne = _e.morphNormals;
                    if (xe) {
                        for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], y = Pe[l.a], b = Pe[l.b], w = Pe[l.c], he[Q] = y.x, he[Q + 1] = y.y, he[Q + 2] = y.z, he[Q + 3] = b.x, he[Q + 4] = b.y, he[Q + 5] = b.z, he[Q + 6] = w.x, he[Q + 7] = w.y, he[Q + 8] = w.z, Q += 9;
                        ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglVertexBuffer), ke.bufferData(ke.ARRAY_BUFFER, he, i)
                    }
                    if (Ce)for (V = 0, W = Oe.length; W > V; V++) {
                        for (ae = 0, a = 0, s = Le.length; s > a; a++)j = Le[a], l = Be[j], y = Oe[V].vertices[l.a], b = Oe[V].vertices[l.b], w = Oe[V].vertices[l.c], H = ge[V], H[ae] = y.x, H[ae + 1] = y.y, H[ae + 2] = y.z, H[ae + 3] = b.x, H[ae + 4] = b.y, H[ae + 5] = b.z, H[ae + 6] = w.x, H[ae + 7] = w.y, H[ae + 8] = w.z, o.morphNormals && (q ? (E = Ne[V].faceNormals[j], M = E, A = E) : (Y = Ne[V].vertexNormals[j], E = Y.a, M = Y.b, A = Y.c), G = ve[V], G[ae] = E.x, G[ae + 1] = E.y, G[ae + 2] = E.z, G[ae + 3] = M.x, G[ae + 4] = M.y, G[ae + 5] = M.z, G[ae + 6] = A.x, G[ae + 7] = A.y, G[ae + 8] = A.z), ae += 9;
                        ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglMorphTargetsBuffers[V]), ke.bufferData(ke.ARRAY_BUFFER, ge[V], i), o.morphNormals && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglMorphNormalsBuffers[V]), ke.bufferData(ke.ARRAY_BUFFER, ve[V], i))
                    }
                    if (De.length) {
                        for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], L = De[l.a], k = De[l.b], B = De[l.c], me[oe] = L.x, me[oe + 1] = L.y, me[oe + 2] = L.z, me[oe + 3] = L.w, me[oe + 4] = k.x, me[oe + 5] = k.y, me[oe + 6] = k.z, me[oe + 7] = k.w, me[oe + 8] = B.x, me[oe + 9] = B.y, me[oe + 10] = B.z, me[oe + 11] = B.w, R = Fe[l.a], I = Fe[l.b], F = Fe[l.c], pe[oe] = R.x, pe[oe + 1] = R.y, pe[oe + 2] = R.z, pe[oe + 3] = R.w, pe[oe + 4] = I.x, pe[oe + 5] = I.y, pe[oe + 6] = I.z, pe[oe + 7] = I.w, pe[oe + 8] = F.x, pe[oe + 9] = F.y, pe[oe + 10] = F.z, pe[oe + 11] = F.w, oe += 12;
                        oe > 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglSkinIndicesBuffer), ke.bufferData(ke.ARRAY_BUFFER, pe, i), ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglSkinWeightsBuffer), ke.bufferData(ke.ARRAY_BUFFER, me, i))
                    }
                    if (Te) {
                        for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], f = l.vertexColors, p = l.color, 3 === f.length && o.vertexColors === n.VertexColors ? (T = f[0], C = f[1], P = f[2]) : (T = p, C = p, P = p), fe[ne] = T.r, fe[ne + 1] = T.g, fe[ne + 2] = T.b, fe[ne + 3] = C.r, fe[ne + 4] = C.g, fe[ne + 5] = C.b, fe[ne + 6] = P.r, fe[ne + 7] = P.g, fe[ne + 8] = P.b, ne += 9;
                        ne > 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglColorBuffer), ke.bufferData(ke.ARRAY_BUFFER, fe, i))
                    }
                    if (Ae && _e.hasTangents) {
                        for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], m = l.vertexTangents, _ = m[0], x = m[1], S = m[2], de[ie] = _.x, de[ie + 1] = _.y, de[ie + 2] = _.z, de[ie + 3] = _.w, de[ie + 4] = x.x, de[ie + 5] = x.y, de[ie + 6] = x.z, de[ie + 7] = x.w, de[ie + 8] = S.x, de[ie + 9] = S.y, de[ie + 10] = S.z, de[ie + 11] = S.w, ie += 12;
                        ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglTangentBuffer), ke.bufferData(ke.ARRAY_BUFFER, de, i)
                    }
                    if (Me) {
                        for (a = 0, s = Le.length; s > a; a++)if (l = Be[Le[a]], c = l.vertexNormals, d = l.normal, 3 === c.length && q === !1)for (D = 0; 3 > D; D++)N = c[D], ce[te] = N.x, ce[te + 1] = N.y, ce[te + 2] = N.z, te += 3; else for (D = 0; 3 > D; D++)ce[te] = d.x, ce[te + 1] = d.y, ce[te + 2] = d.z, te += 3;
                        ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglNormalBuffer), ke.bufferData(ke.ARRAY_BUFFER, ce, i)
                    }
                    if (Ee && Re) {
                        for (a = 0, s = Le.length; s > a; a++)if (h = Le[a], g = Re[h], void 0 !== g)for (D = 0; 3 > D; D++)U = g[D], le[J] = U.x, le[J + 1] = U.y, J += 2;
                        J > 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglUVBuffer), ke.bufferData(ke.ARRAY_BUFFER, le, i))
                    }
                    if (Ee && Ie) {
                        for (a = 0, s = Le.length; s > a; a++)if (h = Le[a], v = Ie[h], void 0 !== v)for (D = 0; 3 > D; D++)z = v[D], ue[$] = z.x, ue[$ + 1] = z.y, $ += 2;
                        $ > 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglUV2Buffer), ke.bufferData(ke.ARRAY_BUFFER, ue, i))
                    }
                    if (Se) {
                        for (a = 0, s = Le.length; s > a; a++)be[ee] = K, be[ee + 1] = K + 1, be[ee + 2] = K + 2, ee += 3, we[re] = K, we[re + 1] = K + 1, we[re + 2] = K, we[re + 3] = K + 2, we[re + 4] = K + 1, we[re + 5] = K + 2, re += 6, K += 3;
                        ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, e.__webglFaceBuffer), ke.bufferData(ke.ELEMENT_ARRAY_BUFFER, be, i), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, e.__webglLineBuffer), ke.bufferData(ke.ELEMENT_ARRAY_BUFFER, we, i)
                    }
                    if (ye)for (D = 0, O = ye.length; O > D; D++)if (X = ye[D], X.__original.needsUpdate) {
                        if (se = 0, 1 === X.size) {
                            if (void 0 === X.boundTo || "vertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], X.array[se] = X.value[l.a], X.array[se + 1] = X.value[l.b], X.array[se + 2] = X.value[l.c], se += 3; else if ("faces" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], X.array[se] = Z, X.array[se + 1] = Z, X.array[se + 2] = Z, se += 3
                        } else if (2 === X.size) {
                            if (void 0 === X.boundTo || "vertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], y = X.value[l.a], b = X.value[l.b], w = X.value[l.c], X.array[se] = y.x, X.array[se + 1] = y.y, X.array[se + 2] = b.x, X.array[se + 3] = b.y, X.array[se + 4] = w.x, X.array[se + 5] = w.y, se += 6; else if ("faces" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], y = Z, b = Z, w = Z, X.array[se] = y.x, X.array[se + 1] = y.y, X.array[se + 2] = b.x, X.array[se + 3] = b.y, X.array[se + 4] = w.x, X.array[se + 5] = w.y, se += 6
                        } else if (3 === X.size) {
                            var Ue;
                            if (Ue = "c" === X.type ? ["r", "g", "b"] : ["x", "y", "z"], void 0 === X.boundTo || "vertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], y = X.value[l.a], b = X.value[l.b], w = X.value[l.c], X.array[se] = y[Ue[0]], X.array[se + 1] = y[Ue[1]], X.array[se + 2] = y[Ue[2]], X.array[se + 3] = b[Ue[0]], X.array[se + 4] = b[Ue[1]], X.array[se + 5] = b[Ue[2]], X.array[se + 6] = w[Ue[0]], X.array[se + 7] = w[Ue[1]], X.array[se + 8] = w[Ue[2]], se += 9; else if ("faces" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], y = Z, b = Z, w = Z, X.array[se] = y[Ue[0]], X.array[se + 1] = y[Ue[1]], X.array[se + 2] = y[Ue[2]], X.array[se + 3] = b[Ue[0]], X.array[se + 4] = b[Ue[1]], X.array[se + 5] = b[Ue[2]], X.array[se + 6] = w[Ue[0]], X.array[se + 7] = w[Ue[1]], X.array[se + 8] = w[Ue[2]], se += 9; else if ("faceVertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], y = Z[0], b = Z[1], w = Z[2], X.array[se] = y[Ue[0]], X.array[se + 1] = y[Ue[1]], X.array[se + 2] = y[Ue[2]], X.array[se + 3] = b[Ue[0]], X.array[se + 4] = b[Ue[1]], X.array[se + 5] = b[Ue[2]], X.array[se + 6] = w[Ue[0]], X.array[se + 7] = w[Ue[1]], X.array[se + 8] = w[Ue[2]], se += 9
                        } else if (4 === X.size)if (void 0 === X.boundTo || "vertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)l = Be[Le[a]], y = X.value[l.a], b = X.value[l.b], w = X.value[l.c], X.array[se] = y.x, X.array[se + 1] = y.y, X.array[se + 2] = y.z, X.array[se + 3] = y.w, X.array[se + 4] = b.x, X.array[se + 5] = b.y, X.array[se + 6] = b.z, X.array[se + 7] = b.w, X.array[se + 8] = w.x, X.array[se + 9] = w.y, X.array[se + 10] = w.z, X.array[se + 11] = w.w, se += 12; else if ("faces" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], y = Z, b = Z, w = Z, X.array[se] = y.x, X.array[se + 1] = y.y, X.array[se + 2] = y.z, X.array[se + 3] = y.w, X.array[se + 4] = b.x, X.array[se + 5] = b.y, X.array[se + 6] = b.z, X.array[se + 7] = b.w, X.array[se + 8] = w.x, X.array[se + 9] = w.y, X.array[se + 10] = w.z, X.array[se + 11] = w.w, se += 12; else if ("faceVertices" === X.boundTo)for (a = 0, s = Le.length; s > a; a++)Z = X.value[Le[a]], y = Z[0], b = Z[1], w = Z[2], X.array[se] = y.x, X.array[se + 1] = y.y, X.array[se + 2] = y.z, X.array[se + 3] = y.w, X.array[se + 4] = b.x, X.array[se + 5] = b.y, X.array[se + 6] = b.z, X.array[se + 7] = b.w, X.array[se + 8] = w.x, X.array[se + 9] = w.y, X.array[se + 10] = w.z, X.array[se + 11] = w.w, se += 12;
                        ke.bindBuffer(ke.ARRAY_BUFFER, X.buffer), ke.bufferData(ke.ARRAY_BUFFER, X.array, i)
                    }
                    r && (delete e.__inittedArrays, delete e.__colorArray, delete e.__normalArray, delete e.__tangentArray, delete e.__uvArray, delete e.__uv2Array, delete e.__faceArray, delete e.__vertexArray, delete e.__lineArray, delete e.__skinIndexArray, delete e.__skinWeightArray)
                }
            }

            function p(e, t, i, r) {
                for (var n = i.attributes, o = t.attributes, a = t.attributesKeys, s = 0, h = a.length; h > s; s++) {
                    var l = a[s], u = o[l];
                    if (u >= 0) {
                        var c = n[l];
                        if (void 0 !== c) {
                            var d = c.itemSize;
                            ke.bindBuffer(ke.ARRAY_BUFFER, c.buffer), et.enableAttribute(u), ke.vertexAttribPointer(u, d, ke.FLOAT, !1, 0, r * d * 4)
                        } else void 0 !== e.defaultAttributeValues && (2 === e.defaultAttributeValues[l].length ? ke.vertexAttrib2fv(u, e.defaultAttributeValues[l]) : 3 === e.defaultAttributeValues[l].length && ke.vertexAttrib3fv(u, e.defaultAttributeValues[l]))
                    }
                }
                et.disableUnusedAttributes()
            }

            function m(e, t, i) {
                var r = e.program.attributes;
                if (-1 !== i.morphTargetBase && r.position >= 0 ? (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglMorphTargetsBuffers[i.morphTargetBase]), et.enableAttribute(r.position), ke.vertexAttribPointer(r.position, 3, ke.FLOAT, !1, 0, 0)) : r.position >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglVertexBuffer), et.enableAttribute(r.position), ke.vertexAttribPointer(r.position, 3, ke.FLOAT, !1, 0, 0)), i.morphTargetForcedOrder.length)for (var n, o = 0, a = i.morphTargetForcedOrder, s = i.morphTargetInfluences; o < e.numSupportedMorphTargets && o < a.length;)n = r["morphTarget" + o], n >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglMorphTargetsBuffers[a[o]]), et.enableAttribute(n), ke.vertexAttribPointer(n, 3, ke.FLOAT, !1, 0, 0)), n = r["morphNormal" + o], n >= 0 && e.morphNormals && (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglMorphNormalsBuffers[a[o]]), et.enableAttribute(n), ke.vertexAttribPointer(n, 3, ke.FLOAT, !1, 0, 0)), i.__webglMorphTargetInfluences[o] = s[a[o]], o++; else {
                    var h = [], s = i.morphTargetInfluences, l = i.geometry.morphTargets;
                    s.length > l.length && (console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."), s.length = l.length);
                    for (var u = 0, c = s.length; c > u; u++) {
                        var d = s[u];
                        h.push([d, u])
                    }
                    h.length > e.numSupportedMorphTargets ? (h.sort(y), h.length = e.numSupportedMorphTargets) : h.length > e.numSupportedMorphNormals ? h.sort(y) : 0 === h.length && h.push([0, 0]);
                    for (var n, o = 0, f = e.numSupportedMorphTargets; f > o; o++)if (h[o]) {
                        var p = h[o][1];
                        n = r["morphTarget" + o], n >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglMorphTargetsBuffers[p]), et.enableAttribute(n), ke.vertexAttribPointer(n, 3, ke.FLOAT, !1, 0, 0)), n = r["morphNormal" + o], n >= 0 && e.morphNormals && (ke.bindBuffer(ke.ARRAY_BUFFER, t.__webglMorphNormalsBuffers[p]), et.enableAttribute(n), ke.vertexAttribPointer(n, 3, ke.FLOAT, !1, 0, 0)), i.__webglMorphTargetInfluences[o] = s[p]
                    } else i.__webglMorphTargetInfluences[o] = 0
                }
                null !== e.program.uniforms.morphTargetInfluences && ke.uniform1fv(e.program.uniforms.morphTargetInfluences, i.__webglMorphTargetInfluences)
            }

            function g(e, t) {
                return e.object.renderOrder !== t.object.renderOrder ? e.object.renderOrder - t.object.renderOrder : e.material.id !== t.material.id ? e.material.id - t.material.id : e.z !== t.z ? e.z - t.z : e.id - t.id
            }

            function v(e, t) {
                return e.object.renderOrder !== t.object.renderOrder ? e.object.renderOrder - t.object.renderOrder : e.z !== t.z ? t.z - e.z : e.id - t.id
            }

            function y(e, t) {
                return t[0] - e[0]
            }

            function b(e) {
                if (e.visible !== !1) {
                    if (e instanceof n.Scene || e instanceof n.Group); else if (E(e), e instanceof n.Light)Ee.push(e); else if (e instanceof n.Sprite)Pe.push(e); else if (e instanceof n.LensFlare)Le.push(e); else {
                        var t = Me[e.id];
                        if (t && (e.frustumCulled === !1 || Ye.intersectsObject(e) === !0))for (var i = 0, r = t.length; r > i; i++) {
                            var o = t[i];
                            S(o), o.render = !0, Be.sortObjects === !0 && (Xe.setFromMatrixPosition(e.matrixWorld), Xe.applyProjection(Ze), o.z = Xe.z)
                        }
                    }
                    for (var i = 0, r = e.children.length; r > i; i++)b(e.children[i])
                }
            }

            function w(e, t, i, r, o) {
                for (var a, s = 0, h = e.length; h > s; s++) {
                    var l = e[s], u = l.object, c = l.buffer;
                    if (K(u, t), o)a = o; else {
                        if (a = l.material, !a)continue;
                        F(a)
                    }
                    Be.setMaterialFaces(a), c instanceof n.BufferGeometry ? Be.renderBufferDirect(t, i, r, a, c, u) : Be.renderBuffer(t, i, r, a, c, u)
                }
            }

            function _(e, t, i, r, n, o) {
                for (var a, s = 0, h = e.length; h > s; s++) {
                    var l = e[s], u = l.object;
                    if (u.visible) {
                        if (o)a = o; else {
                            if (a = l[t], !a)continue;
                            F(a)
                        }
                        Be.renderImmediateObject(i, r, n, a, u)
                    }
                }
            }

            function x(e) {
                var t = e.object, i = t.material;
                i.transparent ? (e.transparent = i, e.opaque = null) : (e.opaque = i, e.transparent = null)
            }

            function S(e) {
                var t = e.object, i = e.buffer, r = t.geometry, o = t.material;
                if (o instanceof n.MeshFaceMaterial) {
                    var a = r instanceof n.BufferGeometry ? 0 : i.materialIndex;
                    o = o.materials[a], e.material = o, o.transparent ? Ce.push(e) : Te.push(e)
                } else o && (e.material = o, o.transparent ? Ce.push(e) : Te.push(e))
            }

            function E(e) {
                void 0 === e.__webglInit && (e.__webglInit = !0, e._modelViewMatrix = new n.Matrix4, e._normalMatrix = new n.Matrix3, e.addEventListener("removed", _t));
                var r = e.geometry;
                if (void 0 === r || void 0 === r.__webglInit && (r.__webglInit = !0, r.addEventListener("dispose", xt), r instanceof n.BufferGeometry ? Be.info.memory.geometries++ : e instanceof n.Mesh ? A(e, r) : e instanceof n.Line ? void 0 === r.__webglVertexBuffer && (i(r), s(r, e), r.verticesNeedUpdate = !0, r.colorsNeedUpdate = !0, r.lineDistancesNeedUpdate = !0) : e instanceof n.PointCloud && void 0 === r.__webglVertexBuffer && (t(r), a(r, e), r.verticesNeedUpdate = !0, r.colorsNeedUpdate = !0)), void 0 === e.__webglActive)if (e.__webglActive = !0, e instanceof n.Mesh) {
                    if (r instanceof n.BufferGeometry)T(Me, r, e); else if (r instanceof n.Geometry)for (var o = kt[r.id], h = 0, l = o.length; l > h; h++)T(Me, o[h], e)
                } else e instanceof n.Line || e instanceof n.PointCloud ? T(Me, r, e) : (e instanceof n.ImmediateRenderObject || e.immediateRenderCallback) && C(Ae, e)
            }

            function M(e, t) {
                for (var i, r, n = tt.get("OES_element_index_uint") ? 4294967296 : 65535, o = {}, a = e.morphTargets.length, s = e.morphNormals.length, h = {}, l = [], u = 0, c = e.faces.length; c > u; u++) {
                    var d = e.faces[u], f = t ? d.materialIndex : 0;
                    f in o || (o[f] = {
                        hash: f,
                        counter: 0
                    }), i = o[f].hash + "_" + o[f].counter, i in h || (r = {
                        id: Bt++,
                        faces3: [],
                        materialIndex: f,
                        vertices: 0,
                        numMorphTargets: a,
                        numMorphNormals: s
                    }, h[i] = r, l.push(r)), h[i].vertices + 3 > n && (o[f].counter += 1, i = o[f].hash + "_" + o[f].counter, i in h || (r = {
                        id: Bt++,
                        faces3: [],
                        materialIndex: f,
                        vertices: 0,
                        numMorphTargets: a,
                        numMorphNormals: s
                    }, h[i] = r, l.push(r))), h[i].faces3.push(u), h[i].vertices += 3
                }
                return l
            }

            function A(e, t) {
                var i = e.material, o = !1;
                (void 0 === kt[t.id] || t.groupsNeedUpdate === !0) && (delete Me[e.id], kt[t.id] = M(t, i instanceof n.MeshFaceMaterial), t.groupsNeedUpdate = !1);
                for (var a = kt[t.id], s = 0, l = a.length; l > s; s++) {
                    var u = a[s];
                    void 0 === u.__webglVertexBuffer ? (r(u), h(u, e), t.verticesNeedUpdate = !0, t.morphTargetsNeedUpdate = !0, t.elementsNeedUpdate = !0, t.uvsNeedUpdate = !0, t.normalsNeedUpdate = !0, t.tangentsNeedUpdate = !0, t.colorsNeedUpdate = !0, o = !0) : o = !1, (o || void 0 === e.__webglActive) && T(Me, u, e)
                }
                e.__webglActive = !0
            }

            function T(e, t, i) {
                var r = i.id;
                e[r] = e[r] || [], e[r].push({id: r, buffer: t, object: i, material: null, z: 0})
            }

            function C(e, t) {
                e.push({id: null, object: t, opaque: null, transparent: null, z: 0})
            }

            function P(e) {
                var t = e.geometry;
                if (t instanceof n.BufferGeometry)for (var i = t.attributes, r = t.attributesKeys, o = 0, a = r.length; a > o; o++) {
                    var s = r[o], h = i[s], u = "index" === s ? ke.ELEMENT_ARRAY_BUFFER : ke.ARRAY_BUFFER;
                    void 0 === h.buffer ? (h.buffer = ke.createBuffer(), ke.bindBuffer(u, h.buffer), ke.bufferData(u, h.array, h instanceof n.DynamicBufferAttribute ? ke.DYNAMIC_DRAW : ke.STATIC_DRAW), h.needsUpdate = !1) : h.needsUpdate === !0 && (ke.bindBuffer(u, h.buffer), void 0 === h.updateRange || -1 === h.updateRange.count ? ke.bufferSubData(u, 0, h.array) : 0 === h.updateRange.count ? console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually.") : (ke.bufferSubData(u, h.updateRange.offset * h.array.BYTES_PER_ELEMENT, h.array.subarray(h.updateRange.offset, h.updateRange.offset + h.updateRange.count)), h.updateRange.count = 0), h.needsUpdate = !1)
                } else if (e instanceof n.Mesh) {
                    t.groupsNeedUpdate === !0 && A(e, t);
                    for (var p = kt[t.id], o = 0, m = p.length; m > o; o++) {
                        var g = p[o], v = l(e, g), y = v.attributes && L(v);
                        (t.verticesNeedUpdate || t.morphTargetsNeedUpdate || t.elementsNeedUpdate || t.uvsNeedUpdate || t.normalsNeedUpdate || t.colorsNeedUpdate || t.tangentsNeedUpdate || y) && f(g, e, ke.DYNAMIC_DRAW, !t.dynamic, v)
                    }
                    t.verticesNeedUpdate = !1, t.morphTargetsNeedUpdate = !1, t.elementsNeedUpdate = !1, t.uvsNeedUpdate = !1, t.normalsNeedUpdate = !1, t.colorsNeedUpdate = !1, t.tangentsNeedUpdate = !1, v.attributes && k(v)
                } else if (e instanceof n.Line) {
                    var v = l(e, t), y = v.attributes && L(v);
                    (t.verticesNeedUpdate || t.colorsNeedUpdate || t.lineDistancesNeedUpdate || y) && d(t, ke.DYNAMIC_DRAW), t.verticesNeedUpdate = !1, t.colorsNeedUpdate = !1, t.lineDistancesNeedUpdate = !1, v.attributes && k(v)
                } else if (e instanceof n.PointCloud) {
                    var v = l(e, t), y = v.attributes && L(v);
                    (t.verticesNeedUpdate || t.colorsNeedUpdate || y) && c(t, ke.DYNAMIC_DRAW, e), t.verticesNeedUpdate = !1, t.colorsNeedUpdate = !1, v.attributes && k(v)
                }
            }

            function L(e) {
                for (var t in e.attributes)if (e.attributes[t].needsUpdate)return !0;
                return !1
            }

            function k(e) {
                for (var t in e.attributes)e.attributes[t].needsUpdate = !1
            }

            function B(e) {
                e instanceof n.Mesh || e instanceof n.PointCloud || e instanceof n.Line ? delete Me[e.id] : (e instanceof n.ImmediateRenderObject || e.immediateRenderCallback) && R(Ae, e), delete e.__webglInit, delete e._modelViewMatrix, delete e._normalMatrix, delete e.__webglActive
            }

            function R(e, t) {
                for (var i = e.length - 1; i >= 0; i--)e[i].object === t && e.splice(i, 1)
            }

            function I(e, t, i, r) {
                e.addEventListener("dispose", Mt);
                var o = Rt[e.type];
                if (o) {
                    var a = n.ShaderLib[o];
                    e.__webglShader = {
                        uniforms: n.UniformsUtils.clone(a.uniforms),
                        vertexShader: a.vertexShader,
                        fragmentShader: a.fragmentShader
                    }
                } else e.__webglShader = {
                    uniforms: e.uniforms,
                    vertexShader: e.vertexShader,
                    fragmentShader: e.fragmentShader
                };
                var s = le(t), h = ue(t), l = he(r), u = {
                    precision: pe,
                    supportsVertexTextures: lt,
                    map: !!e.map,
                    envMap: !!e.envMap,
                    envMapMode: e.envMap && e.envMap.mapping,
                    lightMap: !!e.lightMap,
                    bumpMap: !!e.bumpMap,
                    normalMap: !!e.normalMap,
                    specularMap: !!e.specularMap,
                    alphaMap: !!e.alphaMap,
                    combine: e.combine,
                    vertexColors: e.vertexColors,
                    fog: i,
                    useFog: e.fog,
                    fogExp: i instanceof n.FogExp2,
                    flatShading: e.shading === n.FlatShading,
                    sizeAttenuation: e.sizeAttenuation,
                    logarithmicDepthBuffer: _e,
                    skinning: e.skinning,
                    maxBones: l,
                    useVertexTexture: ut && r && r.skeleton && r.skeleton.useVertexTexture,
                    morphTargets: e.morphTargets,
                    morphNormals: e.morphNormals,
                    maxMorphTargets: Be.maxMorphTargets,
                    maxMorphNormals: Be.maxMorphNormals,
                    maxDirLights: s.directional,
                    maxPointLights: s.point,
                    maxSpotLights: s.spot,
                    maxHemiLights: s.hemi,
                    maxShadows: h,
                    shadowMapEnabled: Be.shadowMapEnabled && r.receiveShadow && h > 0,
                    shadowMapType: Be.shadowMapType,
                    shadowMapDebug: Be.shadowMapDebug,
                    shadowMapCascade: Be.shadowMapCascade,
                    alphaTest: e.alphaTest,
                    metal: e.metal,
                    wrapAround: e.wrapAround,
                    doubleSided: e.side === n.DoubleSide,
                    flipSided: e.side === n.BackSide
                }, c = [];
                if (o ? c.push(o) : (c.push(e.fragmentShader), c.push(e.vertexShader)), void 0 !== e.defines)for (var d in e.defines)c.push(d), c.push(e.defines[d]);
                for (var d in u)c.push(d), c.push(u[d]);
                for (var f, p = c.join(), m = 0, g = Re.length; g > m; m++) {
                    var v = Re[m];
                    if (v.code === p) {
                        f = v, f.usedTimes++;
                        break
                    }
                }
                void 0 === f && (f = new n.WebGLProgram(Be, p, e, u), Re.push(f), Be.info.memory.programs = Re.length), e.program = f;
                var y = f.attributes;
                if (e.morphTargets) {
                    e.numSupportedMorphTargets = 0;
                    for (var b, w = "morphTarget", _ = 0; _ < Be.maxMorphTargets; _++)b = w + _, y[b] >= 0 && e.numSupportedMorphTargets++
                }
                if (e.morphNormals) {
                    e.numSupportedMorphNormals = 0;
                    var b, w = "morphNormal";
                    for (_ = 0; _ < Be.maxMorphNormals; _++)b = w + _, y[b] >= 0 && e.numSupportedMorphNormals++
                }
                e.uniformsList = [];
                for (var x in e.__webglShader.uniforms) {
                    var S = e.program.uniforms[x];
                    S && e.uniformsList.push([e.__webglShader.uniforms[x], S])
                }
            }

            function F(e) {
                e.transparent === !0 ? et.setBlending(e.blending, e.blendEquation, e.blendSrc, e.blendDst, e.blendEquationAlpha, e.blendSrcAlpha, e.blendDstAlpha) : et.setBlending(n.NoBlending), et.setDepthTest(e.depthTest), et.setDepthWrite(e.depthWrite), et.setColorWrite(e.colorWrite), et.setPolygonOffset(e.polygonOffset, e.polygonOffsetFactor, e.polygonOffsetUnits)
            }

            function D(e, t, i, r, o) {
                Ue = 0, r.needsUpdate && (r.program && Lt(r), I(r, t, i, o), r.needsUpdate = !1), r.morphTargets && (o.__webglMorphTargetInfluences || (o.__webglMorphTargetInfluences = new Float32Array(Be.maxMorphTargets)));
                var a = !1, s = !1, h = !1, l = r.program, u = l.uniforms, c = r.__webglShader.uniforms;
                if (l.id !== Ie && (ke.useProgram(l.program), Ie = l.id, a = !0, s = !0, h = !0), r.id !== De && (-1 === De && (h = !0), De = r.id, s = !0), (a || e !== Ne) && (ke.uniformMatrix4fv(u.projectionMatrix, !1, e.projectionMatrix.elements),
                    _e && ke.uniform1f(u.logDepthBufFC, 2 / (Math.log(e.far + 1) / Math.LN2)), e !== Ne && (Ne = e), (r instanceof n.ShaderMaterial || r instanceof n.MeshPhongMaterial || r.envMap) && null !== u.cameraPosition && (Xe.setFromMatrixPosition(e.matrixWorld), ke.uniform3f(u.cameraPosition, Xe.x, Xe.y, Xe.z)), (r instanceof n.MeshPhongMaterial || r instanceof n.MeshLambertMaterial || r instanceof n.MeshBasicMaterial || r instanceof n.ShaderMaterial || r.skinning) && null !== u.viewMatrix && ke.uniformMatrix4fv(u.viewMatrix, !1, e.matrixWorldInverse.elements)), r.skinning)if (o.bindMatrix && null !== u.bindMatrix && ke.uniformMatrix4fv(u.bindMatrix, !1, o.bindMatrix.elements), o.bindMatrixInverse && null !== u.bindMatrixInverse && ke.uniformMatrix4fv(u.bindMatrixInverse, !1, o.bindMatrixInverse.elements), ut && o.skeleton && o.skeleton.useVertexTexture) {
                    if (null !== u.boneTexture) {
                        var d = X();
                        ke.uniform1i(u.boneTexture, d), Be.setTexture(o.skeleton.boneTexture, d)
                    }
                    null !== u.boneTextureWidth && ke.uniform1i(u.boneTextureWidth, o.skeleton.boneTextureWidth), null !== u.boneTextureHeight && ke.uniform1i(u.boneTextureHeight, o.skeleton.boneTextureHeight)
                } else o.skeleton && o.skeleton.boneMatrices && null !== u.boneGlobalMatrices && ke.uniformMatrix4fv(u.boneGlobalMatrices, !1, o.skeleton.boneMatrices);
                return s && (i && r.fog && V(c, i), (r instanceof n.MeshPhongMaterial || r instanceof n.MeshLambertMaterial || r.lights) && (Ke && (h = !0, J(t), Ke = !1), h ? (G(c, Qe), j(c, !0)) : j(c, !1)), (r instanceof n.MeshBasicMaterial || r instanceof n.MeshLambertMaterial || r instanceof n.MeshPhongMaterial) && O(c, r), r instanceof n.LineBasicMaterial ? N(c, r) : r instanceof n.LineDashedMaterial ? (N(c, r), U(c, r)) : r instanceof n.PointCloudMaterial ? z(c, r) : r instanceof n.MeshPhongMaterial ? W(c, r) : r instanceof n.MeshLambertMaterial ? H(c, r) : r instanceof n.MeshDepthMaterial ? (c.mNear.value = e.near, c.mFar.value = e.far, c.opacity.value = r.opacity) : r instanceof n.MeshNormalMaterial && (c.opacity.value = r.opacity), o.receiveShadow && !r._shadowPass && Y(c, t), q(r.uniformsList)), Z(u, o), null !== u.modelMatrix && ke.uniformMatrix4fv(u.modelMatrix, !1, o.matrixWorld.elements), l
            }

            function O(e, t) {
                e.opacity.value = t.opacity, e.diffuse.value = t.color, e.map.value = t.map, e.lightMap.value = t.lightMap, e.specularMap.value = t.specularMap, e.alphaMap.value = t.alphaMap, t.bumpMap && (e.bumpMap.value = t.bumpMap, e.bumpScale.value = t.bumpScale), t.normalMap && (e.normalMap.value = t.normalMap, e.normalScale.value.copy(t.normalScale));
                var i;
                if (t.map ? i = t.map : t.specularMap ? i = t.specularMap : t.normalMap ? i = t.normalMap : t.bumpMap ? i = t.bumpMap : t.alphaMap && (i = t.alphaMap), void 0 !== i) {
                    var r = i.offset, o = i.repeat;
                    e.offsetRepeat.value.set(r.x, r.y, o.x, o.y)
                }
                e.envMap.value = t.envMap, e.flipEnvMap.value = t.envMap instanceof n.WebGLRenderTargetCube ? 1 : -1, e.reflectivity.value = t.reflectivity, e.refractionRatio.value = t.refractionRatio
            }

            function N(e, t) {
                e.diffuse.value = t.color, e.opacity.value = t.opacity
            }

            function U(e, t) {
                e.dashSize.value = t.dashSize, e.totalSize.value = t.dashSize + t.gapSize, e.scale.value = t.scale
            }

            function z(e, t) {
                if (e.psColor.value = t.color, e.opacity.value = t.opacity, e.size.value = t.size, e.scale.value = ce.height / 2, e.map.value = t.map, null !== t.map) {
                    var i = t.map.offset, r = t.map.repeat;
                    e.offsetRepeat.value.set(i.x, i.y, r.x, r.y)
                }
            }

            function V(e, t) {
                e.fogColor.value = t.color, t instanceof n.Fog ? (e.fogNear.value = t.near, e.fogFar.value = t.far) : t instanceof n.FogExp2 && (e.fogDensity.value = t.density)
            }

            function W(e, t) {
                e.shininess.value = t.shininess, e.emissive.value = t.emissive, e.specular.value = t.specular, t.wrapAround && e.wrapRGB.value.copy(t.wrapRGB)
            }

            function H(e, t) {
                e.emissive.value = t.emissive, t.wrapAround && e.wrapRGB.value.copy(t.wrapRGB)
            }

            function G(e, t) {
                e.ambientLightColor.value = t.ambient, e.directionalLightColor.value = t.directional.colors, e.directionalLightDirection.value = t.directional.positions, e.pointLightColor.value = t.point.colors, e.pointLightPosition.value = t.point.positions, e.pointLightDistance.value = t.point.distances, e.pointLightDecay.value = t.point.decays, e.spotLightColor.value = t.spot.colors, e.spotLightPosition.value = t.spot.positions, e.spotLightDistance.value = t.spot.distances, e.spotLightDirection.value = t.spot.directions, e.spotLightAngleCos.value = t.spot.anglesCos, e.spotLightExponent.value = t.spot.exponents, e.spotLightDecay.value = t.spot.decays, e.hemisphereLightSkyColor.value = t.hemi.skyColors, e.hemisphereLightGroundColor.value = t.hemi.groundColors, e.hemisphereLightDirection.value = t.hemi.positions
            }

            function j(e, t) {
                e.ambientLightColor.needsUpdate = t, e.directionalLightColor.needsUpdate = t, e.directionalLightDirection.needsUpdate = t, e.pointLightColor.needsUpdate = t, e.pointLightPosition.needsUpdate = t, e.pointLightDistance.needsUpdate = t, e.pointLightDecay.needsUpdate = t, e.spotLightColor.needsUpdate = t, e.spotLightPosition.needsUpdate = t, e.spotLightDistance.needsUpdate = t, e.spotLightDirection.needsUpdate = t, e.spotLightAngleCos.needsUpdate = t, e.spotLightExponent.needsUpdate = t, e.spotLightDecay.needsUpdate = t, e.hemisphereLightSkyColor.needsUpdate = t, e.hemisphereLightGroundColor.needsUpdate = t, e.hemisphereLightDirection.needsUpdate = t
            }

            function Y(e, t) {
                if (e.shadowMatrix)for (var i = 0, r = 0, o = t.length; o > r; r++) {
                    var a = t[r];
                    a.castShadow && (a instanceof n.SpotLight || a instanceof n.DirectionalLight && !a.shadowCascade) && (e.shadowMap.value[i] = a.shadowMap, e.shadowMapSize.value[i] = a.shadowMapSize, e.shadowMatrix.value[i] = a.shadowMatrix, e.shadowDarkness.value[i] = a.shadowDarkness, e.shadowBias.value[i] = a.shadowBias, i++)
                }
            }

            function Z(e, t) {
                ke.uniformMatrix4fv(e.modelViewMatrix, !1, t._modelViewMatrix.elements), e.normalMatrix && ke.uniformMatrix3fv(e.normalMatrix, !1, t._normalMatrix.elements)
            }

            function X() {
                var e = Ue;
                return e >= ot && n.warn("WebGLRenderer: trying to use " + e + " texture units while this GPU supports only " + ot), Ue += 1, e
            }

            function q(e) {
                for (var t, i, r, o = 0, a = e.length; a > o; o++) {
                    var s = e[o][0];
                    if (s.needsUpdate !== !1) {
                        var h = s.type, l = s.value, u = e[o][1];
                        switch (h) {
                            case"1i":
                                ke.uniform1i(u, l);
                                break;
                            case"1f":
                                ke.uniform1f(u, l);
                                break;
                            case"2f":
                                ke.uniform2f(u, l[0], l[1]);
                                break;
                            case"3f":
                                ke.uniform3f(u, l[0], l[1], l[2]);
                                break;
                            case"4f":
                                ke.uniform4f(u, l[0], l[1], l[2], l[3]);
                                break;
                            case"1iv":
                                ke.uniform1iv(u, l);
                                break;
                            case"3iv":
                                ke.uniform3iv(u, l);
                                break;
                            case"1fv":
                                ke.uniform1fv(u, l);
                                break;
                            case"2fv":
                                ke.uniform2fv(u, l);
                                break;
                            case"3fv":
                                ke.uniform3fv(u, l);
                                break;
                            case"4fv":
                                ke.uniform4fv(u, l);
                                break;
                            case"Matrix3fv":
                                ke.uniformMatrix3fv(u, !1, l);
                                break;
                            case"Matrix4fv":
                                ke.uniformMatrix4fv(u, !1, l);
                                break;
                            case"i":
                                ke.uniform1i(u, l);
                                break;
                            case"f":
                                ke.uniform1f(u, l);
                                break;
                            case"v2":
                                ke.uniform2f(u, l.x, l.y);
                                break;
                            case"v3":
                                ke.uniform3f(u, l.x, l.y, l.z);
                                break;
                            case"v4":
                                ke.uniform4f(u, l.x, l.y, l.z, l.w);
                                break;
                            case"c":
                                ke.uniform3f(u, l.r, l.g, l.b);
                                break;
                            case"iv1":
                                ke.uniform1iv(u, l);
                                break;
                            case"iv":
                                ke.uniform3iv(u, l);
                                break;
                            case"fv1":
                                ke.uniform1fv(u, l);
                                break;
                            case"fv":
                                ke.uniform3fv(u, l);
                                break;
                            case"v2v":
                                void 0 === s._array && (s._array = new Float32Array(2 * l.length));
                                for (var c = 0, d = l.length; d > c; c++)r = 2 * c, s._array[r] = l[c].x, s._array[r + 1] = l[c].y;
                                ke.uniform2fv(u, s._array);
                                break;
                            case"v3v":
                                void 0 === s._array && (s._array = new Float32Array(3 * l.length));
                                for (var c = 0, d = l.length; d > c; c++)r = 3 * c, s._array[r] = l[c].x, s._array[r + 1] = l[c].y, s._array[r + 2] = l[c].z;
                                ke.uniform3fv(u, s._array);
                                break;
                            case"v4v":
                                void 0 === s._array && (s._array = new Float32Array(4 * l.length));
                                for (var c = 0, d = l.length; d > c; c++)r = 4 * c, s._array[r] = l[c].x, s._array[r + 1] = l[c].y, s._array[r + 2] = l[c].z, s._array[r + 3] = l[c].w;
                                ke.uniform4fv(u, s._array);
                                break;
                            case"m3":
                                ke.uniformMatrix3fv(u, !1, l.elements);
                                break;
                            case"m3v":
                                void 0 === s._array && (s._array = new Float32Array(9 * l.length));
                                for (var c = 0, d = l.length; d > c; c++)l[c].flattenToArrayOffset(s._array, 9 * c);
                                ke.uniformMatrix3fv(u, !1, s._array);
                                break;
                            case"m4":
                                ke.uniformMatrix4fv(u, !1, l.elements);
                                break;
                            case"m4v":
                                void 0 === s._array && (s._array = new Float32Array(16 * l.length));
                                for (var c = 0, d = l.length; d > c; c++)l[c].flattenToArrayOffset(s._array, 16 * c);
                                ke.uniformMatrix4fv(u, !1, s._array);
                                break;
                            case"t":
                                if (t = l, i = X(), ke.uniform1i(u, i), !t)continue;
                                t instanceof n.CubeTexture || t.image instanceof Array && 6 === t.image.length ? te(t, i) : t instanceof n.WebGLRenderTargetCube ? ie(t, i) : Be.setTexture(t, i);
                                break;
                            case"tv":
                                void 0 === s._array && (s._array = []);
                                for (var c = 0, d = s.value.length; d > c; c++)s._array[c] = X();
                                ke.uniform1iv(u, s._array);
                                for (var c = 0, d = s.value.length; d > c; c++)t = s.value[c], i = s._array[c], t && Be.setTexture(t, i);
                                break;
                            default:
                                n.warn("THREE.WebGLRenderer: Unknown uniform type: " + h)
                        }
                    }
                }
            }

            function K(e, t) {
                e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse, e.matrixWorld), e._normalMatrix.getNormalMatrix(e._modelViewMatrix)
            }

            function Q(e, t, i, r) {
                e[t] = i.r * r, e[t + 1] = i.g * r, e[t + 2] = i.b * r
            }

            function J(e) {
                var t, i, r, o, a, s, h, l, u = 0, c = 0, d = 0, f = Qe, p = f.directional.colors, m = f.directional.positions, g = f.point.colors, v = f.point.positions, y = f.point.distances, b = f.point.decays, w = f.spot.colors, _ = f.spot.positions, x = f.spot.distances, S = f.spot.directions, E = f.spot.anglesCos, M = f.spot.exponents, A = f.spot.decays, T = f.hemi.skyColors, C = f.hemi.groundColors, P = f.hemi.positions, L = 0, k = 0, B = 0, R = 0, I = 0, F = 0, D = 0, O = 0, N = 0, U = 0, z = 0, V = 0;
                for (t = 0, i = e.length; i > t; t++)if (r = e[t], !r.onlyShadow)if (o = r.color, h = r.intensity, l = r.distance, r instanceof n.AmbientLight) {
                    if (!r.visible)continue;
                    u += o.r, c += o.g, d += o.b
                } else if (r instanceof n.DirectionalLight) {
                    if (I += 1, !r.visible)continue;
                    qe.setFromMatrixPosition(r.matrixWorld), Xe.setFromMatrixPosition(r.target.matrixWorld), qe.sub(Xe), qe.normalize(), N = 3 * L, m[N] = qe.x, m[N + 1] = qe.y, m[N + 2] = qe.z, Q(p, N, o, h), L += 1
                } else if (r instanceof n.PointLight) {
                    if (F += 1, !r.visible)continue;
                    U = 3 * k, Q(g, U, o, h), Xe.setFromMatrixPosition(r.matrixWorld), v[U] = Xe.x, v[U + 1] = Xe.y, v[U + 2] = Xe.z, y[k] = l, b[k] = 0 === r.distance ? 0 : r.decay, k += 1
                } else if (r instanceof n.SpotLight) {
                    if (D += 1, !r.visible)continue;
                    z = 3 * B, Q(w, z, o, h), qe.setFromMatrixPosition(r.matrixWorld), _[z] = qe.x, _[z + 1] = qe.y, _[z + 2] = qe.z, x[B] = l, Xe.setFromMatrixPosition(r.target.matrixWorld), qe.sub(Xe), qe.normalize(), S[z] = qe.x, S[z + 1] = qe.y, S[z + 2] = qe.z, E[B] = Math.cos(r.angle), M[B] = r.exponent, A[B] = 0 === r.distance ? 0 : r.decay, B += 1
                } else if (r instanceof n.HemisphereLight) {
                    if (O += 1, !r.visible)continue;
                    qe.setFromMatrixPosition(r.matrixWorld), qe.normalize(), V = 3 * R, P[V] = qe.x, P[V + 1] = qe.y, P[V + 2] = qe.z, a = r.color, s = r.groundColor, Q(T, V, a, h), Q(C, V, s, h), R += 1
                }
                for (t = 3 * L, i = Math.max(p.length, 3 * I); i > t; t++)p[t] = 0;
                for (t = 3 * k, i = Math.max(g.length, 3 * F); i > t; t++)g[t] = 0;
                for (t = 3 * B, i = Math.max(w.length, 3 * D); i > t; t++)w[t] = 0;
                for (t = 3 * R, i = Math.max(T.length, 3 * O); i > t; t++)T[t] = 0;
                for (t = 3 * R, i = Math.max(C.length, 3 * O); i > t; t++)C[t] = 0;
                f.directional.length = L, f.point.length = k, f.spot.length = B, f.hemi.length = R, f.ambient[0] = u, f.ambient[1] = c, f.ambient[2] = d
            }

            function $(e, t, i) {
                var r;
                i ? (ke.texParameteri(e, ke.TEXTURE_WRAP_S, se(t.wrapS)), ke.texParameteri(e, ke.TEXTURE_WRAP_T, se(t.wrapT)), ke.texParameteri(e, ke.TEXTURE_MAG_FILTER, se(t.magFilter)), ke.texParameteri(e, ke.TEXTURE_MIN_FILTER, se(t.minFilter))) : (ke.texParameteri(e, ke.TEXTURE_WRAP_S, ke.CLAMP_TO_EDGE), ke.texParameteri(e, ke.TEXTURE_WRAP_T, ke.CLAMP_TO_EDGE), (t.wrapS !== n.ClampToEdgeWrapping || t.wrapT !== n.ClampToEdgeWrapping) && n.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( " + t.sourceFile + " )"), ke.texParameteri(e, ke.TEXTURE_MAG_FILTER, ae(t.magFilter)), ke.texParameteri(e, ke.TEXTURE_MIN_FILTER, ae(t.minFilter)), t.minFilter !== n.NearestFilter && t.minFilter !== n.LinearFilter && n.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( " + t.sourceFile + " )")), r = tt.get("EXT_texture_filter_anisotropic"), r && t.type !== n.FloatType && t.type !== n.HalfFloatType && (t.anisotropy > 1 || t.__currentAnisotropy) && (ke.texParameterf(e, r.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(t.anisotropy, Be.getMaxAnisotropy())), t.__currentAnisotropy = t.anisotropy)
            }

            function ee(e, t) {
                if (e.width > t || e.height > t) {
                    var i = t / Math.max(e.width, e.height), r = document.createElement("canvas");
                    r.width = Math.floor(e.width * i), r.height = Math.floor(e.height * i);
                    var o = r.getContext("2d");
                    return o.drawImage(e, 0, 0, e.width, e.height, 0, 0, r.width, r.height), n.warn("THREE.WebGLRenderer: image is too big (" + e.width + "x" + e.height + "). Resized to " + r.width + "x" + r.height, e), r
                }
                return e
            }

            function te(e, t) {
                if (6 === e.image.length)if (e.needsUpdate) {
                    e.image.__webglTextureCube || (e.addEventListener("dispose", St), e.image.__webglTextureCube = ke.createTexture(), Be.info.memory.textures++), ke.activeTexture(ke.TEXTURE0 + t), ke.bindTexture(ke.TEXTURE_CUBE_MAP, e.image.__webglTextureCube), ke.pixelStorei(ke.UNPACK_FLIP_Y_WEBGL, e.flipY);
                    for (var i = e instanceof n.CompressedTexture, r = e.image[0] instanceof n.DataTexture, o = [], a = 0; 6 > a; a++)!Be.autoScaleCubemaps || i || r ? o[a] = r ? e.image[a].image : e.image[a] : o[a] = ee(e.image[a], ht);
                    var s = o[0], h = n.Math.isPowerOfTwo(s.width) && n.Math.isPowerOfTwo(s.height), l = se(e.format), u = se(e.type);
                    $(ke.TEXTURE_CUBE_MAP, e, h);
                    for (var a = 0; 6 > a; a++)if (i)for (var c, d = o[a].mipmaps, f = 0, p = d.length; p > f; f++)c = d[f], e.format !== n.RGBAFormat && e.format !== n.RGBFormat ? mt().indexOf(l) > -1 ? ke.compressedTexImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X + a, f, l, c.width, c.height, 0, c.data) : n.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()") : ke.texImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X + a, f, l, c.width, c.height, 0, l, u, c.data); else r ? ke.texImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X + a, 0, l, o[a].width, o[a].height, 0, l, u, o[a].data) : ke.texImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X + a, 0, l, l, u, o[a]);
                    e.generateMipmaps && h && ke.generateMipmap(ke.TEXTURE_CUBE_MAP), e.needsUpdate = !1, e.onUpdate && e.onUpdate()
                } else ke.activeTexture(ke.TEXTURE0 + t), ke.bindTexture(ke.TEXTURE_CUBE_MAP, e.image.__webglTextureCube)
            }

            function ie(e, t) {
                ke.activeTexture(ke.TEXTURE0 + t), ke.bindTexture(ke.TEXTURE_CUBE_MAP, e.__webglTexture)
            }

            function re(e, t, i) {
                ke.bindFramebuffer(ke.FRAMEBUFFER, e), ke.framebufferTexture2D(ke.FRAMEBUFFER, ke.COLOR_ATTACHMENT0, i, t.__webglTexture, 0)
            }

            function ne(e, t) {
                ke.bindRenderbuffer(ke.RENDERBUFFER, e), t.depthBuffer && !t.stencilBuffer ? (ke.renderbufferStorage(ke.RENDERBUFFER, ke.DEPTH_COMPONENT16, t.width, t.height), ke.framebufferRenderbuffer(ke.FRAMEBUFFER, ke.DEPTH_ATTACHMENT, ke.RENDERBUFFER, e)) : t.depthBuffer && t.stencilBuffer ? (ke.renderbufferStorage(ke.RENDERBUFFER, ke.DEPTH_STENCIL, t.width, t.height), ke.framebufferRenderbuffer(ke.FRAMEBUFFER, ke.DEPTH_STENCIL_ATTACHMENT, ke.RENDERBUFFER, e)) : ke.renderbufferStorage(ke.RENDERBUFFER, ke.RGBA4, t.width, t.height)
            }

            function oe(e) {
                e instanceof n.WebGLRenderTargetCube ? (ke.bindTexture(ke.TEXTURE_CUBE_MAP, e.__webglTexture), ke.generateMipmap(ke.TEXTURE_CUBE_MAP), ke.bindTexture(ke.TEXTURE_CUBE_MAP, null)) : (ke.bindTexture(ke.TEXTURE_2D, e.__webglTexture), ke.generateMipmap(ke.TEXTURE_2D), ke.bindTexture(ke.TEXTURE_2D, null))
            }

            function ae(e) {
                return e === n.NearestFilter || e === n.NearestMipMapNearestFilter || e === n.NearestMipMapLinearFilter ? ke.NEAREST : ke.LINEAR
            }

            function se(e) {
                var t;
                if (e === n.RepeatWrapping)return ke.REPEAT;
                if (e === n.ClampToEdgeWrapping)return ke.CLAMP_TO_EDGE;
                if (e === n.MirroredRepeatWrapping)return ke.MIRRORED_REPEAT;
                if (e === n.NearestFilter)return ke.NEAREST;
                if (e === n.NearestMipMapNearestFilter)return ke.NEAREST_MIPMAP_NEAREST;
                if (e === n.NearestMipMapLinearFilter)return ke.NEAREST_MIPMAP_LINEAR;
                if (e === n.LinearFilter)return ke.LINEAR;
                if (e === n.LinearMipMapNearestFilter)return ke.LINEAR_MIPMAP_NEAREST;
                if (e === n.LinearMipMapLinearFilter)return ke.LINEAR_MIPMAP_LINEAR;
                if (e === n.UnsignedByteType)return ke.UNSIGNED_BYTE;
                if (e === n.UnsignedShort4444Type)return ke.UNSIGNED_SHORT_4_4_4_4;
                if (e === n.UnsignedShort5551Type)return ke.UNSIGNED_SHORT_5_5_5_1;
                if (e === n.UnsignedShort565Type)return ke.UNSIGNED_SHORT_5_6_5;
                if (e === n.ByteType)return ke.BYTE;
                if (e === n.ShortType)return ke.SHORT;
                if (e === n.UnsignedShortType)return ke.UNSIGNED_SHORT;
                if (e === n.IntType)return ke.INT;
                if (e === n.UnsignedIntType)return ke.UNSIGNED_INT;
                if (e === n.FloatType)return ke.FLOAT;
                if (t = tt.get("OES_texture_half_float"), null !== t && e === n.HalfFloatType)return t.HALF_FLOAT_OES;
                if (e === n.AlphaFormat)return ke.ALPHA;
                if (e === n.RGBFormat)return ke.RGB;
                if (e === n.RGBAFormat)return ke.RGBA;
                if (e === n.LuminanceFormat)return ke.LUMINANCE;
                if (e === n.LuminanceAlphaFormat)return ke.LUMINANCE_ALPHA;
                if (e === n.AddEquation)return ke.FUNC_ADD;
                if (e === n.SubtractEquation)return ke.FUNC_SUBTRACT;
                if (e === n.ReverseSubtractEquation)return ke.FUNC_REVERSE_SUBTRACT;
                if (e === n.ZeroFactor)return ke.ZERO;
                if (e === n.OneFactor)return ke.ONE;
                if (e === n.SrcColorFactor)return ke.SRC_COLOR;
                if (e === n.OneMinusSrcColorFactor)return ke.ONE_MINUS_SRC_COLOR;
                if (e === n.SrcAlphaFactor)return ke.SRC_ALPHA;
                if (e === n.OneMinusSrcAlphaFactor)return ke.ONE_MINUS_SRC_ALPHA;
                if (e === n.DstAlphaFactor)return ke.DST_ALPHA;
                if (e === n.OneMinusDstAlphaFactor)return ke.ONE_MINUS_DST_ALPHA;
                if (e === n.DstColorFactor)return ke.DST_COLOR;
                if (e === n.OneMinusDstColorFactor)return ke.ONE_MINUS_DST_COLOR;
                if (e === n.SrcAlphaSaturateFactor)return ke.SRC_ALPHA_SATURATE;
                if (t = tt.get("WEBGL_compressed_texture_s3tc"), null !== t) {
                    if (e === n.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;
                    if (e === n.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;
                    if (e === n.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;
                    if (e === n.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT
                }
                if (t = tt.get("WEBGL_compressed_texture_pvrtc"), null !== t) {
                    if (e === n.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                    if (e === n.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                    if (e === n.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                    if (e === n.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG
                }
                if (t = tt.get("EXT_blend_minmax"), null !== t) {
                    if (e === n.MinEquation)return t.MIN_EXT;
                    if (e === n.MaxEquation)return t.MAX_EXT
                }
                return 0
            }

            function he(e) {
                if (ut && e && e.skeleton && e.skeleton.useVertexTexture)return 1024;
                var t = ke.getParameter(ke.MAX_VERTEX_UNIFORM_VECTORS), i = Math.floor((t - 20) / 4), r = i;
                return void 0 !== e && e instanceof n.SkinnedMesh && (r = Math.min(e.skeleton.bones.length, r), r < e.skeleton.bones.length && n.warn("WebGLRenderer: too many bones - " + e.skeleton.bones.length + ", this GPU supports just " + r + " (try OpenGL instead of ANGLE)")), r
            }

            function le(e) {
                for (var t = 0, i = 0, r = 0, o = 0, a = 0, s = e.length; s > a; a++) {
                    var h = e[a];
                    h.onlyShadow || h.visible === !1 || (h instanceof n.DirectionalLight && t++, h instanceof n.PointLight && i++, h instanceof n.SpotLight && r++, h instanceof n.HemisphereLight && o++)
                }
                return {directional: t, point: i, spot: r, hemi: o}
            }

            function ue(e) {
                for (var t = 0, i = 0, r = e.length; r > i; i++) {
                    var o = e[i];
                    o.castShadow && (o instanceof n.SpotLight && t++, o instanceof n.DirectionalLight && !o.shadowCascade && t++)
                }
                return t
            }

            console.log("THREE.WebGLRenderer", n.REVISION), e = e || {};
            var ce = void 0 !== e.canvas ? e.canvas : document.createElement("canvas"), de = void 0 !== e.context ? e.context : null, fe = 1, pe = void 0 !== e.precision ? e.precision : "highp", me = void 0 !== e.alpha ? e.alpha : !1, ge = void 0 !== e.depth ? e.depth : !0, ve = void 0 !== e.stencil ? e.stencil : !0, ye = void 0 !== e.antialias ? e.antialias : !1, be = void 0 !== e.premultipliedAlpha ? e.premultipliedAlpha : !0, we = void 0 !== e.preserveDrawingBuffer ? e.preserveDrawingBuffer : !1, _e = void 0 !== e.logarithmicDepthBuffer ? e.logarithmicDepthBuffer : !1, xe = new n.Color(0), Se = 0, Ee = [], Me = {}, Ae = [], Te = [], Ce = [], Pe = [], Le = [];
            this.domElement = ce, this.context = null, this.autoClear = !0, this.autoClearColor = !0, this.autoClearDepth = !0, this.autoClearStencil = !0, this.sortObjects = !0, this.gammaFactor = 2, this.gammaInput = !1, this.gammaOutput = !1, this.shadowMapEnabled = !1, this.shadowMapType = n.PCFShadowMap, this.shadowMapCullFace = n.CullFaceFront, this.shadowMapDebug = !1, this.shadowMapCascade = !1, this.maxMorphTargets = 8, this.maxMorphNormals = 4, this.autoScaleCubemaps = !0, this.info = {
                memory: {
                    programs: 0,
                    geometries: 0,
                    textures: 0
                }, render: {calls: 0, vertices: 0, faces: 0, points: 0}
            };
            var ke, Be = this, Re = [], Ie = null, Fe = null, De = -1, Oe = "", Ne = null, Ue = 0, ze = 0, Ve = 0, We = ce.width, He = ce.height, Ge = 0, je = 0, Ye = new n.Frustum, Ze = new n.Matrix4, Xe = new n.Vector3, qe = new n.Vector3, Ke = !0, Qe = {
                ambient: [0, 0, 0],
                directional: {length: 0, colors: [], positions: []},
                point: {length: 0, colors: [], positions: [], distances: [], decays: []},
                spot: {
                    length: 0,
                    colors: [],
                    positions: [],
                    distances: [],
                    directions: [],
                    anglesCos: [],
                    exponents: [],
                    decays: []
                },
                hemi: {length: 0, skyColors: [], groundColors: [], positions: []}
            };
            try {
                var Je = {
                    alpha: me,
                    depth: ge,
                    stencil: ve,
                    antialias: ye,
                    premultipliedAlpha: be,
                    preserveDrawingBuffer: we
                };
                if (ke = de || ce.getContext("webgl", Je) || ce.getContext("experimental-webgl", Je), null === ke)throw null !== ce.getContext("webgl") ? "Error creating WebGL context with your selected attributes." : "Error creating WebGL context.";
                ce.addEventListener("webglcontextlost", function (e) {
                    e.preventDefault(), nt(), rt(), Me = {}
                }, !1)
            } catch ($e) {
                n.error("THREE.WebGLRenderer: " + $e)
            }
            var et = new n.WebGLState(ke, se);
            void 0 === ke.getShaderPrecisionFormat && (ke.getShaderPrecisionFormat = function () {
                return {rangeMin: 1, rangeMax: 1, precision: 1}
            });
            var tt = new n.WebGLExtensions(ke);
            tt.get("OES_texture_float"), tt.get("OES_texture_float_linear"), tt.get("OES_texture_half_float"), tt.get("OES_texture_half_float_linear"), tt.get("OES_standard_derivatives"), _e && tt.get("EXT_frag_depth");
            var it = function (e, t, i, r) {
                be === !0 && (e *= r, t *= r, i *= r), ke.clearColor(e, t, i, r)
            }, rt = function () {
                ke.clearColor(0, 0, 0, 1), ke.clearDepth(1), ke.clearStencil(0), ke.enable(ke.DEPTH_TEST), ke.depthFunc(ke.LEQUAL), ke.frontFace(ke.CCW), ke.cullFace(ke.BACK), ke.enable(ke.CULL_FACE), ke.enable(ke.BLEND), ke.blendEquation(ke.FUNC_ADD), ke.blendFunc(ke.SRC_ALPHA, ke.ONE_MINUS_SRC_ALPHA), ke.viewport(ze, Ve, We, He), it(xe.r, xe.g, xe.b, Se)
            }, nt = function () {
                Ie = null, Ne = null, Oe = "", De = -1, Ke = !0, et.reset()
            };
            rt(), this.context = ke, this.state = et;
            var ot = ke.getParameter(ke.MAX_TEXTURE_IMAGE_UNITS), at = ke.getParameter(ke.MAX_VERTEX_TEXTURE_IMAGE_UNITS), st = ke.getParameter(ke.MAX_TEXTURE_SIZE), ht = ke.getParameter(ke.MAX_CUBE_MAP_TEXTURE_SIZE), lt = at > 0, ut = lt && tt.get("OES_texture_float"), ct = ke.getShaderPrecisionFormat(ke.VERTEX_SHADER, ke.HIGH_FLOAT), dt = ke.getShaderPrecisionFormat(ke.VERTEX_SHADER, ke.MEDIUM_FLOAT), ft = ke.getShaderPrecisionFormat(ke.FRAGMENT_SHADER, ke.HIGH_FLOAT), pt = ke.getShaderPrecisionFormat(ke.FRAGMENT_SHADER, ke.MEDIUM_FLOAT), mt = function () {
                var e;
                return function () {
                    if (void 0 !== e)return e;
                    if (e = [], tt.get("WEBGL_compressed_texture_pvrtc") || tt.get("WEBGL_compressed_texture_s3tc"))for (var t = ke.getParameter(ke.COMPRESSED_TEXTURE_FORMATS), i = 0; i < t.length; i++)e.push(t[i]);
                    return e
                }
            }(), gt = ct.precision > 0 && ft.precision > 0, vt = dt.precision > 0 && pt.precision > 0;
            "highp" !== pe || gt || (vt ? (pe = "mediump", n.warn("THREE.WebGLRenderer: highp not supported, using mediump.")) : (pe = "lowp", n.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))), "mediump" !== pe || vt || (pe = "lowp", n.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));
            var yt = new n.ShadowMapPlugin(this, Ee, Me, Ae), bt = new n.SpritePlugin(this, Pe), wt = new n.LensFlarePlugin(this, Le);
            this.getContext = function () {
                return ke
            }, this.forceContextLoss = function () {
                tt.get("WEBGL_lose_context").loseContext()
            }, this.supportsVertexTextures = function () {
                return lt
            }, this.supportsFloatTextures = function () {
                return tt.get("OES_texture_float")
            }, this.supportsHalfFloatTextures = function () {
                return tt.get("OES_texture_half_float")
            }, this.supportsStandardDerivatives = function () {
                return tt.get("OES_standard_derivatives")
            }, this.supportsCompressedTextureS3TC = function () {
                return tt.get("WEBGL_compressed_texture_s3tc")
            }, this.supportsCompressedTexturePVRTC = function () {
                return tt.get("WEBGL_compressed_texture_pvrtc")
            }, this.supportsBlendMinMax = function () {
                return tt.get("EXT_blend_minmax")
            }, this.getMaxAnisotropy = function () {
                var e;
                return function () {
                    if (void 0 !== e)return e;
                    var t = tt.get("EXT_texture_filter_anisotropic");
                    return e = null !== t ? ke.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0
                }
            }(), this.getPrecision = function () {
                return pe
            }, this.getPixelRatio = function () {
                return fe
            }, this.setPixelRatio = function (e) {
                fe = e
            }, this.setSize = function (e, t, i) {
                ce.width = e * fe, ce.height = t * fe, i !== !1 && (ce.style.width = e + "px", ce.style.height = t + "px"), this.setViewport(0, 0, e, t)
            }, this.setViewport = function (e, t, i, r) {
                ze = e * fe, Ve = t * fe, We = i * fe, He = r * fe, ke.viewport(ze, Ve, We, He)
            }, this.setScissor = function (e, t, i, r) {
                ke.scissor(e * fe, t * fe, i * fe, r * fe)
            }, this.enableScissorTest = function (e) {
                e ? ke.enable(ke.SCISSOR_TEST) : ke.disable(ke.SCISSOR_TEST)
            }, this.getClearColor = function () {
                return xe
            }, this.setClearColor = function (e, t) {
                xe.set(e), Se = void 0 !== t ? t : 1, it(xe.r, xe.g, xe.b, Se)
            }, this.getClearAlpha = function () {
                return Se
            }, this.setClearAlpha = function (e) {
                Se = e, it(xe.r, xe.g, xe.b, Se)
            }, this.clear = function (e, t, i) {
                var r = 0;
                (void 0 === e || e) && (r |= ke.COLOR_BUFFER_BIT), (void 0 === t || t) && (r |= ke.DEPTH_BUFFER_BIT), (void 0 === i || i) && (r |= ke.STENCIL_BUFFER_BIT), ke.clear(r)
            }, this.clearColor = function () {
                ke.clear(ke.COLOR_BUFFER_BIT)
            }, this.clearDepth = function () {
                ke.clear(ke.DEPTH_BUFFER_BIT)
            }, this.clearStencil = function () {
                ke.clear(ke.STENCIL_BUFFER_BIT)
            }, this.clearTarget = function (e, t, i, r) {
                this.setRenderTarget(e), this.clear(t, i, r)
            }, this.resetGLState = nt;
            var _t = function (e) {
                var t = e.target;
                t.traverse(function (e) {
                    e.removeEventListener("remove", _t), B(e)
                })
            }, xt = function (e) {
                var t = e.target;
                t.removeEventListener("dispose", xt), Tt(t)
            }, St = function (e) {
                var t = e.target;
                t.removeEventListener("dispose", St), Ct(t), Be.info.memory.textures--
            }, Et = function (e) {
                var t = e.target;
                t.removeEventListener("dispose", Et), Pt(t), Be.info.memory.textures--
            }, Mt = function (e) {
                var t = e.target;
                t.removeEventListener("dispose", Mt), Lt(t)
            }, At = function (e) {
                for (var t = ["__webglVertexBuffer", "__webglNormalBuffer", "__webglTangentBuffer", "__webglColorBuffer", "__webglUVBuffer", "__webglUV2Buffer", "__webglSkinIndicesBuffer", "__webglSkinWeightsBuffer", "__webglFaceBuffer", "__webglLineBuffer", "__webglLineDistanceBuffer"], i = 0, r = t.length; r > i; i++) {
                    var n = t[i];
                    void 0 !== e[n] && (ke.deleteBuffer(e[n]), delete e[n])
                }
                if (void 0 !== e.__webglCustomAttributesList) {
                    for (var n in e.__webglCustomAttributesList)ke.deleteBuffer(e.__webglCustomAttributesList[n].buffer);
                    delete e.__webglCustomAttributesList
                }
                Be.info.memory.geometries--
            }, Tt = function (e) {
                if (delete e.__webglInit, e instanceof n.BufferGeometry) {
                    for (var t in e.attributes) {
                        var i = e.attributes[t];
                        void 0 !== i.buffer && (ke.deleteBuffer(i.buffer), delete i.buffer)
                    }
                    Be.info.memory.geometries--
                } else {
                    var r = kt[e.id];
                    if (void 0 !== r) {
                        for (var o = 0, a = r.length; a > o; o++) {
                            var s = r[o];
                            if (void 0 !== s.numMorphTargets) {
                                for (var h = 0, l = s.numMorphTargets; l > h; h++)ke.deleteBuffer(s.__webglMorphTargetsBuffers[h]);
                                delete s.__webglMorphTargetsBuffers
                            }
                            if (void 0 !== s.numMorphNormals) {
                                for (var h = 0, l = s.numMorphNormals; l > h; h++)ke.deleteBuffer(s.__webglMorphNormalsBuffers[h]);
                                delete s.__webglMorphNormalsBuffers
                            }
                            At(s)
                        }
                        delete kt[e.id]
                    } else At(e)
                }
                Oe = ""
            }, Ct = function (e) {
                if (e.image && e.image.__webglTextureCube)ke.deleteTexture(e.image.__webglTextureCube), delete e.image.__webglTextureCube; else {
                    if (void 0 === e.__webglInit)return;
                    ke.deleteTexture(e.__webglTexture), delete e.__webglTexture, delete e.__webglInit
                }
            }, Pt = function (e) {
                if (e && void 0 !== e.__webglTexture) {
                    if (ke.deleteTexture(e.__webglTexture), delete e.__webglTexture, e instanceof n.WebGLRenderTargetCube)for (var t = 0; 6 > t; t++)ke.deleteFramebuffer(e.__webglFramebuffer[t]), ke.deleteRenderbuffer(e.__webglRenderbuffer[t]); else ke.deleteFramebuffer(e.__webglFramebuffer), ke.deleteRenderbuffer(e.__webglRenderbuffer);
                    delete e.__webglFramebuffer, delete e.__webglRenderbuffer
                }
            }, Lt = function (e) {
                var t = e.program.program;
                if (void 0 !== t) {
                    e.program = void 0;
                    var i, r, n, o = !1;
                    for (i = 0, r = Re.length; r > i; i++)if (n = Re[i], n.program === t) {
                        n.usedTimes--, 0 === n.usedTimes && (o = !0);
                        break
                    }
                    if (o === !0) {
                        var a = [];
                        for (i = 0, r = Re.length; r > i; i++)n = Re[i], n.program !== t && a.push(n);
                        Re = a, ke.deleteProgram(t), Be.info.memory.programs--
                    }
                }
            };
            this.renderBufferImmediate = function (e, t, i) {
                if (et.initAttributes(), e.hasPositions && !e.__webglVertexBuffer && (e.__webglVertexBuffer = ke.createBuffer()), e.hasNormals && !e.__webglNormalBuffer && (e.__webglNormalBuffer = ke.createBuffer()), e.hasUvs && !e.__webglUvBuffer && (e.__webglUvBuffer = ke.createBuffer()), e.hasColors && !e.__webglColorBuffer && (e.__webglColorBuffer = ke.createBuffer()), e.hasPositions && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglVertexBuffer), ke.bufferData(ke.ARRAY_BUFFER, e.positionArray, ke.DYNAMIC_DRAW), et.enableAttribute(t.attributes.position), ke.vertexAttribPointer(t.attributes.position, 3, ke.FLOAT, !1, 0, 0)), e.hasNormals) {
                    if (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglNormalBuffer), i instanceof n.MeshPhongMaterial == !1 && i.shading === n.FlatShading) {
                        var r, o, a, s, h, l, u, c, d, f, p, m, g, v, y = 3 * e.count;
                        for (v = 0; y > v; v += 9)g = e.normalArray, s = g[v], u = g[v + 1], f = g[v + 2], h = g[v + 3], c = g[v + 4], p = g[v + 5], l = g[v + 6], d = g[v + 7], m = g[v + 8], r = (s + h + l) / 3, o = (u + c + d) / 3, a = (f + p + m) / 3, g[v] = r, g[v + 1] = o, g[v + 2] = a, g[v + 3] = r, g[v + 4] = o, g[v + 5] = a, g[v + 6] = r, g[v + 7] = o, g[v + 8] = a
                    }
                    ke.bufferData(ke.ARRAY_BUFFER, e.normalArray, ke.DYNAMIC_DRAW), et.enableAttribute(t.attributes.normal), ke.vertexAttribPointer(t.attributes.normal, 3, ke.FLOAT, !1, 0, 0)
                }
                e.hasUvs && i.map && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglUvBuffer), ke.bufferData(ke.ARRAY_BUFFER, e.uvArray, ke.DYNAMIC_DRAW), et.enableAttribute(t.attributes.uv), ke.vertexAttribPointer(t.attributes.uv, 2, ke.FLOAT, !1, 0, 0)), e.hasColors && i.vertexColors !== n.NoColors && (ke.bindBuffer(ke.ARRAY_BUFFER, e.__webglColorBuffer), ke.bufferData(ke.ARRAY_BUFFER, e.colorArray, ke.DYNAMIC_DRAW), et.enableAttribute(t.attributes.color), ke.vertexAttribPointer(t.attributes.color, 3, ke.FLOAT, !1, 0, 0)), et.disableUnusedAttributes(), ke.drawArrays(ke.TRIANGLES, 0, e.count), e.count = 0
            }, this.renderBufferDirect = function (e, t, i, r, o, a) {
                if (r.visible !== !1) {
                    P(a);
                    var s = D(e, t, i, r, a), h = !1, l = r.wireframe ? 1 : 0, u = "direct_" + o.id + "_" + s.id + "_" + l;
                    if (u !== Oe && (Oe = u, h = !0), h && et.initAttributes(), a instanceof n.Mesh) {
                        var c = r.wireframe === !0 ? ke.LINES : ke.TRIANGLES, d = o.attributes.index;
                        if (d) {
                            var f, m;
                            d.array instanceof Uint32Array && tt.get("OES_element_index_uint") ? (f = ke.UNSIGNED_INT, m = 4) : (f = ke.UNSIGNED_SHORT, m = 2);
                            var g = o.offsets;
                            if (0 === g.length)h && (p(r, s, o, 0), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, d.array.length, f, 0), Be.info.render.calls++, Be.info.render.vertices += d.array.length, Be.info.render.faces += d.array.length / 3; else {
                                h = !0;
                                for (var v = 0, y = g.length; y > v; v++) {
                                    var b = g[v].index;
                                    h && (p(r, s, o, b), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, g[v].count, f, g[v].start * m), Be.info.render.calls++, Be.info.render.vertices += g[v].count, Be.info.render.faces += g[v].count / 3
                                }
                            }
                        } else {
                            h && p(r, s, o, 0);
                            var w = o.attributes.position;
                            ke.drawArrays(c, 0, w.array.length / w.itemSize), Be.info.render.calls++, Be.info.render.vertices += w.array.length / w.itemSize, Be.info.render.faces += w.array.length / (3 * w.itemSize)
                        }
                    } else if (a instanceof n.PointCloud) {
                        var c = ke.POINTS, d = o.attributes.index;
                        if (d) {
                            var f, m;
                            d.array instanceof Uint32Array && tt.get("OES_element_index_uint") ? (f = ke.UNSIGNED_INT, m = 4) : (f = ke.UNSIGNED_SHORT, m = 2);
                            var g = o.offsets;
                            if (0 === g.length)h && (p(r, s, o, 0), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, d.array.length, f, 0), Be.info.render.calls++, Be.info.render.points += d.array.length; else {
                                g.length > 1 && (h = !0);
                                for (var v = 0, y = g.length; y > v; v++) {
                                    var b = g[v].index;
                                    h && (p(r, s, o, b), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, g[v].count, f, g[v].start * m), Be.info.render.calls++, Be.info.render.points += g[v].count
                                }
                            }
                        } else {
                            h && p(r, s, o, 0);
                            var w = o.attributes.position, g = o.offsets;
                            if (0 === g.length)ke.drawArrays(c, 0, w.array.length / 3), Be.info.render.calls++, Be.info.render.points += w.array.length / 3; else for (var v = 0, y = g.length; y > v; v++)ke.drawArrays(c, g[v].index, g[v].count), Be.info.render.calls++, Be.info.render.points += g[v].count
                        }
                    } else if (a instanceof n.Line) {
                        var c = a.mode === n.LineStrip ? ke.LINE_STRIP : ke.LINES;
                        et.setLineWidth(r.linewidth * fe);
                        var d = o.attributes.index;
                        if (d) {
                            var f, m;
                            d.array instanceof Uint32Array ? (f = ke.UNSIGNED_INT, m = 4) : (f = ke.UNSIGNED_SHORT, m = 2);
                            var g = o.offsets;
                            if (0 === g.length)h && (p(r, s, o, 0), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, d.array.length, f, 0), Be.info.render.calls++, Be.info.render.vertices += d.array.length; else {
                                g.length > 1 && (h = !0);
                                for (var v = 0, y = g.length; y > v; v++) {
                                    var b = g[v].index;
                                    h && (p(r, s, o, b), ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, d.buffer)), ke.drawElements(c, g[v].count, f, g[v].start * m), Be.info.render.calls++, Be.info.render.vertices += g[v].count
                                }
                            }
                        } else {
                            h && p(r, s, o, 0);
                            var w = o.attributes.position, g = o.offsets;
                            if (0 === g.length)ke.drawArrays(c, 0, w.array.length / 3), Be.info.render.calls++, Be.info.render.vertices += w.array.length / 3; else for (var v = 0, y = g.length; y > v; v++)ke.drawArrays(c, g[v].index, g[v].count), Be.info.render.calls++, Be.info.render.vertices += g[v].count
                        }
                    }
                }
            }, this.renderBuffer = function (e, t, i, r, o, a) {
                if (r.visible !== !1) {
                    P(a);
                    var s = D(e, t, i, r, a), h = s.attributes, l = !1, u = r.wireframe ? 1 : 0, c = o.id + "_" + s.id + "_" + u;
                    if (c !== Oe && (Oe = c, l = !0), l && et.initAttributes(), !r.morphTargets && h.position >= 0 ? l && (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglVertexBuffer),
                            et.enableAttribute(h.position), ke.vertexAttribPointer(h.position, 3, ke.FLOAT, !1, 0, 0)) : a.morphTargetBase && m(r, o, a), l) {
                        if (o.__webglCustomAttributesList)for (var d = 0, f = o.__webglCustomAttributesList.length; f > d; d++) {
                            var p = o.__webglCustomAttributesList[d];
                            h[p.buffer.belongsToAttribute] >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, p.buffer), et.enableAttribute(h[p.buffer.belongsToAttribute]), ke.vertexAttribPointer(h[p.buffer.belongsToAttribute], p.size, ke.FLOAT, !1, 0, 0))
                        }
                        h.color >= 0 && (a.geometry.colors.length > 0 || a.geometry.faces.length > 0 ? (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglColorBuffer), et.enableAttribute(h.color), ke.vertexAttribPointer(h.color, 3, ke.FLOAT, !1, 0, 0)) : void 0 !== r.defaultAttributeValues && ke.vertexAttrib3fv(h.color, r.defaultAttributeValues.color)), h.normal >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglNormalBuffer), et.enableAttribute(h.normal), ke.vertexAttribPointer(h.normal, 3, ke.FLOAT, !1, 0, 0)), h.tangent >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglTangentBuffer), et.enableAttribute(h.tangent), ke.vertexAttribPointer(h.tangent, 4, ke.FLOAT, !1, 0, 0)), h.uv >= 0 && (a.geometry.faceVertexUvs[0] ? (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglUVBuffer), et.enableAttribute(h.uv), ke.vertexAttribPointer(h.uv, 2, ke.FLOAT, !1, 0, 0)) : void 0 !== r.defaultAttributeValues && ke.vertexAttrib2fv(h.uv, r.defaultAttributeValues.uv)), h.uv2 >= 0 && (a.geometry.faceVertexUvs[1] ? (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglUV2Buffer), et.enableAttribute(h.uv2), ke.vertexAttribPointer(h.uv2, 2, ke.FLOAT, !1, 0, 0)) : void 0 !== r.defaultAttributeValues && ke.vertexAttrib2fv(h.uv2, r.defaultAttributeValues.uv2)), r.skinning && h.skinIndex >= 0 && h.skinWeight >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglSkinIndicesBuffer), et.enableAttribute(h.skinIndex), ke.vertexAttribPointer(h.skinIndex, 4, ke.FLOAT, !1, 0, 0), ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglSkinWeightsBuffer), et.enableAttribute(h.skinWeight), ke.vertexAttribPointer(h.skinWeight, 4, ke.FLOAT, !1, 0, 0)), h.lineDistance >= 0 && (ke.bindBuffer(ke.ARRAY_BUFFER, o.__webglLineDistanceBuffer), et.enableAttribute(h.lineDistance), ke.vertexAttribPointer(h.lineDistance, 1, ke.FLOAT, !1, 0, 0))
                    }
                    if (et.disableUnusedAttributes(), a instanceof n.Mesh) {
                        var g = o.__typeArray === Uint32Array ? ke.UNSIGNED_INT : ke.UNSIGNED_SHORT;
                        r.wireframe ? (et.setLineWidth(r.wireframeLinewidth * fe), l && ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, o.__webglLineBuffer), ke.drawElements(ke.LINES, o.__webglLineCount, g, 0)) : (l && ke.bindBuffer(ke.ELEMENT_ARRAY_BUFFER, o.__webglFaceBuffer), ke.drawElements(ke.TRIANGLES, o.__webglFaceCount, g, 0)), Be.info.render.calls++, Be.info.render.vertices += o.__webglFaceCount, Be.info.render.faces += o.__webglFaceCount / 3
                    } else if (a instanceof n.Line) {
                        var v = a.mode === n.LineStrip ? ke.LINE_STRIP : ke.LINES;
                        et.setLineWidth(r.linewidth * fe), ke.drawArrays(v, 0, o.__webglLineCount), Be.info.render.calls++
                    } else a instanceof n.PointCloud && (ke.drawArrays(ke.POINTS, 0, o.__webglParticleCount), Be.info.render.calls++, Be.info.render.points += o.__webglParticleCount)
                }
            }, this.render = function (e, t, i, r) {
                if (t instanceof n.Camera == !1)return void n.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
                var o = e.fog;
                Oe = "", De = -1, Ne = null, Ke = !0, e.autoUpdate === !0 && e.updateMatrixWorld(), void 0 === t.parent && t.updateMatrixWorld(), e.traverse(function (e) {
                    e instanceof n.SkinnedMesh && e.skeleton.update()
                }), t.matrixWorldInverse.getInverse(t.matrixWorld), Ze.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse), Ye.setFromMatrix(Ze), Ee.length = 0, Te.length = 0, Ce.length = 0, Pe.length = 0, Le.length = 0, b(e), Be.sortObjects === !0 && (Te.sort(g), Ce.sort(v)), yt.render(e, t), Be.info.render.calls = 0, Be.info.render.vertices = 0, Be.info.render.faces = 0, Be.info.render.points = 0, this.setRenderTarget(i), (this.autoClear || r) && this.clear(this.autoClearColor, this.autoClearDepth, this.autoClearStencil);
                for (var a = 0, s = Ae.length; s > a; a++) {
                    var h = Ae[a], l = h.object;
                    l.visible && (K(l, t), x(h))
                }
                if (e.overrideMaterial) {
                    var u = e.overrideMaterial;
                    F(u), w(Te, t, Ee, o, u), w(Ce, t, Ee, o, u), _(Ae, "", t, Ee, o, u)
                } else et.setBlending(n.NoBlending), w(Te, t, Ee, o, null), _(Ae, "opaque", t, Ee, o, null), w(Ce, t, Ee, o, null), _(Ae, "transparent", t, Ee, o, null);
                bt.render(e, t), wt.render(e, t, Ge, je), i && i.generateMipmaps && i.minFilter !== n.NearestFilter && i.minFilter !== n.LinearFilter && oe(i), et.setDepthTest(!0), et.setDepthWrite(!0), et.setColorWrite(!0)
            }, this.renderImmediateObject = function (e, t, i, r, n) {
                var o = D(e, t, i, r, n);
                Oe = "", Be.setMaterialFaces(r), n.immediateRenderCallback ? n.immediateRenderCallback(o, ke, Ye) : n.render(function (e) {
                    Be.renderBufferImmediate(e, o, r)
                })
            };
            var kt = {}, Bt = 0, Rt = {
                MeshDepthMaterial: "depth",
                MeshNormalMaterial: "normal",
                MeshBasicMaterial: "basic",
                MeshLambertMaterial: "lambert",
                MeshPhongMaterial: "phong",
                LineBasicMaterial: "basic",
                LineDashedMaterial: "dashed",
                PointCloudMaterial: "particle_basic"
            };
            this.setFaceCulling = function (e, t) {
                e === n.CullFaceNone ? ke.disable(ke.CULL_FACE) : (t === n.FrontFaceDirectionCW ? ke.frontFace(ke.CW) : ke.frontFace(ke.CCW), e === n.CullFaceBack ? ke.cullFace(ke.BACK) : e === n.CullFaceFront ? ke.cullFace(ke.FRONT) : ke.cullFace(ke.FRONT_AND_BACK), ke.enable(ke.CULL_FACE))
            }, this.setMaterialFaces = function (e) {
                et.setDoubleSided(e.side === n.DoubleSide), et.setFlipSided(e.side === n.BackSide)
            }, this.uploadTexture = function (e) {
                void 0 === e.__webglInit && (e.__webglInit = !0, e.addEventListener("dispose", St), e.__webglTexture = ke.createTexture(), Be.info.memory.textures++), ke.bindTexture(ke.TEXTURE_2D, e.__webglTexture), ke.pixelStorei(ke.UNPACK_FLIP_Y_WEBGL, e.flipY), ke.pixelStorei(ke.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e.premultiplyAlpha), ke.pixelStorei(ke.UNPACK_ALIGNMENT, e.unpackAlignment), e.image = ee(e.image, st);
                var t = e.image, i = n.Math.isPowerOfTwo(t.width) && n.Math.isPowerOfTwo(t.height), r = se(e.format), o = se(e.type);
                $(ke.TEXTURE_2D, e, i);
                var a, s = e.mipmaps;
                if (e instanceof n.DataTexture)if (s.length > 0 && i) {
                    for (var h = 0, l = s.length; l > h; h++)a = s[h], ke.texImage2D(ke.TEXTURE_2D, h, r, a.width, a.height, 0, r, o, a.data);
                    e.generateMipmaps = !1
                } else ke.texImage2D(ke.TEXTURE_2D, 0, r, t.width, t.height, 0, r, o, t.data); else if (e instanceof n.CompressedTexture)for (var h = 0, l = s.length; l > h; h++)a = s[h], e.format !== n.RGBAFormat && e.format !== n.RGBFormat ? mt().indexOf(r) > -1 ? ke.compressedTexImage2D(ke.TEXTURE_2D, h, r, a.width, a.height, 0, a.data) : n.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : ke.texImage2D(ke.TEXTURE_2D, h, r, a.width, a.height, 0, r, o, a.data); else if (s.length > 0 && i) {
                    for (var h = 0, l = s.length; l > h; h++)a = s[h], ke.texImage2D(ke.TEXTURE_2D, h, r, r, o, a);
                    e.generateMipmaps = !1
                } else ke.texImage2D(ke.TEXTURE_2D, 0, r, r, o, e.image);
                e.generateMipmaps && i && ke.generateMipmap(ke.TEXTURE_2D), e.needsUpdate = !1, e.onUpdate && e.onUpdate()
            }, this.setTexture = function (e, t) {
                ke.activeTexture(ke.TEXTURE0 + t), e.needsUpdate ? Be.uploadTexture(e) : ke.bindTexture(ke.TEXTURE_2D, e.__webglTexture)
            }, this.setRenderTarget = function (e) {
                var t = e instanceof n.WebGLRenderTargetCube;
                if (e && void 0 === e.__webglFramebuffer) {
                    void 0 === e.depthBuffer && (e.depthBuffer = !0), void 0 === e.stencilBuffer && (e.stencilBuffer = !0), e.addEventListener("dispose", Et), e.__webglTexture = ke.createTexture(), Be.info.memory.textures++;
                    var i = n.Math.isPowerOfTwo(e.width) && n.Math.isPowerOfTwo(e.height), r = se(e.format), o = se(e.type);
                    if (t) {
                        e.__webglFramebuffer = [], e.__webglRenderbuffer = [], ke.bindTexture(ke.TEXTURE_CUBE_MAP, e.__webglTexture), $(ke.TEXTURE_CUBE_MAP, e, i);
                        for (var a = 0; 6 > a; a++)e.__webglFramebuffer[a] = ke.createFramebuffer(), e.__webglRenderbuffer[a] = ke.createRenderbuffer(), ke.texImage2D(ke.TEXTURE_CUBE_MAP_POSITIVE_X + a, 0, r, e.width, e.height, 0, r, o, null), re(e.__webglFramebuffer[a], e, ke.TEXTURE_CUBE_MAP_POSITIVE_X + a), ne(e.__webglRenderbuffer[a], e);
                        i && ke.generateMipmap(ke.TEXTURE_CUBE_MAP)
                    } else e.__webglFramebuffer = ke.createFramebuffer(), e.shareDepthFrom ? e.__webglRenderbuffer = e.shareDepthFrom.__webglRenderbuffer : e.__webglRenderbuffer = ke.createRenderbuffer(), ke.bindTexture(ke.TEXTURE_2D, e.__webglTexture), $(ke.TEXTURE_2D, e, i), ke.texImage2D(ke.TEXTURE_2D, 0, r, e.width, e.height, 0, r, o, null), re(e.__webglFramebuffer, e, ke.TEXTURE_2D), e.shareDepthFrom ? e.depthBuffer && !e.stencilBuffer ? ke.framebufferRenderbuffer(ke.FRAMEBUFFER, ke.DEPTH_ATTACHMENT, ke.RENDERBUFFER, e.__webglRenderbuffer) : e.depthBuffer && e.stencilBuffer && ke.framebufferRenderbuffer(ke.FRAMEBUFFER, ke.DEPTH_STENCIL_ATTACHMENT, ke.RENDERBUFFER, e.__webglRenderbuffer) : ne(e.__webglRenderbuffer, e), i && ke.generateMipmap(ke.TEXTURE_2D);
                    t ? ke.bindTexture(ke.TEXTURE_CUBE_MAP, null) : ke.bindTexture(ke.TEXTURE_2D, null), ke.bindRenderbuffer(ke.RENDERBUFFER, null), ke.bindFramebuffer(ke.FRAMEBUFFER, null)
                }
                var s, h, l, u, c;
                e ? (s = t ? e.__webglFramebuffer[e.activeCubeFace] : e.__webglFramebuffer, h = e.width, l = e.height, u = 0, c = 0) : (s = null, h = We, l = He, u = ze, c = Ve), s !== Fe && (ke.bindFramebuffer(ke.FRAMEBUFFER, s), ke.viewport(u, c, h, l), Fe = s), Ge = h, je = l
            }, this.readRenderTargetPixels = function (e, t, i, r, o, a) {
                if (!(e instanceof n.WebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
                if (e.__webglFramebuffer) {
                    if (e.format !== n.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");
                    var s = !1;
                    e.__webglFramebuffer !== Fe && (ke.bindFramebuffer(ke.FRAMEBUFFER, e.__webglFramebuffer), s = !0), ke.checkFramebufferStatus(ke.FRAMEBUFFER) === ke.FRAMEBUFFER_COMPLETE ? ke.readPixels(t, i, r, o, ke.RGBA, ke.UNSIGNED_BYTE, a) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."), s && ke.bindFramebuffer(ke.FRAMEBUFFER, Fe)
                }
            }, this.initMaterial = function () {
                n.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")
            }, this.addPrePlugin = function () {
                n.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")
            }, this.addPostPlugin = function () {
                n.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")
            }, this.updateShadowMap = function () {
                n.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")
            }
        },n.WebGLRenderTarget = function (e, t, i) {
            this.width = e, this.height = t, i = i || {}, this.wrapS = void 0 !== i.wrapS ? i.wrapS : n.ClampToEdgeWrapping, this.wrapT = void 0 !== i.wrapT ? i.wrapT : n.ClampToEdgeWrapping, this.magFilter = void 0 !== i.magFilter ? i.magFilter : n.LinearFilter, this.minFilter = void 0 !== i.minFilter ? i.minFilter : n.LinearMipMapLinearFilter, this.anisotropy = void 0 !== i.anisotropy ? i.anisotropy : 1, this.offset = new n.Vector2(0, 0), this.repeat = new n.Vector2(1, 1), this.format = void 0 !== i.format ? i.format : n.RGBAFormat, this.type = void 0 !== i.type ? i.type : n.UnsignedByteType, this.depthBuffer = void 0 !== i.depthBuffer ? i.depthBuffer : !0, this.stencilBuffer = void 0 !== i.stencilBuffer ? i.stencilBuffer : !0, this.generateMipmaps = !0, this.shareDepthFrom = void 0 !== i.shareDepthFrom ? i.shareDepthFrom : null
        },n.WebGLRenderTarget.prototype = {
            constructor: n.WebGLRenderTarget, setSize: function (e, t) {
                this.width = e, this.height = t
            }, clone: function () {
                var e = new n.WebGLRenderTarget(this.width, this.height);
                return e.wrapS = this.wrapS, e.wrapT = this.wrapT, e.magFilter = this.magFilter, e.minFilter = this.minFilter, e.anisotropy = this.anisotropy, e.offset.copy(this.offset), e.repeat.copy(this.repeat), e.format = this.format, e.type = this.type, e.depthBuffer = this.depthBuffer, e.stencilBuffer = this.stencilBuffer, e.generateMipmaps = this.generateMipmaps, e.shareDepthFrom = this.shareDepthFrom, e
            }, dispose: function () {
                this.dispatchEvent({type: "dispose"})
            }
        },n.EventDispatcher.prototype.apply(n.WebGLRenderTarget.prototype),n.WebGLRenderTargetCube = function (e, t, i) {
            n.WebGLRenderTarget.call(this, e, t, i), this.activeCubeFace = 0
        },n.WebGLRenderTargetCube.prototype = Object.create(n.WebGLRenderTarget.prototype),n.WebGLRenderTargetCube.prototype.constructor = n.WebGLRenderTargetCube,n.WebGLExtensions = function (e) {
            var t = {};
            this.get = function (i) {
                if (void 0 !== t[i])return t[i];
                var r;
                switch (i) {
                    case"EXT_texture_filter_anisotropic":
                        r = e.getExtension("EXT_texture_filter_anisotropic") || e.getExtension("MOZ_EXT_texture_filter_anisotropic") || e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                        break;
                    case"WEBGL_compressed_texture_s3tc":
                        r = e.getExtension("WEBGL_compressed_texture_s3tc") || e.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                        break;
                    case"WEBGL_compressed_texture_pvrtc":
                        r = e.getExtension("WEBGL_compressed_texture_pvrtc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                        break;
                    default:
                        r = e.getExtension(i)
                }
                return null === r && n.warn("THREE.WebGLRenderer: " + i + " extension not supported."), t[i] = r, r
            }
        },n.WebGLProgram = function () {
            var e = 0, t = function (e) {
                var t, i, r = [];
                for (var n in e)t = e[n], t !== !1 && (i = "#define " + n + " " + t, r.push(i));
                return r.join("\n")
            }, i = function (e, t, i) {
                for (var r = {}, n = 0, o = i.length; o > n; n++) {
                    var a = i[n];
                    r[a] = e.getUniformLocation(t, a)
                }
                return r
            }, r = function (e, t, i) {
                for (var r = {}, n = 0, o = i.length; o > n; n++) {
                    var a = i[n];
                    r[a] = e.getAttribLocation(t, a)
                }
                return r
            };
            return function (o, a, s, h) {
                var l = o, u = l.context, c = s.defines, d = s.__webglShader.uniforms, f = s.attributes, p = s.__webglShader.vertexShader, m = s.__webglShader.fragmentShader, g = s.index0AttributeName;
                void 0 === g && h.morphTargets === !0 && (g = "position");
                var v = "SHADOWMAP_TYPE_BASIC";
                h.shadowMapType === n.PCFShadowMap ? v = "SHADOWMAP_TYPE_PCF" : h.shadowMapType === n.PCFSoftShadowMap && (v = "SHADOWMAP_TYPE_PCF_SOFT");
                var y = "ENVMAP_TYPE_CUBE", b = "ENVMAP_MODE_REFLECTION", w = "ENVMAP_BLENDING_MULTIPLY";
                if (h.envMap) {
                    switch (s.envMap.mapping) {
                        case n.CubeReflectionMapping:
                        case n.CubeRefractionMapping:
                            y = "ENVMAP_TYPE_CUBE";
                            break;
                        case n.EquirectangularReflectionMapping:
                        case n.EquirectangularRefractionMapping:
                            y = "ENVMAP_TYPE_EQUIREC";
                            break;
                        case n.SphericalReflectionMapping:
                            y = "ENVMAP_TYPE_SPHERE"
                    }
                    switch (s.envMap.mapping) {
                        case n.CubeRefractionMapping:
                        case n.EquirectangularRefractionMapping:
                            b = "ENVMAP_MODE_REFRACTION"
                    }
                    switch (s.combine) {
                        case n.MultiplyOperation:
                            w = "ENVMAP_BLENDING_MULTIPLY";
                            break;
                        case n.MixOperation:
                            w = "ENVMAP_BLENDING_MIX";
                            break;
                        case n.AddOperation:
                            w = "ENVMAP_BLENDING_ADD"
                    }
                }
                var _, x, S = o.gammaFactor > 0 ? o.gammaFactor : 1, E = t(c), M = u.createProgram();
                s instanceof n.RawShaderMaterial ? (_ = "", x = "") : (_ = ["precision " + h.precision + " float;", "precision " + h.precision + " int;", E, h.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", l.gammaInput ? "#define GAMMA_INPUT" : "", l.gammaOutput ? "#define GAMMA_OUTPUT" : "", "#define GAMMA_FACTOR " + S, "#define MAX_DIR_LIGHTS " + h.maxDirLights, "#define MAX_POINT_LIGHTS " + h.maxPointLights, "#define MAX_SPOT_LIGHTS " + h.maxSpotLights, "#define MAX_HEMI_LIGHTS " + h.maxHemiLights, "#define MAX_SHADOWS " + h.maxShadows, "#define MAX_BONES " + h.maxBones, h.map ? "#define USE_MAP" : "", h.envMap ? "#define USE_ENVMAP" : "", h.envMap ? "#define " + b : "", h.lightMap ? "#define USE_LIGHTMAP" : "", h.bumpMap ? "#define USE_BUMPMAP" : "", h.normalMap ? "#define USE_NORMALMAP" : "", h.specularMap ? "#define USE_SPECULARMAP" : "", h.alphaMap ? "#define USE_ALPHAMAP" : "", h.vertexColors ? "#define USE_COLOR" : "", h.flatShading ? "#define FLAT_SHADED" : "", h.skinning ? "#define USE_SKINNING" : "", h.useVertexTexture ? "#define BONE_TEXTURE" : "", h.morphTargets ? "#define USE_MORPHTARGETS" : "", h.morphNormals ? "#define USE_MORPHNORMALS" : "", h.wrapAround ? "#define WRAP_AROUND" : "", h.doubleSided ? "#define DOUBLE_SIDED" : "", h.flipSided ? "#define FLIP_SIDED" : "", h.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", h.shadowMapEnabled ? "#define " + v : "", h.shadowMapDebug ? "#define SHADOWMAP_DEBUG" : "", h.shadowMapCascade ? "#define SHADOWMAP_CASCADE" : "", h.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", h.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "attribute vec2 uv2;", "#ifdef USE_COLOR", "	attribute vec3 color;", "#endif", "#ifdef USE_MORPHTARGETS", "	attribute vec3 morphTarget0;", "	attribute vec3 morphTarget1;", "	attribute vec3 morphTarget2;", "	attribute vec3 morphTarget3;", "	#ifdef USE_MORPHNORMALS", "		attribute vec3 morphNormal0;", "		attribute vec3 morphNormal1;", "		attribute vec3 morphNormal2;", "		attribute vec3 morphNormal3;", "	#else", "		attribute vec3 morphTarget4;", "		attribute vec3 morphTarget5;", "		attribute vec3 morphTarget6;", "		attribute vec3 morphTarget7;", "	#endif", "#endif", "#ifdef USE_SKINNING", "	attribute vec4 skinIndex;", "	attribute vec4 skinWeight;", "#endif", ""].join("\n"), x = ["precision " + h.precision + " float;", "precision " + h.precision + " int;", h.bumpMap || h.normalMap || h.flatShading ? "#extension GL_OES_standard_derivatives : enable" : "", E, "#define MAX_DIR_LIGHTS " + h.maxDirLights, "#define MAX_POINT_LIGHTS " + h.maxPointLights, "#define MAX_SPOT_LIGHTS " + h.maxSpotLights, "#define MAX_HEMI_LIGHTS " + h.maxHemiLights, "#define MAX_SHADOWS " + h.maxShadows, h.alphaTest ? "#define ALPHATEST " + h.alphaTest : "", l.gammaInput ? "#define GAMMA_INPUT" : "", l.gammaOutput ? "#define GAMMA_OUTPUT" : "", "#define GAMMA_FACTOR " + S, h.useFog && h.fog ? "#define USE_FOG" : "", h.useFog && h.fogExp ? "#define FOG_EXP2" : "", h.map ? "#define USE_MAP" : "", h.envMap ? "#define USE_ENVMAP" : "", h.envMap ? "#define " + y : "", h.envMap ? "#define " + b : "", h.envMap ? "#define " + w : "", h.lightMap ? "#define USE_LIGHTMAP" : "", h.bumpMap ? "#define USE_BUMPMAP" : "", h.normalMap ? "#define USE_NORMALMAP" : "", h.specularMap ? "#define USE_SPECULARMAP" : "", h.alphaMap ? "#define USE_ALPHAMAP" : "", h.vertexColors ? "#define USE_COLOR" : "", h.flatShading ? "#define FLAT_SHADED" : "", h.metal ? "#define METAL" : "", h.wrapAround ? "#define WRAP_AROUND" : "", h.doubleSided ? "#define DOUBLE_SIDED" : "", h.flipSided ? "#define FLIP_SIDED" : "", h.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", h.shadowMapEnabled ? "#define " + v : "", h.shadowMapDebug ? "#define SHADOWMAP_DEBUG" : "", h.shadowMapCascade ? "#define SHADOWMAP_CASCADE" : "", h.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", ""].join("\n"));
                var A = new n.WebGLShader(u, u.VERTEX_SHADER, _ + p), T = new n.WebGLShader(u, u.FRAGMENT_SHADER, x + m);
                u.attachShader(M, A), u.attachShader(M, T), void 0 !== g && u.bindAttribLocation(M, 0, g), u.linkProgram(M);
                var C = u.getProgramInfoLog(M);
                u.getProgramParameter(M, u.LINK_STATUS) === !1 && n.error("THREE.WebGLProgram: shader error: " + u.getError(), "gl.VALIDATE_STATUS", u.getProgramParameter(M, u.VALIDATE_STATUS), "gl.getPRogramInfoLog", C), "" !== C && n.warn("THREE.WebGLProgram: gl.getProgramInfoLog()" + C), u.deleteShader(A), u.deleteShader(T);
                var P = ["viewMatrix", "modelViewMatrix", "projectionMatrix", "normalMatrix", "modelMatrix", "cameraPosition", "morphTargetInfluences", "bindMatrix", "bindMatrixInverse"];
                h.useVertexTexture ? (P.push("boneTexture"), P.push("boneTextureWidth"), P.push("boneTextureHeight")) : P.push("boneGlobalMatrices"), h.logarithmicDepthBuffer && P.push("logDepthBufFC");
                for (var L in d)P.push(L);
                this.uniforms = i(u, M, P), P = ["position", "normal", "uv", "uv2", "tangent", "color", "skinIndex", "skinWeight", "lineDistance"];
                for (var k = 0; k < h.maxMorphTargets; k++)P.push("morphTarget" + k);
                for (var k = 0; k < h.maxMorphNormals; k++)P.push("morphNormal" + k);
                for (var B in f)P.push(B);
                return this.attributes = r(u, M, P), this.attributesKeys = Object.keys(this.attributes), this.id = e++, this.code = a, this.usedTimes = 1, this.program = M, this.vertexShader = A, this.fragmentShader = T, this
            }
        }(),n.WebGLShader = function () {
            var e = function (e) {
                for (var t = e.split("\n"), i = 0; i < t.length; i++)t[i] = i + 1 + ": " + t[i];
                return t.join("\n")
            };
            return function (t, i, r) {
                var o = t.createShader(i);
                return t.shaderSource(o, r), t.compileShader(o), t.getShaderParameter(o, t.COMPILE_STATUS) === !1 && n.error("THREE.WebGLShader: Shader couldn't compile."), "" !== t.getShaderInfoLog(o) && n.warn("THREE.WebGLShader: gl.getShaderInfoLog()", t.getShaderInfoLog(o), e(r)), o
            }
        }(),n.WebGLState = function (e, t) {
            var i = new Uint8Array(16), r = new Uint8Array(16), o = null, a = null, s = null, h = null, l = null, u = null, c = null, d = null, f = null, p = null, m = null, g = null, v = null, y = null, b = null, w = null;
            this.initAttributes = function () {
                for (var e = 0, t = i.length; t > e; e++)i[e] = 0
            }, this.enableAttribute = function (t) {
                i[t] = 1, 0 === r[t] && (e.enableVertexAttribArray(t), r[t] = 1)
            }, this.disableUnusedAttributes = function () {
                for (var t = 0, n = r.length; n > t; t++)r[t] !== i[t] && (e.disableVertexAttribArray(t), r[t] = 0)
            }, this.setBlending = function (i, r, d, f, p, m, g) {
                i !== o && (i === n.NoBlending ? e.disable(e.BLEND) : i === n.AdditiveBlending ? (e.enable(e.BLEND), e.blendEquation(e.FUNC_ADD), e.blendFunc(e.SRC_ALPHA, e.ONE)) : i === n.SubtractiveBlending ? (e.enable(e.BLEND), e.blendEquation(e.FUNC_ADD), e.blendFunc(e.ZERO, e.ONE_MINUS_SRC_COLOR)) : i === n.MultiplyBlending ? (e.enable(e.BLEND), e.blendEquation(e.FUNC_ADD), e.blendFunc(e.ZERO, e.SRC_COLOR)) : i === n.CustomBlending ? e.enable(e.BLEND) : (e.enable(e.BLEND), e.blendEquationSeparate(e.FUNC_ADD, e.FUNC_ADD), e.blendFuncSeparate(e.SRC_ALPHA, e.ONE_MINUS_SRC_ALPHA, e.ONE, e.ONE_MINUS_SRC_ALPHA)), o = i), i === n.CustomBlending ? (p = p || r, m = m || d, g = g || f, (r !== a || p !== l) && (e.blendEquationSeparate(t(r), t(p)), a = r, l = p), (d !== s || f !== h || m !== u || g !== c) && (e.blendFuncSeparate(t(d), t(f), t(m), t(g)), s = d, h = f, u = m, c = g)) : (a = null, s = null, h = null, l = null, u = null, c = null)
            }, this.setDepthTest = function (t) {
                d !== t && (t ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), d = t)
            }, this.setDepthWrite = function (t) {
                f !== t && (e.depthMask(t), f = t)
            }, this.setColorWrite = function (t) {
                p !== t && (e.colorMask(t, t, t, t), p = t)
            }, this.setDoubleSided = function (t) {
                m !== t && (t ? e.disable(e.CULL_FACE) : e.enable(e.CULL_FACE), m = t)
            }, this.setFlipSided = function (t) {
                g !== t && (t ? e.frontFace(e.CW) : e.frontFace(e.CCW), g = t)
            }, this.setLineWidth = function (t) {
                t !== v && (e.lineWidth(t), v = t)
            }, this.setPolygonOffset = function (t, i, r) {
                y !== t && (t ? e.enable(e.POLYGON_OFFSET_FILL) : e.disable(e.POLYGON_OFFSET_FILL), y = t), !t || b === i && w === r || (e.polygonOffset(i, r), b = i, w = r)
            }, this.reset = function () {
                for (var e = 0; e < r.length; e++)r[e] = 0;
                o = null, d = null, f = null, p = null, m = null, g = null
            }
        },n.LensFlarePlugin = function (e, t) {
            function i(t) {
                var i = d.createProgram(), r = d.createShader(d.FRAGMENT_SHADER), n = d.createShader(d.VERTEX_SHADER), o = "precision " + e.getPrecision() + " float;\n";
                return d.shaderSource(r, o + t.fragmentShader), d.shaderSource(n, o + t.vertexShader), d.compileShader(r), d.compileShader(n), d.attachShader(i, r), d.attachShader(i, n), d.linkProgram(i), i
            }

            var r, o, a, s, h, l, u, c, d = e.context, f = function () {
                var e = new Float32Array([-1, -1, 0, 0, 1, -1, 1, 0, 1, 1, 1, 1, -1, 1, 0, 1]), t = new Uint16Array([0, 1, 2, 0, 2, 3]);
                r = d.createBuffer(), o = d.createBuffer(), d.bindBuffer(d.ARRAY_BUFFER, r), d.bufferData(d.ARRAY_BUFFER, e, d.STATIC_DRAW), d.bindBuffer(d.ELEMENT_ARRAY_BUFFER, o), d.bufferData(d.ELEMENT_ARRAY_BUFFER, t, d.STATIC_DRAW), u = d.createTexture(), c = d.createTexture(), d.bindTexture(d.TEXTURE_2D, u), d.texImage2D(d.TEXTURE_2D, 0, d.RGB, 16, 16, 0, d.RGB, d.UNSIGNED_BYTE, null), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MAG_FILTER, d.NEAREST), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MIN_FILTER, d.NEAREST), d.bindTexture(d.TEXTURE_2D, c), d.texImage2D(d.TEXTURE_2D, 0, d.RGBA, 16, 16, 0, d.RGBA, d.UNSIGNED_BYTE, null), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_S, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_WRAP_T, d.CLAMP_TO_EDGE), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MAG_FILTER, d.NEAREST), d.texParameteri(d.TEXTURE_2D, d.TEXTURE_MIN_FILTER, d.NEAREST), l = d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;
                var n;
                n = l ? {
                    vertexShader: ["uniform lowp int renderType;", "uniform vec3 screenPosition;", "uniform vec2 scale;", "uniform float rotation;", "uniform sampler2D occlusionMap;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "vUV = uv;", "vec2 pos = position;", "if( renderType == 2 ) {", "vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );", "vVisibility =        visibility.r / 9.0;", "vVisibility *= 1.0 - visibility.g / 9.0;", "vVisibility *=       visibility.b / 9.0;", "vVisibility *= 1.0 - visibility.a / 9.0;", "pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;", "pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;", "}", "gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );", "}"].join("\n"),
                    fragmentShader: ["uniform lowp int renderType;", "uniform sampler2D map;", "uniform float opacity;", "uniform vec3 color;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "if( renderType == 0 ) {", "gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );", "} else if( renderType == 1 ) {", "gl_FragColor = texture2D( map, vUV );", "} else {", "vec4 texture = texture2D( map, vUV );", "texture.a *= opacity * vVisibility;", "gl_FragColor = texture;", "gl_FragColor.rgb *= color;", "}", "}"].join("\n")
                } : {
                    vertexShader: ["uniform lowp int renderType;", "uniform vec3 screenPosition;", "uniform vec2 scale;", "uniform float rotation;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "void main() {", "vUV = uv;", "vec2 pos = position;", "if( renderType == 2 ) {", "pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;", "pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;", "}", "gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );", "}"].join("\n"),
                    fragmentShader: ["precision mediump float;", "uniform lowp int renderType;", "uniform sampler2D map;", "uniform sampler2D occlusionMap;", "uniform float opacity;", "uniform vec3 color;", "varying vec2 vUV;", "void main() {", "if( renderType == 0 ) {", "gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );", "} else if( renderType == 1 ) {", "gl_FragColor = texture2D( map, vUV );", "} else {", "float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;", "visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;", "visibility = ( 1.0 - visibility / 4.0 );", "vec4 texture = texture2D( map, vUV );", "texture.a *= opacity * visibility;", "gl_FragColor = texture;", "gl_FragColor.rgb *= color;", "}", "}"].join("\n")
                }, a = i(n), s = {
                    vertex: d.getAttribLocation(a, "position"),
                    uv: d.getAttribLocation(a, "uv")
                }, h = {
                    renderType: d.getUniformLocation(a, "renderType"),
                    map: d.getUniformLocation(a, "map"),
                    occlusionMap: d.getUniformLocation(a, "occlusionMap"),
                    opacity: d.getUniformLocation(a, "opacity"),
                    color: d.getUniformLocation(a, "color"),
                    scale: d.getUniformLocation(a, "scale"),
                    rotation: d.getUniformLocation(a, "rotation"),
                    screenPosition: d.getUniformLocation(a, "screenPosition")
                }
            };
            this.render = function (i, p, m, g) {
                if (0 !== t.length) {
                    var v = new n.Vector3, y = g / m, b = .5 * m, w = .5 * g, _ = 16 / g, x = new n.Vector2(_ * y, _), S = new n.Vector3(1, 1, 0), E = new n.Vector2(1, 1);
                    void 0 === a && f(), d.useProgram(a), d.enableVertexAttribArray(s.vertex), d.enableVertexAttribArray(s.uv), d.uniform1i(h.occlusionMap, 0), d.uniform1i(h.map, 1), d.bindBuffer(d.ARRAY_BUFFER, r), d.vertexAttribPointer(s.vertex, 2, d.FLOAT, !1, 16, 0), d.vertexAttribPointer(s.uv, 2, d.FLOAT, !1, 16, 8), d.bindBuffer(d.ELEMENT_ARRAY_BUFFER, o), d.disable(d.CULL_FACE), d.depthMask(!1);
                    for (var M = 0, A = t.length; A > M; M++) {
                        _ = 16 / g, x.set(_ * y, _);
                        var T = t[M];
                        if (v.set(T.matrixWorld.elements[12], T.matrixWorld.elements[13], T.matrixWorld.elements[14]), v.applyMatrix4(p.matrixWorldInverse), v.applyProjection(p.projectionMatrix), S.copy(v), E.x = S.x * b + b, E.y = S.y * w + w, l || E.x > 0 && E.x < m && E.y > 0 && E.y < g) {
                            d.activeTexture(d.TEXTURE1), d.bindTexture(d.TEXTURE_2D, u), d.copyTexImage2D(d.TEXTURE_2D, 0, d.RGB, E.x - 8, E.y - 8, 16, 16, 0), d.uniform1i(h.renderType, 0), d.uniform2f(h.scale, x.x, x.y), d.uniform3f(h.screenPosition, S.x, S.y, S.z), d.disable(d.BLEND), d.enable(d.DEPTH_TEST), d.drawElements(d.TRIANGLES, 6, d.UNSIGNED_SHORT, 0), d.activeTexture(d.TEXTURE0), d.bindTexture(d.TEXTURE_2D, c), d.copyTexImage2D(d.TEXTURE_2D, 0, d.RGBA, E.x - 8, E.y - 8, 16, 16, 0), d.uniform1i(h.renderType, 1), d.disable(d.DEPTH_TEST), d.activeTexture(d.TEXTURE1), d.bindTexture(d.TEXTURE_2D, u), d.drawElements(d.TRIANGLES, 6, d.UNSIGNED_SHORT, 0), T.positionScreen.copy(S), T.customUpdateCallback ? T.customUpdateCallback(T) : T.updateLensFlares(), d.uniform1i(h.renderType, 2), d.enable(d.BLEND);
                            for (var C = 0, P = T.lensFlares.length; P > C; C++) {
                                var L = T.lensFlares[C];
                                L.opacity > .001 && L.scale > .001 && (S.x = L.x, S.y = L.y, S.z = L.z, _ = L.size * L.scale / g, x.x = _ * y, x.y = _, d.uniform3f(h.screenPosition, S.x, S.y, S.z), d.uniform2f(h.scale, x.x, x.y), d.uniform1f(h.rotation, L.rotation), d.uniform1f(h.opacity, L.opacity), d.uniform3f(h.color, L.color.r, L.color.g, L.color.b), e.state.setBlending(L.blending, L.blendEquation, L.blendSrc, L.blendDst), e.setTexture(L.texture, 1), d.drawElements(d.TRIANGLES, 6, d.UNSIGNED_SHORT, 0))
                            }
                        }
                    }
                    d.enable(d.CULL_FACE), d.enable(d.DEPTH_TEST), d.depthMask(!0), e.resetGLState()
                }
            }
        },n.ShadowMapPlugin = function (e, t, i, r) {
            function o(e, t, r) {
                if (t.visible) {
                    var n = i[t.id];
                    if (n && t.castShadow && (t.frustumCulled === !1 || m.intersectsObject(t) === !0))for (var a = 0, s = n.length; s > a; a++) {
                        var h = n[a];
                        t._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse, t.matrixWorld), w.push(h)
                    }
                    for (var a = 0, s = t.children.length; s > a; a++)o(e, t.children[a], r)
                }
            }

            function a(e, t) {
                var i = new n.DirectionalLight;
                i.isVirtual = !0, i.onlyShadow = !0, i.castShadow = !0, i.shadowCameraNear = e.shadowCameraNear, i.shadowCameraFar = e.shadowCameraFar, i.shadowCameraLeft = e.shadowCameraLeft, i.shadowCameraRight = e.shadowCameraRight, i.shadowCameraBottom = e.shadowCameraBottom, i.shadowCameraTop = e.shadowCameraTop, i.shadowCameraVisible = e.shadowCameraVisible, i.shadowDarkness = e.shadowDarkness, i.shadowBias = e.shadowCascadeBias[t], i.shadowMapWidth = e.shadowCascadeWidth[t], i.shadowMapHeight = e.shadowCascadeHeight[t], i.pointsWorld = [], i.pointsFrustum = [];
                for (var r = i.pointsWorld, o = i.pointsFrustum, a = 0; 8 > a; a++)r[a] = new n.Vector3, o[a] = new n.Vector3;
                var s = e.shadowCascadeNearZ[t], h = e.shadowCascadeFarZ[t];
                return o[0].set(-1, -1, s), o[1].set(1, -1, s), o[2].set(-1, 1, s), o[3].set(1, 1, s), o[4].set(-1, -1, h), o[5].set(1, -1, h), o[6].set(-1, 1, h), o[7].set(1, 1, h), i
            }

            function s(e, t) {
                var i = e.shadowCascadeArray[t];
                i.position.copy(e.position), i.target.position.copy(e.target.position), i.lookAt(i.target), i.shadowCameraVisible = e.shadowCameraVisible, i.shadowDarkness = e.shadowDarkness, i.shadowBias = e.shadowCascadeBias[t];
                var r = e.shadowCascadeNearZ[t], n = e.shadowCascadeFarZ[t], o = i.pointsFrustum;
                o[0].z = r, o[1].z = r, o[2].z = r, o[3].z = r, o[4].z = n, o[5].z = n, o[6].z = n, o[7].z = n
            }

            function h(e, t) {
                var i = t.shadowCamera, r = t.pointsFrustum, n = t.pointsWorld;
                v.set(1 / 0, 1 / 0, 1 / 0), y.set(-(1 / 0), -(1 / 0), -(1 / 0));
                for (var o = 0; 8 > o; o++) {
                    var a = n[o];
                    a.copy(r[o]), a.unproject(e), a.applyMatrix4(i.matrixWorldInverse), a.x < v.x && (v.x = a.x), a.x > y.x && (y.x = a.x), a.y < v.y && (v.y = a.y), a.y > y.y && (y.y = a.y), a.z < v.z && (v.z = a.z), a.z > y.z && (y.z = a.z)
                }
                i.left = v.x, i.right = y.x, i.top = y.y, i.bottom = v.y, i.updateProjectionMatrix()
            }

            function l(e) {
                return e.material instanceof n.MeshFaceMaterial ? e.material.materials[0] : e.material
            }

            var u, c, d, f, p = e.context, m = new n.Frustum, g = new n.Matrix4, v = new n.Vector3, y = new n.Vector3, b = new n.Vector3, w = [], _ = n.ShaderLib.depthRGBA, x = n.UniformsUtils.clone(_.uniforms);
            u = new n.ShaderMaterial({
                uniforms: x,
                vertexShader: _.vertexShader,
                fragmentShader: _.fragmentShader
            }), c = new n.ShaderMaterial({
                uniforms: x,
                vertexShader: _.vertexShader,
                fragmentShader: _.fragmentShader,
                morphTargets: !0
            }), d = new n.ShaderMaterial({
                uniforms: x,
                vertexShader: _.vertexShader,
                fragmentShader: _.fragmentShader,
                skinning: !0
            }), f = new n.ShaderMaterial({
                uniforms: x,
                vertexShader: _.vertexShader,
                fragmentShader: _.fragmentShader,
                morphTargets: !0,
                skinning: !0
            }), u._shadowPass = !0, c._shadowPass = !0, d._shadowPass = !0, f._shadowPass = !0, this.render = function (i, v) {
                if (e.shadowMapEnabled !== !1) {
                    var y, _, x, S, E, M, A, T, C, P, L, k, B, R = [], I = 0, F = null;
                    for (p.clearColor(1, 1, 1, 1), p.disable(p.BLEND), p.enable(p.CULL_FACE), p.frontFace(p.CCW), e.shadowMapCullFace === n.CullFaceFront ? p.cullFace(p.FRONT) : p.cullFace(p.BACK), e.state.setDepthTest(!0), y = 0, _ = t.length; _ > y; y++)if (B = t[y], B.castShadow)if (B instanceof n.DirectionalLight && B.shadowCascade)for (E = 0; E < B.shadowCascadeCount; E++) {
                        var D;
                        if (B.shadowCascadeArray[E])D = B.shadowCascadeArray[E]; else {
                            D = a(B, E), D.originalCamera = v;
                            var O = new n.Gyroscope;
                            O.position.copy(B.shadowCascadeOffset), O.add(D), O.add(D.target), v.add(O), B.shadowCascadeArray[E] = D
                        }
                        s(B, E), R[I] = D, I++
                    } else R[I] = B, I++;
                    for (y = 0, _ = R.length; _ > y; y++) {
                        if (B = R[y], !B.shadowMap) {
                            var N = n.LinearFilter;
                            e.shadowMapType === n.PCFSoftShadowMap && (N = n.NearestFilter);
                            var U = {minFilter: N, magFilter: N, format: n.RGBAFormat};
                            B.shadowMap = new n.WebGLRenderTarget(B.shadowMapWidth, B.shadowMapHeight, U), B.shadowMapSize = new n.Vector2(B.shadowMapWidth, B.shadowMapHeight), B.shadowMatrix = new n.Matrix4
                        }
                        if (!B.shadowCamera) {
                            if (B instanceof n.SpotLight)B.shadowCamera = new n.PerspectiveCamera(B.shadowCameraFov, B.shadowMapWidth / B.shadowMapHeight, B.shadowCameraNear, B.shadowCameraFar); else {
                                if (!(B instanceof n.DirectionalLight)) {
                                    n.error("THREE.ShadowMapPlugin: Unsupported light type for shadow", B);
                                    continue
                                }
                                B.shadowCamera = new n.OrthographicCamera(B.shadowCameraLeft, B.shadowCameraRight, B.shadowCameraTop, B.shadowCameraBottom, B.shadowCameraNear, B.shadowCameraFar)
                            }
                            i.add(B.shadowCamera), i.autoUpdate === !0 && i.updateMatrixWorld()
                        }
                        B.shadowCameraVisible && !B.cameraHelper && (B.cameraHelper = new n.CameraHelper(B.shadowCamera), i.add(B.cameraHelper)), B.isVirtual && D.originalCamera == v && h(v, B), M = B.shadowMap, A = B.shadowMatrix, T = B.shadowCamera, T.position.setFromMatrixPosition(B.matrixWorld), b.setFromMatrixPosition(B.target.matrixWorld), T.lookAt(b), T.updateMatrixWorld(), T.matrixWorldInverse.getInverse(T.matrixWorld), B.cameraHelper && (B.cameraHelper.visible = B.shadowCameraVisible), B.shadowCameraVisible && B.cameraHelper.update(), A.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), A.multiply(T.projectionMatrix), A.multiply(T.matrixWorldInverse), g.multiplyMatrices(T.projectionMatrix, T.matrixWorldInverse), m.setFromMatrix(g), e.setRenderTarget(M), e.clear(), w.length = 0, o(i, i, T);
                        var z, V, W;
                        for (x = 0, S = w.length; S > x; x++)L = w[x], k = L.object, C = L.buffer, z = l(k), V = void 0 !== k.geometry.morphTargets && k.geometry.morphTargets.length > 0 && z.morphTargets, W = k instanceof n.SkinnedMesh && z.skinning, P = k.customDepthMaterial ? k.customDepthMaterial : W ? V ? f : d : V ? c : u, e.setMaterialFaces(z), C instanceof n.BufferGeometry ? e.renderBufferDirect(T, t, F, P, C, k) : e.renderBuffer(T, t, F, P, C, k);
                        for (x = 0, S = r.length; S > x; x++)L = r[x], k = L.object, k.visible && k.castShadow && (k._modelViewMatrix.multiplyMatrices(T.matrixWorldInverse, k.matrixWorld), e.renderImmediateObject(T, t, F, u, k))
                    }
                    var H = e.getClearColor(), G = e.getClearAlpha();
                    p.clearColor(H.r, H.g, H.b, G), p.enable(p.BLEND), e.shadowMapCullFace === n.CullFaceFront && p.cullFace(p.BACK), e.resetGLState()
                }
            }
        },n.SpritePlugin = function (e, t) {
            function i() {
                var t = c.createProgram(), i = c.createShader(c.VERTEX_SHADER), r = c.createShader(c.FRAGMENT_SHADER);
                return c.shaderSource(i, ["precision " + e.getPrecision() + " float;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform float rotation;", "uniform vec2 scale;", "uniform vec2 uvOffset;", "uniform vec2 uvScale;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "void main() {", "vUV = uvOffset + uv * uvScale;", "vec2 alignedPosition = position * scale;", "vec2 rotatedPosition;", "rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;", "rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;", "vec4 finalPosition;", "finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );", "finalPosition.xy += rotatedPosition;", "finalPosition = projectionMatrix * finalPosition;", "gl_Position = finalPosition;", "}"].join("\n")), c.shaderSource(r, ["precision " + e.getPrecision() + " float;", "uniform vec3 color;", "uniform sampler2D map;", "uniform float opacity;", "uniform int fogType;", "uniform vec3 fogColor;", "uniform float fogDensity;", "uniform float fogNear;", "uniform float fogFar;", "uniform float alphaTest;", "varying vec2 vUV;", "void main() {", "vec4 texture = texture2D( map, vUV );", "if ( texture.a < alphaTest ) discard;", "gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );", "if ( fogType > 0 ) {", "float depth = gl_FragCoord.z / gl_FragCoord.w;", "float fogFactor = 0.0;", "if ( fogType == 1 ) {", "fogFactor = smoothstep( fogNear, fogFar, depth );", "} else {", "const float LOG2 = 1.442695;", "float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );", "fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );", "}", "gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );", "}", "}"].join("\n")), c.compileShader(i), c.compileShader(r), c.attachShader(t, i), c.attachShader(t, r), c.linkProgram(t), t
            }

            function r(e, t) {
                return e.z !== t.z ? t.z - e.z : t.id - e.id
            }

            var o, a, s, h, l, u, c = e.context, d = new n.Vector3, f = new n.Quaternion, p = new n.Vector3, m = function () {
                var e = new Float32Array([-.5, -.5, 0, 0, .5, -.5, 1, 0, .5, .5, 1, 1, -.5, .5, 0, 1]), t = new Uint16Array([0, 1, 2, 0, 2, 3]);
                o = c.createBuffer(), a = c.createBuffer(), c.bindBuffer(c.ARRAY_BUFFER, o), c.bufferData(c.ARRAY_BUFFER, e, c.STATIC_DRAW), c.bindBuffer(c.ELEMENT_ARRAY_BUFFER, a), c.bufferData(c.ELEMENT_ARRAY_BUFFER, t, c.STATIC_DRAW), s = i(), h = {
                    position: c.getAttribLocation(s, "position"),
                    uv: c.getAttribLocation(s, "uv")
                }, l = {
                    uvOffset: c.getUniformLocation(s, "uvOffset"),
                    uvScale: c.getUniformLocation(s, "uvScale"),
                    rotation: c.getUniformLocation(s, "rotation"),
                    scale: c.getUniformLocation(s, "scale"),
                    color: c.getUniformLocation(s, "color"),
                    map: c.getUniformLocation(s, "map"),
                    opacity: c.getUniformLocation(s, "opacity"),
                    modelViewMatrix: c.getUniformLocation(s, "modelViewMatrix"),
                    projectionMatrix: c.getUniformLocation(s, "projectionMatrix"),
                    fogType: c.getUniformLocation(s, "fogType"),
                    fogDensity: c.getUniformLocation(s, "fogDensity"),
                    fogNear: c.getUniformLocation(s, "fogNear"),
                    fogFar: c.getUniformLocation(s, "fogFar"),
                    fogColor: c.getUniformLocation(s, "fogColor"),
                    alphaTest: c.getUniformLocation(s, "alphaTest")
                };
                var r = document.createElement("canvas");
                r.width = 8, r.height = 8;
                var d = r.getContext("2d");
                d.fillStyle = "white", d.fillRect(0, 0, 8, 8), u = new n.Texture(r), u.needsUpdate = !0
            };
            this.render = function (i, g) {
                if (0 !== t.length) {
                    void 0 === s && m(), c.useProgram(s), c.enableVertexAttribArray(h.position), c.enableVertexAttribArray(h.uv), c.disable(c.CULL_FACE), c.enable(c.BLEND), c.bindBuffer(c.ARRAY_BUFFER, o), c.vertexAttribPointer(h.position, 2, c.FLOAT, !1, 16, 0), c.vertexAttribPointer(h.uv, 2, c.FLOAT, !1, 16, 8), c.bindBuffer(c.ELEMENT_ARRAY_BUFFER, a), c.uniformMatrix4fv(l.projectionMatrix, !1, g.projectionMatrix.elements), c.activeTexture(c.TEXTURE0), c.uniform1i(l.map, 0);
                    var v = 0, y = 0, b = i.fog;
                    b ? (c.uniform3f(l.fogColor, b.color.r, b.color.g, b.color.b), b instanceof n.Fog ? (c.uniform1f(l.fogNear, b.near), c.uniform1f(l.fogFar, b.far), c.uniform1i(l.fogType, 1), v = 1, y = 1) : b instanceof n.FogExp2 && (c.uniform1f(l.fogDensity, b.density), c.uniform1i(l.fogType, 2), v = 2, y = 2)) : (c.uniform1i(l.fogType, 0), v = 0, y = 0);
                    for (var w = 0, _ = t.length; _ > w; w++) {
                        var x = t[w];
                        x._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse, x.matrixWorld), x.z = -x._modelViewMatrix.elements[14]
                    }
                    t.sort(r);
                    for (var S = [], w = 0, _ = t.length; _ > w; w++) {
                        var x = t[w], E = x.material;
                        c.uniform1f(l.alphaTest, E.alphaTest), c.uniformMatrix4fv(l.modelViewMatrix, !1, x._modelViewMatrix.elements), x.matrixWorld.decompose(d, f, p), S[0] = p.x, S[1] = p.y;
                        var M = 0;
                        i.fog && E.fog && (M = y), v !== M && (c.uniform1i(l.fogType, M), v = M), null !== E.map ? (c.uniform2f(l.uvOffset, E.map.offset.x, E.map.offset.y), c.uniform2f(l.uvScale, E.map.repeat.x, E.map.repeat.y)) : (c.uniform2f(l.uvOffset, 0, 0), c.uniform2f(l.uvScale, 1, 1)), c.uniform1f(l.opacity, E.opacity), c.uniform3f(l.color, E.color.r, E.color.g, E.color.b), c.uniform1f(l.rotation, E.rotation), c.uniform2fv(l.scale, S), e.state.setBlending(E.blending, E.blendEquation, E.blendSrc, E.blendDst), e.state.setDepthTest(E.depthTest), e.state.setDepthWrite(E.depthWrite), E.map && E.map.image && E.map.image.width ? e.setTexture(E.map, 0) : e.setTexture(u, 0), c.drawElements(c.TRIANGLES, 6, c.UNSIGNED_SHORT, 0)
                    }
                    c.enable(c.CULL_FACE), e.resetGLState()
                }
            }
        },n.GeometryUtils = {
            merge: function (e, t, i) {
                n.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");
                var r;
                t instanceof n.Mesh && (t.matrixAutoUpdate && t.updateMatrix(), r = t.matrix, t = t.geometry), e.merge(t, r, i)
            }, center: function (e) {
                return n.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."), e.center()
            }
        },n.ImageUtils = {
            crossOrigin: void 0, loadTexture: function (e, t, i, r) {
                var o = new n.ImageLoader;
                o.crossOrigin = this.crossOrigin;
                var a = new n.Texture(void 0, t);
                return o.load(e, function (e) {
                    a.image = e, a.needsUpdate = !0, i && i(a)
                }, void 0, function (e) {
                    r && r(e)
                }), a.sourceFile = e, a
            }, loadTextureCube: function (e, t, i, r) {
                var o = [], a = new n.ImageLoader;
                a.crossOrigin = this.crossOrigin;
                var s = new n.CubeTexture(o, t);
                s.flipY = !1;
                for (var h = 0, l = function (t) {
                    a.load(e[t], function (e) {
                        s.images[t] = e, h += 1, 6 === h && (s.needsUpdate = !0, i && i(s))
                    }, void 0, r)
                }, u = 0, c = e.length; c > u; ++u)l(u);
                return s
            }, loadCompressedTexture: function () {
                n.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")
            }, loadCompressedTextureCube: function () {
                n.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")
            }, getNormalMap: function (e, t) {
                var i = function (e, t) {
                    return [e[1] * t[2] - e[2] * t[1], e[2] * t[0] - e[0] * t[2], e[0] * t[1] - e[1] * t[0]]
                }, r = function (e, t) {
                    return [e[0] - t[0], e[1] - t[1], e[2] - t[2]]
                }, n = function (e) {
                    var t = Math.sqrt(e[0] * e[0] + e[1] * e[1] + e[2] * e[2]);
                    return [e[0] / t, e[1] / t, e[2] / t]
                };
                t = 1 | t;
                var o = e.width, a = e.height, s = document.createElement("canvas");
                s.width = o, s.height = a;
                var h = s.getContext("2d");
                h.drawImage(e, 0, 0);
                for (var l = h.getImageData(0, 0, o, a).data, u = h.createImageData(o, a), c = u.data, d = 0; o > d; d++)for (var f = 0; a > f; f++) {
                    var p = 0 > f - 1 ? 0 : f - 1, m = f + 1 > a - 1 ? a - 1 : f + 1, g = 0 > d - 1 ? 0 : d - 1, v = d + 1 > o - 1 ? o - 1 : d + 1, y = [], b = [0, 0, l[4 * (f * o + d)] / 255 * t];
                    y.push([-1, 0, l[4 * (f * o + g)] / 255 * t]), y.push([-1, -1, l[4 * (p * o + g)] / 255 * t]), y.push([0, -1, l[4 * (p * o + d)] / 255 * t]), y.push([1, -1, l[4 * (p * o + v)] / 255 * t]), y.push([1, 0, l[4 * (f * o + v)] / 255 * t]), y.push([1, 1, l[4 * (m * o + v)] / 255 * t]), y.push([0, 1, l[4 * (m * o + d)] / 255 * t]), y.push([-1, 1, l[4 * (m * o + g)] / 255 * t]);
                    for (var w = [], _ = y.length, x = 0; _ > x; x++) {
                        var S = y[x], E = y[(x + 1) % _];
                        S = r(S, b), E = r(E, b), w.push(n(i(S, E)))
                    }
                    for (var M = [0, 0, 0], x = 0; x < w.length; x++)M[0] += w[x][0], M[1] += w[x][1], M[2] += w[x][2];
                    M[0] /= w.length, M[1] /= w.length, M[2] /= w.length;
                    var A = 4 * (f * o + d);
                    c[A] = (M[0] + 1) / 2 * 255 | 0, c[A + 1] = (M[1] + 1) / 2 * 255 | 0, c[A + 2] = 255 * M[2] | 0, c[A + 3] = 255
                }
                return h.putImageData(u, 0, 0), s
            }, generateDataTexture: function (e, t, i) {
                for (var r = e * t, o = new Uint8Array(3 * r), a = Math.floor(255 * i.r), s = Math.floor(255 * i.g), h = Math.floor(255 * i.b), l = 0; r > l; l++)o[3 * l] = a, o[3 * l + 1] = s, o[3 * l + 2] = h;
                var u = new n.DataTexture(o, e, t, n.RGBFormat);
                return u.needsUpdate = !0, u
            }
        },n.SceneUtils = {
            createMultiMaterialObject: function (e, t) {
                for (var i = new n.Object3D, r = 0, o = t.length; o > r; r++)i.add(new n.Mesh(e, t[r]));
                return i
            }, detach: function (e, t, i) {
                e.applyMatrix(t.matrixWorld), t.remove(e), i.add(e)
            }, attach: function (e, t, i) {
                var r = new n.Matrix4;
                r.getInverse(i.matrixWorld), e.applyMatrix(r), t.remove(e), i.add(e)
            }
        },n.FontUtils = {
            faces: {},
            face: "helvetiker",
            weight: "normal",
            style: "normal",
            size: 150,
            divisions: 10,
            getFace: function () {
                try {
                    return this.faces[this.face][this.weight][this.style]
                } catch (e) {
                    throw"The font " + this.face + " with " + this.weight + " weight and " + this.style + " style is missing."
                }
            },
            loadFace: function (e) {
                var t = e.familyName.toLowerCase(), i = this;
                return i.faces[t] = i.faces[t] || {}, i.faces[t][e.cssFontWeight] = i.faces[t][e.cssFontWeight] || {}, i.faces[t][e.cssFontWeight][e.cssFontStyle] = e, i.faces[t][e.cssFontWeight][e.cssFontStyle] = e, e
            },
            drawText: function (e) {
                var t, i = this.getFace(), r = this.size / i.resolution, o = 0, a = String(e).split(""), s = a.length, h = [];
                for (t = 0; s > t; t++) {
                    var l = new n.Path, u = this.extractGlyphPoints(a[t], i, r, o, l);
                    o += u.offset, h.push(u.path)
                }
                var c = o / 2;
                return {paths: h, offset: c}
            },
            extractGlyphPoints: function (e, t, i, r, o) {
                var a, s, h, l, u, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M = [], A = t.glyphs[e] || t.glyphs["?"];
                if (A) {
                    if (A.o)for (l = A._cachedOutline || (A._cachedOutline = A.o.split(" ")), c = l.length, d = i, f = i, a = 0; c > a;)switch (u = l[a++]) {
                        case"m":
                            p = l[a++] * d + r, m = l[a++] * f, o.moveTo(p, m);
                            break;
                        case"l":
                            p = l[a++] * d + r, m = l[a++] * f, o.lineTo(p, m);
                            break;
                        case"q":
                            if (g = l[a++] * d + r, v = l[a++] * f, w = l[a++] * d + r, _ = l[a++] * f, o.quadraticCurveTo(w, _, g, v), E = M[M.length - 1])for (y = E.x, b = E.y, s = 1, h = this.divisions; h >= s; s++) {
                                var T = s / h;
                                n.Shape.Utils.b2(T, y, w, g), n.Shape.Utils.b2(T, b, _, v)
                            }
                            break;
                        case"b":
                            if (g = l[a++] * d + r, v = l[a++] * f, w = l[a++] * d + r, _ = l[a++] * f, x = l[a++] * d + r, S = l[a++] * f, o.bezierCurveTo(w, _, x, S, g, v), E = M[M.length - 1])for (y = E.x, b = E.y, s = 1, h = this.divisions; h >= s; s++) {
                                var T = s / h;
                                n.Shape.Utils.b3(T, y, w, x, g), n.Shape.Utils.b3(T, b, _, S, v)
                            }
                    }
                    return {offset: A.ha * i, path: o}
                }
            }
        },n.FontUtils.generateShapes = function (e, t) {
            t = t || {};
            var i = void 0 !== t.size ? t.size : 100, r = void 0 !== t.curveSegments ? t.curveSegments : 4, o = void 0 !== t.font ? t.font : "helvetiker", a = void 0 !== t.weight ? t.weight : "normal", s = void 0 !== t.style ? t.style : "normal";
            n.FontUtils.size = i, n.FontUtils.divisions = r, n.FontUtils.face = o, n.FontUtils.weight = a, n.FontUtils.style = s;
            for (var h = n.FontUtils.drawText(e), l = h.paths, u = [], c = 0, d = l.length; d > c; c++)Array.prototype.push.apply(u, l[c].toShapes());
            return u
        },function (e) {
            var t = 1e-10, i = function (e, t) {
                var i = e.length;
                if (3 > i)return null;
                var a, s, h, l = [], u = [], c = [];
                if (r(e) > 0)for (s = 0; i > s; s++)u[s] = s; else for (s = 0; i > s; s++)u[s] = i - 1 - s;
                var d = i, f = 2 * d;
                for (s = d - 1; d > 2;) {
                    if (f-- <= 0)return n.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"), t ? c : l;
                    if (a = s, a >= d && (a = 0), s = a + 1, s >= d && (s = 0), h = s + 1, h >= d && (h = 0), o(e, a, s, h, d, u)) {
                        var p, m, g, v, y;
                        for (p = u[a], m = u[s], g = u[h], l.push([e[p], e[m], e[g]]), c.push([u[a], u[s], u[h]]), v = s, y = s + 1; d > y; v++, y++)u[v] = u[y];
                        d--, f = 2 * d
                    }
                }
                return t ? c : l
            }, r = function (e) {
                for (var t = e.length, i = 0, r = t - 1, n = 0; t > n; r = n++)i += e[r].x * e[n].y - e[n].x * e[r].y;
                return .5 * i
            }, o = function (e, i, r, n, o, a) {
                var s, h, l, u, c, d, f, p, m;
                if (h = e[a[i]].x, l = e[a[i]].y, u = e[a[r]].x, c = e[a[r]].y, d = e[a[n]].x, f = e[a[n]].y, t > (u - h) * (f - l) - (c - l) * (d - h))return !1;
                var g, v, y, b, w, _, x, S, E, M, A, T, C, P, L;
                for (g = d - u, v = f - c, y = h - d, b = l - f, w = u - h, _ = c - l, s = 0; o > s; s++)if (p = e[a[s]].x, m = e[a[s]].y, !(p === h && m === l || p === u && m === c || p === d && m === f) && (x = p - h, S = m - l, E = p - u, M = m - c, A = p - d, T = m - f, L = g * M - v * E, C = w * S - _ * x, P = y * T - b * A, L >= -t && P >= -t && C >= -t))return !1;
                return !0
            };
            return e.Triangulate = i, e.Triangulate.area = r, e
        }(n.FontUtils),r._typeface_js = {
            faces: n.FontUtils.faces,
            loadFace: n.FontUtils.loadFace
        },n.typeface_js = r._typeface_js,n.Audio = function (e) {
            n.Object3D.call(this), this.type = "Audio", this.context = e.context, this.source = this.context.createBufferSource(), this.source.onended = this.onEnded.bind(this), this.gain = this.context.createGain(), this.gain.connect(this.context.destination), this.panner = this.context.createPanner(), this.panner.connect(this.gain), this.autoplay = !1, this.startTime = 0, this.isPlaying = !1
        },n.Audio.prototype = Object.create(n.Object3D.prototype),n.Audio.prototype.constructor = n.Audio,n.Audio.prototype.load = function (e) {
            var t = this, i = new XMLHttpRequest;
            return i.open("GET", e, !0), i.responseType = "arraybuffer", i.onload = function (e) {
                t.context.decodeAudioData(this.response, function (e) {
                    t.source.buffer = e, t.autoplay && t.play()
                })
            }, i.send(), this
        },n.Audio.prototype.play = function () {
            if (this.isPlaying === !0)return void n.warn("THREE.Audio: Audio is already playing.");
            var e = this.context.createBufferSource();
            e.buffer = this.source.buffer, e.loop = this.source.loop, e.onended = this.source.onended, e.connect(this.panner), e.start(0, this.startTime), this.isPlaying = !0, this.source = e
        },n.Audio.prototype.pause = function () {
            this.source.stop(), this.startTime = this.context.currentTime
        },n.Audio.prototype.stop = function () {
            this.source.stop(), this.startTime = 0
        },n.Audio.prototype.onEnded = function () {
            this.isPlaying = !1
        },n.Audio.prototype.setLoop = function (e) {
            this.source.loop = e
        },n.Audio.prototype.setRefDistance = function (e) {
            this.panner.refDistance = e
        },n.Audio.prototype.setRolloffFactor = function (e) {
            this.panner.rolloffFactor = e
        },n.Audio.prototype.setVolume = function (e) {
            this.gain.gain.value = e
        },n.Audio.prototype.updateMatrixWorld = function () {
            var e = new n.Vector3;
            return function (t) {
                n.Object3D.prototype.updateMatrixWorld.call(this, t), e.setFromMatrixPosition(this.matrixWorld), this.panner.setPosition(e.x, e.y, e.z)
            }
        }(),n.AudioListener = function () {
            n.Object3D.call(this), this.type = "AudioListener", this.context = new (window.AudioContext || window.webkitAudioContext)
        },n.AudioListener.prototype = Object.create(n.Object3D.prototype),n.AudioListener.prototype.constructor = n.AudioListener,n.AudioListener.prototype.updateMatrixWorld = function () {
            var e = new n.Vector3, t = new n.Quaternion, i = new n.Vector3, r = new n.Vector3, o = new n.Vector3, a = new n.Vector3;
            return function (s) {
                n.Object3D.prototype.updateMatrixWorld.call(this, s);
                var h = this.context.listener, l = this.up;
                this.matrixWorld.decompose(e, t, i), r.set(0, 0, -1).applyQuaternion(t), o.subVectors(e, a), h.setPosition(e.x, e.y, e.z), h.setOrientation(r.x, r.y, r.z, l.x, l.y, l.z), h.setVelocity(o.x, o.y, o.z), a.copy(e)
            }
        }(),n.Curve = function () {
        },n.Curve.prototype.getPoint = function (e) {
            return n.warn("THREE.Curve: Warning, getPoint() not implemented!"), null
        },n.Curve.prototype.getPointAt = function (e) {
            var t = this.getUtoTmapping(e);
            return this.getPoint(t)
        },n.Curve.prototype.getPoints = function (e) {
            e || (e = 5);
            var t, i = [];
            for (t = 0; e >= t; t++)i.push(this.getPoint(t / e));
            return i
        },n.Curve.prototype.getSpacedPoints = function (e) {
            e || (e = 5);
            var t, i = [];
            for (t = 0; e >= t; t++)i.push(this.getPointAt(t / e));
            return i
        },n.Curve.prototype.getLength = function () {
            var e = this.getLengths();
            return e[e.length - 1]
        },n.Curve.prototype.getLengths = function (e) {
            if (e || (e = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length == e + 1 && !this.needsUpdate)return this.cacheArcLengths;
            this.needsUpdate = !1;
            var t, i, r = [], n = this.getPoint(0), o = 0;
            for (r.push(0), i = 1; e >= i; i++)t = this.getPoint(i / e), o += t.distanceTo(n), r.push(o), n = t;
            return this.cacheArcLengths = r, r
        },n.Curve.prototype.updateArcLengths = function () {
            this.needsUpdate = !0, this.getLengths()
        },n.Curve.prototype.getUtoTmapping = function (e, t) {
            var i, r = this.getLengths(), n = 0, o = r.length;
            i = t ? t : e * r[o - 1];
            for (var a, s = 0, h = o - 1; h >= s;)if (n = Math.floor(s + (h - s) / 2), a = r[n] - i, 0 > a)s = n + 1; else {
                if (!(a > 0)) {
                    h = n;
                    break
                }
                h = n - 1
            }
            if (n = h, r[n] == i) {
                var l = n / (o - 1);
                return l
            }
            var u = r[n], c = r[n + 1], d = c - u, f = (i - u) / d, l = (n + f) / (o - 1);
            return l
        },n.Curve.prototype.getTangent = function (e) {
            var t = 1e-4, i = e - t, r = e + t;
            0 > i && (i = 0), r > 1 && (r = 1);
            var n = this.getPoint(i), o = this.getPoint(r), a = o.clone().sub(n);
            return a.normalize()
        },n.Curve.prototype.getTangentAt = function (e) {
            var t = this.getUtoTmapping(e);
            return this.getTangent(t)
        },n.Curve.Utils = {
            tangentQuadraticBezier: function (e, t, i, r) {
                return 2 * (1 - e) * (i - t) + 2 * e * (r - i)
            }, tangentCubicBezier: function (e, t, i, r, n) {
                return -3 * t * (1 - e) * (1 - e) + 3 * i * (1 - e) * (1 - e) - 6 * e * i * (1 - e) + 6 * e * r * (1 - e) - 3 * e * e * r + 3 * e * e * n
            }, tangentSpline: function (e, t, i, r, n) {
                var o = 6 * e * e - 6 * e, a = 3 * e * e - 4 * e + 1, s = -6 * e * e + 6 * e, h = 3 * e * e - 2 * e;
                return o + a + s + h
            }, interpolate: function (e, t, i, r, n) {
                var o = .5 * (i - e), a = .5 * (r - t), s = n * n, h = n * s;
                return (2 * t - 2 * i + o + a) * h + (-3 * t + 3 * i - 2 * o - a) * s + o * n + t
            }
        },n.Curve.create = function (e, t) {
            return e.prototype = Object.create(n.Curve.prototype), e.prototype.constructor = e, e.prototype.getPoint = t, e
        },n.CurvePath = function () {
            this.curves = [], this.bends = [], this.autoClose = !1
        },n.CurvePath.prototype = Object.create(n.Curve.prototype),n.CurvePath.prototype.constructor = n.CurvePath,n.CurvePath.prototype.add = function (e) {
            this.curves.push(e)
        },n.CurvePath.prototype.checkConnection = function () {
        },n.CurvePath.prototype.closePath = function () {
            var e = this.curves[0].getPoint(0), t = this.curves[this.curves.length - 1].getPoint(1);
            e.equals(t) || this.curves.push(new n.LineCurve(t, e))
        },n.CurvePath.prototype.getPoint = function (e) {
            for (var t, i, r = e * this.getLength(), n = this.getCurveLengths(), o = 0; o < n.length;) {
                if (n[o] >= r) {
                    t = n[o] - r, i = this.curves[o];
                    var a = 1 - t / i.getLength();
                    return i.getPointAt(a)
                }
                o++
            }
            return null
        },n.CurvePath.prototype.getLength = function () {
            var e = this.getCurveLengths();
            return e[e.length - 1]
        },n.CurvePath.prototype.getCurveLengths = function () {
            if (this.cacheLengths && this.cacheLengths.length == this.curves.length)return this.cacheLengths;
            var e, t = [], i = 0, r = this.curves.length;
            for (e = 0; r > e; e++)i += this.curves[e].getLength(), t.push(i);
            return this.cacheLengths = t, t
        },n.CurvePath.prototype.getBoundingBox = function () {
            var e, t, i, r, o, a, s = this.getPoints();
            e = t = Number.NEGATIVE_INFINITY, r = o = Number.POSITIVE_INFINITY;
            var h, l, u, c, d = s[0] instanceof n.Vector3;
            for (c = d ? new n.Vector3 : new n.Vector2, l = 0, u = s.length; u > l; l++)h = s[l], h.x > e ? e = h.x : h.x < r && (r = h.x), h.y > t ? t = h.y : h.y < o && (o = h.y), d && (h.z > i ? i = h.z : h.z < a && (a = h.z)), c.add(h);
            var f = {minX: r, minY: o, maxX: e, maxY: t};
            return d && (f.maxZ = i, f.minZ = a), f
        },n.CurvePath.prototype.createPointsGeometry = function (e) {
            var t = this.getPoints(e, !0);
            return this.createGeometry(t)
        },n.CurvePath.prototype.createSpacedPointsGeometry = function (e) {
            var t = this.getSpacedPoints(e, !0);
            return this.createGeometry(t)
        },n.CurvePath.prototype.createGeometry = function (e) {
            for (var t = new n.Geometry, i = 0; i < e.length; i++)t.vertices.push(new n.Vector3(e[i].x, e[i].y, e[i].z || 0));
            return t
        },n.CurvePath.prototype.addWrapPath = function (e) {
            this.bends.push(e)
        },n.CurvePath.prototype.getTransformedPoints = function (e, t) {
            var i, r, n = this.getPoints(e);
            for (t || (t = this.bends), i = 0, r = t.length; r > i; i++)n = this.getWrapPoints(n, t[i]);
            return n
        },n.CurvePath.prototype.getTransformedSpacedPoints = function (e, t) {
            var i, r, n = this.getSpacedPoints(e);
            for (t || (t = this.bends), i = 0, r = t.length; r > i; i++)n = this.getWrapPoints(n, t[i]);
            return n
        },n.CurvePath.prototype.getWrapPoints = function (e, t) {
            var i, r, n, o, a, s, h = this.getBoundingBox();
            for (i = 0, r = e.length; r > i; i++) {
                n = e[i], o = n.x, a = n.y, s = o / h.maxX, s = t.getUtoTmapping(s, o);
                var l = t.getPoint(s), u = t.getTangent(s);
                u.set(-u.y, u.x).multiplyScalar(a), n.x = l.x + u.x, n.y = l.y + u.y
            }
            return e
        },n.Gyroscope = function () {
            n.Object3D.call(this)
        },n.Gyroscope.prototype = Object.create(n.Object3D.prototype),n.Gyroscope.prototype.constructor = n.Gyroscope,n.Gyroscope.prototype.updateMatrixWorld = function () {
            var e = new n.Vector3, t = new n.Quaternion, i = new n.Vector3, r = new n.Vector3, o = new n.Quaternion, a = new n.Vector3;
            return function (n) {
                this.matrixAutoUpdate && this.updateMatrix(), (this.matrixWorldNeedsUpdate || n) && (this.parent ? (this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorld.decompose(r, o, a), this.matrix.decompose(e, t, i), this.matrixWorld.compose(r, t, a)) : this.matrixWorld.copy(this.matrix), this.matrixWorldNeedsUpdate = !1, n = !0);
                for (var s = 0, h = this.children.length; h > s; s++)this.children[s].updateMatrixWorld(n)
            }
        }(),n.Path = function (e) {
            n.CurvePath.call(this), this.actions = [], e && this.fromPoints(e)
        },n.Path.prototype = Object.create(n.CurvePath.prototype),n.Path.prototype.constructor = n.Path,n.PathActions = {
            MOVE_TO: "moveTo",
            LINE_TO: "lineTo",
            QUADRATIC_CURVE_TO: "quadraticCurveTo",
            BEZIER_CURVE_TO: "bezierCurveTo",
            CSPLINE_THRU: "splineThru",
            ARC: "arc",
            ELLIPSE: "ellipse"
        },n.Path.prototype.fromPoints = function (e) {
            this.moveTo(e[0].x, e[0].y);
            for (var t = 1, i = e.length; i > t; t++)this.lineTo(e[t].x, e[t].y)
        },n.Path.prototype.moveTo = function (e, t) {
            var i = Array.prototype.slice.call(arguments);
            this.actions.push({action: n.PathActions.MOVE_TO, args: i})
        },n.Path.prototype.lineTo = function (e, t) {
            var i = Array.prototype.slice.call(arguments), r = this.actions[this.actions.length - 1].args, o = r[r.length - 2], a = r[r.length - 1], s = new n.LineCurve(new n.Vector2(o, a), new n.Vector2(e, t));
            this.curves.push(s), this.actions.push({action: n.PathActions.LINE_TO, args: i})
        },n.Path.prototype.quadraticCurveTo = function (e, t, i, r) {
            var o = Array.prototype.slice.call(arguments), a = this.actions[this.actions.length - 1].args, s = a[a.length - 2], h = a[a.length - 1], l = new n.QuadraticBezierCurve(new n.Vector2(s, h), new n.Vector2(e, t), new n.Vector2(i, r));
            this.curves.push(l), this.actions.push({action: n.PathActions.QUADRATIC_CURVE_TO, args: o})
        },n.Path.prototype.bezierCurveTo = function (e, t, i, r, o, a) {
            var s = Array.prototype.slice.call(arguments), h = this.actions[this.actions.length - 1].args, l = h[h.length - 2], u = h[h.length - 1], c = new n.CubicBezierCurve(new n.Vector2(l, u), new n.Vector2(e, t), new n.Vector2(i, r), new n.Vector2(o, a));
            this.curves.push(c), this.actions.push({action: n.PathActions.BEZIER_CURVE_TO, args: s})
        },n.Path.prototype.splineThru = function (e) {
            var t = Array.prototype.slice.call(arguments), i = this.actions[this.actions.length - 1].args, r = i[i.length - 2], o = i[i.length - 1], a = [new n.Vector2(r, o)];
            Array.prototype.push.apply(a, e);
            var s = new n.SplineCurve(a);
            this.curves.push(s), this.actions.push({action: n.PathActions.CSPLINE_THRU, args: t})
        },n.Path.prototype.arc = function (e, t, i, r, n, o) {
            var a = this.actions[this.actions.length - 1].args, s = a[a.length - 2], h = a[a.length - 1];
            this.absarc(e + s, t + h, i, r, n, o)
        },n.Path.prototype.absarc = function (e, t, i, r, n, o) {
            this.absellipse(e, t, i, i, r, n, o)
        },n.Path.prototype.ellipse = function (e, t, i, r, n, o, a) {
            var s = this.actions[this.actions.length - 1].args, h = s[s.length - 2], l = s[s.length - 1];
            this.absellipse(e + h, t + l, i, r, n, o, a)
        },n.Path.prototype.absellipse = function (e, t, i, r, o, a, s) {
            var h = Array.prototype.slice.call(arguments), l = new n.EllipseCurve(e, t, i, r, o, a, s);
            this.curves.push(l);
            var u = l.getPoint(1);
            h.push(u.x), h.push(u.y), this.actions.push({action: n.PathActions.ELLIPSE, args: h})
        },n.Path.prototype.getSpacedPoints = function (e, t) {
            e || (e = 40);
            for (var i = [], r = 0; e > r; r++)i.push(this.getPoint(r / e));
            return i
        },n.Path.prototype.getPoints = function (e, t) {
            if (this.useSpacedPoints)return console.log("tata"), this.getSpacedPoints(e, t);
            e = e || 12;
            var i, r, o, a, s, h, l, u, c, d, f, p, m, g, v, y, b, w, _ = [];
            for (i = 0, r = this.actions.length; r > i; i++)switch (o = this.actions[i], a = o.action, s = o.args, a) {
                case n.PathActions.MOVE_TO:
                    _.push(new n.Vector2(s[0], s[1]));
                    break;
                case n.PathActions.LINE_TO:
                    _.push(new n.Vector2(s[0], s[1]));
                    break;
                case n.PathActions.QUADRATIC_CURVE_TO:
                    for (h = s[2], l = s[3], d = s[0], f = s[1], _.length > 0 ? (g = _[_.length - 1], p = g.x, m = g.y) : (g = this.actions[i - 1].args, p = g[g.length - 2], m = g[g.length - 1]), v = 1; e >= v; v++)y = v / e, b = n.Shape.Utils.b2(y, p, d, h), w = n.Shape.Utils.b2(y, m, f, l), _.push(new n.Vector2(b, w));
                    break;
                case n.PathActions.BEZIER_CURVE_TO:
                    for (h = s[4], l = s[5], d = s[0], f = s[1], u = s[2], c = s[3], _.length > 0 ? (g = _[_.length - 1], p = g.x, m = g.y) : (g = this.actions[i - 1].args, p = g[g.length - 2], m = g[g.length - 1]), v = 1; e >= v; v++)y = v / e, b = n.Shape.Utils.b3(y, p, d, u, h), w = n.Shape.Utils.b3(y, m, f, c, l), _.push(new n.Vector2(b, w));
                    break;
                case n.PathActions.CSPLINE_THRU:
                    g = this.actions[i - 1].args;
                    var x = new n.Vector2(g[g.length - 2], g[g.length - 1]), S = [x], E = e * s[0].length;
                    S = S.concat(s[0]);
                    var M = new n.SplineCurve(S);
                    for (v = 1; E >= v; v++)_.push(M.getPointAt(v / E));
                    break;
                case n.PathActions.ARC:
                    var A, T = s[0], C = s[1], P = s[2], L = s[3], k = s[4], B = !!s[5], R = k - L, I = 2 * e;
                    for (v = 1; I >= v; v++)y = v / I, B || (y = 1 - y), A = L + y * R, b = T + P * Math.cos(A), w = C + P * Math.sin(A), _.push(new n.Vector2(b, w));
                    break;
                case n.PathActions.ELLIPSE:
                    var A, T = s[0], C = s[1], F = s[2], D = s[3], L = s[4], k = s[5], B = !!s[6], R = k - L, I = 2 * e;
                    for (v = 1; I >= v; v++)y = v / I, B || (y = 1 - y), A = L + y * R, b = T + F * Math.cos(A), w = C + D * Math.sin(A), _.push(new n.Vector2(b, w))
            }
            var O = _[_.length - 1], N = 1e-10;
            return Math.abs(O.x - _[0].x) < N && Math.abs(O.y - _[0].y) < N && _.splice(_.length - 1, 1), t && _.push(_[0]), _
        },n.Path.prototype.toShapes = function (e, t) {
            function i(e) {
                var t, i, r, o, a, s = [], h = new n.Path;
                for (t = 0, i = e.length; i > t; t++)r = e[t], a = r.args, o = r.action, o == n.PathActions.MOVE_TO && 0 != h.actions.length && (s.push(h), h = new n.Path), h[o].apply(h, a);
                return 0 != h.actions.length && s.push(h), s
            }

            function r(e) {
                for (var t = [], i = 0, r = e.length; r > i; i++) {
                    var o = e[i], a = new n.Shape;
                    a.actions = o.actions, a.curves = o.curves, t.push(a)
                }
                return t
            }

            function o(e, t) {
                for (var i = 1e-10, r = t.length, n = !1, o = r - 1, a = 0; r > a; o = a++) {
                    var s = t[o], h = t[a], l = h.x - s.x, u = h.y - s.y;
                    if (Math.abs(u) > i) {
                        if (0 > u && (s = t[a], l = -l, h = t[o], u = -u), e.y < s.y || e.y > h.y)continue;
                        if (e.y == s.y) {
                            if (e.x == s.x)return !0
                        } else {
                            var c = u * (e.x - s.x) - l * (e.y - s.y);
                            if (0 == c)return !0;
                            if (0 > c)continue;
                            n = !n
                        }
                    } else {
                        if (e.y != s.y)continue;
                        if (h.x <= e.x && e.x <= s.x || s.x <= e.x && e.x <= h.x)return !0
                    }
                }
                return n
            }

            var a = i(this.actions);
            if (0 == a.length)return [];
            if (t === !0)return r(a);
            var s, h, l, u = [];
            if (1 == a.length)return h = a[0], l = new n.Shape, l.actions = h.actions, l.curves = h.curves, u.push(l), u;
            var c = !n.Shape.Utils.isClockWise(a[0].getPoints());
            c = e ? !c : c;
            var d, f = [], p = [], m = [], g = 0;
            p[g] = void 0, m[g] = [];
            var v, y;
            for (v = 0, y = a.length; y > v; v++)h = a[v], d = h.getPoints(), s = n.Shape.Utils.isClockWise(d), s = e ? !s : s, s ? (!c && p[g] && g++, p[g] = {
                s: new n.Shape,
                p: d
            }, p[g].s.actions = h.actions, p[g].s.curves = h.curves, c && g++, m[g] = []) : m[g].push({h: h, p: d[0]});
            if (!p[0])return r(a);
            if (p.length > 1) {
                for (var b = !1, w = [], _ = 0, x = p.length; x > _; _++)f[_] = [];
                for (var _ = 0, x = p.length; x > _; _++)for (var S = m[_], E = 0; E < S.length; E++) {
                    for (var M = S[E], A = !0, T = 0; T < p.length; T++)o(M.p, p[T].p) && (_ != T && w.push({
                        froms: _,
                        tos: T,
                        hole: E
                    }), A ? (A = !1, f[T].push(M)) : b = !0);
                    A && f[_].push(M)
                }
                w.length > 0 && (b || (m = f))
            }
            var C, P, L;
            for (v = 0, y = p.length; y > v; v++)for (l = p[v].s, u.push(l), C = m[v], P = 0, L = C.length; L > P; P++)l.holes.push(C[P].h);
            return u
        },n.Shape = function () {
            n.Path.apply(this, arguments), this.holes = []
        },n.Shape.prototype = Object.create(n.Path.prototype),n.Shape.prototype.constructor = n.Shape,n.Shape.prototype.extrude = function (e) {
            var t = new n.ExtrudeGeometry(this, e);
            return t
        },n.Shape.prototype.makeGeometry = function (e) {
            var t = new n.ShapeGeometry(this, e);
            return t
        },n.Shape.prototype.getPointsHoles = function (e) {
            var t, i = this.holes.length, r = [];
            for (t = 0; i > t; t++)r[t] = this.holes[t].getTransformedPoints(e, this.bends);
            return r
        },n.Shape.prototype.getSpacedPointsHoles = function (e) {
            var t, i = this.holes.length, r = [];
            for (t = 0; i > t; t++)r[t] = this.holes[t].getTransformedSpacedPoints(e, this.bends);
            return r
        },n.Shape.prototype.extractAllPoints = function (e) {
            return {shape: this.getTransformedPoints(e), holes: this.getPointsHoles(e)}
        },n.Shape.prototype.extractPoints = function (e) {
            return this.useSpacedPoints ? this.extractAllSpacedPoints(e) : this.extractAllPoints(e)
        },n.Shape.prototype.extractAllSpacedPoints = function (e) {
            return {shape: this.getTransformedSpacedPoints(e), holes: this.getSpacedPointsHoles(e)}
        },n.Shape.Utils = {
            triangulateShape: function (e, t) {
                function i(e, t, i) {
                    return e.x != t.x ? e.x < t.x ? e.x <= i.x && i.x <= t.x : t.x <= i.x && i.x <= e.x : e.y < t.y ? e.y <= i.y && i.y <= t.y : t.y <= i.y && i.y <= e.y
                }

                function r(e, t, r, n, o) {
                    var a = 1e-10, s = t.x - e.x, h = t.y - e.y, l = n.x - r.x, u = n.y - r.y, c = e.x - r.x, d = e.y - r.y, f = h * l - s * u, p = h * c - s * d;
                    if (Math.abs(f) > a) {
                        var m;
                        if (f > 0) {
                            if (0 > p || p > f)return [];
                            if (m = u * c - l * d, 0 > m || m > f)return []
                        } else {
                            if (p > 0 || f > p)return [];
                            if (m = u * c - l * d, m > 0 || f > m)return []
                        }
                        if (0 == m)return !o || 0 != p && p != f ? [e] : [];
                        if (m == f)return !o || 0 != p && p != f ? [t] : [];
                        if (0 == p)return [r];
                        if (p == f)return [n];
                        var g = m / f;
                        return [{x: e.x + g * s, y: e.y + g * h}]
                    }
                    if (0 != p || u * c != l * d)return [];
                    var v = 0 == s && 0 == h, y = 0 == l && 0 == u;
                    if (v && y)return e.x != r.x || e.y != r.y ? [] : [e];
                    if (v)return i(r, n, e) ? [e] : [];
                    if (y)return i(e, t, r) ? [r] : [];
                    var b, w, _, x, S, E, M, A;
                    return 0 != s ? (e.x < t.x ? (b = e, _ = e.x, w = t, x = t.x) : (b = t, _ = t.x, w = e, x = e.x), r.x < n.x ? (S = r, M = r.x, E = n, A = n.x) : (S = n, M = n.x, E = r, A = r.x)) : (e.y < t.y ? (b = e, _ = e.y, w = t, x = t.y) : (b = t, _ = t.y, w = e, x = e.y), r.y < n.y ? (S = r, M = r.y, E = n, A = n.y) : (S = n, M = n.y, E = r, A = r.y)), M >= _ ? M > x ? [] : x == M ? o ? [] : [S] : A >= x ? [S, w] : [S, E] : _ > A ? [] : _ == A ? o ? [] : [b] : A >= x ? [b, w] : [b, E]
                }

                function o(e, t, i, r) {
                    var n = 1e-10, o = t.x - e.x, a = t.y - e.y, s = i.x - e.x, h = i.y - e.y, l = r.x - e.x, u = r.y - e.y, c = o * h - a * s, d = o * u - a * l;
                    if (Math.abs(c) > n) {
                        var f = l * h - u * s;
                        return c > 0 ? d >= 0 && f >= 0 : d >= 0 || f >= 0
                    }
                    return d > 0
                }

                function a(e, t) {
                    function i(e, t) {
                        var i = y.length - 1, r = e - 1;
                        0 > r && (r = i);
                        var n = e + 1;
                        n > i && (n = 0);
                        var a = o(y[e], y[r], y[n], s[t]);
                        if (!a)return !1;
                        var h = s.length - 1, l = t - 1;
                        0 > l && (l = h);
                        var u = t + 1;
                        return u > h && (u = 0), a = o(s[t], s[l], s[u], y[e]), a ? !0 : !1
                    }

                    function n(e, t) {
                        var i, n, o;
                        for (i = 0; i < y.length; i++)if (n = i + 1, n %= y.length, o = r(e, t, y[i], y[n], !0), o.length > 0)return !0;
                        return !1
                    }

                    function a(e, i) {
                        var n, o, a, s, h;
                        for (n = 0; n < b.length; n++)for (o = t[b[n]], a = 0; a < o.length; a++)if (s = a + 1, s %= o.length, h = r(e, i, o[a], o[s], !0), h.length > 0)return !0;
                        return !1
                    }

                    for (var s, h, l, u, c, d, f, p, m, g, v, y = e.concat(), b = [], w = [], _ = 0, x = t.length; x > _; _++)b.push(_);
                    for (var S = 0, E = 2 * b.length; b.length > 0;) {
                        if (E--, 0 > E) {
                            console.log("Infinite Loop! Holes left:" + b.length + ", Probably Hole outside Shape!");
                            break
                        }
                        for (l = S; l < y.length; l++) {
                            u = y[l], h = -1;
                            for (var _ = 0; _ < b.length; _++)if (d = b[_], f = u.x + ":" + u.y + ":" + d, void 0 === w[f]) {
                                s = t[d];
                                for (var M = 0; M < s.length; M++)if (c = s[M], i(l, M) && !n(u, c) && !a(u, c)) {
                                    h = M, b.splice(_, 1), p = y.slice(0, l + 1), m = y.slice(l), g = s.slice(h), v = s.slice(0, h + 1), y = p.concat(g).concat(v).concat(m), S = l;
                                    break
                                }
                                if (h >= 0)break;
                                w[f] = !0
                            }
                            if (h >= 0)break
                        }
                    }
                    return y
                }

                for (var s, h, l, u, c, d, f = {}, p = e.concat(), m = 0, g = t.length; g > m; m++)Array.prototype.push.apply(p, t[m]);
                for (s = 0, h = p.length; h > s; s++)c = p[s].x + ":" + p[s].y, void 0 !== f[c] && n.warn("THREE.Shape: Duplicate point", c), f[c] = s;
                var v = a(e, t), y = n.FontUtils.Triangulate(v, !1);
                for (s = 0, h = y.length; h > s; s++)for (u = y[s], l = 0; 3 > l; l++)c = u[l].x + ":" + u[l].y, d = f[c], void 0 !== d && (u[l] = d);
                return y.concat()
            }, isClockWise: function (e) {
                return n.FontUtils.Triangulate.area(e) < 0
            }, b2p0: function (e, t) {
                var i = 1 - e;
                return i * i * t
            }, b2p1: function (e, t) {
                return 2 * (1 - e) * e * t
            }, b2p2: function (e, t) {
                return e * e * t
            }, b2: function (e, t, i, r) {
                return this.b2p0(e, t) + this.b2p1(e, i) + this.b2p2(e, r)
            }, b3p0: function (e, t) {
                var i = 1 - e;
                return i * i * i * t
            }, b3p1: function (e, t) {
                var i = 1 - e;
                return 3 * i * i * e * t
            }, b3p2: function (e, t) {
                var i = 1 - e;
                return 3 * i * e * e * t
            }, b3p3: function (e, t) {
                return e * e * e * t
            }, b3: function (e, t, i, r, n) {
                return this.b3p0(e, t) + this.b3p1(e, i) + this.b3p2(e, r) + this.b3p3(e, n);
            }
        },n.LineCurve = function (e, t) {
            this.v1 = e, this.v2 = t
        },n.LineCurve.prototype = Object.create(n.Curve.prototype),n.LineCurve.prototype.constructor = n.LineCurve,n.LineCurve.prototype.getPoint = function (e) {
            var t = this.v2.clone().sub(this.v1);
            return t.multiplyScalar(e).add(this.v1), t
        },n.LineCurve.prototype.getPointAt = function (e) {
            return this.getPoint(e)
        },n.LineCurve.prototype.getTangent = function (e) {
            var t = this.v2.clone().sub(this.v1);
            return t.normalize()
        },n.QuadraticBezierCurve = function (e, t, i) {
            this.v0 = e, this.v1 = t, this.v2 = i
        },n.QuadraticBezierCurve.prototype = Object.create(n.Curve.prototype),n.QuadraticBezierCurve.prototype.constructor = n.QuadraticBezierCurve,n.QuadraticBezierCurve.prototype.getPoint = function (e) {
            var t = new n.Vector2;
            return t.x = n.Shape.Utils.b2(e, this.v0.x, this.v1.x, this.v2.x), t.y = n.Shape.Utils.b2(e, this.v0.y, this.v1.y, this.v2.y), t
        },n.QuadraticBezierCurve.prototype.getTangent = function (e) {
            var t = new n.Vector2;
            return t.x = n.Curve.Utils.tangentQuadraticBezier(e, this.v0.x, this.v1.x, this.v2.x), t.y = n.Curve.Utils.tangentQuadraticBezier(e, this.v0.y, this.v1.y, this.v2.y), t.normalize()
        },n.CubicBezierCurve = function (e, t, i, r) {
            this.v0 = e, this.v1 = t, this.v2 = i, this.v3 = r
        },n.CubicBezierCurve.prototype = Object.create(n.Curve.prototype),n.CubicBezierCurve.prototype.constructor = n.CubicBezierCurve,n.CubicBezierCurve.prototype.getPoint = function (e) {
            var t, i;
            return t = n.Shape.Utils.b3(e, this.v0.x, this.v1.x, this.v2.x, this.v3.x), i = n.Shape.Utils.b3(e, this.v0.y, this.v1.y, this.v2.y, this.v3.y), new n.Vector2(t, i)
        },n.CubicBezierCurve.prototype.getTangent = function (e) {
            var t, i;
            t = n.Curve.Utils.tangentCubicBezier(e, this.v0.x, this.v1.x, this.v2.x, this.v3.x), i = n.Curve.Utils.tangentCubicBezier(e, this.v0.y, this.v1.y, this.v2.y, this.v3.y);
            var r = new n.Vector2(t, i);
            return r.normalize(), r
        },n.SplineCurve = function (e) {
            this.points = void 0 == e ? [] : e
        },n.SplineCurve.prototype = Object.create(n.Curve.prototype),n.SplineCurve.prototype.constructor = n.SplineCurve,n.SplineCurve.prototype.getPoint = function (e) {
            var t = this.points, i = (t.length - 1) * e, r = Math.floor(i), o = i - r, a = t[0 == r ? r : r - 1], s = t[r], h = t[r > t.length - 2 ? t.length - 1 : r + 1], l = t[r > t.length - 3 ? t.length - 1 : r + 2], u = new n.Vector2;
            return u.x = n.Curve.Utils.interpolate(a.x, s.x, h.x, l.x, o), u.y = n.Curve.Utils.interpolate(a.y, s.y, h.y, l.y, o), u
        },n.EllipseCurve = function (e, t, i, r, n, o, a) {
            this.aX = e, this.aY = t, this.xRadius = i, this.yRadius = r, this.aStartAngle = n, this.aEndAngle = o, this.aClockwise = a
        },n.EllipseCurve.prototype = Object.create(n.Curve.prototype),n.EllipseCurve.prototype.constructor = n.EllipseCurve,n.EllipseCurve.prototype.getPoint = function (e) {
            var t = this.aEndAngle - this.aStartAngle;
            0 > t && (t += 2 * Math.PI), t > 2 * Math.PI && (t -= 2 * Math.PI);
            var i;
            i = this.aClockwise === !0 ? this.aEndAngle + (1 - e) * (2 * Math.PI - t) : this.aStartAngle + e * t;
            var r = new n.Vector2;
            return r.x = this.aX + this.xRadius * Math.cos(i), r.y = this.aY + this.yRadius * Math.sin(i), r
        },n.ArcCurve = function (e, t, i, r, o, a) {
            n.EllipseCurve.call(this, e, t, i, i, r, o, a)
        },n.ArcCurve.prototype = Object.create(n.EllipseCurve.prototype),n.ArcCurve.prototype.constructor = n.ArcCurve,n.LineCurve3 = n.Curve.create(function (e, t) {
            this.v1 = e, this.v2 = t
        }, function (e) {
            var t = new n.Vector3;
            return t.subVectors(this.v2, this.v1), t.multiplyScalar(e), t.add(this.v1), t
        }),n.QuadraticBezierCurve3 = n.Curve.create(function (e, t, i) {
            this.v0 = e, this.v1 = t, this.v2 = i
        }, function (e) {
            var t = new n.Vector3;
            return t.x = n.Shape.Utils.b2(e, this.v0.x, this.v1.x, this.v2.x), t.y = n.Shape.Utils.b2(e, this.v0.y, this.v1.y, this.v2.y), t.z = n.Shape.Utils.b2(e, this.v0.z, this.v1.z, this.v2.z), t
        }),n.CubicBezierCurve3 = n.Curve.create(function (e, t, i, r) {
            this.v0 = e, this.v1 = t, this.v2 = i, this.v3 = r
        }, function (e) {
            var t = new n.Vector3;
            return t.x = n.Shape.Utils.b3(e, this.v0.x, this.v1.x, this.v2.x, this.v3.x), t.y = n.Shape.Utils.b3(e, this.v0.y, this.v1.y, this.v2.y, this.v3.y), t.z = n.Shape.Utils.b3(e, this.v0.z, this.v1.z, this.v2.z, this.v3.z), t
        }),n.SplineCurve3 = n.Curve.create(function (e) {
            this.points = void 0 == e ? [] : e
        }, function (e) {
            var t = this.points, i = (t.length - 1) * e, r = Math.floor(i), o = i - r, a = t[0 == r ? r : r - 1], s = t[r], h = t[r > t.length - 2 ? t.length - 1 : r + 1], l = t[r > t.length - 3 ? t.length - 1 : r + 2], u = new n.Vector3;
            return u.x = n.Curve.Utils.interpolate(a.x, s.x, h.x, l.x, o), u.y = n.Curve.Utils.interpolate(a.y, s.y, h.y, l.y, o), u.z = n.Curve.Utils.interpolate(a.z, s.z, h.z, l.z, o), u
        }),n.ClosedSplineCurve3 = n.Curve.create(function (e) {
            this.points = void 0 == e ? [] : e
        }, function (e) {
            var t = this.points, i = (t.length - 0) * e, r = Math.floor(i), o = i - r;
            r += r > 0 ? 0 : (Math.floor(Math.abs(r) / t.length) + 1) * t.length;
            var a = t[(r - 1) % t.length], s = t[r % t.length], h = t[(r + 1) % t.length], l = t[(r + 2) % t.length], u = new n.Vector3;
            return u.x = n.Curve.Utils.interpolate(a.x, s.x, h.x, l.x, o), u.y = n.Curve.Utils.interpolate(a.y, s.y, h.y, l.y, o), u.z = n.Curve.Utils.interpolate(a.z, s.z, h.z, l.z, o), u
        }),n.AnimationHandler = {
            LINEAR: 0, CATMULLROM: 1, CATMULLROM_FORWARD: 2, add: function () {
                n.warn("THREE.AnimationHandler.add() has been deprecated.")
            }, get: function () {
                n.warn("THREE.AnimationHandler.get() has been deprecated.")
            }, remove: function () {
                n.warn("THREE.AnimationHandler.remove() has been deprecated.")
            }, animations: [], init: function (e) {
                if (e.initialized === !0)return e;
                for (var t = 0; t < e.hierarchy.length; t++) {
                    for (var i = 0; i < e.hierarchy[t].keys.length; i++)if (e.hierarchy[t].keys[i].time < 0 && (e.hierarchy[t].keys[i].time = 0), void 0 !== e.hierarchy[t].keys[i].rot && !(e.hierarchy[t].keys[i].rot instanceof n.Quaternion)) {
                        var r = e.hierarchy[t].keys[i].rot;
                        e.hierarchy[t].keys[i].rot = (new n.Quaternion).fromArray(r)
                    }
                    if (e.hierarchy[t].keys.length && void 0 !== e.hierarchy[t].keys[0].morphTargets) {
                        for (var o = {}, i = 0; i < e.hierarchy[t].keys.length; i++)for (var a = 0; a < e.hierarchy[t].keys[i].morphTargets.length; a++) {
                            var s = e.hierarchy[t].keys[i].morphTargets[a];
                            o[s] = -1
                        }
                        e.hierarchy[t].usedMorphTargets = o;
                        for (var i = 0; i < e.hierarchy[t].keys.length; i++) {
                            var h = {};
                            for (var s in o) {
                                for (var a = 0; a < e.hierarchy[t].keys[i].morphTargets.length; a++)if (e.hierarchy[t].keys[i].morphTargets[a] === s) {
                                    h[s] = e.hierarchy[t].keys[i].morphTargetsInfluences[a];
                                    break
                                }
                                a === e.hierarchy[t].keys[i].morphTargets.length && (h[s] = 0)
                            }
                            e.hierarchy[t].keys[i].morphTargetsInfluences = h
                        }
                    }
                    for (var i = 1; i < e.hierarchy[t].keys.length; i++)e.hierarchy[t].keys[i].time === e.hierarchy[t].keys[i - 1].time && (e.hierarchy[t].keys.splice(i, 1), i--);
                    for (var i = 0; i < e.hierarchy[t].keys.length; i++)e.hierarchy[t].keys[i].index = i
                }
                return e.initialized = !0, e
            }, parse: function (e) {
                var t = function (e, i) {
                    i.push(e);
                    for (var r = 0; r < e.children.length; r++)t(e.children[r], i)
                }, i = [];
                if (e instanceof n.SkinnedMesh)for (var r = 0; r < e.skeleton.bones.length; r++)i.push(e.skeleton.bones[r]); else t(e, i);
                return i
            }, play: function (e) {
                -1 === this.animations.indexOf(e) && this.animations.push(e)
            }, stop: function (e) {
                var t = this.animations.indexOf(e);
                -1 !== t && this.animations.splice(t, 1)
            }, update: function (e) {
                for (var t = 0; t < this.animations.length; t++)this.animations[t].resetBlendWeights();
                for (var t = 0; t < this.animations.length; t++)this.animations[t].update(e)
            }
        },n.Animation = function (e, t) {
            this.root = e, this.data = n.AnimationHandler.init(t), this.hierarchy = n.AnimationHandler.parse(e), this.currentTime = 0, this.timeScale = 1, this.isPlaying = !1, this.loop = !0, this.weight = 0, this.interpolationType = n.AnimationHandler.LINEAR
        },n.Animation.prototype = {
            constructor: n.Animation, keyTypes: ["pos", "rot", "scl"], play: function (e, t) {
                this.currentTime = void 0 !== e ? e : 0, this.weight = void 0 !== t ? t : 1, this.isPlaying = !0, this.reset(), n.AnimationHandler.play(this)
            }, stop: function () {
                this.isPlaying = !1, n.AnimationHandler.stop(this)
            }, reset: function () {
                for (var e = 0, t = this.hierarchy.length; t > e; e++) {
                    var i = this.hierarchy[e];
                    void 0 === i.animationCache && (i.animationCache = {
                        animations: {},
                        blending: {positionWeight: 0, quaternionWeight: 0, scaleWeight: 0}
                    });
                    var r = this.data.name, n = i.animationCache.animations, o = n[r];
                    void 0 === o && (o = {
                        prevKey: {pos: 0, rot: 0, scl: 0},
                        nextKey: {pos: 0, rot: 0, scl: 0},
                        originalMatrix: i.matrix
                    }, n[r] = o);
                    for (var a = 0; 3 > a; a++) {
                        for (var s = this.keyTypes[a], h = this.data.hierarchy[e].keys[0], l = this.getNextKeyWith(s, e, 1); l.time < this.currentTime && l.index > h.index;)h = l, l = this.getNextKeyWith(s, e, l.index + 1);
                        o.prevKey[s] = h, o.nextKey[s] = l
                    }
                }
            }, resetBlendWeights: function () {
                for (var e = 0, t = this.hierarchy.length; t > e; e++) {
                    var i = this.hierarchy[e], r = i.animationCache;
                    if (void 0 !== r) {
                        var n = r.blending;
                        n.positionWeight = 0, n.quaternionWeight = 0, n.scaleWeight = 0
                    }
                }
            }, update: function () {
                var e = [], t = new n.Vector3, i = new n.Vector3, r = new n.Quaternion, o = function (e, t) {
                    var i, r, n, o, s, h, l, u, c, d = [], f = [];
                    return i = (e.length - 1) * t, r = Math.floor(i), n = i - r, d[0] = 0 === r ? r : r - 1, d[1] = r, d[2] = r > e.length - 2 ? r : r + 1, d[3] = r > e.length - 3 ? r : r + 2, h = e[d[0]], l = e[d[1]], u = e[d[2]], c = e[d[3]], o = n * n, s = n * o, f[0] = a(h[0], l[0], u[0], c[0], n, o, s), f[1] = a(h[1], l[1], u[1], c[1], n, o, s), f[2] = a(h[2], l[2], u[2], c[2], n, o, s), f
                }, a = function (e, t, i, r, n, o, a) {
                    var s = .5 * (i - e), h = .5 * (r - t);
                    return (2 * (t - i) + s + h) * a + (-3 * (t - i) - 2 * s - h) * o + s * n + t
                };
                return function (a) {
                    if (this.isPlaying !== !1 && (this.currentTime += a * this.timeScale, 0 !== this.weight)) {
                        var s = this.data.length;
                        (this.currentTime > s || this.currentTime < 0) && (this.loop ? (this.currentTime %= s, this.currentTime < 0 && (this.currentTime += s), this.reset()) : this.stop());
                        for (var h = 0, l = this.hierarchy.length; l > h; h++)for (var u = this.hierarchy[h], c = u.animationCache.animations[this.data.name], d = u.animationCache.blending, f = 0; 3 > f; f++) {
                            var p = this.keyTypes[f], m = c.prevKey[p], g = c.nextKey[p];
                            if (this.timeScale > 0 && g.time <= this.currentTime || this.timeScale < 0 && m.time >= this.currentTime) {
                                for (m = this.data.hierarchy[h].keys[0], g = this.getNextKeyWith(p, h, 1); g.time < this.currentTime && g.index > m.index;)m = g, g = this.getNextKeyWith(p, h, g.index + 1);
                                c.prevKey[p] = m, c.nextKey[p] = g
                            }
                            var v = (this.currentTime - m.time) / (g.time - m.time), y = m[p], b = g[p];
                            if (0 > v && (v = 0), v > 1 && (v = 1), "pos" === p) {
                                if (this.interpolationType === n.AnimationHandler.LINEAR) {
                                    i.x = y[0] + (b[0] - y[0]) * v, i.y = y[1] + (b[1] - y[1]) * v, i.z = y[2] + (b[2] - y[2]) * v;
                                    var w = this.weight / (this.weight + d.positionWeight);
                                    u.position.lerp(i, w), d.positionWeight += this.weight
                                } else if (this.interpolationType === n.AnimationHandler.CATMULLROM || this.interpolationType === n.AnimationHandler.CATMULLROM_FORWARD) {
                                    e[0] = this.getPrevKeyWith("pos", h, m.index - 1).pos, e[1] = y, e[2] = b, e[3] = this.getNextKeyWith("pos", h, g.index + 1).pos, v = .33 * v + .33;
                                    var _ = o(e, v), w = this.weight / (this.weight + d.positionWeight);
                                    d.positionWeight += this.weight;
                                    var x = u.position;
                                    if (x.x = x.x + (_[0] - x.x) * w, x.y = x.y + (_[1] - x.y) * w, x.z = x.z + (_[2] - x.z) * w, this.interpolationType === n.AnimationHandler.CATMULLROM_FORWARD) {
                                        var S = o(e, 1.01 * v);
                                        t.set(S[0], S[1], S[2]), t.sub(x), t.y = 0, t.normalize();
                                        var E = Math.atan2(t.x, t.z);
                                        u.rotation.set(0, E, 0)
                                    }
                                }
                            } else if ("rot" === p)if (n.Quaternion.slerp(y, b, r, v), 0 === d.quaternionWeight)u.quaternion.copy(r), d.quaternionWeight = this.weight; else {
                                var w = this.weight / (this.weight + d.quaternionWeight);
                                n.Quaternion.slerp(u.quaternion, r, u.quaternion, w), d.quaternionWeight += this.weight
                            } else if ("scl" === p) {
                                i.x = y[0] + (b[0] - y[0]) * v, i.y = y[1] + (b[1] - y[1]) * v, i.z = y[2] + (b[2] - y[2]) * v;
                                var w = this.weight / (this.weight + d.scaleWeight);
                                u.scale.lerp(i, w), d.scaleWeight += this.weight
                            }
                        }
                        return !0
                    }
                }
            }(), getNextKeyWith: function (e, t, i) {
                var r = this.data.hierarchy[t].keys;
                for (this.interpolationType === n.AnimationHandler.CATMULLROM || this.interpolationType === n.AnimationHandler.CATMULLROM_FORWARD ? i = i < r.length - 1 ? i : r.length - 1 : i %= r.length; i < r.length; i++)if (void 0 !== r[i][e])return r[i];
                return this.data.hierarchy[t].keys[0]
            }, getPrevKeyWith: function (e, t, i) {
                var r = this.data.hierarchy[t].keys;
                for (i = this.interpolationType === n.AnimationHandler.CATMULLROM || this.interpolationType === n.AnimationHandler.CATMULLROM_FORWARD ? i > 0 ? i : 0 : i >= 0 ? i : i + r.length; i >= 0; i--)if (void 0 !== r[i][e])return r[i];
                return this.data.hierarchy[t].keys[r.length - 1]
            }
        },n.KeyFrameAnimation = function (e) {
            this.root = e.node, this.data = n.AnimationHandler.init(e), this.hierarchy = n.AnimationHandler.parse(this.root), this.currentTime = 0, this.timeScale = .001, this.isPlaying = !1, this.isPaused = !0, this.loop = !0;
            for (var t = 0, i = this.hierarchy.length; i > t; t++) {
                var r = this.data.hierarchy[t].keys, o = this.data.hierarchy[t].sids, a = this.hierarchy[t];
                if (r.length && o) {
                    for (var s = 0; s < o.length; s++) {
                        var h = o[s], l = this.getNextKeyWith(h, t, 0);
                        l && l.apply(h)
                    }
                    a.matrixAutoUpdate = !1, this.data.hierarchy[t].node.updateMatrix(), a.matrixWorldNeedsUpdate = !0
                }
            }
        },n.KeyFrameAnimation.prototype = {
            constructor: n.KeyFrameAnimation, play: function (e) {
                if (this.currentTime = void 0 !== e ? e : 0, this.isPlaying === !1) {
                    this.isPlaying = !0;
                    var t, i, r, o = this.hierarchy.length;
                    for (t = 0; o > t; t++) {
                        i = this.hierarchy[t], r = this.data.hierarchy[t], void 0 === r.animationCache && (r.animationCache = {}, r.animationCache.prevKey = null, r.animationCache.nextKey = null, r.animationCache.originalMatrix = i.matrix);
                        var a = this.data.hierarchy[t].keys;
                        a.length && (r.animationCache.prevKey = a[0], r.animationCache.nextKey = a[1], this.startTime = Math.min(a[0].time, this.startTime), this.endTime = Math.max(a[a.length - 1].time, this.endTime))
                    }
                    this.update(0)
                }
                this.isPaused = !1, n.AnimationHandler.play(this)
            }, stop: function () {
                this.isPlaying = !1, this.isPaused = !1, n.AnimationHandler.stop(this);
                for (var e = 0; e < this.data.hierarchy.length; e++) {
                    var t = this.hierarchy[e], i = this.data.hierarchy[e];
                    if (void 0 !== i.animationCache) {
                        var r = i.animationCache.originalMatrix;
                        r.copy(t.matrix), t.matrix = r, delete i.animationCache
                    }
                }
            }, update: function (e) {
                if (this.isPlaying !== !1) {
                    this.currentTime += e * this.timeScale;
                    var t = this.data.length;
                    this.loop === !0 && this.currentTime > t && (this.currentTime %= t), this.currentTime = Math.min(this.currentTime, t);
                    for (var i = 0, r = this.hierarchy.length; r > i; i++) {
                        var n = this.hierarchy[i], o = this.data.hierarchy[i], a = o.keys, s = o.animationCache;
                        if (a.length) {
                            var h = s.prevKey, l = s.nextKey;
                            if (l.time <= this.currentTime) {
                                for (; l.time < this.currentTime && l.index > h.index;)h = l, l = a[h.index + 1];
                                s.prevKey = h, s.nextKey = l
                            }
                            l.time >= this.currentTime ? h.interpolate(l, this.currentTime) : h.interpolate(l, l.time), this.data.hierarchy[i].node.updateMatrix(), n.matrixWorldNeedsUpdate = !0
                        }
                    }
                }
            }, getNextKeyWith: function (e, t, i) {
                var r = this.data.hierarchy[t].keys;
                for (i %= r.length; i < r.length; i++)if (r[i].hasTarget(e))return r[i];
                return r[0]
            }, getPrevKeyWith: function (e, t, i) {
                var r = this.data.hierarchy[t].keys;
                for (i = i >= 0 ? i : i + r.length; i >= 0; i--)if (r[i].hasTarget(e))return r[i];
                return r[r.length - 1]
            }
        },n.MorphAnimation = function (e) {
            this.mesh = e, this.frames = e.morphTargetInfluences.length, this.currentTime = 0, this.duration = 1e3, this.loop = !0, this.lastFrame = 0, this.currentFrame = 0, this.isPlaying = !1
        },n.MorphAnimation.prototype = {
            constructor: n.MorphAnimation, play: function () {
                this.isPlaying = !0
            }, pause: function () {
                this.isPlaying = !1
            }, update: function (e) {
                if (this.isPlaying !== !1) {
                    this.currentTime += e, this.loop === !0 && this.currentTime > this.duration && (this.currentTime %= this.duration), this.currentTime = Math.min(this.currentTime, this.duration);
                    var t = this.duration / this.frames, i = Math.floor(this.currentTime / t), r = this.mesh.morphTargetInfluences;
                    i != this.currentFrame && (r[this.lastFrame] = 0, r[this.currentFrame] = 1, r[i] = 0, this.lastFrame = this.currentFrame, this.currentFrame = i), r[i] = this.currentTime % t / t, r[this.lastFrame] = 1 - r[i]
                }
            }
        },n.BoxGeometry = function (e, t, i, r, o, a) {
            function s(e, t, i, r, o, a, s, l) {
                var u, c, d, f = h.widthSegments, p = h.heightSegments, m = o / 2, g = a / 2, v = h.vertices.length;
                "x" === e && "y" === t || "y" === e && "x" === t ? u = "z" : "x" === e && "z" === t || "z" === e && "x" === t ? (u = "y", p = h.depthSegments) : ("z" === e && "y" === t || "y" === e && "z" === t) && (u = "x", f = h.depthSegments);
                var y = f + 1, b = p + 1, w = o / f, _ = a / p, x = new n.Vector3;
                for (x[u] = s > 0 ? 1 : -1, d = 0; b > d; d++)for (c = 0; y > c; c++) {
                    var S = new n.Vector3;
                    S[e] = (c * w - m) * i, S[t] = (d * _ - g) * r, S[u] = s, h.vertices.push(S)
                }
                for (d = 0; p > d; d++)for (c = 0; f > c; c++) {
                    var E = c + y * d, M = c + y * (d + 1), A = c + 1 + y * (d + 1), T = c + 1 + y * d, C = new n.Vector2(c / f, 1 - d / p), P = new n.Vector2(c / f, 1 - (d + 1) / p), L = new n.Vector2((c + 1) / f, 1 - (d + 1) / p), k = new n.Vector2((c + 1) / f, 1 - d / p), B = new n.Face3(E + v, M + v, T + v);
                    B.normal.copy(x), B.vertexNormals.push(x.clone(), x.clone(), x.clone()), B.materialIndex = l, h.faces.push(B), h.faceVertexUvs[0].push([C, P, k]), B = new n.Face3(M + v, A + v, T + v), B.normal.copy(x), B.vertexNormals.push(x.clone(), x.clone(), x.clone()), B.materialIndex = l, h.faces.push(B), h.faceVertexUvs[0].push([P.clone(), L, k.clone()])
                }
            }

            n.Geometry.call(this), this.type = "BoxGeometry", this.parameters = {
                width: e,
                height: t,
                depth: i,
                widthSegments: r,
                heightSegments: o,
                depthSegments: a
            }, this.widthSegments = r || 1, this.heightSegments = o || 1, this.depthSegments = a || 1;
            var h = this, l = e / 2, u = t / 2, c = i / 2;
            s("z", "y", -1, -1, i, t, l, 0), s("z", "y", 1, -1, i, t, -l, 1), s("x", "z", 1, 1, e, i, u, 2), s("x", "z", 1, -1, e, i, -u, 3), s("x", "y", 1, -1, e, t, c, 4), s("x", "y", -1, -1, e, t, -c, 5), this.mergeVertices()
        },n.BoxGeometry.prototype = Object.create(n.Geometry.prototype),n.BoxGeometry.prototype.constructor = n.BoxGeometry,n.CircleGeometry = function (e, t, i, r) {
            n.Geometry.call(this), this.type = "CircleGeometry", this.parameters = {
                radius: e,
                segments: t,
                thetaStart: i,
                thetaLength: r
            }, e = e || 50, t = void 0 !== t ? Math.max(3, t) : 8, i = void 0 !== i ? i : 0, r = void 0 !== r ? r : 2 * Math.PI;
            var o, a = [], s = new n.Vector3, h = new n.Vector2(.5, .5);
            for (this.vertices.push(s), a.push(h), o = 0; t >= o; o++) {
                var l = new n.Vector3, u = i + o / t * r;
                l.x = e * Math.cos(u), l.y = e * Math.sin(u), this.vertices.push(l), a.push(new n.Vector2((l.x / e + 1) / 2, (l.y / e + 1) / 2))
            }
            var c = new n.Vector3(0, 0, 1);
            for (o = 1; t >= o; o++)this.faces.push(new n.Face3(o, o + 1, 0, [c.clone(), c.clone(), c.clone()])), this.faceVertexUvs[0].push([a[o].clone(), a[o + 1].clone(), h.clone()]);
            this.computeFaceNormals(), this.boundingSphere = new n.Sphere(new n.Vector3, e)
        },n.CircleGeometry.prototype = Object.create(n.Geometry.prototype),n.CircleGeometry.prototype.constructor = n.CircleGeometry,n.CubeGeometry = function (e, t, i, r, o, a) {
            return n.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."), new n.BoxGeometry(e, t, i, r, o, a)
        },n.CylinderGeometry = function (e, t, i, r, o, a, s, h) {
            n.Geometry.call(this), this.type = "CylinderGeometry", this.parameters = {
                radiusTop: e,
                radiusBottom: t,
                height: i,
                radialSegments: r,
                heightSegments: o,
                openEnded: a,
                thetaStart: s,
                thetaLength: h
            }, e = void 0 !== e ? e : 20, t = void 0 !== t ? t : 20, i = void 0 !== i ? i : 100, r = r || 8, o = o || 1, a = void 0 !== a ? a : !1, s = void 0 !== s ? s : 0, h = void 0 !== h ? h : 2 * Math.PI;
            var l, u, c = i / 2, d = [], f = [];
            for (u = 0; o >= u; u++) {
                var p = [], m = [], g = u / o, v = g * (t - e) + e;
                for (l = 0; r >= l; l++) {
                    var y = l / r, b = new n.Vector3;
                    b.x = v * Math.sin(y * h + s), b.y = -g * i + c, b.z = v * Math.cos(y * h + s), this.vertices.push(b), p.push(this.vertices.length - 1), m.push(new n.Vector2(y, 1 - g))
                }
                d.push(p), f.push(m)
            }
            var w, _, x = (t - e) / i;
            for (l = 0; r > l; l++)for (0 !== e ? (w = this.vertices[d[0][l]].clone(), _ = this.vertices[d[0][l + 1]].clone()) : (w = this.vertices[d[1][l]].clone(), _ = this.vertices[d[1][l + 1]].clone()), w.setY(Math.sqrt(w.x * w.x + w.z * w.z) * x).normalize(), _.setY(Math.sqrt(_.x * _.x + _.z * _.z) * x).normalize(), u = 0; o > u; u++) {
                var S = d[u][l], E = d[u + 1][l], M = d[u + 1][l + 1], A = d[u][l + 1], T = w.clone(), C = w.clone(), P = _.clone(), L = _.clone(), k = f[u][l].clone(), B = f[u + 1][l].clone(), R = f[u + 1][l + 1].clone(), I = f[u][l + 1].clone();
                this.faces.push(new n.Face3(S, E, A, [T, C, L])), this.faceVertexUvs[0].push([k, B, I]), this.faces.push(new n.Face3(E, M, A, [C.clone(), P, L.clone()])), this.faceVertexUvs[0].push([B.clone(), R, I.clone()])
            }
            if (a === !1 && e > 0)for (this.vertices.push(new n.Vector3(0, c, 0)), l = 0; r > l; l++) {
                var S = d[0][l], E = d[0][l + 1], M = this.vertices.length - 1, T = new n.Vector3(0, 1, 0), C = new n.Vector3(0, 1, 0), P = new n.Vector3(0, 1, 0), k = f[0][l].clone(), B = f[0][l + 1].clone(), R = new n.Vector2(B.x, 0);
                this.faces.push(new n.Face3(S, E, M, [T, C, P])), this.faceVertexUvs[0].push([k, B, R])
            }
            if (a === !1 && t > 0)for (this.vertices.push(new n.Vector3(0, -c, 0)), l = 0; r > l; l++) {
                var S = d[o][l + 1], E = d[o][l], M = this.vertices.length - 1, T = new n.Vector3(0, -1, 0), C = new n.Vector3(0, -1, 0), P = new n.Vector3(0, -1, 0), k = f[o][l + 1].clone(), B = f[o][l].clone(), R = new n.Vector2(B.x, 1);
                this.faces.push(new n.Face3(S, E, M, [T, C, P])), this.faceVertexUvs[0].push([k, B, R])
            }
            this.computeFaceNormals()
        },n.CylinderGeometry.prototype = Object.create(n.Geometry.prototype),n.CylinderGeometry.prototype.constructor = n.CylinderGeometry,n.ExtrudeGeometry = function (e, t) {
            return "undefined" == typeof e ? void(e = []) : (n.Geometry.call(this), this.type = "ExtrudeGeometry", e = e instanceof Array ? e : [e], this.addShapeList(e, t), void this.computeFaceNormals())
        },n.ExtrudeGeometry.prototype = Object.create(n.Geometry.prototype),n.ExtrudeGeometry.prototype.constructor = n.ExtrudeGeometry,n.ExtrudeGeometry.prototype.addShapeList = function (e, t) {
            for (var i = e.length, r = 0; i > r; r++) {
                var n = e[r];
                this.addShape(n, t)
            }
        },n.ExtrudeGeometry.prototype.addShape = function (e, t) {
            function i(e, t, i) {
                return t || n.error("THREE.ExtrudeGeometry: vec does not exist"), t.clone().multiplyScalar(i).add(e)
            }

            function r(e, t, i) {
                var r, o, a = 1e-10, s = 1, h = e.x - t.x, l = e.y - t.y, u = i.x - e.x, c = i.y - e.y, d = h * h + l * l, f = h * c - l * u;
                if (Math.abs(f) > a) {
                    var p = Math.sqrt(d), m = Math.sqrt(u * u + c * c), g = t.x - l / p, v = t.y + h / p, y = i.x - c / m, b = i.y + u / m, w = ((y - g) * c - (b - v) * u) / (h * c - l * u);
                    r = g + h * w - e.x, o = v + l * w - e.y;
                    var _ = r * r + o * o;
                    if (2 >= _)return new n.Vector2(r, o);
                    s = Math.sqrt(_ / 2)
                } else {
                    var x = !1;
                    h > a ? u > a && (x = !0) : -a > h ? -a > u && (x = !0) : Math.sign(l) == Math.sign(c) && (x = !0), x ? (r = -l, o = h, s = Math.sqrt(d)) : (r = h, o = l, s = Math.sqrt(d / 2))
                }
                return new n.Vector2(r / s, o / s)
            }

            function o() {
                if (w) {
                    var e = 0, t = j * e;
                    for (X = 0; Y > X; X++)G = O[X], l(G[2] + t, G[1] + t, G[0] + t);
                    for (e = x + 2 * b, t = j * e, X = 0; Y > X; X++)G = O[X], l(G[0] + t, G[1] + t, G[2] + t)
                } else {
                    for (X = 0; Y > X; X++)G = O[X], l(G[2], G[1], G[0]);
                    for (X = 0; Y > X; X++)G = O[X], l(G[0] + j * x, G[1] + j * x, G[2] + j * x)
                }
            }

            function a() {
                var e = 0;
                for (s(N, e), e += N.length, P = 0, L = F.length; L > P; P++)C = F[P], s(C, e), e += C.length
            }

            function s(e, t) {
                var i, r;
                for (X = e.length; --X >= 0;) {
                    i = X, r = X - 1, 0 > r && (r = e.length - 1);
                    var n = 0, o = x + 2 * b;
                    for (n = 0; o > n; n++) {
                        var a = j * n, s = j * (n + 1), h = t + i + a, l = t + r + a, c = t + r + s, d = t + i + s;
                        u(h, l, c, d, e, n, o, i, r)
                    }
                }
            }

            function h(e, t, i) {
                k.vertices.push(new n.Vector3(e, t, i))
            }

            function l(e, t, i) {
                e += B, t += B, i += B, k.faces.push(new n.Face3(e, t, i, null, null, M));
                var r = T.generateTopUV(k, e, t, i);
                k.faceVertexUvs[0].push(r)
            }

            function u(e, t, i, r, o, a, s, h, l) {
                e += B, t += B, i += B, r += B, k.faces.push(new n.Face3(e, t, r, null, null, A)), k.faces.push(new n.Face3(t, i, r, null, null, A));
                var u = T.generateSideWallUV(k, e, t, i, r);
                k.faceVertexUvs[0].push([u[0], u[1], u[3]]), k.faceVertexUvs[0].push([u[1], u[2], u[3]])
            }

            var c, d, f, p, m, g = void 0 !== t.amount ? t.amount : 100, v = void 0 !== t.bevelThickness ? t.bevelThickness : 6, y = void 0 !== t.bevelSize ? t.bevelSize : v - 2, b = void 0 !== t.bevelSegments ? t.bevelSegments : 3, w = void 0 !== t.bevelEnabled ? t.bevelEnabled : !0, _ = void 0 !== t.curveSegments ? t.curveSegments : 12, x = void 0 !== t.steps ? t.steps : 1, S = t.extrudePath, E = !1, M = t.material, A = t.extrudeMaterial, T = void 0 !== t.UVGenerator ? t.UVGenerator : n.ExtrudeGeometry.WorldUVGenerator;
            S && (c = S.getSpacedPoints(x), E = !0, w = !1, d = void 0 !== t.frames ? t.frames : new n.TubeGeometry.FrenetFrames(S, x, !1), f = new n.Vector3, p = new n.Vector3, m = new n.Vector3), w || (b = 0, v = 0, y = 0);
            var C, P, L, k = this, B = this.vertices.length, R = e.extractPoints(_), I = R.shape, F = R.holes, D = !n.Shape.Utils.isClockWise(I);
            if (D) {
                for (I = I.reverse(), P = 0, L = F.length; L > P; P++)C = F[P], n.Shape.Utils.isClockWise(C) && (F[P] = C.reverse());
                D = !1
            }
            var O = n.Shape.Utils.triangulateShape(I, F), N = I;
            for (P = 0, L = F.length; L > P; P++)C = F[P], I = I.concat(C);
            for (var U, z, V, W, H, G, j = I.length, Y = O.length, Z = [], X = 0, q = N.length, K = q - 1, Q = X + 1; q > X; X++, K++, Q++)K === q && (K = 0), Q === q && (Q = 0), Z[X] = r(N[X], N[K], N[Q]);
            var J, $ = [], ee = Z.concat();
            for (P = 0, L = F.length; L > P; P++) {
                for (C = F[P], J = [], X = 0, q = C.length, K = q - 1, Q = X + 1; q > X; X++, K++, Q++)K === q && (K = 0), Q === q && (Q = 0), J[X] = r(C[X], C[K], C[Q]);
                $.push(J), ee = ee.concat(J)
            }
            for (U = 0; b > U; U++) {
                for (V = U / b, W = v * (1 - V), z = y * Math.sin(V * Math.PI / 2), X = 0, q = N.length; q > X; X++)H = i(N[X], Z[X], z), h(H.x, H.y, -W);
                for (P = 0, L = F.length; L > P; P++)for (C = F[P], J = $[P], X = 0, q = C.length; q > X; X++)H = i(C[X], J[X], z), h(H.x, H.y, -W)
            }
            for (z = y, X = 0; j > X; X++)H = w ? i(I[X], ee[X], z) : I[X], E ? (p.copy(d.normals[0]).multiplyScalar(H.x), f.copy(d.binormals[0]).multiplyScalar(H.y), m.copy(c[0]).add(p).add(f), h(m.x, m.y, m.z)) : h(H.x, H.y, 0);
            var te;
            for (te = 1; x >= te; te++)for (X = 0; j > X; X++)H = w ? i(I[X], ee[X], z) : I[X], E ? (p.copy(d.normals[te]).multiplyScalar(H.x), f.copy(d.binormals[te]).multiplyScalar(H.y), m.copy(c[te]).add(p).add(f), h(m.x, m.y, m.z)) : h(H.x, H.y, g / x * te);
            for (U = b - 1; U >= 0; U--) {
                for (V = U / b, W = v * (1 - V), z = y * Math.sin(V * Math.PI / 2), X = 0, q = N.length; q > X; X++)H = i(N[X], Z[X], z), h(H.x, H.y, g + W);
                for (P = 0, L = F.length; L > P; P++)for (C = F[P], J = $[P], X = 0, q = C.length; q > X; X++)H = i(C[X], J[X], z), E ? h(H.x, H.y + c[x - 1].y, c[x - 1].x + W) : h(H.x, H.y, g + W)
            }
            o(), a()
        },n.ExtrudeGeometry.WorldUVGenerator = {
            generateTopUV: function (e, t, i, r) {
                var o = e.vertices, a = o[t], s = o[i], h = o[r];
                return [new n.Vector2(a.x, a.y), new n.Vector2(s.x, s.y), new n.Vector2(h.x, h.y)]
            }, generateSideWallUV: function (e, t, i, r, o) {
                var a = e.vertices, s = a[t], h = a[i], l = a[r], u = a[o];
                return Math.abs(s.y - h.y) < .01 ? [new n.Vector2(s.x, 1 - s.z), new n.Vector2(h.x, 1 - h.z), new n.Vector2(l.x, 1 - l.z), new n.Vector2(u.x, 1 - u.z)] : [new n.Vector2(s.y, 1 - s.z), new n.Vector2(h.y, 1 - h.z), new n.Vector2(l.y, 1 - l.z), new n.Vector2(u.y, 1 - u.z)]
            }
        },n.ShapeGeometry = function (e, t) {
            n.Geometry.call(this), this.type = "ShapeGeometry", e instanceof Array == !1 && (e = [e]), this.addShapeList(e, t), this.computeFaceNormals()
        },n.ShapeGeometry.prototype = Object.create(n.Geometry.prototype),n.ShapeGeometry.prototype.constructor = n.ShapeGeometry,n.ShapeGeometry.prototype.addShapeList = function (e, t) {
            for (var i = 0, r = e.length; r > i; i++)this.addShape(e[i], t);
            return this
        },n.ShapeGeometry.prototype.addShape = function (e, t) {
            void 0 === t && (t = {});
            var i, r, o, a = void 0 !== t.curveSegments ? t.curveSegments : 12, s = t.material, h = void 0 === t.UVGenerator ? n.ExtrudeGeometry.WorldUVGenerator : t.UVGenerator, l = this.vertices.length, u = e.extractPoints(a), c = u.shape, d = u.holes, f = !n.Shape.Utils.isClockWise(c);
            if (f) {
                for (c = c.reverse(), i = 0, r = d.length; r > i; i++)o = d[i], n.Shape.Utils.isClockWise(o) && (d[i] = o.reverse());
                f = !1
            }
            var p = n.Shape.Utils.triangulateShape(c, d);
            for (i = 0, r = d.length; r > i; i++)o = d[i], c = c.concat(o);
            var m, g, v = c.length, y = p.length;
            for (i = 0; v > i; i++)m = c[i], this.vertices.push(new n.Vector3(m.x, m.y, 0));
            for (i = 0; y > i; i++) {
                g = p[i];
                var b = g[0] + l, w = g[1] + l, _ = g[2] + l;
                this.faces.push(new n.Face3(b, w, _, null, null, s)), this.faceVertexUvs[0].push(h.generateTopUV(this, b, w, _))
            }
        },n.LatheGeometry = function (e, t, i, r) {
            n.Geometry.call(this), this.type = "LatheGeometry", this.parameters = {
                points: e,
                segments: t,
                phiStart: i,
                phiLength: r
            }, t = t || 12, i = i || 0, r = r || 2 * Math.PI;
            for (var o = 1 / (e.length - 1), a = 1 / t, s = 0, h = t; h >= s; s++)for (var l = i + s * a * r, u = Math.cos(l), c = Math.sin(l), d = 0, f = e.length; f > d; d++) {
                var p = e[d], m = new n.Vector3;
                m.x = u * p.x - c * p.y, m.y = c * p.x + u * p.y, m.z = p.z, this.vertices.push(m)
            }
            for (var g = e.length, s = 0, h = t; h > s; s++)for (var d = 0, f = e.length - 1; f > d; d++) {
                var v = d + g * s, y = v, b = v + g, u = v + 1 + g, w = v + 1, _ = s * a, x = d * o, S = _ + a, E = x + o;
                this.faces.push(new n.Face3(y, b, w)), this.faceVertexUvs[0].push([new n.Vector2(_, x), new n.Vector2(S, x), new n.Vector2(_, E)]), this.faces.push(new n.Face3(b, u, w)), this.faceVertexUvs[0].push([new n.Vector2(S, x), new n.Vector2(S, E), new n.Vector2(_, E)])
            }
            this.mergeVertices(), this.computeFaceNormals(), this.computeVertexNormals()
        },n.LatheGeometry.prototype = Object.create(n.Geometry.prototype),n.LatheGeometry.prototype.constructor = n.LatheGeometry,n.PlaneGeometry = function (e, t, i, r) {
            console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."), n.Geometry.call(this), this.type = "PlaneGeometry", this.parameters = {
                width: e,
                height: t,
                widthSegments: i,
                heightSegments: r
            }, this.fromBufferGeometry(new n.PlaneBufferGeometry(e, t, i, r))
        },n.PlaneGeometry.prototype = Object.create(n.Geometry.prototype),n.PlaneGeometry.prototype.constructor = n.PlaneGeometry,n.PlaneBufferGeometry = function (e, t, i, r) {
            n.BufferGeometry.call(this), this.type = "PlaneBufferGeometry", this.parameters = {
                width: e,
                height: t,
                widthSegments: i,
                heightSegments: r
            };
            for (var o = e / 2, a = t / 2, s = i || 1, h = r || 1, l = s + 1, u = h + 1, c = e / s, d = t / h, f = new Float32Array(l * u * 3), p = new Float32Array(l * u * 3), m = new Float32Array(l * u * 2), g = 0, v = 0, y = 0; u > y; y++)for (var b = y * d - a, w = 0; l > w; w++) {
                var _ = w * c - o;
                f[g] = _, f[g + 1] = -b, p[g + 2] = 1, m[v] = w / s, m[v + 1] = 1 - y / h, g += 3, v += 2
            }
            g = 0;
            for (var x = new (f.length / 3 > 65535 ? Uint32Array : Uint16Array)(s * h * 6), y = 0; h > y; y++)for (var w = 0; s > w; w++) {
                var S = w + l * y, E = w + l * (y + 1), M = w + 1 + l * (y + 1), A = w + 1 + l * y;
                x[g] = S, x[g + 1] = E, x[g + 2] = A, x[g + 3] = E, x[g + 4] = M, x[g + 5] = A, g += 6
            }
            this.addAttribute("index", new n.BufferAttribute(x, 1)), this.addAttribute("position", new n.BufferAttribute(f, 3)), this.addAttribute("normal", new n.BufferAttribute(p, 3)), this.addAttribute("uv", new n.BufferAttribute(m, 2))
        },n.PlaneBufferGeometry.prototype = Object.create(n.BufferGeometry.prototype),n.PlaneBufferGeometry.prototype.constructor = n.PlaneBufferGeometry,n.RingGeometry = function (e, t, i, r, o, a) {
            n.Geometry.call(this), this.type = "RingGeometry", this.parameters = {
                innerRadius: e,
                outerRadius: t,
                thetaSegments: i,
                phiSegments: r,
                thetaStart: o,
                thetaLength: a
            }, e = e || 0, t = t || 50, o = void 0 !== o ? o : 0, a = void 0 !== a ? a : 2 * Math.PI, i = void 0 !== i ? Math.max(3, i) : 8, r = void 0 !== r ? Math.max(1, r) : 8;
            var s, h, l = [], u = e, c = (t - e) / r;
            for (s = 0; r + 1 > s; s++) {
                for (h = 0; i + 1 > h; h++) {
                    var d = new n.Vector3, f = o + h / i * a;
                    d.x = u * Math.cos(f), d.y = u * Math.sin(f), this.vertices.push(d), l.push(new n.Vector2((d.x / t + 1) / 2, (d.y / t + 1) / 2))
                }
                u += c
            }
            var p = new n.Vector3(0, 0, 1);
            for (s = 0; r > s; s++) {
                var m = s * (i + 1);
                for (h = 0; i > h; h++) {
                    var f = h + m, g = f, v = f + i + 1, y = f + i + 2;
                    this.faces.push(new n.Face3(g, v, y, [p.clone(), p.clone(), p.clone()])), this.faceVertexUvs[0].push([l[g].clone(), l[v].clone(), l[y].clone()]), g = f, v = f + i + 2, y = f + 1, this.faces.push(new n.Face3(g, v, y, [p.clone(), p.clone(), p.clone()])), this.faceVertexUvs[0].push([l[g].clone(), l[v].clone(), l[y].clone()])
                }
            }
            this.computeFaceNormals(), this.boundingSphere = new n.Sphere(new n.Vector3, u)
        },n.RingGeometry.prototype = Object.create(n.Geometry.prototype),n.RingGeometry.prototype.constructor = n.RingGeometry,n.SphereGeometry = function (e, t, i, r, o, a, s) {
            n.Geometry.call(this), this.type = "SphereGeometry", this.parameters = {
                radius: e,
                widthSegments: t,
                heightSegments: i,
                phiStart: r,
                phiLength: o,
                thetaStart: a,
                thetaLength: s
            }, e = e || 50, t = Math.max(3, Math.floor(t) || 8), i = Math.max(2, Math.floor(i) || 6), r = void 0 !== r ? r : 0, o = void 0 !== o ? o : 2 * Math.PI, a = void 0 !== a ? a : 0, s = void 0 !== s ? s : Math.PI;
            var h, l, u = [], c = [];
            for (l = 0; i >= l; l++) {
                var d = [], f = [];
                for (h = 0; t >= h; h++) {
                    var p = h / t, m = l / i, g = new n.Vector3;
                    g.x = -e * Math.cos(r + p * o) * Math.sin(a + m * s), g.y = e * Math.cos(a + m * s), g.z = e * Math.sin(r + p * o) * Math.sin(a + m * s), this.vertices.push(g), d.push(this.vertices.length - 1), f.push(new n.Vector2(p, 1 - m))
                }
                u.push(d), c.push(f)
            }
            for (l = 0; i > l; l++)for (h = 0; t > h; h++) {
                var v = u[l][h + 1], y = u[l][h], b = u[l + 1][h], w = u[l + 1][h + 1], _ = this.vertices[v].clone().normalize(), x = this.vertices[y].clone().normalize(), S = this.vertices[b].clone().normalize(), E = this.vertices[w].clone().normalize(), M = c[l][h + 1].clone(), A = c[l][h].clone(), T = c[l + 1][h].clone(), C = c[l + 1][h + 1].clone();
                Math.abs(this.vertices[v].y) === e ? (M.x = (M.x + A.x) / 2, this.faces.push(new n.Face3(v, b, w, [_, S, E])), this.faceVertexUvs[0].push([M, T, C])) : Math.abs(this.vertices[b].y) === e ? (T.x = (T.x + C.x) / 2, this.faces.push(new n.Face3(v, y, b, [_, x, S])), this.faceVertexUvs[0].push([M, A, T])) : (this.faces.push(new n.Face3(v, y, w, [_, x, E])), this.faceVertexUvs[0].push([M, A, C]), this.faces.push(new n.Face3(y, b, w, [x.clone(), S, E.clone()])), this.faceVertexUvs[0].push([A.clone(), T, C.clone()]))
            }
            this.computeFaceNormals(), this.boundingSphere = new n.Sphere(new n.Vector3, e)
        },n.SphereGeometry.prototype = Object.create(n.Geometry.prototype),n.SphereGeometry.prototype.constructor = n.SphereGeometry,n.TextGeometry = function (e, t) {
            t = t || {};
            var i = n.FontUtils.generateShapes(e, t);
            t.amount = void 0 !== t.height ? t.height : 50, void 0 === t.bevelThickness && (t.bevelThickness = 10), void 0 === t.bevelSize && (t.bevelSize = 8), void 0 === t.bevelEnabled && (t.bevelEnabled = !1), n.ExtrudeGeometry.call(this, i, t), this.type = "TextGeometry"
        },n.TextGeometry.prototype = Object.create(n.ExtrudeGeometry.prototype),n.TextGeometry.prototype.constructor = n.TextGeometry,n.TorusGeometry = function (e, t, i, r, o) {
            n.Geometry.call(this), this.type = "TorusGeometry", this.parameters = {
                radius: e,
                tube: t,
                radialSegments: i,
                tubularSegments: r,
                arc: o
            }, e = e || 100, t = t || 40, i = i || 8, r = r || 6, o = o || 2 * Math.PI;
            for (var a = new n.Vector3, s = [], h = [], l = 0; i >= l; l++)for (var u = 0; r >= u; u++) {
                var c = u / r * o, d = l / i * Math.PI * 2;
                a.x = e * Math.cos(c), a.y = e * Math.sin(c);
                var f = new n.Vector3;
                f.x = (e + t * Math.cos(d)) * Math.cos(c), f.y = (e + t * Math.cos(d)) * Math.sin(c), f.z = t * Math.sin(d), this.vertices.push(f), s.push(new n.Vector2(u / r, l / i)), h.push(f.clone().sub(a).normalize())
            }
            for (var l = 1; i >= l; l++)for (var u = 1; r >= u; u++) {
                var p = (r + 1) * l + u - 1, m = (r + 1) * (l - 1) + u - 1, g = (r + 1) * (l - 1) + u, v = (r + 1) * l + u, y = new n.Face3(p, m, v, [h[p].clone(), h[m].clone(), h[v].clone()]);
                this.faces.push(y), this.faceVertexUvs[0].push([s[p].clone(), s[m].clone(), s[v].clone()]), y = new n.Face3(m, g, v, [h[m].clone(), h[g].clone(), h[v].clone()]), this.faces.push(y), this.faceVertexUvs[0].push([s[m].clone(), s[g].clone(), s[v].clone()])
            }
            this.computeFaceNormals()
        },n.TorusGeometry.prototype = Object.create(n.Geometry.prototype),n.TorusGeometry.prototype.constructor = n.TorusGeometry,n.TorusKnotGeometry = function (e, t, i, r, o, a, s) {
            function h(e, t, i, r, o) {
                var a = Math.cos(e), s = Math.sin(e), h = t / i * e, l = Math.cos(h), u = r * (2 + l) * .5 * a, c = r * (2 + l) * s * .5, d = o * r * Math.sin(h) * .5;
                return new n.Vector3(u, c, d)
            }

            n.Geometry.call(this), this.type = "TorusKnotGeometry", this.parameters = {
                radius: e, tube: t, radialSegments: i,
                tubularSegments: r, p: o, q: a, heightScale: s
            }, e = e || 100, t = t || 40, i = i || 64, r = r || 8, o = o || 2, a = a || 3, s = s || 1;
            for (var l = new Array(i), u = new n.Vector3, c = new n.Vector3, d = new n.Vector3, f = 0; i > f; ++f) {
                l[f] = new Array(r);
                var p = f / i * 2 * o * Math.PI, m = h(p, a, o, e, s), g = h(p + .01, a, o, e, s);
                u.subVectors(g, m), c.addVectors(g, m), d.crossVectors(u, c), c.crossVectors(d, u), d.normalize(), c.normalize();
                for (var v = 0; r > v; ++v) {
                    var y = v / r * 2 * Math.PI, b = -t * Math.cos(y), w = t * Math.sin(y), _ = new n.Vector3;
                    _.x = m.x + b * c.x + w * d.x, _.y = m.y + b * c.y + w * d.y, _.z = m.z + b * c.z + w * d.z, l[f][v] = this.vertices.push(_) - 1
                }
            }
            for (var f = 0; i > f; ++f)for (var v = 0; r > v; ++v) {
                var x = (f + 1) % i, S = (v + 1) % r, E = l[f][v], M = l[x][v], A = l[x][S], T = l[f][S], C = new n.Vector2(f / i, v / r), P = new n.Vector2((f + 1) / i, v / r), L = new n.Vector2((f + 1) / i, (v + 1) / r), k = new n.Vector2(f / i, (v + 1) / r);
                this.faces.push(new n.Face3(E, M, T)), this.faceVertexUvs[0].push([C, P, k]), this.faces.push(new n.Face3(M, A, T)), this.faceVertexUvs[0].push([P.clone(), L, k.clone()])
            }
            this.computeFaceNormals(), this.computeVertexNormals()
        },n.TorusKnotGeometry.prototype = Object.create(n.Geometry.prototype),n.TorusKnotGeometry.prototype.constructor = n.TorusKnotGeometry,n.TubeGeometry = function (e, t, i, r, o, a) {
            function s(e, t, i) {
                return L.vertices.push(new n.Vector3(e, t, i)) - 1
            }

            n.Geometry.call(this), this.type = "TubeGeometry", this.parameters = {
                path: e,
                segments: t,
                radius: i,
                radialSegments: r,
                closed: o
            }, t = t || 64, i = i || 1, r = r || 8, o = o || !1, a = a || n.TubeGeometry.NoTaper;
            var h, l, u, c, d, f, p, m, g, v, y, b, w, _, x, S, E, M, A, T, C, P = [], L = this, k = t + 1, B = new n.Vector3, R = new n.TubeGeometry.FrenetFrames(e, t, o), I = R.tangents, F = R.normals, D = R.binormals;
            for (this.tangents = I, this.normals = F, this.binormals = D, v = 0; k > v; v++)for (P[v] = [], c = v / (k - 1), g = e.getPointAt(c), h = I[v], l = F[v], u = D[v], f = i * a(c), y = 0; r > y; y++)d = y / r * 2 * Math.PI, p = -f * Math.cos(d), m = f * Math.sin(d), B.copy(g), B.x += p * l.x + m * u.x, B.y += p * l.y + m * u.y, B.z += p * l.z + m * u.z, P[v][y] = s(B.x, B.y, B.z);
            for (v = 0; t > v; v++)for (y = 0; r > y; y++)b = o ? (v + 1) % t : v + 1, w = (y + 1) % r, _ = P[v][y], x = P[b][y], S = P[b][w], E = P[v][w], M = new n.Vector2(v / t, y / r), A = new n.Vector2((v + 1) / t, y / r), T = new n.Vector2((v + 1) / t, (y + 1) / r), C = new n.Vector2(v / t, (y + 1) / r), this.faces.push(new n.Face3(_, x, E)), this.faceVertexUvs[0].push([M, A, C]), this.faces.push(new n.Face3(x, S, E)), this.faceVertexUvs[0].push([A.clone(), T, C.clone()]);
            this.computeFaceNormals(), this.computeVertexNormals()
        },n.TubeGeometry.prototype = Object.create(n.Geometry.prototype),n.TubeGeometry.prototype.constructor = n.TubeGeometry,n.TubeGeometry.NoTaper = function (e) {
            return 1
        },n.TubeGeometry.SinusoidalTaper = function (e) {
            return Math.sin(Math.PI * e)
        },n.TubeGeometry.FrenetFrames = function (e, t, i) {
            function r() {
                p[0] = new n.Vector3, m[0] = new n.Vector3, a = Number.MAX_VALUE, s = Math.abs(f[0].x), h = Math.abs(f[0].y), l = Math.abs(f[0].z), a >= s && (a = s, d.set(1, 0, 0)), a >= h && (a = h, d.set(0, 1, 0)), a >= l && d.set(0, 0, 1), g.crossVectors(f[0], d).normalize(), p[0].crossVectors(f[0], g), m[0].crossVectors(f[0], p[0])
            }

            var o, a, s, h, l, u, c, d = new n.Vector3, f = [], p = [], m = [], g = new n.Vector3, v = new n.Matrix4, y = t + 1, b = 1e-4;
            for (this.tangents = f, this.normals = p, this.binormals = m, u = 0; y > u; u++)c = u / (y - 1), f[u] = e.getTangentAt(c), f[u].normalize();
            for (r(), u = 1; y > u; u++)p[u] = p[u - 1].clone(), m[u] = m[u - 1].clone(), g.crossVectors(f[u - 1], f[u]), g.length() > b && (g.normalize(), o = Math.acos(n.Math.clamp(f[u - 1].dot(f[u]), -1, 1)), p[u].applyMatrix4(v.makeRotationAxis(g, o))), m[u].crossVectors(f[u], p[u]);
            if (i)for (o = Math.acos(n.Math.clamp(p[0].dot(p[y - 1]), -1, 1)), o /= y - 1, f[0].dot(g.crossVectors(p[0], p[y - 1])) > 0 && (o = -o), u = 1; y > u; u++)p[u].applyMatrix4(v.makeRotationAxis(f[u], o * u)), m[u].crossVectors(f[u], p[u])
        },n.PolyhedronGeometry = function (e, t, i, r) {
            function o(e) {
                var t = e.normalize().clone();
                t.index = c.vertices.push(t) - 1;
                var i = h(e) / 2 / Math.PI + .5, r = l(e) / Math.PI + .5;
                return t.uv = new n.Vector2(i, 1 - r), t
            }

            function a(e, t, i) {
                var r = new n.Face3(e.index, t.index, i.index, [e.clone(), t.clone(), i.clone()]);
                c.faces.push(r), w.copy(e).add(t).add(i).divideScalar(3);
                var o = h(w);
                c.faceVertexUvs[0].push([u(e.uv, e, o), u(t.uv, t, o), u(i.uv, i, o)])
            }

            function s(e, t) {
                for (var i = Math.pow(2, t), r = o(c.vertices[e.a]), n = o(c.vertices[e.b]), s = o(c.vertices[e.c]), h = [], l = 0; i >= l; l++) {
                    h[l] = [];
                    for (var u = o(r.clone().lerp(s, l / i)), d = o(n.clone().lerp(s, l / i)), f = i - l, p = 0; f >= p; p++)0 == p && l == i ? h[l][p] = u : h[l][p] = o(u.clone().lerp(d, p / f))
                }
                for (var l = 0; i > l; l++)for (var p = 0; 2 * (i - l) - 1 > p; p++) {
                    var m = Math.floor(p / 2);
                    p % 2 == 0 ? a(h[l][m + 1], h[l + 1][m], h[l][m]) : a(h[l][m + 1], h[l + 1][m + 1], h[l + 1][m])
                }
            }

            function h(e) {
                return Math.atan2(e.z, -e.x)
            }

            function l(e) {
                return Math.atan2(-e.y, Math.sqrt(e.x * e.x + e.z * e.z))
            }

            function u(e, t, i) {
                return 0 > i && 1 === e.x && (e = new n.Vector2(e.x - 1, e.y)), 0 === t.x && 0 === t.z && (e = new n.Vector2(i / 2 / Math.PI + .5, e.y)), e.clone()
            }

            n.Geometry.call(this), this.type = "PolyhedronGeometry", this.parameters = {
                vertices: e,
                indices: t,
                radius: i,
                detail: r
            }, i = i || 1, r = r || 0;
            for (var c = this, d = 0, f = e.length; f > d; d += 3)o(new n.Vector3(e[d], e[d + 1], e[d + 2]));
            for (var p = this.vertices, m = [], d = 0, g = 0, f = t.length; f > d; d += 3, g++) {
                var v = p[t[d]], y = p[t[d + 1]], b = p[t[d + 2]];
                m[g] = new n.Face3(v.index, y.index, b.index, [v.clone(), y.clone(), b.clone()])
            }
            for (var w = new n.Vector3, d = 0, f = m.length; f > d; d++)s(m[d], r);
            for (var d = 0, f = this.faceVertexUvs[0].length; f > d; d++) {
                var _ = this.faceVertexUvs[0][d], x = _[0].x, S = _[1].x, E = _[2].x, M = Math.max(x, Math.max(S, E)), A = Math.min(x, Math.min(S, E));
                M > .9 && .1 > A && (.2 > x && (_[0].x += 1), .2 > S && (_[1].x += 1), .2 > E && (_[2].x += 1))
            }
            for (var d = 0, f = this.vertices.length; f > d; d++)this.vertices[d].multiplyScalar(i);
            this.mergeVertices(), this.computeFaceNormals(), this.boundingSphere = new n.Sphere(new n.Vector3, i)
        },n.PolyhedronGeometry.prototype = Object.create(n.Geometry.prototype),n.PolyhedronGeometry.prototype.constructor = n.PolyhedronGeometry,n.DodecahedronGeometry = function (e, t) {
            this.parameters = {radius: e, detail: t};
            var i = (1 + Math.sqrt(5)) / 2, r = 1 / i, o = [-1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 0, -r, -i, 0, -r, i, 0, r, -i, 0, r, i, -r, -i, 0, -r, i, 0, r, -i, 0, r, i, 0, -i, 0, -r, i, 0, -r, -i, 0, r, i, 0, r], a = [3, 11, 7, 3, 7, 15, 3, 15, 13, 7, 19, 17, 7, 17, 6, 7, 6, 15, 17, 4, 8, 17, 8, 10, 17, 10, 6, 8, 0, 16, 8, 16, 2, 8, 2, 10, 0, 12, 1, 0, 1, 18, 0, 18, 16, 6, 10, 2, 6, 2, 13, 6, 13, 15, 2, 16, 18, 2, 18, 3, 2, 3, 13, 18, 1, 9, 18, 9, 11, 18, 11, 3, 4, 14, 12, 4, 12, 0, 4, 0, 8, 11, 9, 5, 11, 5, 19, 11, 19, 7, 19, 5, 14, 19, 14, 4, 19, 4, 17, 1, 12, 14, 1, 14, 5, 1, 5, 9];
            n.PolyhedronGeometry.call(this, o, a, e, t)
        },n.DodecahedronGeometry.prototype = Object.create(n.Geometry.prototype),n.DodecahedronGeometry.prototype.constructor = n.DodecahedronGeometry,n.IcosahedronGeometry = function (e, t) {
            var i = (1 + Math.sqrt(5)) / 2, r = [-1, i, 0, 1, i, 0, -1, -i, 0, 1, -i, 0, 0, -1, i, 0, 1, i, 0, -1, -i, 0, 1, -i, i, 0, -1, i, 0, 1, -i, 0, -1, -i, 0, 1], o = [0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11, 1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8, 3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9, 4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1];
            n.PolyhedronGeometry.call(this, r, o, e, t), this.type = "IcosahedronGeometry", this.parameters = {
                radius: e,
                detail: t
            }
        },n.IcosahedronGeometry.prototype = Object.create(n.Geometry.prototype),n.IcosahedronGeometry.prototype.constructor = n.IcosahedronGeometry,n.OctahedronGeometry = function (e, t) {
            this.parameters = {radius: e, detail: t};
            var i = [1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1], r = [0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2];
            n.PolyhedronGeometry.call(this, i, r, e, t), this.type = "OctahedronGeometry", this.parameters = {
                radius: e,
                detail: t
            }
        },n.OctahedronGeometry.prototype = Object.create(n.Geometry.prototype),n.OctahedronGeometry.prototype.constructor = n.OctahedronGeometry,n.TetrahedronGeometry = function (e, t) {
            var i = [1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1], r = [2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1];
            n.PolyhedronGeometry.call(this, i, r, e, t), this.type = "TetrahedronGeometry", this.parameters = {
                radius: e,
                detail: t
            }
        },n.TetrahedronGeometry.prototype = Object.create(n.Geometry.prototype),n.TetrahedronGeometry.prototype.constructor = n.TetrahedronGeometry,n.ParametricGeometry = function (e, t, i) {
            n.Geometry.call(this), this.type = "ParametricGeometry", this.parameters = {func: e, slices: t, stacks: i};
            var r, o, a, s, h, l = this.vertices, u = this.faces, c = this.faceVertexUvs[0], d = t + 1;
            for (r = 0; i >= r; r++)for (h = r / i, o = 0; t >= o; o++)s = o / t, a = e(s, h), l.push(a);
            var f, p, m, g, v, y, b, w;
            for (r = 0; i > r; r++)for (o = 0; t > o; o++)f = r * d + o, p = r * d + o + 1, m = (r + 1) * d + o + 1, g = (r + 1) * d + o, v = new n.Vector2(o / t, r / i), y = new n.Vector2((o + 1) / t, r / i), b = new n.Vector2((o + 1) / t, (r + 1) / i), w = new n.Vector2(o / t, (r + 1) / i), u.push(new n.Face3(f, p, g)), c.push([v, y, w]), u.push(new n.Face3(p, m, g)), c.push([y.clone(), b, w.clone()]);
            this.computeFaceNormals(), this.computeVertexNormals()
        },n.ParametricGeometry.prototype = Object.create(n.Geometry.prototype),n.ParametricGeometry.prototype.constructor = n.ParametricGeometry,n.AxisHelper = function (e) {
            e = e || 1;
            var t = new Float32Array([0, 0, 0, e, 0, 0, 0, 0, 0, 0, e, 0, 0, 0, 0, 0, 0, e]), i = new Float32Array([1, 0, 0, 1, .6, 0, 0, 1, 0, .6, 1, 0, 0, 0, 1, 0, .6, 1]), r = new n.BufferGeometry;
            r.addAttribute("position", new n.BufferAttribute(t, 3)), r.addAttribute("color", new n.BufferAttribute(i, 3));
            var o = new n.LineBasicMaterial({vertexColors: n.VertexColors});
            n.Line.call(this, r, o, n.LinePieces)
        },n.AxisHelper.prototype = Object.create(n.Line.prototype),n.AxisHelper.prototype.constructor = n.AxisHelper,n.ArrowHelper = function () {
            var e = new n.Geometry;
            e.vertices.push(new n.Vector3(0, 0, 0), new n.Vector3(0, 1, 0));
            var t = new n.CylinderGeometry(0, .5, 1, 5, 1);
            return t.applyMatrix((new n.Matrix4).makeTranslation(0, -.5, 0)), function (i, r, o, a, s, h) {
                n.Object3D.call(this), void 0 === a && (a = 16776960), void 0 === o && (o = 1), void 0 === s && (s = .2 * o), void 0 === h && (h = .2 * s), this.position.copy(r), this.line = new n.Line(e, new n.LineBasicMaterial({color: a})), this.line.matrixAutoUpdate = !1, this.add(this.line), this.cone = new n.Mesh(t, new n.MeshBasicMaterial({color: a})), this.cone.matrixAutoUpdate = !1, this.add(this.cone), this.setDirection(i), this.setLength(o, s, h)
            }
        }(),n.ArrowHelper.prototype = Object.create(n.Object3D.prototype),n.ArrowHelper.prototype.constructor = n.ArrowHelper,n.ArrowHelper.prototype.setDirection = function () {
            var e, t = new n.Vector3;
            return function (i) {
                i.y > .99999 ? this.quaternion.set(0, 0, 0, 1) : i.y < -.99999 ? this.quaternion.set(1, 0, 0, 0) : (t.set(i.z, 0, -i.x).normalize(), e = Math.acos(i.y), this.quaternion.setFromAxisAngle(t, e))
            }
        }(),n.ArrowHelper.prototype.setLength = function (e, t, i) {
            void 0 === t && (t = .2 * e), void 0 === i && (i = .2 * t), this.line.scale.set(1, e - t, 1), this.line.updateMatrix(), this.cone.scale.set(i, t, i), this.cone.position.y = e, this.cone.updateMatrix()
        },n.ArrowHelper.prototype.setColor = function (e) {
            this.line.material.color.set(e), this.cone.material.color.set(e)
        },n.BoxHelper = function (e) {
            var t = new n.BufferGeometry;
            t.addAttribute("position", new n.BufferAttribute(new Float32Array(72), 3)), n.Line.call(this, t, new n.LineBasicMaterial({color: 16776960}), n.LinePieces), void 0 !== e && this.update(e)
        },n.BoxHelper.prototype = Object.create(n.Line.prototype),n.BoxHelper.prototype.constructor = n.BoxHelper,n.BoxHelper.prototype.update = function (e) {
            var t = e.geometry;
            null === t.boundingBox && t.computeBoundingBox();
            var i = t.boundingBox.min, r = t.boundingBox.max, n = this.geometry.attributes.position.array;
            n[0] = r.x, n[1] = r.y, n[2] = r.z, n[3] = i.x, n[4] = r.y, n[5] = r.z, n[6] = i.x, n[7] = r.y, n[8] = r.z, n[9] = i.x, n[10] = i.y, n[11] = r.z, n[12] = i.x, n[13] = i.y, n[14] = r.z, n[15] = r.x, n[16] = i.y, n[17] = r.z, n[18] = r.x, n[19] = i.y, n[20] = r.z, n[21] = r.x, n[22] = r.y, n[23] = r.z, n[24] = r.x, n[25] = r.y, n[26] = i.z, n[27] = i.x, n[28] = r.y, n[29] = i.z, n[30] = i.x, n[31] = r.y, n[32] = i.z, n[33] = i.x, n[34] = i.y, n[35] = i.z, n[36] = i.x, n[37] = i.y, n[38] = i.z, n[39] = r.x, n[40] = i.y, n[41] = i.z, n[42] = r.x, n[43] = i.y, n[44] = i.z, n[45] = r.x, n[46] = r.y, n[47] = i.z, n[48] = r.x, n[49] = r.y, n[50] = r.z, n[51] = r.x, n[52] = r.y, n[53] = i.z, n[54] = i.x, n[55] = r.y, n[56] = r.z, n[57] = i.x, n[58] = r.y, n[59] = i.z, n[60] = i.x, n[61] = i.y, n[62] = r.z, n[63] = i.x, n[64] = i.y, n[65] = i.z, n[66] = r.x, n[67] = i.y, n[68] = r.z, n[69] = r.x, n[70] = i.y, n[71] = i.z, this.geometry.attributes.position.needsUpdate = !0, this.geometry.computeBoundingSphere(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1
        },n.BoundingBoxHelper = function (e, t) {
            var i = void 0 !== t ? t : 8947848;
            this.object = e, this.box = new n.Box3, n.Mesh.call(this, new n.BoxGeometry(1, 1, 1), new n.MeshBasicMaterial({
                color: i,
                wireframe: !0
            }))
        },n.BoundingBoxHelper.prototype = Object.create(n.Mesh.prototype),n.BoundingBoxHelper.prototype.constructor = n.BoundingBoxHelper,n.BoundingBoxHelper.prototype.update = function () {
            this.box.setFromObject(this.object), this.box.size(this.scale), this.box.center(this.position)
        },n.CameraHelper = function (e) {
            function t(e, t, r) {
                i(e, r), i(t, r)
            }

            function i(e, t) {
                r.vertices.push(new n.Vector3), r.colors.push(new n.Color(t)), void 0 === a[e] && (a[e] = []), a[e].push(r.vertices.length - 1)
            }

            var r = new n.Geometry, o = new n.LineBasicMaterial({
                color: 16777215,
                vertexColors: n.FaceColors
            }), a = {}, s = 16755200, h = 16711680, l = 43775, u = 16777215, c = 3355443;
            t("n1", "n2", s), t("n2", "n4", s), t("n4", "n3", s), t("n3", "n1", s), t("f1", "f2", s), t("f2", "f4", s), t("f4", "f3", s), t("f3", "f1", s), t("n1", "f1", s), t("n2", "f2", s), t("n3", "f3", s), t("n4", "f4", s), t("p", "n1", h), t("p", "n2", h), t("p", "n3", h), t("p", "n4", h), t("u1", "u2", l), t("u2", "u3", l), t("u3", "u1", l), t("c", "t", u), t("p", "c", c), t("cn1", "cn2", c), t("cn3", "cn4", c), t("cf1", "cf2", c), t("cf3", "cf4", c), n.Line.call(this, r, o, n.LinePieces), this.camera = e, this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.pointMap = a, this.update()
        },n.CameraHelper.prototype = Object.create(n.Line.prototype),n.CameraHelper.prototype.constructor = n.CameraHelper,n.CameraHelper.prototype.update = function () {
            var e, t, i = new n.Vector3, r = new n.Camera, o = function (n, o, a, s) {
                i.set(o, a, s).unproject(r);
                var h = t[n];
                if (void 0 !== h)for (var l = 0, u = h.length; u > l; l++)e.vertices[h[l]].copy(i)
            };
            return function () {
                e = this.geometry, t = this.pointMap;
                var i = 1, n = 1;
                r.projectionMatrix.copy(this.camera.projectionMatrix), o("c", 0, 0, -1), o("t", 0, 0, 1), o("n1", -i, -n, -1), o("n2", i, -n, -1), o("n3", -i, n, -1), o("n4", i, n, -1), o("f1", -i, -n, 1), o("f2", i, -n, 1), o("f3", -i, n, 1), o("f4", i, n, 1), o("u1", .7 * i, 1.1 * n, -1), o("u2", .7 * -i, 1.1 * n, -1), o("u3", 0, 2 * n, -1), o("cf1", -i, 0, 1), o("cf2", i, 0, 1), o("cf3", 0, -n, 1), o("cf4", 0, n, 1), o("cn1", -i, 0, -1), o("cn2", i, 0, -1), o("cn3", 0, -n, -1), o("cn4", 0, n, -1), e.verticesNeedUpdate = !0
            }
        }(),n.DirectionalLightHelper = function (e, t) {
            n.Object3D.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, t = t || 1;
            var i = new n.Geometry;
            i.vertices.push(new n.Vector3(-t, t, 0), new n.Vector3(t, t, 0), new n.Vector3(t, -t, 0), new n.Vector3(-t, -t, 0), new n.Vector3(-t, t, 0));
            var r = new n.LineBasicMaterial({fog: !1});
            r.color.copy(this.light.color).multiplyScalar(this.light.intensity), this.lightPlane = new n.Line(i, r), this.add(this.lightPlane), i = new n.Geometry, i.vertices.push(new n.Vector3, new n.Vector3), r = new n.LineBasicMaterial({fog: !1}), r.color.copy(this.light.color).multiplyScalar(this.light.intensity), this.targetLine = new n.Line(i, r), this.add(this.targetLine), this.update()
        },n.DirectionalLightHelper.prototype = Object.create(n.Object3D.prototype),n.DirectionalLightHelper.prototype.constructor = n.DirectionalLightHelper,n.DirectionalLightHelper.prototype.dispose = function () {
            this.lightPlane.geometry.dispose(), this.lightPlane.material.dispose(), this.targetLine.geometry.dispose(), this.targetLine.material.dispose()
        },n.DirectionalLightHelper.prototype.update = function () {
            var e = new n.Vector3, t = new n.Vector3, i = new n.Vector3;
            return function () {
                e.setFromMatrixPosition(this.light.matrixWorld), t.setFromMatrixPosition(this.light.target.matrixWorld), i.subVectors(t, e), this.lightPlane.lookAt(i), this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity), this.targetLine.geometry.vertices[1].copy(i), this.targetLine.geometry.verticesNeedUpdate = !0, this.targetLine.material.color.copy(this.lightPlane.material.color)
            }
        }(),n.EdgesHelper = function (e, t, i) {
            var r = void 0 !== t ? t : 16777215;
            i = void 0 !== i ? i : 1;
            var o, a = Math.cos(n.Math.degToRad(i)), s = [0, 0], h = {}, l = function (e, t) {
                return e - t
            }, u = ["a", "b", "c"], c = new n.BufferGeometry;
            e.geometry instanceof n.BufferGeometry ? (o = new n.Geometry, o.fromBufferGeometry(e.geometry)) : o = e.geometry.clone(), o.mergeVertices(), o.computeFaceNormals();
            for (var d = o.vertices, f = o.faces, p = 0, m = 0, g = f.length; g > m; m++)for (var v = f[m], y = 0; 3 > y; y++) {
                s[0] = v[u[y]], s[1] = v[u[(y + 1) % 3]], s.sort(l);
                var b = s.toString();
                void 0 === h[b] ? (h[b] = {vert1: s[0], vert2: s[1], face1: m, face2: void 0}, p++) : h[b].face2 = m
            }
            var w = new Float32Array(2 * p * 3), _ = 0;
            for (var b in h) {
                var x = h[b];
                if (void 0 === x.face2 || f[x.face1].normal.dot(f[x.face2].normal) <= a) {
                    var S = d[x.vert1];
                    w[_++] = S.x, w[_++] = S.y, w[_++] = S.z, S = d[x.vert2], w[_++] = S.x, w[_++] = S.y, w[_++] = S.z
                }
            }
            c.addAttribute("position", new n.BufferAttribute(w, 3)), n.Line.call(this, c, new n.LineBasicMaterial({color: r}), n.LinePieces), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1
        },n.EdgesHelper.prototype = Object.create(n.Line.prototype),n.EdgesHelper.prototype.constructor = n.EdgesHelper,n.FaceNormalsHelper = function (e, t, i, r) {
            this.object = e, this.size = void 0 !== t ? t : 1;
            for (var o = void 0 !== i ? i : 16776960, a = void 0 !== r ? r : 1, s = new n.Geometry, h = this.object.geometry.faces, l = 0, u = h.length; u > l; l++)s.vertices.push(new n.Vector3, new n.Vector3);
            n.Line.call(this, s, new n.LineBasicMaterial({
                color: o,
                linewidth: a
            }), n.LinePieces), this.matrixAutoUpdate = !1, this.normalMatrix = new n.Matrix3, this.update()
        },n.FaceNormalsHelper.prototype = Object.create(n.Line.prototype),n.FaceNormalsHelper.prototype.constructor = n.FaceNormalsHelper,n.FaceNormalsHelper.prototype.update = function () {
            var e = this.geometry.vertices, t = this.object, i = t.geometry.vertices, r = t.geometry.faces, n = t.matrixWorld;
            t.updateMatrixWorld(!0), this.normalMatrix.getNormalMatrix(n);
            for (var o = 0, a = 0, s = r.length; s > o; o++, a += 2) {
                var h = r[o];
                e[a].copy(i[h.a]).add(i[h.b]).add(i[h.c]).divideScalar(3).applyMatrix4(n), e[a + 1].copy(h.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[a])
            }
            return this.geometry.verticesNeedUpdate = !0, this
        },n.GridHelper = function (e, t) {
            var i = new n.Geometry, r = new n.LineBasicMaterial({vertexColors: n.VertexColors});
            this.color1 = new n.Color(4473924), this.color2 = new n.Color(8947848);
            for (var o = -e; e >= o; o += t) {
                i.vertices.push(new n.Vector3(-e, 0, o), new n.Vector3(e, 0, o), new n.Vector3(o, 0, -e), new n.Vector3(o, 0, e));
                var a = 0 === o ? this.color1 : this.color2;
                i.colors.push(a, a, a, a)
            }
            n.Line.call(this, i, r, n.LinePieces)
        },n.GridHelper.prototype = Object.create(n.Line.prototype),n.GridHelper.prototype.constructor = n.GridHelper,n.GridHelper.prototype.setColors = function (e, t) {
            this.color1.set(e), this.color2.set(t), this.geometry.colorsNeedUpdate = !0
        },n.HemisphereLightHelper = function (e, t) {
            n.Object3D.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.colors = [new n.Color, new n.Color];
            var i = new n.SphereGeometry(t, 4, 2);
            i.applyMatrix((new n.Matrix4).makeRotationX(-Math.PI / 2));
            for (var r = 0, o = 8; o > r; r++)i.faces[r].color = this.colors[4 > r ? 0 : 1];
            var a = new n.MeshBasicMaterial({vertexColors: n.FaceColors, wireframe: !0});
            this.lightSphere = new n.Mesh(i, a), this.add(this.lightSphere), this.update()
        },n.HemisphereLightHelper.prototype = Object.create(n.Object3D.prototype),n.HemisphereLightHelper.prototype.constructor = n.HemisphereLightHelper,n.HemisphereLightHelper.prototype.dispose = function () {
            this.lightSphere.geometry.dispose(), this.lightSphere.material.dispose()
        },n.HemisphereLightHelper.prototype.update = function () {
            var e = new n.Vector3;
            return function () {
                this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity), this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity), this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()), this.lightSphere.geometry.colorsNeedUpdate = !0
            }
        }(),n.PointLightHelper = function (e, t) {
            this.light = e, this.light.updateMatrixWorld();
            var i = new n.SphereGeometry(t, 4, 2), r = new n.MeshBasicMaterial({wireframe: !0, fog: !1});
            r.color.copy(this.light.color).multiplyScalar(this.light.intensity), n.Mesh.call(this, i, r), this.matrix = this.light.matrixWorld, this.matrixAutoUpdate = !1
        },n.PointLightHelper.prototype = Object.create(n.Mesh.prototype),n.PointLightHelper.prototype.constructor = n.PointLightHelper,n.PointLightHelper.prototype.dispose = function () {
            this.geometry.dispose(), this.material.dispose()
        },n.PointLightHelper.prototype.update = function () {
            this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)
        },n.SkeletonHelper = function (e) {
            this.bones = this.getBoneList(e);
            for (var t = new n.Geometry, i = 0; i < this.bones.length; i++) {
                var r = this.bones[i];
                r.parent instanceof n.Bone && (t.vertices.push(new n.Vector3), t.vertices.push(new n.Vector3), t.colors.push(new n.Color(0, 0, 1)), t.colors.push(new n.Color(0, 1, 0)))
            }
            var o = new n.LineBasicMaterial({
                vertexColors: n.VertexColors,
                depthTest: !1,
                depthWrite: !1,
                transparent: !0
            });
            n.Line.call(this, t, o, n.LinePieces), this.root = e, this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.update()
        },n.SkeletonHelper.prototype = Object.create(n.Line.prototype),n.SkeletonHelper.prototype.constructor = n.SkeletonHelper,n.SkeletonHelper.prototype.getBoneList = function (e) {
            var t = [];
            e instanceof n.Bone && t.push(e);
            for (var i = 0; i < e.children.length; i++)t.push.apply(t, this.getBoneList(e.children[i]));
            return t
        },n.SkeletonHelper.prototype.update = function () {
            for (var e = this.geometry, t = (new n.Matrix4).getInverse(this.root.matrixWorld), i = new n.Matrix4, r = 0, o = 0; o < this.bones.length; o++) {
                var a = this.bones[o];
                a.parent instanceof n.Bone && (i.multiplyMatrices(t, a.matrixWorld), e.vertices[r].setFromMatrixPosition(i), i.multiplyMatrices(t, a.parent.matrixWorld), e.vertices[r + 1].setFromMatrixPosition(i), r += 2)
            }
            e.verticesNeedUpdate = !0, e.computeBoundingSphere()
        },n.SpotLightHelper = function (e) {
            n.Object3D.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1;
            var t = new n.CylinderGeometry(0, 1, 1, 8, 1, !0);
            t.applyMatrix((new n.Matrix4).makeTranslation(0, -.5, 0)), t.applyMatrix((new n.Matrix4).makeRotationX(-Math.PI / 2));
            var i = new n.MeshBasicMaterial({wireframe: !0, fog: !1});
            this.cone = new n.Mesh(t, i), this.add(this.cone), this.update()
        },n.SpotLightHelper.prototype = Object.create(n.Object3D.prototype),n.SpotLightHelper.prototype.constructor = n.SpotLightHelper,n.SpotLightHelper.prototype.dispose = function () {
            this.cone.geometry.dispose(), this.cone.material.dispose()
        },n.SpotLightHelper.prototype.update = function () {
            var e = new n.Vector3, t = new n.Vector3;
            return function () {
                var i = this.light.distance ? this.light.distance : 1e4, r = i * Math.tan(this.light.angle);
                this.cone.scale.set(r, r, i), e.setFromMatrixPosition(this.light.matrixWorld), t.setFromMatrixPosition(this.light.target.matrixWorld), this.cone.lookAt(t.sub(e)), this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)
            }
        }(),n.VertexNormalsHelper = function (e, t, i, r) {
            this.object = e, this.size = void 0 !== t ? t : 1;
            for (var o = void 0 !== i ? i : 16711680, a = void 0 !== r ? r : 1, s = new n.Geometry, h = e.geometry.faces, l = 0, u = h.length; u > l; l++)for (var c = h[l], d = 0, f = c.vertexNormals.length; f > d; d++)s.vertices.push(new n.Vector3, new n.Vector3);
            n.Line.call(this, s, new n.LineBasicMaterial({
                color: o,
                linewidth: a
            }), n.LinePieces), this.matrixAutoUpdate = !1, this.normalMatrix = new n.Matrix3, this.update()
        },n.VertexNormalsHelper.prototype = Object.create(n.Line.prototype),n.VertexNormalsHelper.prototype.constructor = n.VertexNormalsHelper,n.VertexNormalsHelper.prototype.update = function (e) {
            var t = new n.Vector3;
            return function (e) {
                var i = ["a", "b", "c", "d"];
                this.object.updateMatrixWorld(!0), this.normalMatrix.getNormalMatrix(this.object.matrixWorld);
                for (var r = this.geometry.vertices, n = this.object.geometry.vertices, o = this.object.geometry.faces, a = this.object.matrixWorld, s = 0, h = 0, l = o.length; l > h; h++)for (var u = o[h], c = 0, d = u.vertexNormals.length; d > c; c++) {
                    var f = u[i[c]], p = n[f], m = u.vertexNormals[c];
                    r[s].copy(p).applyMatrix4(a), t.copy(m).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size), t.add(r[s]), s += 1, r[s].copy(t), s += 1
                }
                return this.geometry.verticesNeedUpdate = !0, this
            }
        }(),n.VertexTangentsHelper = function (e, t, i, r) {
            this.object = e, this.size = void 0 !== t ? t : 1;
            for (var o = void 0 !== i ? i : 255, a = void 0 !== r ? r : 1, s = new n.Geometry, h = e.geometry.faces, l = 0, u = h.length; u > l; l++)for (var c = h[l], d = 0, f = c.vertexTangents.length; f > d; d++)s.vertices.push(new n.Vector3), s.vertices.push(new n.Vector3);
            n.Line.call(this, s, new n.LineBasicMaterial({
                color: o,
                linewidth: a
            }), n.LinePieces), this.matrixAutoUpdate = !1, this.update()
        },n.VertexTangentsHelper.prototype = Object.create(n.Line.prototype),n.VertexTangentsHelper.prototype.constructor = n.VertexTangentsHelper,n.VertexTangentsHelper.prototype.update = function (e) {
            var t = new n.Vector3;
            return function (e) {
                var i = ["a", "b", "c", "d"];
                this.object.updateMatrixWorld(!0);
                for (var r = this.geometry.vertices, n = this.object.geometry.vertices, o = this.object.geometry.faces, a = this.object.matrixWorld, s = 0, h = 0, l = o.length; l > h; h++)for (var u = o[h], c = 0, d = u.vertexTangents.length; d > c; c++) {
                    var f = u[i[c]], p = n[f], m = u.vertexTangents[c];
                    r[s].copy(p).applyMatrix4(a), t.copy(m).transformDirection(a).multiplyScalar(this.size), t.add(r[s]), s += 1, r[s].copy(t), s += 1
                }
                return this.geometry.verticesNeedUpdate = !0, this
            }
        }(),n.WireframeHelper = function (e, t) {
            var i = void 0 !== t ? t : 16777215, r = [0, 0], o = {}, a = function (e, t) {
                return e - t
            }, s = ["a", "b", "c"], h = new n.BufferGeometry;
            if (e.geometry instanceof n.Geometry) {
                for (var l = e.geometry.vertices, u = e.geometry.faces, c = 0, d = new Uint32Array(6 * u.length), f = 0, p = u.length; p > f; f++)for (var m = u[f], g = 0; 3 > g; g++) {
                    r[0] = m[s[g]], r[1] = m[s[(g + 1) % 3]], r.sort(a);
                    var v = r.toString();
                    void 0 === o[v] && (d[2 * c] = r[0], d[2 * c + 1] = r[1], o[v] = !0, c++)
                }
                for (var y = new Float32Array(2 * c * 3), f = 0, p = c; p > f; f++)for (var g = 0; 2 > g; g++) {
                    var b = l[d[2 * f + g]], w = 6 * f + 3 * g;
                    y[w + 0] = b.x, y[w + 1] = b.y, y[w + 2] = b.z
                }
                h.addAttribute("position", new n.BufferAttribute(y, 3))
            } else if (e.geometry instanceof n.BufferGeometry)if (void 0 !== e.geometry.attributes.index) {
                var l = e.geometry.attributes.position.array, _ = e.geometry.attributes.index.array, x = e.geometry.drawcalls, c = 0;
                0 === x.length && (x = [{count: _.length, index: 0, start: 0}]);
                for (var d = new Uint32Array(2 * _.length), S = 0, E = x.length; E > S; ++S)for (var M = x[S].start, A = x[S].count, w = x[S].index, f = M, T = M + A; T > f; f += 3)for (var g = 0; 3 > g; g++) {
                    r[0] = w + _[f + g], r[1] = w + _[f + (g + 1) % 3], r.sort(a);
                    var v = r.toString();
                    void 0 === o[v] && (d[2 * c] = r[0], d[2 * c + 1] = r[1], o[v] = !0, c++)
                }
                for (var y = new Float32Array(2 * c * 3), f = 0, p = c; p > f; f++)for (var g = 0; 2 > g; g++) {
                    var w = 6 * f + 3 * g, C = 3 * d[2 * f + g];
                    y[w + 0] = l[C], y[w + 1] = l[C + 1], y[w + 2] = l[C + 2]
                }
                h.addAttribute("position", new n.BufferAttribute(y, 3))
            } else {
                for (var l = e.geometry.attributes.position.array, c = l.length / 3, P = c / 3, y = new Float32Array(2 * c * 3), f = 0, p = P; p > f; f++)for (var g = 0; 3 > g; g++) {
                    var w = 18 * f + 6 * g, L = 9 * f + 3 * g;
                    y[w + 0] = l[L], y[w + 1] = l[L + 1], y[w + 2] = l[L + 2];
                    var C = 9 * f + 3 * ((g + 1) % 3);
                    y[w + 3] = l[C], y[w + 4] = l[C + 1], y[w + 5] = l[C + 2]
                }
                h.addAttribute("position", new n.BufferAttribute(y, 3))
            }
            n.Line.call(this, h, new n.LineBasicMaterial({color: i}), n.LinePieces), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1
        },n.WireframeHelper.prototype = Object.create(n.Line.prototype),n.WireframeHelper.prototype.constructor = n.WireframeHelper,n.ImmediateRenderObject = function () {
            n.Object3D.call(this), this.render = function (e) {
            }
        },n.ImmediateRenderObject.prototype = Object.create(n.Object3D.prototype),n.ImmediateRenderObject.prototype.constructor = n.ImmediateRenderObject,n.MorphBlendMesh = function (e, t) {
            n.Mesh.call(this, e, t), this.animationsMap = {}, this.animationsList = [];
            var i = this.geometry.morphTargets.length, r = "__default", o = 0, a = i - 1, s = i / 1;
            this.createAnimation(r, o, a, s), this.setAnimationWeight(r, 1)
        },n.MorphBlendMesh.prototype = Object.create(n.Mesh.prototype),n.MorphBlendMesh.prototype.constructor = n.MorphBlendMesh,n.MorphBlendMesh.prototype.createAnimation = function (e, t, i, r) {
            var n = {
                startFrame: t,
                endFrame: i,
                length: i - t + 1,
                fps: r,
                duration: (i - t) / r,
                lastFrame: 0,
                currentFrame: 0,
                active: !1,
                time: 0,
                direction: 1,
                weight: 1,
                directionBackwards: !1,
                mirroredLoop: !1
            };
            this.animationsMap[e] = n, this.animationsList.push(n)
        },n.MorphBlendMesh.prototype.autoCreateAnimations = function (e) {
            for (var t, i = /([a-z]+)_?(\d+)/, r = {}, n = this.geometry, o = 0, a = n.morphTargets.length; a > o; o++) {
                var s = n.morphTargets[o], h = s.name.match(i);
                if (h && h.length > 1) {
                    var l = h[1];
                    r[l] || (r[l] = {start: 1 / 0, end: -(1 / 0)});
                    var u = r[l];
                    o < u.start && (u.start = o), o > u.end && (u.end = o), t || (t = l)
                }
            }
            for (var l in r) {
                var u = r[l];
                this.createAnimation(l, u.start, u.end, e)
            }
            this.firstAnimation = t
        },n.MorphBlendMesh.prototype.setAnimationDirectionForward = function (e) {
            var t = this.animationsMap[e];
            t && (t.direction = 1, t.directionBackwards = !1)
        },n.MorphBlendMesh.prototype.setAnimationDirectionBackward = function (e) {
            var t = this.animationsMap[e];
            t && (t.direction = -1, t.directionBackwards = !0)
        },n.MorphBlendMesh.prototype.setAnimationFPS = function (e, t) {
            var i = this.animationsMap[e];
            i && (i.fps = t, i.duration = (i.end - i.start) / i.fps)
        },n.MorphBlendMesh.prototype.setAnimationDuration = function (e, t) {
            var i = this.animationsMap[e];
            i && (i.duration = t, i.fps = (i.end - i.start) / i.duration)
        },n.MorphBlendMesh.prototype.setAnimationWeight = function (e, t) {
            var i = this.animationsMap[e];
            i && (i.weight = t)
        },n.MorphBlendMesh.prototype.setAnimationTime = function (e, t) {
            var i = this.animationsMap[e];
            i && (i.time = t)
        },n.MorphBlendMesh.prototype.getAnimationTime = function (e) {
            var t = 0, i = this.animationsMap[e];
            return i && (t = i.time), t
        },n.MorphBlendMesh.prototype.getAnimationDuration = function (e) {
            var t = -1, i = this.animationsMap[e];
            return i && (t = i.duration), t
        },n.MorphBlendMesh.prototype.playAnimation = function (e) {
            var t = this.animationsMap[e];
            t ? (t.time = 0, t.active = !0) : n.warn("THREE.MorphBlendMesh: animation[" + e + "] undefined in .playAnimation()")
        },n.MorphBlendMesh.prototype.stopAnimation = function (e) {
            var t = this.animationsMap[e];
            t && (t.active = !1)
        },n.MorphBlendMesh.prototype.update = function (e) {
            for (var t = 0, i = this.animationsList.length; i > t; t++) {
                var r = this.animationsList[t];
                if (r.active) {
                    var o = r.duration / r.length;
                    r.time += r.direction * e, r.mirroredLoop ? (r.time > r.duration || r.time < 0) && (r.direction *= -1, r.time > r.duration && (r.time = r.duration, r.directionBackwards = !0), r.time < 0 && (r.time = 0, r.directionBackwards = !1)) : (r.time = r.time % r.duration, r.time < 0 && (r.time += r.duration));
                    var a = r.startFrame + n.Math.clamp(Math.floor(r.time / o), 0, r.length - 1), s = r.weight;
                    a !== r.currentFrame && (this.morphTargetInfluences[r.lastFrame] = 0, this.morphTargetInfluences[r.currentFrame] = 1 * s, this.morphTargetInfluences[a] = 0, r.lastFrame = r.currentFrame, r.currentFrame = a);
                    var h = r.time % o / o;
                    r.directionBackwards && (h = 1 - h), this.morphTargetInfluences[r.currentFrame] = h * s, this.morphTargetInfluences[r.lastFrame] = (1 - h) * s
                }
            }
        },"undefined" != typeof i ? ("undefined" != typeof t && t.exports && (i = t.exports = n), i.THREE = n) : this.THREE = n
    }, {}]
}, {}, [54]);